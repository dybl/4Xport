/************No.1: A001******************HD_ZBMX_HZ***A001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A001')
begin
	print '����ָ��A001,��ָ��A001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A001','�ż����˴�','select "A001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10000','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','','timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey','','select "A001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.2: A001002******************HD_ZBMX_HZ***A001002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A001002')
begin
	print '����ָ��A001002,��ָ��A001002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A001002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A001002','�ӱ������ż����˴���','select ''A001002'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A001002'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A001002'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12803','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"}]','timekey,yykey,kskey,yskey','','select ''A001002'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.3: A001003******************HD_ZBMX_HZ***A001003******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A001003')
begin
	print '����ָ��A001003,��ָ��A001003�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A001003') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A001003','�ӱ������ż�������˴���ռ��','','select timekey,yykey,kskey,yskey,sum(ghrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ybghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''A001003'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001002'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A001003'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A001002,C001','12804','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ӱ������ż����˴���(A001002)/@�ż���ҽ���˴�(C001)','select ''A001003'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.4: A00101******************HD_ZBMX_HZ***A00101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00101')
begin
	print '����ָ��A00101,��ָ��A00101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00101','�����˴�','select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10001','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey','','select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.5: A00102******************HD_ZBMX_HZ***A00102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00102')
begin
	print '����ָ��A00102,��ָ��A00102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00102','�����˴�','select "A00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10002','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey','','select "A00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.6: A0010502******************HD_ZBMX_HZ***A0010502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A0010502')
begin
	print '����ָ��A0010502,��ָ��A0010502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A0010502') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A0010502','�ż���ҽ������','select "A0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10006','','','0','0','0','FACT_YY_MZ_PATID','patid','[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,mjzkey,ybflkey,cfzkey','','select "A0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.7: A0010503******************HD_ZBMX_HZ***A0010503******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A0010503')
begin
	print '����ָ��A0010503,��ָ��A0010503�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A0010503') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A0010503','�ż���ҽ����������','select "A0010503" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1)',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A0010503" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A0010503" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10007','','','0','0','0','FACT_YY_MZ_PATID','patid','[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"cfzbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,mjzkey,ybflkey,cfzkey','','select "A0010503" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.8: A0010903******************HD_ZBMX_HZ***A0010903******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A0010903')
begin
	print '����ָ��A0010903,��ָ��A0010903�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A0010903') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A0010903','ר�ҳ�����ͨ�����˴�','select "A0010903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select a.timekey,a.yykey,a.kskey,a.yskey,sum(a.ghrc) fz from FACT_YY_MZ_JZRC  a  inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by a.timekey,a.yykey,a.kskey,a.yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A0010903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(a.ghrc) fz from FACT_YY_MZ_JZRC  a  inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A0010903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(a.ghrc) fz from FACT_YY_MZ_JZRC  a  inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12782','','','0','1','-1','FACT_YY_MZ_JZRC ','sum(a.ghrc) fz',' inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in (''01'',''02'',''03'')','a.timekey,a.yykey,a.kskey,a.yskey','','select "A0010903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(a.ghrc) fz from FACT_YY_MZ_JZRC  a  inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.9: A0010904******************HD_ZBMX_HZ***A0010904******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A0010904')
begin
	print '����ָ��A0010904,��ָ��A0010904�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A0010904') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A0010904','ר�ҳ�����ͨ�����˴α���','','select ,sum(a.ghrc) fz,0 fm from FACT_YY_MZ_JZRC  a where a.timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by  union all select ,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by ','','select "A0010904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A0010903" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A0010904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A0010903" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A0010903,A00101','12783','','','0','-1','-1','','','','','@ר�ҳ�����ͨ�����˴�(A0010903)/@�����˴�(A00101)','select "A0010904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A0010903" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.10: A0010905******************HD_ZBMX_HZ***A0010905******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A0010905')
begin
	print '����ָ��A0010905,��ָ��A0010905�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A0010905') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A0010905','ר����ͨ�����ܳ������','select ''A0010905'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select a.timekey,a.yykey,a.kskey,a.yskey,sum(ghrc)*7/abs(datediff ( day,@kssj,@jssj)) fz from FACT_YY_MZ_JZRC a inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'') group by a.timekey,a.yykey,a.kskey,a.yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A0010905'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(ghrc)*7/abs(datediff ( day,@kssj,@jssj)) fz from FACT_YY_MZ_JZRC a inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'') group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A0010905'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(ghrc)*7/abs(datediff ( day,dateadd(year,-1,@kssj),dateadd(year,-1,@jssj))) fz from FACT_YY_MZ_JZRC a inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'') group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12848','','','0','-1','-1','FACT_YY_MZ_JZRC','sum(ghrc)*7/abs(datediff ( day,@kssj,@jssj)) fz','inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'')','a.timekey,a.yykey,a.kskey,a.yskey','','select ''A0010905'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(ghrc)*7/abs(datediff ( day,dateadd(month,-1,@kssj),dateadd(month,-1,@jssj))) fz from FACT_YY_MZ_JZRC a inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'') group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','1')
	
end
go

/************No.11: A00110******************HD_ZBMX_HZ***A00110******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00110')
begin
	print '����ָ��A00110,��ָ��A00110�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00110') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00110','ר�ҹҺ��˴�','select "A00110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10013','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','[{\"dim_key\":\"ghlbkey\",\"relation\":\"0\",\"caliber\":\"3\"}]','timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey','','select "A00110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.12: A001105******************HD_ZBMX_HZ***A001105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A001105')
begin
	print '����ָ��A001105,��ָ��A001105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A001105') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A001105','ר���˾�ÿ���յ��������˴�','','select timekey,yykey,kskey,sum(ghrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghhxzs) fm from FACT_YYGH_PBXX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by timekey,yykey,kskey','','select ''A001105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00110'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00803'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A001105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00110'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00803'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A00110,A00803','12786','','','0','-1','-1','','','','timekey,yykey,kskey','@ר�ҹҺ��˴�(A00110)/@ר���Ű��˴�(A00803)','select ''A001105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00110'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00803'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.13: A00140******************HD_ZBMX_HZ***A00140******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00140')
begin
	print '����ָ��A00140,��ָ��A00140�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00140') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00140','��ҽ�Һ��˴�(��ҽ�����˴���)','select "A00140" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) and kskey in (29) group by timekey,yykey,kskey,ghlbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00140" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) and kskey in (29) group by timekey,yykey,kskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00140" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) and kskey in (29) group by timekey,yykey,kskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11187','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1,2\"},{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"29\"}]','timekey,yykey,kskey,ghlbkey','','select "A00140" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) and kskey in (29) group by timekey,yykey,kskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.14: A0014001******************HD_ZBMX_HZ***A0014001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A0014001')
begin
	print '����ָ��A0014001,��ָ��A0014001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A0014001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A0014001','������ҽ�Һ��˴�(��ҽ�����˴���)','select ''A0014001'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey,yskey,ghlbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A0014001'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey,yskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A0014001'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey,yskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12647','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"46,53,58\"}]','timekey,yykey,kskey,yskey,ghlbkey','','select ''A0014001'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey,yskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.15: A00141******************HD_ZBMX_HZ***A00141******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00141')
begin
	print '����ָ��A00141,��ָ��A00141�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00141') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00141','��ҽ�Һ��˴�ռ��','','','','select "A00141" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00140" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A00141" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00140" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A00140,A001','11188','','','0','-1','-1','','','','timekey,hourkey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,yyfskey,zddmkey,sexkey,nldkey,czykey,dzkey,cfzkey','@��ҽ�Һ��˴�(��ҽ�����˴���)(A00140)/@�ż����˴�(A001)','select "A00141" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00140" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.16: A00142******************HD_ZBMX_HZ***A00142******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00142')
begin
	print '����ָ��A00142,��ָ��A00142�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00142') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00142','��ҽ��ҩ���Ʒ������˴�','select "A00142" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yblxkey,sum(zyfywlfrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00142" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yblxkey,sum(zyfywlfrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00142" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yblxkey,sum(zyfywlfrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11203','','','0','1','0','FACT_YY_MZ_JZRC','zyfywlfrc','','timekey,yykey,kskey,yblxkey','','select "A00142" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yblxkey,sum(zyfywlfrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.17: A00143******************HD_ZBMX_HZ***A00143******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00143')
begin
	print '����ָ��A00143,��ָ��A00143�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00143') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00143','��ҽ��ҩ���Ʒ������ʣ�%��','','','','select "A00143" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00142" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A00143" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00142" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A00142,A001','11204','','','0','-1','-1','','','','timekey,hourkey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,yyfskey,zddmkey,sexkey,nldkey,czykey,dzkey,cfzkey','@��ҽ��ҩ���Ʒ������˴�(A00142)/@�ż����˴�(A001)','select "A00143" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00142" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.18: A002******************HD_ZBMX_HZ***A002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A002')
begin
	print '����ָ��A002,��ָ��A002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A002','��������˴�','select "A002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(tjrc) fz from FACT_YY_MZ_TJRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(tjrc) fz from FACT_YY_MZ_TJRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(tjrc) fz from FACT_YY_MZ_TJRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10032','','','0','1','0','FACT_YY_MZ_TJRC','tjrc','','timekey,yykey,kskey,yskey','','select "A002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(tjrc) fz from FACT_YY_MZ_TJRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.19: A0020******************HD_ZBMX_HZ***A0020******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A0020')
begin
	print '����ָ��A0020,��ָ��A0020�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A0020') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb A0020'

end
go

/************No.20: A002001******************HD_ZBMX_HZ***A002001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A002001')
begin
	print '����ָ��A002001,��ָ��A002001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A002001') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb A002001'

end
go

/************No.21: A002002******************HD_ZBMX_HZ***A002002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A002002')
begin
	print '����ָ��A002002,��ָ��A002002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A002002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A002002','�׼���ʷ��','','','','select ''A002002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A002001'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A0020'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A002002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A002001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A0020'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A002001,A0020','12780','','','0','-1','-1','','','','','@�׼���ʷ����(A002001)/@��鲡ʷ������(A0020)','select ''A002002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A002001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A0020'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.22: A00201******************HD_ZBMX_HZ***A00201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00201')
begin
	print '����ָ��A00201,��ָ��A00201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00201','��������˴���ռ��','','select timekey,yykey,kskey,yskey,sum(tjrc) fz,0 fm from FACT_YY_MZ_TJRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey','','select ''A00201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A002'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A00201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A002,A001','12870','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@��������˴�(A002)/@�ż����˴�(A001)','select ''A00201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.23: A0021******************HD_ZBMX_HZ***A0021******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A0021')
begin
	print '����ָ��A0021,��ָ��A0021�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A0021') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb A0021'

end
go

/************No.24: A002101******************HD_ZBMX_HZ***A002101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A002101')
begin
	print '����ָ��A002101,��ָ��A002101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A002101') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb A002101'

end
go

/************No.25: A002102******************HD_ZBMX_HZ***A002102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A002102')
begin
	print '����ָ��A002102,��ָ��A002102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A002102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A002102','ֲ����淶����ʹ����','','','','select "A002102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A002101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A0021" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A002102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A002101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A0021" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A002101,A0021','12784','','','0','-1','-1','','','','','@ֲ����淶����ʹ�ò�����(A002101)/@���ֲ����ʹ�ò�����(A0021)','select "A002102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A002101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A0021" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.26: A00301******************HD_ZBMX_HZ***A00301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00301')
begin
	print '����ָ��A00301,��ָ��A00301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00301','����ԤԼ��(%)','','select timekey,yykey,kskey,yskey,yyfskey,sum(yxyyjzrc) fz,0 fm from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey union all select timekey,yykey,kskey,yskey,yyfskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey','','select "A00301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00401" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A00301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A00401,A001','12333','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,yyfskey','@��ЧԤԼ�����˴�(A00401)/@�ż����˴�(A001)','select "A00301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.27: A00401******************HD_ZBMX_HZ***A00401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00401')
begin
	print '����ָ��A00401,��ָ��A00401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00401','��ЧԤԼ�����˴�','select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12332','','','0','1','0','FACT_YY_MZ_JZLC','rc','[{\"dim_key\":\"yybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.28: A00803******************HD_ZBMX_HZ***A00803******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00803')
begin
	print '����ָ��A00803,��ָ��A00803�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00803') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00803','ר���Ű��˴�','select "A00803" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select yykey,timekey,kskey,pbkmkey,hxlxkey,sum(ghhxzs) fz from FACT_YYGH_PBXX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by yykey,timekey,kskey,pbkmkey,hxlxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00803" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,pbkmkey,hxlxkey,sum(ghhxzs) fz from FACT_YYGH_PBXX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by yykey,timekey,kskey,pbkmkey,hxlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00803" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,pbkmkey,hxlxkey,sum(ghhxzs) fz from FACT_YYGH_PBXX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by yykey,timekey,kskey,pbkmkey,hxlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10045','','','0','1','0','FACT_YYGH_PBXX','ghhxzs','[{\"dim_key\":\"zjysbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','yykey,timekey,kskey,pbkmkey,hxlxkey','','select "A00803" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,pbkmkey,hxlxkey,sum(ghhxzs) fz from FACT_YYGH_PBXX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by yykey,timekey,kskey,pbkmkey,hxlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.29: A101******************HD_ZBMX_HZ***A101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A101')
begin
	print '����ָ��A101,��ָ��A101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A101','��Ժ�˴�','select "A101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ryrc) fz from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ryrc) fz from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ryrc) fz from FACT_YY_ZY_RYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10054','','','0','1','0','FACT_YY_ZY_RYYWLFX','ryrc','','timekey,yykey,kskey','','select "A101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ryrc) fz from FACT_YY_ZY_RYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.30: A10102******************HD_ZBMX_HZ***A10102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10102')
begin
	print '����ָ��A10102,��ָ��A10102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10102','����סԺ��','','select timekey,yykey,kskey,yskey,ybflkey,sum(ryrc) fz,0 fm from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,ybflkey','','select ''A10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A101,A001','12771','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey','@��Ժ�˴�(A101)/@�ż����˴�(A001)','select ''A10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.31: A10103******************HD_ZBMX_HZ***A10103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10103')
begin
	print '����ָ��A10103,��ָ��A10103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10103','��Ժ����','select ''A10103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,patid from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A10103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,patid from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A10103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,patid from FACT_YY_ZY_RYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12776','','','0','0','0','FACT_YY_ZY_RYYWLFX','patid','','timekey,yykey,kskey','','select ''A10103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,patid from FACT_YY_ZY_RYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.32: A10104******************HD_ZBMX_HZ***A10104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10104')
begin
	print '����ָ��A10104,��ָ��A10104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10104','סԺ�˴���ͷ��','','select timekey,yykey,kskey,sum(ryrc) fz,0 fm from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,patid fm from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))','','select ''A10104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10103'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A10104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10103'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A101,A10103','12777','','','0','-1','-1','','','','timekey,yykey,kskey','@��Ժ�˴�(A101)/@��Ժ����(A10103)','select ''A10104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10103'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.33: A102******************HD_ZBMX_HZ***A102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A102')
begin
	print '����ָ��A102,��ָ��A102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A102','��Ժ�˴�','select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10056','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','','timekey,yykey,kskey,ybflkey,cyfskey','','select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.34: A10213******************HD_ZBMX_HZ***A10213******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10213')
begin
	print '����ָ��A10213,��ָ��A10213�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10213') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10213','��Ժ����Ӧ����ҩ��Ƭ���˴�','select ''A10213'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A10213'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A10213'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12652','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"zyypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''A10213'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.35: A1021301******************HD_ZBMX_HZ***A1021301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021301')
begin
	print '����ָ��A1021301,��ָ��A1021301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021301','��Ժ����Ӧ����ҩ��Ƭ�˴α���','','select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select "A1021301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A10213" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A1021301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A10213" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A10213,A102','12653','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@��Ժ����Ӧ����ҩ��Ƭ���˴�(A10213)/@��Ժ�˴�(A102)','select "A1021301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A10213" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.36: A10214******************HD_ZBMX_HZ***A10214******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10214')
begin
	print '����ָ��A10214,��ָ��A10214�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10214') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10214','��Ժ����Ӧ����ҽ������������','select ''A10214'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A10214'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A10214'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12812','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"zyhlbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''A10214'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.37: A1021401******************HD_ZBMX_HZ***A1021401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021401')
begin
	print '����ָ��A1021401,��ָ��A1021401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021401','סԺ������ҽ��������Ӧ����','','select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''A1021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10214'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10214'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A10214,A102','12813','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@��Ժ����Ӧ����ҽ������������(A10214)/@��Ժ�˴�(A102)','select ''A1021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10214'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.38: A10215******************HD_ZBMX_HZ***A10215******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10215')
begin
	print '����ָ��A10215,��ָ��A10215�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10215') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10215','��Ժ��Ӧ�ù���ҽ���Ƽ�������Ա��','select ''A10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12810','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"zyzlbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''A10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.39: A1021501******************HD_ZBMX_HZ***A1021501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021501')
begin
	print '����ָ��A1021501,��ָ��A1021501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021501','��Ժ��Ӧ����ҽ���Ƽ�����Ա����','','select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''A1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10215'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10215'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A10215,A102','12811','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@��Ժ��Ӧ�ù���ҽ���Ƽ�������Ա��(A10215)/@��Ժ�˴�(A102)','select ''A1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10215'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.40: A10216******************HD_ZBMX_HZ***A10216******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10216')
begin
	print '����ָ��A10216,��ָ��A10216�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10216') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10216','סԺ��ҽҩ�ۺ������˴�','select "A10216" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A10216" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A10216" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12814','','','0','1','0','FACT_YY_MZ_JZRC','zyyzhzlrc','','timekey,yykey,kskey','','select "A10216" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.41: A1021601******************HD_ZBMX_HZ***A1021601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021601')
begin
	print '����ָ��A1021601,��ָ��A1021601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021601','��ҽҩ�ۺ�����ռסԺ�˴α���','','select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyyzhzlbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''A1021601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10216'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1021601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A10216,A102','12815','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@סԺ��ҽҩ�ۺ������˴�(A10216)/@��Ժ�˴�(A102)','select ''A1021601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.42: A10217******************HD_ZBMX_HZ***A10217******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10217')
begin
	print '����ָ��A10217,��ָ��A10217�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10217') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10217','������ҽҩ�ۺ������˴�','select "A10217" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A10217" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A10217" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12816','','','0','1','0','FACT_YY_MZ_JZRC','zyyzhzlrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "A10217" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.43: A1021701******************HD_ZBMX_HZ***A1021701******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021701')
begin
	print '����ָ��A1021701,��ָ��A1021701�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021701') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021701','��ҽҩ�ۺ�����ռ�����˴α���','','select timekey,yykey,kskey,sum(zyyzhzlrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey','','select "A1021701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A10217" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A1021701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A10217" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A10217,A00101','12817','','','0','-1','-1','','','','timekey,yykey,kskey','@������ҽҩ�ۺ������˴�(A10217)/@�����˴�(A00101)','select "A1021701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A10217" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.44: A10218******************HD_ZBMX_HZ***A10218******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10218')
begin
	print '����ָ��A10218,��ָ��A10218�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10218') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10218','��ҽԤ�����������˴���','select "A10218" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zyyfbjfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A10218" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyfbjfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A10218" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyfbjfwrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12818','','','0','1','0','FACT_YY_MZ_JZRC','zyyfbjfwrc','','timekey,yykey,kskey','','select "A10218" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyfbjfwrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.45: A1021801******************HD_ZBMX_HZ***A1021801******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021801')
begin
	print '����ָ��A1021801,��ָ��A1021801�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021801') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021801','��ҽԤ�����������˴�ռ�������˴α���','','select timekey,yykey,kskey,sum(zyyfbjfwrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey','','select "A1021801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A10218" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A1021801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A10218" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A10218,A00101','12819','','','0','-1','-1','','','','timekey,yykey,kskey','@��ҽԤ�����������˴���(A10218)/@�����˴�(A00101)','select "A1021801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A10218" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.46: A10219******************HD_ZBMX_HZ***A10219******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A10219')
begin
	print '����ָ��A10219,��ָ��A10219�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A10219') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A10219','������ҽ���Ƽ�����Ŀ����','select "A10219" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A10219" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A10219" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12820','','','0','1','0','FACT_YY_MZ_JZRC','zyzlxmcs','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select "A10219" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.47: A1021901******************HD_ZBMX_HZ***A1021901******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021901')
begin
	print '����ָ��A1021901,��ָ��A1021901�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021901') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021901','���ﻼ���˾�Ӧ����ҽ���Ƽ�����Ŀ����','','select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey','','select ''A1021901'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10219'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1021901'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10219'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A10219,A00101','12821','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@������ҽ���Ƽ�����Ŀ����(A10219)/@�����˴�(A00101)','select ''A1021901'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10219'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.48: A1024******************HD_ZBMX_HZ***A1024******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1024')
begin
	print '����ָ��A1024,��ָ��A1024�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1024') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1024','��Ժ�в����˴�','select ''A1024'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A1024'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A1024'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12764','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"ycfbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''A1024'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.49: A102401******************HD_ZBMX_HZ***A102401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A102401')
begin
	print '����ָ��A102401,��ָ��A102401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A102401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A102401','סԺ�����в�������','select "A102401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A102401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A102401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12765','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"ycfbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"3\"}]','timekey,yykey,kskey','','select "A102401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.50: A102402******************HD_ZBMX_HZ***A102402******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A102402')
begin
	print '����ָ��A102402,��ָ��A102402�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A102402') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A102402','�в���סԺ������','','select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey','','select ''A102402'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102401'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A1024'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A102402'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102401'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A1024'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A102401,A1024','12766','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@סԺ�����в�������(A102401)/@��Ժ�в����˴�(A1024)','select ''A102402'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102401'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A1024'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.51: A104******************HD_ZBMX_HZ***A104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A104')
begin
	print '����ָ��A104,��ָ��A104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A104','סԺ��������','select "A104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(sws) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(sws) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(sws) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10066','','','0','1','0','FACT_YY_ZYBRZYL','sws','','timekey,yykey,kskey','','select "A104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(sws) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.52: A105******************HD_ZBMX_HZ***A105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A105')
begin
	print '����ָ��A105,��ָ��A105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A105') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A105','ƽ��סԺ��','','','','select "A105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A111,A102','11511','','','0','-1','-1','','','','','@��Ժ����ʵ��ռ���ܴ���(A111)/@��Ժ�˴�(A102)','select "A105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.53: A106******************HD_ZBMX_HZ***A106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A106')
begin
	print '����ָ��A106,��ָ��A106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A106','��λ��ת����','','select timekey,yykey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz, fm from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  

  group by timekey,yykey,kskey,b.count_days','','select "A106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A113" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A113" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A102,A113','11655','','','0','-1','-1','','','','timekey,yykey,kskey','@��Ժ�˴�(A102)/@ƽ�����Ŵ�λ��(A113)','select "A106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A113" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.54: A107******************HD_ZBMX_HZ***A107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A107')
begin
	print '����ָ��A107,��ָ��A107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A107') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A107','��λʹ����(%)','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(kfcw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select "A107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A112" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A110" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A112" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A110" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A112,A110','11513','','','0','-1','-1','','','','timekey,yykey,kskey','@ʵ��ռ���ܴ�����(A112)/@ʵ�ʿ����ܴ�����(A110)','select "A107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A112" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A110" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.55: A108******************HD_ZBMX_HZ***A108******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A108')
begin
	print '����ָ��A108,��ָ��A108�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A108') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A108','סԺ���վ�����','','','','select "A108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A112"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A112"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00102,A112','11514','','','0','-1','-1','','','','','@סԺ����(B00102)/@ʵ��ռ���ܴ�����(A112)','select "A108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A112"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.56: A109******************HD_ZBMX_HZ***A109******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A109')
begin
	print '����ָ��A109,��ָ��A109�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A109') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A109','ƽ����λ������','','','','select "A109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A112"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A113"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A112"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A113"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A112,A113','11656','','','0','-1','-1','','','','','@ʵ��ռ���ܴ�����(A112)/@ƽ�����Ŵ�λ��(A113)','select "A109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A112"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A113"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.57: A110******************HD_ZBMX_HZ***A110******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A110')
begin
	print '����ָ��A110,��ָ��A110�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A110') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A110','ʵ�ʿ����ܴ�����','select "A110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(kfcw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(kfcw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(kfcw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10070','','','0','1','0','FACT_YY_ZY_CWSYQK','kfcw','','timekey,yykey,kskey','','select "A110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(kfcw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.58: A111******************HD_ZBMX_HZ***A111******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A111')
begin
	print '����ָ��A111,��ָ��A111�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A111') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A111','��Ժ����ʵ��ռ���ܴ���','select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10071','','','0','1','0','FACT_YY_ZY_CYYWLFX','zyts','','timekey,yykey,kskey','','select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.59: A11104******************HD_ZBMX_HZ***A11104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11104')
begin
	print '����ָ��A11104,��ָ��A11104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11104','������ͥ������������','select ''A11104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12843','','','0','1','0','FACT_YY_ZY_CYYWLFX','zyts','[{\"dim_key\":\"jtbcbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''A11104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.60: A11105******************HD_ZBMX_HZ***A11105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11105')
begin
	print '����ָ��A11105,��ָ��A11105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11105') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11105','��ͥ����ƽ��������','','select timekey,yykey,kskey,yskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey','','select ''A11105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11104'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''ZLZB_YY000101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A11105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''ZLZB_YY000101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11104,ZLZB_YY000101','12844','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@������ͥ������������(A11104)/@������ͥ��������(ZLZB_YY000101)','select ''A11105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''ZLZB_YY000101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.61: A1110601******************HD_ZBMX_HZ***A1110601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1110601')
begin
	print '����ָ��A1110601,��ָ��A1110601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1110601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1110601','�ӱ�����סԺ�����˴���ռ��','','select timekey,yykey,kskey,yskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyts) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey','','select ''A1110601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A111060101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A111060202'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1110601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A111060101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A111060202'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A111060101,A111060202','12809','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ӱ�����סԺ������(A111060101)/@ȫԺҽ��������סԺ������(A111060202)','select ''A1110601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A111060101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A111060202'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.62: A111060101******************HD_ZBMX_HZ***A111060101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A111060101')
begin
	print '����ָ��A111060101,��ָ��A111060101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A111060101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A111060101','�ӱ�����סԺ������','select ''A111060101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A111060101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A111060101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12808','','','0','1','0','FACT_YY_ZY_CYYWLFX','zyts','[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"}]','timekey,yykey,kskey,yskey','','select ''A111060101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.63: A1110602******************HD_ZBMX_HZ***A1110602******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1110602')
begin
	print '����ָ��A1110602,��ָ��A1110602�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1110602') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1110602','�Ǳ�����סԺ�����˴���ռ��','','select timekey,yykey,kskey,yskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyts) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey','','select ''A1110602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A111060201'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A111060202'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1110602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A111060201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A111060202'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A111060201,A111060202','12792','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ�����סԺ������(A111060201)/@ȫԺҽ��������סԺ������(A111060202)','select ''A1110602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A111060201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A111060202'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.64: A111060201******************HD_ZBMX_HZ***A111060201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A111060201')
begin
	print '����ָ��A111060201,��ָ��A111060201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A111060201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A111060201','�Ǳ�����סԺ������','select ''A111060201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A111060201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A111060201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12791','','','0','1','0','FACT_YY_ZY_CYYWLFX','zyts','[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"}]','timekey,yykey,kskey,yskey','','select ''A111060201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.65: A111060202******************HD_ZBMX_HZ***A111060202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A111060202')
begin
	print '����ָ��A111060202,��ָ��A111060202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A111060202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A111060202','ȫԺҽ��������סԺ������','select ''A111060202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A111060202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A111060202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12790','','','0','1','0','FACT_YY_ZY_CYYWLFX','zyts','[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''A111060202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.66: A112******************HD_ZBMX_HZ***A112******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A112')
begin
	print '����ָ��A112,��ָ��A112�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A112') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A112','ʵ��ռ���ܴ�����','select "A112" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A112" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A112" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10072','','','0','1','0','FACT_YY_ZY_CWSYQK','zycw','','timekey,yykey,kskey','','select "A112" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.67: A1120101******************HD_ZBMX_HZ***A1120101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1120101')
begin
	print '����ָ��A1120101,��ָ��A1120101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1120101') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb A1120101'

end
go

/************No.68: A1120102******************HD_ZBMX_HZ***A1120102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1120102')
begin
	print '����ָ��A1120102,��ָ��A1120102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1120102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1120102','ʵ�ʿ������贲��������','','','','select ''A1120102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A1120101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1120102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A1120101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A1120101,A112','12781','','','0','-1','-1','','','','','@ʵ�ʿ������贲����(A1120101)/@ʵ��ռ���ܴ�����(A112)','select ''A1120102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A1120101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.69: A11202******************HD_ZBMX_HZ***A11202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11202')
begin
	print '����ָ��A11202,��ָ��A11202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11202','����ҽѧ��סԺʵ��ռ�ô���','select ''A11202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12731','','','0','1','0','FACT_YY_ZY_CWSYQK','zycw','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"62\"}]','timekey,yykey,kskey','','select ''A11202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.70: A1120201******************HD_ZBMX_HZ***A1120201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1120201')
begin
	print '����ָ��A1120201,��ָ��A1120201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1120201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1120201','����ҽѧ��סԺ����ռ��','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1120201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11202'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1120201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11202'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11202,A112','12732','','','0','-1','-1','','','','timekey,yykey,kskey','@����ҽѧ��סԺʵ��ռ�ô���(A11202)/@ʵ��ռ���ܴ�����(A112)','select ''A1120201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11202'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.71: A11203******************HD_ZBMX_HZ***A11203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11203')
begin
	print '����ָ��A11203,��ָ��A11203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11203','��ҽ��סԺʵ��ռ�ô���','select ''A11203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12733','','','0','1','0','FACT_YY_ZY_CWSYQK','zycw','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"46,47,48,49\"}]','timekey,yykey,kskey','','select ''A11203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.72: A1120301******************HD_ZBMX_HZ***A1120301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1120301')
begin
	print '����ָ��A1120301,��ָ��A1120301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1120301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1120301','��ҽ��סԺ����ռ��','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1120301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11203'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1120301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11203'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11203,A112','12734','','','0','-1','-1','','','','timekey,yykey,kskey','@��ҽ��סԺʵ��ռ�ô���(A11203)/@ʵ��ռ���ܴ�����(A112)','select ''A1120301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11203'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.73: A11204******************HD_ZBMX_HZ***A11204******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11204')
begin
	print '����ָ��A11204,��ָ��A11204�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11204') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11204','����סԺʵ��ռ�ô���','select ''A11204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12735','','','0','1','0','FACT_YY_ZY_CWSYQK','zycw','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"76\"}]','timekey,yykey,kskey','','select ''A11204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.74: A1120401******************HD_ZBMX_HZ***A1120401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1120401')
begin
	print '����ָ��A1120401,��ָ��A1120401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1120401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1120401','����סԺ����ռ��','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1120401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11204'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1120401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11204'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11204,A112','12736','','','0','-1','-1','','','','timekey,yykey,kskey','@����סԺʵ��ռ�ô���(A11204)/@ʵ��ռ���ܴ�����(A112)','select ''A1120401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11204'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.75: A11205******************HD_ZBMX_HZ***A11205******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11205')
begin
	print '����ָ��A11205,��ָ��A11205�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11205') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11205','��֢ҽѧ��סԺʵ��ռ�ô���','select ''A11205'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11205'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11205'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12737','','','0','1','0','FACT_YY_ZY_CWSYQK','zycw','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"7\"}]','timekey,yykey,kskey','','select ''A11205'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.76: A1120501******************HD_ZBMX_HZ***A1120501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1120501')
begin
	print '����ָ��A1120501,��ָ��A1120501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1120501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1120501','��֢ҽѧ��סԺ����ռ��','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1120501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11205'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1120501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11205'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11205,A112','12738','','','0','-1','-1','','','','timekey,yykey,kskey','@��֢ҽѧ��סԺʵ��ռ�ô���(A11205)/@ʵ��ռ���ܴ�����(A112)','select ''A1120501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11205'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.77: A11206******************HD_ZBMX_HZ***A11206******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11206')
begin
	print '����ָ��A11206,��ָ��A11206�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11206') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11206','����סԺʵ��ռ�ô���','select ''A11206'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11206'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11206'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12739','','','0','1','0','FACT_YY_ZY_CWSYQK','zycw','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"70\"}]','timekey,yykey,kskey','','select ''A11206'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.78: A1120601******************HD_ZBMX_HZ***A1120601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1120601')
begin
	print '����ָ��A1120601,��ָ��A1120601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1120601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1120601','����סԺ����ռ��','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1120601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11206'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1120601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11206'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11206,A112','12740','','','0','-1','-1','','','','timekey,yykey,kskey','@����סԺʵ��ռ�ô���(A11206)/@ʵ��ռ���ܴ�����(A112)','select ''A1120601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11206'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.79: A11208******************HD_ZBMX_HZ***A11208******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11208')
begin
	print '����ָ��A11208,��ָ��A11208�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11208') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11208','����ҽ�ƻ���סԺʵ��ռ�ô���','select ''A11208'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11208'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11208'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12729','','','0','1','0','FACT_YY_ZY_CWSYQK','zycw','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"8\"}]','timekey,yykey,kskey','','select ''A11208'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.80: A1120801******************HD_ZBMX_HZ***A1120801******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1120801')
begin
	print '����ָ��A1120801,��ָ��A1120801�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1120801') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1120801','����ҽ�ƻ���סԺ����ռ��','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1120801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11208'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1120801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11208'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11208,A112','12730','','','0','-1','-1','','','','timekey,yykey,kskey','@����ҽ�ƻ���סԺʵ��ռ�ô���(A11208)/@ʵ��ռ���ܴ�����(A112)','select ''A1120801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11208'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.81: A11209******************HD_ZBMX_HZ***A11209******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11209')
begin
	print '����ָ��A11209,��ָ��A11209�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11209') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11209','�껯ʵ��ռ�ô���','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey','','select ''A11209'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A11209'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A112,A001','12785','','','0','-1','-1','','','','timekey,yykey,kskey','@ʵ��ռ���ܴ�����(A112)/@�ż����˴�(A001)','select ''A11209'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.82: A11210******************HD_ZBMX_HZ***A11210******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11210')
begin
	print '����ָ��A11210,��ָ��A11210�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11210') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11210','��ԺΣ�ز���ռ�ô�����','select ''A11210'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11210'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11210'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12871','','','0','1','0','FACT_YY_ZY_CYYWLFX','zyts','[{\"dim_key\":\"wzrc\",\"relation\":\"2\",\"caliber\":\"0\"}]','timekey,yykey,kskey,yskey','','select ''A11210'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.83: A1121001******************HD_ZBMX_HZ***A1121001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1121001')
begin
	print '����ָ��A1121001,��ָ��A1121001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1121001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1121001','Σ�ز���ռ�ô�λ��','','select timekey,yykey,kskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1121001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11210'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1121001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11210'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11210,A112','12872','','','0','-1','-1','','','','timekey,yykey,kskey','@��ԺΣ�ز���ռ�ô�����(A11210)/@ʵ��ռ���ܴ�����(A112)','select ''A1121001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11210'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.84: A11211******************HD_ZBMX_HZ***A11211******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11211')
begin
	print '����ָ��A11211,��ָ��A11211�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11211') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11211','�����סԺʵ��ռ�ô���','select ''A11211'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11211'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''A11211'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12873','','','0','1','0','FACT_YY_ZY_CWSYQK','zycw','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"70\"}]','timekey,yykey,kskey','','select ''A11211'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.85: A1121101******************HD_ZBMX_HZ***A1121101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1121101')
begin
	print '����ָ��A1121101,��ָ��A1121101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1121101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1121101','�����סԺ����ռ��','','select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1121101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11211'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1121101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11211'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11211,A112','12874','','','0','-1','-1','','','','timekey,yykey,kskey','@�����סԺʵ��ռ�ô���(A11211)/@ʵ��ռ���ܴ�����(A112)','select ''A1121101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11211'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.86: A11212******************HD_ZBMX_HZ***A11212******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A11212')
begin
	print '����ָ��A11212,��ָ��A11212�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A11212') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A11212','ĸӤͬ��ʵ��ռ�ô���','select "A11212" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A11212" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A11212" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12876','','','0','1','0','FACT_YY_ZY_CYYWLFX','zyts','[{\"dim_key\":\"yebz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"ycfbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select "A11212" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.87: A1121201******************HD_ZBMX_HZ***A1121201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1121201')
begin
	print '����ָ��A1121201,��ָ��A1121201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1121201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1121201','ĸӤͬ�Ҵ���ռ��','','select timekey,yykey,kskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''A1121201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11212'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A1121201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11212'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A11212,A112','12877','','','0','-1','-1','','','','timekey,yykey,kskey','@ĸӤͬ��ʵ��ռ�ô���(A11212)/@ʵ��ռ���ܴ�����(A112)','select ''A1121201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11212'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.88: A113******************HD_ZBMX_HZ***A113******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A113')
begin
	print '����ָ��A113,��ָ��A113�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A113') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A113','ƽ�����Ŵ�λ��','','select timekey,yykey,kskey,sum(kfcw)*1.0/b.count_days fz   



  from FACT_YY_ZY_CWSYQK a   



  left join (SELECT CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") month,COUNT(1) count_days                                                                                                   



  from DIM_TIME d                                                                                            



  GROUP BY  CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1")    



  )b   on (CONVERT(CHAR(8),a.timekey,120)+"1")=b.month  



  where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  



  group by timekey,yykey,kskey,b.count_days','','select "A113" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120) + "1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (



select timekey,yykey,kskey,sum(kfcw)*1.0/b.count_days fz 



from FACT_YY_ZY_CWSYQK a 



left join (SELECT CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") month,COUNT(1) count_days                                                                                                 



from DIM_TIME d                                                                                              



GROUP BY  CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") 



 )b 



on (CONVERT(CHAR(8),a.timekey,120)+"1")=b.month



where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))



group by timekey,yykey,kskey,b.count_days



)



 a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120) + "1")



',' select "A113" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (



select timekey,yykey,kskey,sum(kfcw)*1.0/b.count_days fz 



from FACT_YY_ZY_CWSYQK a 



left join 



(SELECT CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") month,COUNT(1) count_days                                                                                                  



from DIM_TIME d                                                                                       



GROUP BY  CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1")



 )b 



on (CONVERT(CHAR(8),a.timekey,120)+"1")=b.month



where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) 



and (a.yykey in (@yykey) or -1 in (@yykey))



group by timekey,yykey,kskey,b.count_days



)



 a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")



','1','','','11646','','','0','-1','-1','','','','timekey,yykey,kskey','','



select "A113" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,



convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq ,



null bqkey from (  



select timekey,yykey,kskey,sum(kfcw)*1.0/b.count_days fz  



 from FACT_YY_ZY_CWSYQK a   



 left join (SELECT CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") month,COUNT(1) count_days   



 from DIM_TIME d                                                                                      



  GROUP BY  CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1")   )b   



  on (CONVERT(CHAR(8),a.timekey,120)+"1")=b.month 



  where timekey between  dateadd(month,-1,@kssj) and  dateadd(month,-1,@jssj) 



  and (a.yykey in (@yykey) or -1 in (@yykey))  group by timekey,yykey,kskey,b.count_days  )   a 



  inner join DIM_YYXX b on a.yykey=b.yykey 



  inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey 



  group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") ','','0')
	
end
go

/************No.89: A114******************HD_ZBMX_HZ***A114******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A114')
begin
	print '����ָ��A114,��ָ��A114�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A114') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A114','ƽ��ÿҽ����Ժ�˴�','','','','select ''A114'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''ZLZB_YY000401'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''A114'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''ZLZB_YY000401'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A102,ZLZB_YY000401','12885','','','0','-1','-1','','','','','@��Ժ�˴�(A102)/@����������Ա����(ZLZB_YY000401)','select ''A114'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''ZLZB_YY000401'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.90: A322******************HD_ZBMX_HZ***A322******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A322')
begin
	print '����ָ��A322,��ָ��A322�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A322') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A322','����ҽ�Ʒ�����','-1','select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey','-1','select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32203" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32203" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','A32202,A32203','12884','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�ż�������ҽ�Ʒ�����(A32202)+@סԺ����ҽ�Ʒ�����(A32203)','select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32203" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.91: A32201******************HD_ZBMX_HZ***A32201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A32201')
begin
	print '����ָ��A32201,��ָ��A32201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A32201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A32201','����ҽ�Ʒ�����ռ��','-1','select timekey,yykey,kskey,sum(txylfwrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','-1','select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A322" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A323" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A322" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A323" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','A322,A323','12520','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@����ҽ�Ʒ�����(A322)/@ҽ�Ʒ�����(A323)','select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A322" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A323" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.92: A323******************HD_ZBMX_HZ***A323******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A323')
begin
	print '����ָ��A323,��ָ��A323�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A323') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A323','ҽ�Ʒ�����','-1','select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey union all select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(-cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey','-1','select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','A00101,A102','13000','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey','@�����˴�(A00101)+@��Ժ�˴�(A102)','select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.93: B001******************HD_ZBMX_HZ***B001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B001')
begin
	print '����ָ��B001,��ָ��B001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B001','ҽԺ�ܷ���','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,0 fm,null czry,getdate() gxrq ,bqkey from ( select yykey,yydm,kskey,ksdm,month,fz_tq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00101'' and month between @kssj and @jssj   union all select yykey,yydm,kskey,ksdm,month,fz_tq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00102'' and month between @kssj and @jssj  )t group by yykey,yydm,kskey,ksdm,month ,bqkey','1','-1','B00101,B00102','11518','-1','-1','0','-1','-1','-1','-1','-1','-1','@�ż������(B00101)+@סԺ����(B00102)','select ''B001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,0 fm,null czry,getdate() gxrq ,bqkey from ( select yykey,yydm,kskey,ksdm,month,fz_hq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00101'' and month between @kssj and @jssj   union all select yykey,yydm,kskey,ksdm,month,fz_hq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00102'' and month between @kssj and @jssj  )t group by yykey,yydm,kskey,ksdm,month ,bqkey','-1','-1')
	
end
go

/************No.94: B00101******************HD_ZBMX_HZ***B00101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00101')
begin
	print '����ָ��B00101,��ָ��B00101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00101','�ż������','select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10077','','','0','1','0','FACT_FY_MZ_FYFX','ghfy+cffy','','timekey,yykey,kskey,mjzkey,dxmkey','','select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.95: B0010106******************HD_ZBMX_HZ***B0010106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010106')
begin
	print '����ָ��B0010106,��ָ��B0010106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010106','�ż��﴿ҽ�����루����ҩƷ���룩','select "B0010106" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ghfy+cffy-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010106" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010106" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12769','','','0','1','-1','FACT_FY_MZ_FYFX','sum(ghfy cffy-ypfy) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))','timekey,yykey,kskey','','select "B0010106" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.96: B0010107******************HD_ZBMX_HZ***B0010107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010107')
begin
	print '����ָ��B0010107,��ָ��B0010107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010107') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010107','�ż���ҽ��������','select ''B0010107'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''B0010107'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''B0010107'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12772','','','0','1','0','FACT_FY_MZ_FYFX','ghfy+cffy','[{\"dim_key\":\"dxmkey\",\"relation\":\"0\",\"caliber\":\"5,6,7,43\"}]','timekey,yykey,kskey,yskey','','select ''B0010107'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.97: B00102******************HD_ZBMX_HZ***B00102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00102')
begin
	print '����ָ��B00102,��ָ��B00102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00102','סԺ����','select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10080','','','0','1','0','FACT_FY_ZY_FYFX','zfy','','timekey,yykey,kskey,dxmkey','','select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.98: B0010201******************HD_ZBMX_HZ***B0010201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010201')
begin
	print '����ָ��B0010201,��ָ��B0010201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010201','��ҽ���Ƽ�����������ռҽ���������','','select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''B0010201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010202'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B0010201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010202'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010202,B001','12750','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@��ҽ���Ƽ�����������(B0010202)/@ҽԺ�ܷ���(B001)','select ''B0010201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010202'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.99: B0010202******************HD_ZBMX_HZ***B0010202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010202')
begin
	print '����ָ��B0010202,��ָ��B0010202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010202','��ҽ���Ƽ�����������','','select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''B0010202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010203'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010204'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B0010202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010203'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010204'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010203,B0010204','12749','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ż�����ҽ���Ƽ�����������(B0010203)+@סԺ��ҽ���Ƽ�����������(B0010204)','select ''B0010202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010203'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010204'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.100: B0010203******************HD_ZBMX_HZ***B0010203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010203')
begin
	print '����ָ��B0010203,��ָ��B0010203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010203','�ż�����ҽ���Ƽ�����������','select ''B0010203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''B0010203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''B0010203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12747','','','0','1','0','FACT_FY_MZ_FYFX','zyzljsfyfy','','timekey,yykey,kskey,yskey','','select ''B0010203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.101: B0010204******************HD_ZBMX_HZ***B0010204******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010204')
begin
	print '����ָ��B0010204,��ָ��B0010204�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010204') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010204','סԺ��ҽ���Ƽ�����������','select ''B0010204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''B0010204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''B0010204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12748','','','0','1','0','FACT_FY_ZY_FYFX','zyzljsfyfy','','timekey,yykey,kskey,yskey','','select ''B0010204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.102: B0010206******************HD_ZBMX_HZ***B0010206******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010206')
begin
	print '����ָ��B0010206,��ָ��B0010206�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010206') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010206','סԺ��ҽ�����루����ҩƷ���룩','select "B0010206" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010206" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010206" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12770','','','0','1','-1','FACT_FY_ZY_FYFX','sum(zfy-ypfy) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))','timekey,yykey,kskey','','select "B0010206" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.103: B0010207******************HD_ZBMX_HZ***B0010207******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010207')
begin
	print '����ָ��B0010207,��ָ��B0010207�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010207') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010207','סԺҽ��������','select "B0010207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12773','','','0','1','0','FACT_FY_ZY_FYFX','zfy','[{\"dim_key\":\"dxmkey\",\"relation\":\"0\",\"caliber\":\"5,6,7,43\"}]','timekey,yykey,kskey,yskey','','select "B0010207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.104: B0010208******************HD_ZBMX_HZ***B0010208******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010208')
begin
	print '����ָ��B0010208,��ָ��B0010208�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010208') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010208','��Ժ����ֲ�������','select "B0010208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zrwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zrwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zrwfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12822','','','0','1','0','FACT_FY_ZY_FYFX','zrwfy','','timekey,yykey,kskey','','select "B0010208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zrwfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.105: B001020801******************HD_ZBMX_HZ***B001020801******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B001020801')
begin
	print '����ָ��B001020801,��ָ��B001020801�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B001020801') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B001020801','סԺ����ֲ���������','','select timekey,yykey,kskey,yskey,sum(zrwfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''B001020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010208'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B001020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010208'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010208,B00102','12823','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@��Ժ����ֲ�������(B0010208)/@סԺ����(B00102)','select ''B001020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010208'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.106: B00107******************HD_ZBMX_HZ***B00107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00107')
begin
	print '����ָ��B00107,��ָ��B00107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00107') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00107','ҽ������(������ҩ��Ƭ)','','select timekey,yykey,kskey,ybflkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) and mjzkey in (1) group by timekey,yykey,kskey,ybflkey union all select timekey,yykey,kskey,ybflkey,sum(-ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) and mjzkey in (2) group by timekey,yykey,kskey,ybflkey union all select timekey,yykey,kskey,ybflkey,sum(-zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey,ybflkey','','select "B00107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001070101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001070102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0010702" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001070101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001070102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0010702" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010701,B0010702','12518','','','0','-1','-1','','','','timekey,yykey,kskey,ybflkey','@�ż���ҽ������(������ҩ��Ƭ)(B0010701)+@סԺҽ������(������ҩ��Ƭ)(B0010702)','select "B00107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001070101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001070102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0010702" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.107: B00110******************HD_ZBMX_HZ***B00110******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00110')
begin
	print '����ָ��B00110,��ָ��B00110�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00110') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00110','�ż��﴿ҽ�����루����ҩƷ���룩','','','','select ''B00110'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010106'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010206'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B00110'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010106'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010206'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010106,B0010206','12770','','','0','-1','-1','','','','timekey,yykey,kskey','@�ż��﴿ҽ�����루����ҩƷ���룩(B0010106)+@סԺ��ҽ�����루����ҩƷ���룩(B0010206)','select ''B00110'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010106'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010206'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.108: B00111******************HD_ZBMX_HZ***B00111******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00111')
begin
	print '����ָ��B00111,��ָ��B00111�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00111') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00111','ȫԺҽ��������','','select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey','','select ''B00111'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010107'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010207'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B00111'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010107'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010207'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010107,B0010207','12774','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ż���ҽ��������(B0010107)+@סԺҽ��������(B0010207)','select ''B00111'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010107'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010207'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.109: B00112******************HD_ZBMX_HZ***B00112******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00112')
begin
	print '����ָ��B00112,��ָ��B00112�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00112') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00112','ҽ��������ռ��','','select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''B00112'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00111'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B00112'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00111'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00111,B001','12775','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@ȫԺҽ��������(B00111)/@ҽԺ�ܷ���(B001)','select ''B00112'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00111'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.110: B002******************HD_ZBMX_HZ***B002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002')
begin
	print '����ָ��B002,��ָ��B002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002','ҩƷ�ܷ���','-1','select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey','-1','select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00201,B00202','11519','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey','@�ż���ҩƷ����(B00201)+@סԺҩƷ����(B00202)','select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.111: B00201******************HD_ZBMX_HZ***B00201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00201')
begin
	print '����ָ��B00201,��ָ��B00201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00201','�ż���ҩƷ����','select "B00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10081','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','','timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey','','select "B00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.112: B0020101******************HD_ZBMX_HZ***B0020101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0020101')
begin
	print '����ָ��B0020101,��ָ��B0020101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0020101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0020101','����ҩƷ����','select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10082','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey','','select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.113: B0020102******************HD_ZBMX_HZ***B0020102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0020102')
begin
	print '����ָ��B0020102,��ָ��B0020102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0020102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0020102','����ҩƷ����','select "B0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10083','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey','','select "B0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.114: B00202******************HD_ZBMX_HZ***B00202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00202')
begin
	print '����ָ��B00202,��ָ��B00202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00202','סԺҩƷ����','select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','10084','','','0','1','0','FACT_YP_ZY_FYFX','ypfy','','timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey','','select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','-1','')
	
end
go

/************No.115: B00205******************HD_ZBMX_HZ***B00205******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00205')
begin
	print '����ָ��B00205,��ָ��B00205�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00205') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00205','ҩƷ����(������ҩ��Ƭ)','','select timekey,yykey,kskey,sum(ypfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (4) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (4) and mjzkey in (2) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (4) group by timekey,yykey,kskey','','select "B00205" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002050101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002050102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020502" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00205" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002050101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002050102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0020501,B0020502','12526','','','0','-1','-1','','','','timekey,yykey,kskey','@�ż���ҩƷ����(������ҩ��Ƭ)(B0020501)+@סԺҩƷ����(������ҩ��Ƭ)(B0020502)','select "B00205" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002050101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002050102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.116: B004******************HD_ZBMX_HZ***B004******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B004')
begin
	print '����ָ��B004,��ָ��B004�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B004') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B004','�������','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00401"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00402"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00401"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00401,B00402','11613','-1','-1','0','-1','-1','-1','-1','-1','-1','@�ż���������(B00401)+@סԺ�������(B00402)','select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00401"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.117: B0040103******************HD_ZBMX_HZ***B0040103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0040103')
begin
	print '����ָ��B0040103,��ָ��B0040103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0040103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0040103','�ż����ٴ�����Լ��ɱ�֧��','select "B0040103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0040103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0040103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12825','','','0','1','0','FACT_FY_MZ_FYFX','lczdsjfy','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1,2\"}]','timekey,yykey,kskey,yskey','','select "B0040103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.118: B0040203******************HD_ZBMX_HZ***B0040203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0040203')
begin
	print '����ָ��B0040203,��ָ��B0040203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0040203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0040203','סԺ�ٴ�����Լ��ɱ�֧��','select "B0040203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0040203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0040203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12824','','','0','1','0','FACT_FY_ZY_FYFX','lczdsjfy','','timekey,yykey,kskey','','select "B0040203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.119: B00404******************HD_ZBMX_HZ***B00404******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00404')
begin
	print '����ָ��B00404,��ָ��B00404�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00404') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00404','�ٴ�����Լ��ɱ�֧��','','select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''B00404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0040103'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0040203'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B00404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0040103'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0040203'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0040103,B0040203','12826','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ż����ٴ�����Լ��ɱ�֧��(B0040103)+@סԺ�ٴ�����Լ��ɱ�֧��(B0040203)','select ''B00404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0040103'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0040203'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.120: B0040401******************HD_ZBMX_HZ***B0040401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0040401')
begin
	print '����ָ��B0040401,��ָ��B0040401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0040401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0040401','�ٴ�����Լ��ɱ���','','select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey','','select ''B0040401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00404'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B004'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B0040401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00404'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B004'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00404,B004','12827','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ٴ�����Լ��ɱ�֧��(B00404)/@�������(B004)','select ''B0040401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00404'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B004'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.121: B005******************HD_ZBMX_HZ***B005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B005')
begin
	print '����ָ��B005,��ָ��B005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B005') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B005','�������Ϸ���','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00501"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00502"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00501"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00502"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00501,B00502','11618','-1','-1','0','-1','-1','-1','-1','-1','-1','@�ż����������Ϸ���(B00501)+@סԺ�������Ϸ���(B00502)','select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00501"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00502"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.122: B00503******************HD_ZBMX_HZ***B00503******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00503')
begin
	print '����ָ��B00503,��ָ��B00503�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00503') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00503','�������Ϸ���ռ��(%)','','','','select "B00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B005"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B005"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B005,B001','11639','','','0','-1','-1','','','','','@�������Ϸ���(B005)/@ҽԺ�ܷ���(B001)','select "B00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B005"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.123: B009******************HD_ZBMX_HZ***B009******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B009')
begin
	print '����ָ��B009,��ָ��B009�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B009') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B009','����������','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum() fz from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum() fz from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B003"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B004"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B003"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B004"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B003,B004','11633','-1','-1','0','-1','-1','-1','-1','-1','-1','@������(B003)+@�������(B004)','select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B003"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B004"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.124: B00901******************HD_ZBMX_HZ***B00901******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00901')
begin
	print '����ָ��B00901,��ָ��B00901�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00901') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00901','����������ռ��','','','','select "B00901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B009"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B009"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B009,B001','11645','','','0','-1','-1','','','','','@����������(B009)/@ҽԺ�ܷ���(B001)','select "B00901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B009"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.125: B00902******************HD_ZBMX_HZ***B00902******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00902')
begin
	print '����ָ��B00902,��ָ��B00902�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00902') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00902','�ż������������','','select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey','','select "B00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00301"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00401"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00301"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00401"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00301,B00401','11469','','','0','-1','-1','','','','','@�ż��������(B00301)+@�ż���������(B00401)','select "B00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00301"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00401"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.126: B0090201******************HD_ZBMX_HZ***B0090201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0090201')
begin
	print '����ָ��B0090201,��ָ��B0090201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0090201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0090201','�ż�����μ������','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','','select ''B0090201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00902'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B0090201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00902'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00902,A001','12799','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','@�ż������������(B00902)/@�ż����˴�(A001)','select ''B0090201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00902'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.127: B00903******************HD_ZBMX_HZ***B00903******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00903')
begin
	print '����ָ��B00903,��ָ��B00903�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00903') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00903','סԺ����������','','select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey','','select "B00903" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00302"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00402"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00903" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00302"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00302,B00402','11470','','','0','-1','-1','','','','','@סԺ������(B00302)+@סԺ�������(B00402)','select "B00903" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00302"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.128: B0090301******************HD_ZBMX_HZ***B0090301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0090301')
begin
	print '����ָ��B0090301,��ָ��B0090301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0090301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0090301','סԺ���μ��������','','select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey','','select ''B0090301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00903'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B0090301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00903'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00903,A102','12800','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey','@סԺ����������(B00903)/@��Ժ�˴�(A102)','select ''B0090301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00903'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.129: B101******************HD_ZBMX_HZ***B101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B101')
begin
	print '����ָ��B101,��ָ��B101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B101','�ż�����η�','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','','select "B101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00101,A001','11471','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','@�ż������(B00101)/@�ż����˴�(A001)','select "B101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.130: B10101******************HD_ZBMX_HZ***B10101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10101')
begin
	print '����ָ��B10101,��ָ��B10101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10101','������η�','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','','select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010101,A00101','12605','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','@�������(B0010101)/@�����˴�(A00101)','select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.131: B10102******************HD_ZBMX_HZ***B10102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10102')
begin
	print '����ָ��B10102,��ָ��B10102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10102','������η�','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) and mjzkey in (2) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','','select ''B10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010102'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010102,A00102','12606','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','@�������(B0010102)/@�����˴�(A00102)','select ''B10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.132: B102******************HD_ZBMX_HZ***B102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B102')
begin
	print '����ָ��B102,��ָ��B102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B102','סԺ���η�','','select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey','','select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00102,A102','11472','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey','@סԺ����(B00102)/@��Ժ�˴�(A102)','select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.133: B103******************HD_ZBMX_HZ***B103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B103')
begin
	print '����ָ��B103,��ָ��B103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B103','�ż���ҩƷ���η�','','','','select "B103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00201"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00201"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00201,A001','11473','','','0','-1','-1','','','','','@�ż���ҩƷ����(B00201)/@�ż����˴�(A001)','select "B103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00201"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.134: B10301******************HD_ZBMX_HZ***B10301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10301')
begin
	print '����ָ��B10301,��ָ��B10301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10301','����ҩƷ���η�','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey','','select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0020101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0020101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0020101,A00101','12616','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey','@����ҩƷ����(B0020101)/@�����˴�(A00101)','select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0020101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.135: B10302******************HD_ZBMX_HZ***B10302******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10302')
begin
	print '����ָ��B10302,��ָ��B10302�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10302') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10302','����ҩƷ���η�','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) and mjzkey in (2) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey','','select ''B10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0020102'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0020102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0020102,A00102','12617','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey','@����ҩƷ����(B0020102)/@�����˴�(A00102)','select ''B10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0020102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.136: B104******************HD_ZBMX_HZ***B104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B104')
begin
	print '����ָ��B104,��ָ��B104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B104','סԺҩƷ����ҩ��','','select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey union all select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey','','select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00202,A102','11474','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey','@סԺҩƷ����(B00202)/@��Ժ�˴�(A102)','select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.137: C001******************HD_ZBMX_HZ***C001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C001')
begin
	print '����ָ��C001,��ָ��C001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C001','�ż���ҽ���˴�','select "C001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ybflkey,sum(ybghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "C001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(ybghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "C001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(ybghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10176','','','0','1','0','FACT_YY_MZ_JZRC','ybghrc','','timekey,yykey,kskey,ybflkey','','select "C001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(ybghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.138: C00101******************HD_ZBMX_HZ***C00101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C00101')
begin
	print '����ָ��C00101,��ָ��C00101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C00101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C00101','�ż���ҽ��������(%)','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,cfzkey,yblxkey,patid fz,0 fm from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1) union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,cfzkey,yblxkey,0 fz,patid fm from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)','','select "C00101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A0010503" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A0010502" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "C00101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A0010503" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A0010502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A0010503,A0010502','11533','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,cfzkey,yblxkey','@�ż���ҽ����������(A0010503)/@�ż���ҽ������(A0010502)','select "C00101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A0010503" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A0010502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.139: C00104******************HD_ZBMX_HZ***C00104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C00104')
begin
	print '����ָ��C00104,��ָ��C00104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C00104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C00104','�Ǳ������ż����˴���','select ''C00104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C00104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C00104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12788','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C00104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.140: C0010401******************HD_ZBMX_HZ***C0010401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0010401')
begin
	print '����ָ��C0010401,��ָ��C0010401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0010401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0010401','�Ǳ������ż�������˴���ռ��','','select timekey,yykey,kskey,yskey,sum(ghrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ybghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''C0010401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00104'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C0010401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C00104,C001','12789','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ������ż����˴���(C00104)/@�ż���ҽ���˴�(C001)','select ''C0010401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.141: C00214******************HD_ZBMX_HZ***C00214******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C00214')
begin
	print '����ָ��C00214,��ָ��C00214�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C00214') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C00214','�Ǳ��ż��ﻼ���ܷ���','select "C00214" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "C00214" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "C00214" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_YB_YBZKFX','zfy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzy\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "C00214" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.142: C0021401******************HD_ZBMX_HZ***C0021401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0021401')
begin
	print '����ָ��C0021401,��ָ��C0021401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0021401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0021401','�Ǳ��ż�����η���','','select timekey,yykey,kskey,yskey,sum(zfy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey','','select ''C0021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00214'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00104'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C0021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00214'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C00214,C00104','12798','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ��ż��ﻼ���ܷ���(C00214)/@�Ǳ������ż����˴���(C00104)','select ''C0021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00214'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.143: C00216******************HD_ZBMX_HZ***C00216******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C00216')
begin
	print '����ָ��C00216,��ָ��C00216�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C00216') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C00216','�Ǳ������ż���ҽҩ�����ܶ�','select ''C00216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C00216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C00216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12857','','','0','1','0','FACT_YB_YBZKFX','zfy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C00216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.144: C0021601******************HD_ZBMX_HZ***C0021601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0021601')
begin
	print '����ָ��C0021601,��ָ��C0021601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0021601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0021601','�Ǳ������ż����Է�ҽҩ�����ܶ�','select ''C0021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C0021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C0021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12856','','','0','1','0','FACT_YB_YBZKFX','zffy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C0021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.145: C0021602******************HD_ZBMX_HZ***C0021602******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0021602')
begin
	print '����ָ��C0021602,��ָ��C0021602�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0021602') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0021602','�Ǳ������ż���ƽ���Էѷ��ñ���','','select timekey,yykey,kskey,yskey,sum(zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey','','select ''C0021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C0021601'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C0021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C0021601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C0021601,C00216','12858','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ������ż����Է�ҽҩ�����ܶ�(C0021601)/@�Ǳ������ż���ҽҩ�����ܶ�(C00216)','select ''C0021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C0021601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.146: C0021603******************HD_ZBMX_HZ***C0021603******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0021603')
begin
	print '����ָ��C0021603,��ָ��C0021603�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0021603') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0021603','�Ǳ�����ҽ����Χ���ż����Ը�ҽҩ�����ܶ�','select ''C0021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C0021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C0021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12859','','','0','1','0','FACT_YB_YBZKFX','ybzfy_zfje','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C0021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.147: C0021604******************HD_ZBMX_HZ***C0021604******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0021604')
begin
	print '����ָ��C0021604,��ָ��C0021604�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0021604') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0021604','�Ǳ������ż���ƽ���Ը����ñ���','','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey','','select ''C0021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C0021603'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C0021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C0021603'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C0021603,C00216','12860','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ�����ҽ����Χ���ż����Ը�ҽҩ�����ܶ�(C0021603)/@�Ǳ������ż���ҽҩ�����ܶ�(C00216)','select ''C0021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C0021603'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.148: C0021605******************HD_ZBMX_HZ***C0021605******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0021605')
begin
	print '����ָ��C0021605,��ָ��C0021605�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0021605') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0021605','�Ǳ�����ҽ����Χ���ż����Ը��Է�ҽҩ�����ܶ�','select ''C0021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C0021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C0021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12861','','','0','1','0','FACT_YB_YBZKFX','ybzfy_zfje+zffy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C0021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.149: C0021606******************HD_ZBMX_HZ***C0021606******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0021606')
begin
	print '����ָ��C0021606,��ָ��C0021606�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0021606') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0021606','�Ǳ������ż���ƽ���Ը��Էѷ��ñ���','','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey','','select ''C0021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C0021605'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C0021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C0021605'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C0021605,C00216','12862','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ�����ҽ����Χ���ż����Ը��Է�ҽҩ�����ܶ�(C0021605)/@�Ǳ������ż���ҽҩ�����ܶ�(C00216)','select ''C0021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C0021605'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.150: C0021702******************HD_ZBMX_HZ***C0021702******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0021702')
begin
	print '����ָ��C0021702,��ָ��C0021702�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0021702') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0021702','�ӱ�����סԺƽ���Էѷ��ñ���','','select timekey,yykey,kskey,yskey,sum(zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey','','select ''C0021702'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021701'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10217'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C0021702'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021701'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C1021701,C10217','12851','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ӱ�����ҽ����Χ��סԺ�Էѷ����ܶ�(C1021701)/@�ӱ�����סԺҽҩ�����ܶ�(C10217)','select ''C0021702'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021701'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.151: C00304******************HD_ZBMX_HZ***C00304******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C00304')
begin
	print '����ָ��C00304,��ָ��C00304�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C00304') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C00304','�Ǳ��ż���ҩƷ����','select ''C00304'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C00304'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C00304'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12794','','','0','1','0','FACT_YB_YBZKFX','ypfy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C00304'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.152: C0030401******************HD_ZBMX_HZ***C0030401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0030401')
begin
	print '����ָ��C0030401,��ָ��C0030401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0030401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0030401','�Ǳ��ż������ҩ��','','select timekey,yykey,kskey,yskey,sum(ypfy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey','','select ''C0030401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00304'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00104'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C0030401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00304'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C00304,C00104','12795','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ��ż���ҩƷ����(C00304)/@�Ǳ������ż����˴���(C00104)','select ''C0030401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00304'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.153: C10101******************HD_ZBMX_HZ***C10101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C10101')
begin
	print '����ָ��C10101,��ָ��C10101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C10101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C10101','�Ǳ���Ժ�������˴�','select ''C10101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12793','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"}]','timekey,yykey,kskey,yskey','','select ''C10101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.154: C10215******************HD_ZBMX_HZ***C10215******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C10215')
begin
	print '����ָ��C10215,��ָ��C10215�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C10215') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C10215','�Ǳ�סԺ�����ܷ���','select ''C10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12796','','','0','1','0','FACT_YB_YBZKFX','zfy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.155: C1021501******************HD_ZBMX_HZ***C1021501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021501')
begin
	print '����ָ��C1021501,��ָ��C1021501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021501','�Ǳ�סԺ���η���','','select timekey,yykey,kskey,yskey,sum(zfy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (0) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey','','select ''C1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10215'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10215'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C10215,C10101','12797','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ�סԺ�����ܷ���(C10215)/@�Ǳ���Ժ�������˴�(C10101)','select ''C1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10215'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.156: C10216******************HD_ZBMX_HZ***C10216******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C10216')
begin
	print '����ָ��C10216,��ָ��C10216�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C10216') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C10216','�Ǳ�����סԺҽҩ�����ܶ�','select ''C10216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12863','','','0','1','0','FACT_YB_YBZKFX','zfy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C10216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.157: C1021601******************HD_ZBMX_HZ***C1021601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021601')
begin
	print '����ָ��C1021601,��ָ��C1021601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021601','�Ǳ�����סԺ�Է�ҽҩ�����ܶ�','select ''C1021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12864','','','0','1','0','FACT_YB_YBZKFX','zffy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C1021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.158: C1021602******************HD_ZBMX_HZ***C1021602******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021602')
begin
	print '����ָ��C1021602,��ָ��C1021602�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021602') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021602','�Ǳ�����סԺƽ���Էѷ��ñ���','','select timekey,yykey,kskey,yskey,sum(zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey','','select ''C1021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021601'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C1021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C1021601,C10216','12865','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ�����סԺ�Է�ҽҩ�����ܶ�(C1021601)/@�Ǳ�����סԺҽҩ�����ܶ�(C10216)','select ''C1021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.159: C1021603******************HD_ZBMX_HZ***C1021603******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021603')
begin
	print '����ָ��C1021603,��ָ��C1021603�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021603') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021603','�Ǳ�����ҽ����Χ��סԺ�Ը�ҽҩ�����ܶ�','select ''C1021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12866','','','0','1','0','FACT_YB_YBZKFX','ybzfy_zfje','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C1021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.160: C1021604******************HD_ZBMX_HZ***C1021604******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021604')
begin
	print '����ָ��C1021604,��ָ��C1021604�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021604') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021604','�Ǳ�����סԺƽ���Ը����ñ���','','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey','','select ''C1021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021603'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C1021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021603'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C1021603,C10216','12867','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ�����ҽ����Χ��סԺ�Ը�ҽҩ�����ܶ�(C1021603)/@�Ǳ�����סԺҽҩ�����ܶ�(C10216)','select ''C1021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021603'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.161: C1021605******************HD_ZBMX_HZ***C1021605******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021605')
begin
	print '����ָ��C1021605,��ָ��C1021605�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021605') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021605','�Ǳ�����ҽ����Χ��סԺ�Ը��Է�ҽҩ�����ܶ�','select ''C1021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12868','','','0','1','0','FACT_YB_YBZKFX','ybzfy_zfje+zffy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C1021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.162: C1021606******************HD_ZBMX_HZ***C1021606******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021606')
begin
	print '����ָ��C1021606,��ָ��C1021606�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021606') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021606','�Ǳ�����סԺƽ���Ը��Էѷ��ñ���','','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey','','select ''C1021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021605'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C1021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021605'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C1021605,C10216','12869','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ�����ҽ����Χ��סԺ�Ը��Է�ҽҩ�����ܶ�(C1021605)/@�Ǳ�����סԺҽҩ�����ܶ�(C10216)','select ''C1021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021605'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.163: C10217******************HD_ZBMX_HZ***C10217******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C10217')
begin
	print '����ָ��C10217,��ָ��C10217�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C10217') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C10217','�ӱ�����סԺҽҩ�����ܶ�','select ''C10217'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10217'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10217'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12850','','','0','1','0','FACT_YB_YBZKFX','zfy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C10217'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.164: C1021701******************HD_ZBMX_HZ***C1021701******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021701')
begin
	print '����ָ��C1021701,��ָ��C1021701�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021701') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021701','�ӱ�����ҽ����Χ��סԺ�Էѷ����ܶ�','select ''C1021701'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021701'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021701'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12849','','','0','1','0','FACT_YB_YBZKFX','zffy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C1021701'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.165: C1021703******************HD_ZBMX_HZ***C1021703******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021703')
begin
	print '����ָ��C1021703,��ָ��C1021703�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021703') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021703','�ӱ�����ҽ����Χ��סԺ�Ը�ҽҩ�����ܶ�','select ''C1021703'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021703'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021703'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12852','','','0','1','0','FACT_YB_YBZKFX','ybzfy_zfje','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C1021703'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.166: C1021704******************HD_ZBMX_HZ***C1021704******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021704')
begin
	print '����ָ��C1021704,��ָ��C1021704�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021704') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021704','�ӱ�����סԺƽ���Ը����ñ���','','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey','','select ''C1021704'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021703'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10217'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C1021704'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021703'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C1021703,C10217','12853','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ӱ�����ҽ����Χ��סԺ�Ը�ҽҩ�����ܶ�(C1021703)/@�ӱ�����סԺҽҩ�����ܶ�(C10217)','select ''C1021704'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021703'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.167: C1021705******************HD_ZBMX_HZ***C1021705******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021705')
begin
	print '����ָ��C1021705,��ָ��C1021705�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021705') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021705','�ӱ�����ҽ����Χ��סԺ�Ը��Է�ҽҩ�����ܶ�','select ''C1021705'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021705'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C1021705'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12854','','','0','1','0','FACT_YB_YBZKFX','ybzfy_zfje+zffy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select ''C1021705'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.168: C1021706******************HD_ZBMX_HZ***C1021706******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1021706')
begin
	print '����ָ��C1021706,��ָ��C1021706�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1021706') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1021706','�ӱ�����סԺƽ���Ը��Էѷ��ñ���','','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey','','select ''C1021706'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021705'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10217'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C1021706'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021705'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C1021705,C10217','12855','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ӱ�����ҽ����Χ��סԺ�Ը��Է�ҽҩ�����ܶ�(C1021705)/@�ӱ�����סԺҽҩ�����ܶ�(C10217)','select ''C1021706'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021705'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.169: C10303******************HD_ZBMX_HZ***C10303******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C10303')
begin
	print '����ָ��C10303,��ָ��C10303�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C10303') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C10303','�Ǳ���Ժ����סԺҩƷ����','select ''C10303'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10303'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C10303'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12801','','','0','1','0','FACT_YB_YBZKFX','ypfy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C10303'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.170: C1030301******************HD_ZBMX_HZ***C1030301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1030301')
begin
	print '����ָ��C1030301,��ָ��C1030301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1030301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1030301','�Ǳ�סԺ����ҩ��','','select timekey,yykey,kskey,yskey,sum(ypfy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey','','select ''C1030301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10303'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C1030301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10303'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C10303,C10101','12802','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�Ǳ���Ժ����סԺҩƷ����(C10303)/@�Ǳ���Ժ�������˴�(C10101)','select ''C1030301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10303'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.171: C601******************HD_ZBMX_HZ***C601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C601')
begin
	print '����ָ��C601,��ָ��C601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C601','�ӱ������ż���ҽҩ�����ܶ�','select ''C601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12805','','','0','1','0','FACT_YB_YBZKFX','zfy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.172: C60101******************HD_ZBMX_HZ***C60101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C60101')
begin
	print '����ָ��C60101,��ָ��C60101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C60101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C60101','�ӱ�����ҽ����Χ���ż���ҽҩ�����ܶ�','select ''C60101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C60101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C60101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12806','','','0','1','0','FACT_YB_YBZKFX','zffy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C60101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.173: C60102******************HD_ZBMX_HZ***C60102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C60102')
begin
	print '����ָ��C60102,��ָ��C60102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C60102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C60102','�ӱ������ż���ƽ���Էѷ��ñ���','','select timekey,yykey,kskey,yskey,sum(zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey','','select ''C60102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C60101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C601'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C60102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C60101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C60101,C601','12807','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ӱ�����ҽ����Χ���ż���ҽҩ�����ܶ�(C60101)/@�ӱ������ż���ҽҩ�����ܶ�(C601)','select ''C60102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C60101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.174: C60103******************HD_ZBMX_HZ***C60103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C60103')
begin
	print '����ָ��C60103,��ָ��C60103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C60103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C60103','�ӱ�����ҽ����Χ���ż����Ը�ҽҩ�����ܶ�','select ''C60103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C60103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C60103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12838','','','0','1','0','FACT_YB_YBZKFX','ybzfy_zfje','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C60103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.175: C60104******************HD_ZBMX_HZ***C60104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C60104')
begin
	print '����ָ��C60104,��ָ��C60104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C60104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C60104','�ӱ������ż���ƽ���Ը����ñ���','','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey','','select ''C60104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C60103'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C601'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C60104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C60103'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C60103,C601','12839','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ӱ�����ҽ����Χ���ż����Ը�ҽҩ�����ܶ�(C60103)/@�ӱ������ż���ҽҩ�����ܶ�(C601)','select ''C60104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C60103'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.176: C60105******************HD_ZBMX_HZ***C60105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C60105')
begin
	print '����ָ��C60105,��ָ��C60105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C60105') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C60105','�ӱ�����ҽ����Χ���ż����Ը��Է�ҽҩ�����ܶ�','select ''C60105'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C60105'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''C60105'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12840','','','0','1','0','FACT_YB_YBZKFX','ybzfy_zfje+zffy','[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''C60105'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.177: C60106******************HD_ZBMX_HZ***C60106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C60106')
begin
	print '����ָ��C60106,��ָ��C60106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C60106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C60106','�ӱ������ż���ƽ���Ը��Էѷ��ñ���','','select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey','','select ''C60106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C60105'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C601'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''C60106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C60105'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C60105,C601','12841','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�ӱ�����ҽ����Χ���ż����Ը��Է�ҽҩ�����ܶ�(C60105)/@�ӱ������ż���ҽҩ�����ܶ�(C601)','select ''C60106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C60105'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.178: D0001******************HD_ZBMX_HZ***D0001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0001')
begin
	print '����ָ��D0001,��ָ��D0001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0001','����������','','select timekey,yykey,kskey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''D0001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D001'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''D0001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','D001,D002','12787','','','0','-1','-1','','','','timekey,yykey,kskey','@�ż��������˴�(D001)+@סԺ��������(D002)','select ''D0001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.179: D001******************HD_ZBMX_HZ***D001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D001')
begin
	print '����ָ��D001,��ָ��D001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D001','�ż��������˴�','select "D001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ybflkey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10205','','','0','1','0','FACT_YY_SS_MZSSYWLFX','mzssrc','','timekey,yykey,kskey,ybflkey','','select "D001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.180: D002******************HD_ZBMX_HZ***D002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D002')
begin
	print '����ָ��D002,��ָ��D002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D002','��Ժ��������̨��������Ժ����������','select "D002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10206','','','0','1','0','FACT_YY_SS_ZYSSYWLFX','ssrc','','timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey','','select "D002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.181: D00201******************HD_ZBMX_HZ***D00201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D00201')
begin
	print '����ָ��D00201,��ָ��D00201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D00201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D00201','������������','select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.182: D0020101******************HD_ZBMX_HZ***D0020101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0020101')
begin
	print '����ָ��D0020101,��ָ��D0020101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0020101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0020101','סԺ����������������','select ''D0020101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''D0020101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''D0020101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12724','','','0','1','0','FACT_YY_SS_ZYSSYWLFX','ssrc','[{\"dim_key\":\"swbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select ''D0020101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.183: D0020102******************HD_ZBMX_HZ***D0020102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0020102')
begin
	print '����ָ��D0020102,��ָ��D0020102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0020102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0020102','סԺ��������������','','select timekey,yykey,kskey,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ssrc) fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey','','select ''D0020102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D0020101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D00201'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''D0020102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D0020101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D00201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','D0020101,D00201','12725','','','0','-1','-1','','','','timekey,yykey,kskey','@סԺ����������������(D0020101)/@סԺ������������(D00201)','select ''D0020102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D0020101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D00201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.184: D0020103******************HD_ZBMX_HZ***D0020103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0020103')
begin
	print '����ָ��D0020103,��ָ��D0020103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0020103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0020103','���������ٷ���','','select timekey,yykey,kskey,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ssrc) fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''D0020103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D00201'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''D0020103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D00201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','D00201,D002','12887','','','0','-1','-1','','','','timekey,yykey,kskey','@סԺ������������(D00201)/@סԺ��������(D002)','select ''D0020103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D00201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.185: D00201******************HD_ZBMX_HZ***D00201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D00201')
begin
	print '����ָ��D00201,��ָ��D00201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D00201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D00201','������������','select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.186: D00202******************HD_ZBMX_HZ***D00202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D00202')
begin
	print '����ָ��D00202,��ָ��D00202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D00202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D00202','�ռ���������','select "D00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_RJSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_RJSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_RJSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10207','','','0','1','0','FACT_YY_SS_RJSSYWLFX','ssrc','','timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey','','select "D00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_RJSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.187: D0020201******************HD_ZBMX_HZ***D0020201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0020201')
begin
	print '����ָ��D0020201,��ָ��D0020201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0020201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0020201','�ռ������ٷ���(%)','','','','select "D0020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D00202"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D002"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "D0020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D00202"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D002"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','D00202,D002','11549','','','0','-1','-1','','','','','@�ռ���������(D00202)/@סԺ��������(D002)','select "D0020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D00202"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D002"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.188: D00204******************HD_ZBMX_HZ***D00204******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D00204')
begin
	print '����ָ��D00204,��ָ��D00204�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D00204') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D00204','���ļ�����ռ��(%)','','','','select "D00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D00209"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D002"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "D00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D00209"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D002"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','D00209,D002','11551','','','0','-1','-1','','','','','@���ļ���������(D00209)/@סԺ��������(D002)','select "D00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D00209"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D002"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.189: D00209******************HD_ZBMX_HZ***D00209******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D00209')
begin
	print '����ָ��D00209,��ָ��D00209�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D00209') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D00209','���ļ���������','select "D00209" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey,sum(sjssrc+sijssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D00209" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey,sum(sjssrc+sijssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D00209" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey,sum(sjssrc+sijssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10213','','','0','1','0','FACT_YY_SS_ZYSSYWLFX','sjssrc+sijssrc','','timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey','','select "D00209" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey,sum(sjssrc+sijssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.190: D0021001******************HD_ZBMX_HZ***D0021001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0021001')
begin
	print '����ָ��D0021001,��ָ��D0021001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0021001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0021001','���������ط��������ٴ���������','select "D0021001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D0021001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D0021001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12828','','','0','1','0','FACT_YY_SS_ZYSSYWLFX','ssrc','[{\"dim_key\":\"cfssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,zdyskey','','select "D0021001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.191: D0021002******************HD_ZBMX_HZ***D0021002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0021002')
begin
	print '����ָ��D0021002,��ָ��D0021002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0021002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0021002','���������ط��������ٴ������ܷ�����','','select timekey,yykey,kskey,zdyskey,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey union all select timekey,yykey,kskey,zdyskey,0 fz,sum(ssrc) fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey','','select ''D0021002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D0021001'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''D0021002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D0021001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','D0021001,D002','12829','','','0','-1','-1','','','','timekey,yykey,kskey,zdyskey','@���������ط��������ٴ���������(D0021001)/@סԺ��������(D002)','select ''D0021002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D0021001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.192: D0021003******************HD_ZBMX_HZ***D0021003******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0021003')
begin
	print '����ָ��D0021003,��ָ��D0021003�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0021003') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0021003','�޾��������߳�Ժ�˴�','select "D0021003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D0021003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D0021003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12845','','','0','1','0','FACT_YY_SS_ZYSSYWLFX','ssrc','[{\"dim_key\":\"qkdjkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,zdyskey','','select "D0021003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.193: D002100301******************HD_ZBMX_HZ***D002100301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D002100301')
begin
	print '����ָ��D002100301,��ָ��D002100301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D002100301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D002100301','�޾��������߼׼���������','select "D002100301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D002100301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D002100301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12846','','','0','1','0','FACT_YY_SS_ZYSSYWLFX','ssrc','[{\"dim_key\":\"qkdjkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"yhlb\",\"relation\":\"3\",\"caliber\":\"1\"}]','timekey,yykey,kskey,zdyskey','','select "D002100301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.194: D002100302******************HD_ZBMX_HZ***D002100302******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D002100302')
begin
	print '����ָ��D002100302,��ָ��D002100302�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D002100302') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D002100302','�޾������׼�������','','select timekey,yykey,kskey,zdyskey,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey union all select timekey,yykey,kskey,zdyskey,0 fz,sum(ssrc) fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey','','select ''D002100302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D002100301'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D0021003'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''D002100302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D002100301'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D0021003'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','D002100301,D0021003','12847','','','0','-1','-1','','','','timekey,yykey,kskey,zdyskey','@�޾��������߼׼���������(D002100301)/@�޾��������߳�Ժ�˴�(D0021003)','select ''D002100302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D002100301'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D0021003'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.195: D0021004******************HD_ZBMX_HZ***D0021004******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D0021004')
begin
	print '����ָ��D0021004,��ָ��D0021004�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D0021004') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D0021004','��������','select "D0021004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D0021004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D0021004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12833','','','0','1','0','FACT_YY_ZY_CYYWLFX','ssrc','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"70,71,73\"}]','timekey,yykey,kskey,yskey','','select "D0021004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.196: D002100401******************HD_ZBMX_HZ***D002100401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D002100401')
begin
	print '����ָ��D002100401,��ָ��D002100401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D002100401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D002100401','�����ʹ��������Ĳ�������','select "D002100401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select a.timekey,a.yykey,a.kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by a.timekey,a.yykey,a.kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D002100401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by a.timekey,a.yykey,a.kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D002100401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by a.timekey,a.yykey,a.kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12834','','','0','1','-1','FACT_YY_SS_ZYSSYWLFX','sum(ssrc) fz','join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like ''%�ʹ���%''','a.timekey,a.yykey,a.kskey','','select "D002100401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by a.timekey,a.yykey,a.kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.197: D002100402******************HD_ZBMX_HZ***D002100402******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D002100402')
begin
	print '����ָ��D002100402,��ָ��D002100402�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D002100402') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D002100402','�ʹ�����','','select ,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by  union all select ,0 fz,sum(ssrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by ','','select "D002100402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D002100401" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D0021004" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "D002100402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D002100401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D0021004" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','D002100401,D0021004','12835','','','0','-1','-1','','','','','@�����ʹ��������Ĳ�������(D002100401)/@��������(D0021004)','select "D002100402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D002100401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D0021004" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.198: D007******************HD_ZBMX_HZ***D007******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='D007')
begin
	print '����ָ��D007,��ָ��D007�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='D007') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('D007','��Ժ��������̨��������Ժ����������','select "D007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "D007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10215','','','0','1','0','FACT_YY_ZY_CYYWLFX','ssrc','','timekey,yykey,kskey','','select "D007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.199: E001002******************HD_ZBMX_HZ***E001002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E001002')
begin
	print '����ָ��E001002,��ָ��E001002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E001002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E001002','����ҩ��Ʒ������','select "E001002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E001002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E001002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11155','','','0','0','0','FACT_DIM_YP','idm','[{\"dim_key\":\"jybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey','','select "E001002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.200: E00100201******************HD_ZBMX_HZ***E00100201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00100201')
begin
	print '����ָ��E00100201,��ָ��E00100201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00100201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00100201','����ҩ���г�ҩƷ����','select ''E00100201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''E00100201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''E00100201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12751','','','0','0','0','FACT_DIM_YP','idm','[{\"dim_key\":\"jybz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"zmlb\",\"relation\":\"3\",\"caliber\":\"3\"}]','yykey,timekey,kskey','','select ''E00100201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.201: E00100202******************HD_ZBMX_HZ***E00100202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00100202')
begin
	print '����ָ��E00100202,��ָ��E00100202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00100202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00100202','����ҩ���г�ҩ�䱸��','','select yykey,timekey,kskey,idm fz,0 fm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3 union all select yykey,timekey,kskey,0 fz,idm fm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)','','select ''E00100202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00100201'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E001002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E00100202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00100201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E001002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00100201,E001002','12752','','','0','-1','-1','','','','yykey,timekey,kskey','@����ҩ���г�ҩƷ����(E00100201)/@����ҩ��Ʒ������(E001002)','select ''E00100202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00100201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E001002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.202: E0010402******************HD_ZBMX_HZ***E0010402******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0010402')
begin
	print '����ָ��E0010402,��ָ��E0010402�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0010402') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0010402','סԺ��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���','select "E0010402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zyfy_ypcyzj) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0010402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyfy_ypcyzj) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0010402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyfy_ypcyzj) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12657','','','0','1','0','FACT_YP_ZY_FYFX','zyfy_ypcyzj','','timekey,yykey,kskey','','select "E0010402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyfy_ypcyzj) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.203: E001040201******************HD_ZBMX_HZ***E001040201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E001040201')
begin
	print '����ָ��E001040201,��ָ��E001040201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E001040201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E001040201','סԺ��ҽҩ����ռסԺ���������','','select timekey,yykey,kskey,yskey,sum(zyfy_ypcyzj) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''E001040201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E0010402'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E001040201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E0010402'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0010402,B00102','12875','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@סԺ��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���(E0010402)/@סԺ����(B00102)','select ''E001040201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E0010402'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.204: E0010403******************HD_ZBMX_HZ***E0010403******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0010403')
begin
	print '����ָ��E0010403,��ָ��E0010403�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0010403') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0010403','��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���ռҩƷ�������','','select timekey,yykey,kskey,yskey,sum(zyfy_ypcyzj) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zyfy_ypcyzj) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zyfy_ypcyzj) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''E0010403'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00104'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E0010403'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00104,B002','12659','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���(E00104)/@ҩƷ�ܷ���(B002)','select ''E0010403'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.205: E0010404******************HD_ZBMX_HZ***E0010404******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0010404')
begin
	print '����ָ��E0010404,��ָ��E0010404�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0010404') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0010404','�в�ҩ����ռ��ҩ�������','','select timekey,yykey,kskey,yskey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyfy_ypcyzj) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyfy_ypcyzj) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyfy_ypcyzj) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''E0010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00102'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00104'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E0010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00102,E00104','12660','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@�в�ҩ����(E00102)/@��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���(E00104)','select ''E0010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.206: E002******************HD_ZBMX_HZ***E002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E002')
begin
	print '����ָ��E002,��ָ��E002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E002','����ҩ���ܷ���','','select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey','','select "E002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00202" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00201,E00202','11566','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey','@�ż��￹��ҩ�����(E00201)+@סԺ����ҩ�����(E00202)','select "E002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.207: E00201******************HD_ZBMX_HZ***E00201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00201')
begin
	print '����ָ��E00201,��ָ��E00201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00201','�ż��￹��ҩ�����','select "E00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,kssjbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10230','','','0','1','0','FACT_YP_MZ_FYFX','kjfy','','timekey,yykey,kskey,kssjbkey','','select "E00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.208: E002010101******************HD_ZBMX_HZ***E002010101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E002010101')
begin
	print '����ָ��E002010101,��ָ��E002010101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E002010101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E002010101','���￹��ҩ����ռҩ���ܽ��ٷֱ�','','select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey union all select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey','','select "E002010101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E002010101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0020102,B0020101','11568','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey','@���￹��ҩ�����(E0020102)/@����ҩƷ����(B0020101)','select "E002010101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.209: E002010102******************HD_ZBMX_HZ***E002010102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E002010102')
begin
	print '����ָ��E002010102,��ָ��E002010102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E002010102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E002010102','���￹��ҩ����ռҩ���ܽ��ٷֱ�','','select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey union all select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey','','select "E002010102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E002010102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0020103,B0020102','11569','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey','@���￹��ҩ�����(E0020103)/@����ҩƷ����(B0020102)','select "E002010102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.210: E0020102******************HD_ZBMX_HZ***E0020102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0020102')
begin
	print '����ָ��E0020102,��ָ��E0020102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0020102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0020102','���￹��ҩ�����','select "E0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10231','','','0','1','0','FACT_YP_MZ_FYFX','kjfy','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey','','select "E0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.211: E0020103******************HD_ZBMX_HZ***E0020103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0020103')
begin
	print '����ָ��E0020103,��ָ��E0020103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0020103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0020103','���￹��ҩ�����','select "E0020103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0020103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0020103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10232','','','0','1','0','FACT_YP_MZ_FYFX','kjfy','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey','','select "E0020103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.212: E00202******************HD_ZBMX_HZ***E00202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00202')
begin
	print '����ָ��E00202,��ָ��E00202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00202','סԺ����ҩ�����','select "E00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10233','','','0','1','0','FACT_YP_ZY_FYFX','kjfy','','timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey','','select "E00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.213: E00203******************HD_ZBMX_HZ***E00203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00203')
begin
	print '����ָ��E00203,��ָ��E00203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00203','�ż��￹��ҩ����η�','','select timekey,yykey,kskey,yskey,ybflkey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(sykjyrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey','','select "E00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00205" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00205" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00201,E00205','11570','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey','@�ż��￹��ҩ�����(E00201)/@�ż��￹��ҩ��ʹ���˴�(E00205)','select "E00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00205" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.214: E0020301******************HD_ZBMX_HZ***E0020301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0020301')
begin
	print '����ָ��E0020301,��ָ��E0020301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0020301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0020301','���￹��ҩ����η�','','select timekey,yykey,kskey,yskey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(sykjyrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey','','select "E0020301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020510" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E0020301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020510" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0020102,E0020510','11571','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@���￹��ҩ�����(E0020102)/@���￹��ҩ��ʹ���˴�(E0020510)','select "E0020301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020510" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.215: E0020302******************HD_ZBMX_HZ***E0020302******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0020302')
begin
	print '����ָ��E0020302,��ָ��E0020302�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0020302') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0020302','���￹��ҩ����η�','','select timekey,yykey,kskey,yskey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(sykjyrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey','','select "E0020302" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020511" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E0020302" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020511" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0020103,E0020511','11572','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@���￹��ҩ�����(E0020103)/@���￹��ҩ��ʹ���˴�(E0020511)','select "E0020302" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020511" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.216: E00204******************HD_ZBMX_HZ***E00204******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00204')
begin
	print '����ָ��E00204,��ָ��E00204�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00204') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00204','סԺ����ҩ����η�','','select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,sum(kjfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey union all select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,0 fz,sum(kjysyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey','','select "E00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00207" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00207" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00202,E00207','11573','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey','@סԺ����ҩ�����(E00202)/@��Ժ���߿���ҩ��ʹ���˴�(E00207)','select "E00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00207" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.217: E00205******************HD_ZBMX_HZ***E00205******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00205')
begin
	print '����ָ��E00205,��ָ��E00205�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00205') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00205','�ż��￹��ҩ��ʹ���˴�','select "E00205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10235','','','0','1','0','FACT_YY_MZ_JZRC','sykjyrc','','timekey,yykey,kskey,yskey,ybflkey,ghlbkey','','select "E00205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.218: E0020510******************HD_ZBMX_HZ***E0020510******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0020510')
begin
	print '����ָ��E0020510,��ָ��E0020510�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0020510') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0020510','���￹��ҩ��ʹ���˴�','select "E0020510" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0020510" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0020510" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10244','','','0','1','0','FACT_YY_MZ_JZRC','sykjyrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey,ybflkey,ghlbkey','','select "E0020510" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.219: E0020511******************HD_ZBMX_HZ***E0020511******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0020511')
begin
	print '����ָ��E0020511,��ָ��E0020511�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0020511') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0020511','���￹��ҩ��ʹ���˴�','select "E0020511" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0020511" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0020511" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10245','','','0','1','0','FACT_YY_MZ_JZRC','sykjyrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey,ybflkey,ghlbkey','','select "E0020511" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.220: E00206******************HD_ZBMX_HZ***E00206******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00206')
begin
	print '����ָ��E00206,��ָ��E00206�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00206') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00206','�ż��￹��ҩ��ʹ����(%)','','select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey union all select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey','','select "E00206" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00205" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00206" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00205" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00205,A001','11582','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,ghlbkey','@�ż��￹��ҩ��ʹ���˴�(E00205)/@�ż����˴�(A001)','select "E00206" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00205" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.221: E0020601******************HD_ZBMX_HZ***E0020601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0020601')
begin
	print '����ָ��E0020601,��ָ��E0020601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0020601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0020601','���￹��ҩ��ʹ����(%)','','','','select "E0020601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020510"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E0020601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020510"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0020510,A00101','11583','','','0','-1','-1','','','','','@���￹��ҩ��ʹ���˴�(E0020510)/@�����˴�(A00101)','select "E0020601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020510"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.222: E0020602******************HD_ZBMX_HZ***E0020602******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0020602')
begin
	print '����ָ��E0020602,��ָ��E0020602�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0020602') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0020602','���￹��ҩ��ʹ����(%)','','','','select "E0020602" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020511"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00102"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E0020602" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020511"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00102"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0020511,A00102','11584','','','0','-1','-1','','','','','@���￹��ҩ��ʹ���˴�(E0020511)/@�����˴�(A00102)','select "E0020602" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020511"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00102"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.223: E00207******************HD_ZBMX_HZ***E00207******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00207')
begin
	print '����ָ��E00207,��ָ��E00207�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00207') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00207','��Ժ���߿���ҩ��ʹ���˴�','select "E00207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "E00207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "E00207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','10246','','','0','1','0','FACT_YY_ZY_CYYWLFX','kjysyrc','','timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey','','select "E00207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.224: E002070104******************HD_ZBMX_HZ***E002070104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E002070104')
begin
	print '����ָ��E002070104,��ָ��E002070104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E002070104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E002070104','һ���п�Ԥ��ʹ�ÿ���ҩ��ʹ���˴�','select "E002070104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "E002070104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "E002070104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','10251','','','0','1','0','FACT_YY_ZY_CYYWLFX','kjysyrc','[{\"dim_key\":\"yfxkjysybz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"ylqkssbrbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey','','select "E002070104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.225: E00207010404******************HD_ZBMX_HZ***E00207010404******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00207010404')
begin
	print '����ָ��E00207010404,��ָ��E00207010404�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00207010404') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00207010404','һ���п�����Ԥ�����ÿ���ҩ��ѡ��һ������ͷ�߾���ʹ����','','select timekey,yykey,kskey,yskey,sum(kjysyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) and yedtbjsypbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(kjysyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,kskey,yskey','','select ''E00207010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207010403'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E002070104'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E00207010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00207010403'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E002070104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00207010403,E002070104','12583','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@һ���п�����Ԥ��ʹ�ÿ���ҩ��ѡ��һ������ͷ�߾����˴�(E00207010403)/@һ���п�Ԥ��ʹ�ÿ���ҩ��ʹ���˴�(E002070104)','select ''E00207010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00207010403'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E002070104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.226: E00208******************HD_ZBMX_HZ***E00208******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00208')
begin
	print '����ָ��E00208,��ָ��E00208�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00208') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00208','��Ժ���߿���ҩ��ʹ����(%)','','','','select "E00208" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00207"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E00208'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_tq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_tq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey','1','','E00207,A102','11588','','','0','-1','-1','','','','','@��Ժ���߿���ҩ��ʹ���˴�(E00207)/@��Ժ�˴�(A102)','select ''E00208'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_hq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_hq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey','','')
	
end
go

/************No.227: E00209******************HD_ZBMX_HZ***E00209******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00209')
begin
	print '����ָ��E00209,��ָ��E00209�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00209') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00209','סԺ����ҩ��ʹ��ǿ��','','select timekey,yykey,kskey,sum(ddds) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zyts) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00230" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00230" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00230,A111','11589','','','0','-1','-1','','','','timekey,yykey,kskey','@��Ժ���߿���ҩ��DDDS(E00230)/@��Ժ����ʵ��ռ���ܴ���(A111)','select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00230" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.228: E00211******************HD_ZBMX_HZ***E00211******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00211')
begin
	print '����ָ��E00211,��ָ��E00211�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00211') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00211','һ���п�Ԥ��ʹ�ÿ���ҩ��ʹ���ʣ�%��','','','','select "E00211" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E002070104"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00207"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E00211'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_tq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E002070104'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_tq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey','1','','E002070104,E00207','11593','','','0','-1','-1','','','','','@һ���п�Ԥ��ʹ�ÿ���ҩ��ʹ���˴�(E002070104)/@��Ժ���߿���ҩ��ʹ���˴�(E00207)Ժ����','select ''E00211'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_hq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E002070104'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_hq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey','','')
	
end
go

/************No.229: E00230******************HD_ZBMX_HZ***E00230******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00230')
begin
	print '����ָ��E00230,��ָ��E00230�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00230') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00230','��Ժ���߿���ҩ��DDDS','select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10261','','','0','1','0','FACT_YP_ZY_FYFX','ddds','','timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey','','select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.230: E0026******************HD_ZBMX_HZ***E0026******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0026')
begin
	print '����ָ��E0026,��ָ��E0026�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0026') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0026','ȫԺ����ҩ��ʹ�ý��ռ��','','select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(kjfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey','','select "E0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E002" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E002,B002','12313','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey','@����ҩ���ܷ���(E002)/@ҩƷ�ܷ���(B002)','select "E0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.231: E003******************HD_ZBMX_HZ***E003******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E003')
begin
	print '����ָ��E003,��ָ��E003�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E003') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E003','����ҩƷ����','','select timekey,yykey,kskey,yskey,ybflkey,sum(jbfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,sum(jbfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey','','select "E003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00301"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00302"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00301"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00302"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00301,E00302','11601','','','0','-1','-1','','','','','@�ż������ҩƷ����(E00301)+@סԺ����ҩƷ����(E00302)','select "E003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00301"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00302"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.232: E00303******************HD_ZBMX_HZ***E00303******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00303')
begin
	print '����ָ��E00303,��ָ��E00303�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00303') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00303','����ҩ������ռ��','','select timekey,yykey,kskey,yskey,ybflkey,sum(jbfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,sum(jbfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey','','select "E00303" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E003" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00303" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E003" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E003,B002','11602','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey','@����ҩƷ����(E003)/@ҩƷ�ܷ���(B002)','select "E00303" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E003" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.233: E00306******************HD_ZBMX_HZ***E00306******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00306')
begin
	print '����ָ��E00306,��ָ��E00306�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00306') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00306','����ҩ���䱸��','','select timekey,yykey,kskey,ypdm fz,0 fm from FACT_YP_JXCFX_YK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ykczlbkey in (1) union all select timekey,yykey,kskey,0 fz,idm fm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)','','select ''E00306'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''G30001'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E001002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E00306'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''G30001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E001002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','G30001,E001002','12888','','','0','-1','-1','','','','timekey,yykey,kskey','@�ɹ�(���)����ҩ��Ʒ����(G30001)/@����ҩ��Ʒ������(E001002)','select ''E00306'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''G30001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E001002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.234: E101******************HD_ZBMX_HZ***E101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E101')
begin
	print '����ָ��E101,��ָ��E101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E101','ҩռ��(%)','','','','select "E101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_tq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B002'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_tq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B001'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey','1','','B002,B001','11641','','','0','-1','-1','','','','','@ҩƷ�ܷ���(B002)/@ҽԺ�ܷ���(B001)','select ''E101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_hq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B002'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_hq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B001'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey','','')
	
end
go

/************No.235: E10106******************HD_ZBMX_HZ***E10106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E10106')
begin
	print '����ָ��E10106,��ָ��E10106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E10106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E10106','ҩռ�ȣ�������ҩ��Ƭ��','','select timekey,yykey,kskey,sum(ypfy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ypfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey','','select ''E10106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00205'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00107'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E10106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00205'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00107'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00205,B00107','12527','','','0','-1','-1','','','','timekey,yykey,kskey','@ҩƷ����(������ҩ��Ƭ)(B00205)/@ҽ������(������ҩ��Ƭ)(B00107)','select ''E10106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00205'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00107'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.236: E10302******************HD_ZBMX_HZ***E10302******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E10302')
begin
	print '����ָ��E10302,��ָ��E10302�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E10302') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E10302','סԺ����ҩ��ռ��(%)','','','','select "E10302" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00202"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_tq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00202'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_tq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00202'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey','1','','E00202,B00202','11300','','','0','-1','-1','','','','','@סԺ����ҩ�����(E00202)/@סԺҩƷ����(B00202)','select ''E10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_hq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00202'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_hq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00202'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey','','')
	
end
go

/************No.237: E201******************HD_ZBMX_HZ***E201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201')
begin
	print '����ָ��E201,��ָ��E201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201','�ż��ﴦ����','select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10285','','','0','1','0','FACT_YP_CFLFX','cfs','','timekey,yykey,kskey,mjzkey','','select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.238: E20103******************HD_ZBMX_HZ***E20103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20103')
begin
	print '����ָ��E20103,��ָ��E20103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20103','�ż������ҩƷ������','select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10288','','','0','1','0','FACT_YP_CFLFX','jbypcfs','','timekey,yykey,kskey,yskey','','select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','-1','')
	
end
go

/************No.239: E201101******************HD_ZBMX_HZ***E201101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201101')
begin
	print '����ָ��E201101,��ָ��E201101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201101','���￹��ҩ�ﴦ������','select "E201101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(kjypcfs) fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1 group by timekey,yykey,kskey,yskey,ybflkey,mjzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(kjypcfs) fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1 group by timekey,yykey,kskey,yskey,ybflkey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(kjypcfs) fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1 group by timekey,yykey,kskey,yskey,ybflkey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12305','','','0','-1','-1','FACT_YP_CFLFX','sum(kjypcfs) fz,sum(cfs) fm','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1','timekey,yykey,kskey,yskey,ybflkey,mjzkey','','select "E201101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(kjypcfs) fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1 group by timekey,yykey,kskey,yskey,ybflkey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.240: E201170301******************HD_ZBMX_HZ***E201170301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201170301')
begin
	print '����ָ��E201170301,��ָ��E201170301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201170301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201170301','������ҩ��������Ƭ���г�ҩ��Ժ���Ƽ�����','select "E201170301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zycfs_ypcyzj) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201170301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycfs_ypcyzj) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201170301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycfs_ypcyzj) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12634','','','0','1','0','FACT_YP_CFLFX','zycfs_ypcyzj','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "E201170301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycfs_ypcyzj) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.241: E201170303******************HD_ZBMX_HZ***E201170303******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201170303')
begin
	print '����ָ��E201170303,��ָ��E201170303�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201170303') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201170303','��ҩ��������Ƭ���г�ҩ��Ժ���Ƽ�����ռ�����ܴ������ı���','','select timekey,yykey,kskey,yskey,sum(zycfs_ypcyzj) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey','','select ''E201170303'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E201170301'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E20137'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E201170303'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E201170301'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E20137'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E201170301,E20137','12890','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@������ҩ��������Ƭ���г�ҩ��Ժ���Ƽ�����(E201170301)/@���ﴦ����(E20137)','select ''E201170303'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E201170301'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E20137'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.242: E20118******************HD_ZBMX_HZ***E20118******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20118')
begin
	print '����ָ��E20118,��ָ��E20118�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20118') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20118','�ż����ҩ������','select "E20118" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,mjzkey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,mjzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20118" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20118" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11699','','','0','1','0','FACT_YP_CFLFX','caoycfs','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1,2\"}]','timekey,yykey,kskey,yskey,mjzkey','','select "E20118" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.243: E2011801******************HD_ZBMX_HZ***E2011801******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E2011801')
begin
	print '����ָ��E2011801,��ָ��E2011801�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E2011801') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E2011801','�����ҩ������','select "E2011801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E2011801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E2011801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12561','','','0','1','0','FACT_YP_CFLFX','caoycfs','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "E2011801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.244: E201180101******************HD_ZBMX_HZ***E201180101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201180101')
begin
	print '����ָ��E201180101,��ָ��E201180101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201180101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201180101','����С��װ��ҩ��Ƭ������','select "E201180101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(xbzcycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201180101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(xbzcycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201180101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(xbzcycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12745','','','0','1','0','FACT_YP_CFLFX','xbzcycfs','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "E201180101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(xbzcycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.245: E201180102******************HD_ZBMX_HZ***E201180102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201180102')
begin
	print '����ָ��E201180102,��ָ��E201180102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201180102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201180102','С��װ��ҩ��ƬӦ����','','select timekey,yykey,kskey,sum(xbzcycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey','','select "E201180102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201180101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20137" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E201180102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201180101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20137" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E201180101,E20137','12746','','','0','-1','-1','','','','timekey,yykey,kskey','@����С��װ��ҩ��Ƭ������(E201180101)/@���ﴦ����(E20137)','select "E201180102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201180101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20137" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.246: E201180301******************HD_ZBMX_HZ***E201180301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201180301')
begin
	print '����ָ��E201180301,��ָ��E201180301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201180301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201180301','�˾���ҽ�����˴�������ҩ��Ƭ������','','select timekey,yykey,kskey,sum(caoycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey','','select ''E201180301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E2011801'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A0014001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E201180301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E2011801'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A0014001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E2011801,A0014001','12650','','','0','-1','-1','','','','timekey,yykey,kskey','@�����ҩ������(E2011801)/@������ҽ�Һ��˴�(��ҽ�����˴���)(A0014001)','select ''E201180301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E2011801'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A0014001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.247: E2011804******************HD_ZBMX_HZ***E2011804******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E2011804')
begin
	print '����ָ��E2011804,��ָ��E2011804�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E2011804') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E2011804','��ҩ��Ƭ����ռ������ҩ������������','','select timekey,yykey,kskey,sum(caoycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycfs_ypcyzj) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey','','select ''E2011804'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E2011801'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E201170301'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E2011804'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E2011801'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E201170301'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E2011801,E201170301','12741','','','0','-1','-1','','','','timekey,yykey,kskey','@�����ҩ������(E2011801)/@������ҩ��������Ƭ���г�ҩ��Ժ���Ƽ�����(E201170301)','select ''E2011804'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E2011801'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E201170301'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.248: E20119******************HD_ZBMX_HZ***E20119******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20119')
begin
	print '����ָ��E20119,��ָ��E20119�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20119') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20119','�ż����ҩ����ռ��','','select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(caoycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey union all select timekey,yykey,kskey,yskey,ybflkey,mjzkey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey','','select "E20119" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20118" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E20119" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20118" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E20118,E201','11700','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,mjzkey','@�ż����ҩ������(E20118)/@�ż��ﴦ����(E201)','select "E20119" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20118" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.249: E20137******************HD_ZBMX_HZ***E20137******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20137')
begin
	print '����ָ��E20137,��ָ��E20137�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20137') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20137','���ﴦ����','select "E20137" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20137" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20137" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12557','','','0','1','0','FACT_YP_CFLFX','cfs','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "E20137" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.250: E201407******************HD_ZBMX_HZ***E201407******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201407')
begin
	print '����ָ��E201407,��ָ��E201407�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201407') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201407','�ϸ񴦷���','select ''E201407'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select yykey,timekey,kskey,yskey,sum(hgcfs) fz from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''E201407'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,yskey,sum(hgcfs) fz from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''E201407'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,yskey,sum(hgcfs) fz from FACT_SF_MZ_CFJC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12743','','','0','1','0','FACT_SF_MZ_CFJC','hgcfs','','yykey,timekey,kskey,yskey','','select ''E201407'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,yskey,sum(hgcfs) fz from FACT_SF_MZ_CFJC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.251: E20140701******************HD_ZBMX_HZ***E20140701******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20140701')
begin
	print '����ָ��E20140701,��ָ��E20140701�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20140701') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20140701','�����ϸ���','','select yykey,timekey,kskey,yskey,sum(hgcfs) fz,0 fm from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey union all select yykey,timekey,kskey,yskey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey','','select ''E20140701'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E201407'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E201'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E20140701'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E201407'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E201407,E201','12744','','','0','-1','-1','','','','yykey,timekey,kskey,yskey','@�ϸ񴦷���(E201407)/@�ż��ﴦ����(E201)','select ''E20140701'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E201407'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.252: E20203******************HD_ZBMX_HZ***E20203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20203')
begin
	print '����ָ��E20203,��ָ��E20203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20203','�ż������ҩƷ������(%)','','select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(jbypcfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey union all select timekey,yykey,kskey,yskey,ybflkey,mjzkey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey','','select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E20103,E201','11303','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,mjzkey','@�ż������ҩƷ������(E20103)/@�ż��ﴦ����(E201)','select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.253: E2020801******************HD_ZBMX_HZ***E2020801******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E2020801')
begin
	print '����ָ��E2020801,��ָ��E2020801�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E2020801') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E2020801','���ﾲ����Һ������','','select timekey,yykey,kskey,yskey,ybflkey,sum(jmbycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey','','select ''E2020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E2010801'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E20137'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E2020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E2010801'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E20137'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E2010801,E20137','12580','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey','@���ﾲ����Һ������(E2010801)/@���ﴦ����(E20137)','select ''E2020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E2010801'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E20137'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.254: E20301******************HD_ZBMX_HZ***E20301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20301')
begin
	print '����ָ��E20301,��ָ��E20301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20301','�ż���ע����(%)','','','','select "E20301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E306"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E20301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E306"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E306,A001','11309','','','0','-1','-1','','','','','@�ż���ע���ҩ���˴�(E306)/@�ż����˴�(A001)','select "E20301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E306"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.255: E2030103******************HD_ZBMX_HZ***E2030103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E2030103')
begin
	print '����ָ��E2030103,��ָ��E2030103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E2030103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E2030103','����ע����(%)','','select timekey,yykey,kskey,yskey,ybflkey,sum(zslywsyrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,ybflkey','','select ''E2030103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E30601'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E2030103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E30601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E30601,A00101','12594','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey','@����ע���ҩ���˴�(E30601)/@�����˴�(A00101)','select ''E2030103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E30601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.256: E2030104******************HD_ZBMX_HZ***E2030104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E2030104')
begin
	print '����ָ��E2030104,��ָ��E2030104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E2030104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E2030104','����ע����(%)','','select timekey,yykey,kskey,yskey,ybflkey,sum(zslywsyrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey','','select ''E2030104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E30602'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''E2030104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E30602'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E30602,A00102','12595','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey','@����ע���ҩ���˴�(E30602)/@�����˴�(A00102)','select ''E2030104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E30602'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.257: E301******************HD_ZBMX_HZ***E301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E301')
begin
	print '����ָ��E301,��ָ��E301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E301','���վ���ҩ��','','','','select "E301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00202,A111','11310','','','0','-1','-1','','','','','@סԺҩƷ����(B00202)/@��Ժ����ʵ��ռ���ܴ���(A111)','select "E301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.258: E306******************HD_ZBMX_HZ***E306******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E306')
begin
	print '����ָ��E306,��ָ��E306�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E306') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E306','�ż���ע���ҩ���˴�','select "E306" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(zslywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E306" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(zslywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E306" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(zslywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10296','','','0','1','0','FACT_YY_MZ_JZRC','zslywsyrc','','timekey,yykey,kskey,yskey,ybflkey,ghlbkey','','select "E306" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(zslywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.259: F001******************HD_ZBMX_HZ***F001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F001')
begin
	print '����ָ��F001,��ָ��F001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F001','�������˴�','select "F001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ybflkey,sum(zls) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zls) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zls) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10301','','','0','1','0','FACT_YY_ZYBRZYL','zls','','timekey,yykey,kskey,yskey,ybflkey','','select "F001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zls) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.260: F002******************HD_ZBMX_HZ***F002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F002')
begin
	print '����ָ��F002,��ָ��F002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F002','������ת�˴�','select "F002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ybflkey,sum(zys+hzs) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zys+hzs) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zys+hzs) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10302','','','0','1','0','FACT_YY_ZYBRZYL','zys+hzs','','timekey,yykey,kskey,yskey,ybflkey','','select "F002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zys+hzs) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.261: F00203******************HD_ZBMX_HZ***F00203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F00203')
begin
	print '����ָ��F00203,��ָ��F00203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F00203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F00203','��Ժ����������','','select timekey,yykey,kskey,yskey,ybflkey,sum(zys) fz,0 fm from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(zls) fm from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey','','select ''F00203'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''F00201'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''F001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''F00203'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''F00201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''F001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F00201,F001','12726','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey','@�����˴�(F00201)/@�������˴�(F001)','select ''F00203'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''F00201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''F001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.262: F003******************HD_ZBMX_HZ***F003******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F003')
begin
	print '����ָ��F003,��ָ��F003�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F003') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F003','������ת��(%)','','','','select "F003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F002"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F002"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F002,F001','11322','','','0','-1','-1','','','','','@������ת�˴�(F002)/@�������˴�(F001)','select "F003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F002"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.263: F004******************HD_ZBMX_HZ***F004******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F004')
begin
	print '����ָ��F004,��ָ��F004�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F004') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F004','���������Զ���Ժ�˴�','select "F004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','1','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"5\"}]','timekey,yykey,kskey','','select "F004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.264: F005******************HD_ZBMX_HZ***F005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F005')
begin
	print '����ָ��F005,��ָ��F005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F005') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F005','���������Զ���Ժ��(%)','','select timekey,yykey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zls) fm from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select "F005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F004" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F004" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F004,F001','12892','','','0','-1','-1','','','','timekey,yykey,kskey','@���������Զ���Ժ�˴�(F004)/@�������˴�(F001)','select "F005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F004" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.265: F006******************HD_ZBMX_HZ***F006******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F006')
begin
	print '����ָ��F006,��ָ��F006�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F006') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F006','סԺ��������(%)','','','','select "F006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A104"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A104"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A104,A102','11323','','','0','-1','-1','','','','','@סԺ��������(A104)/@��Ժ�˴�(A102)','select "F006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A104"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.266: F009******************HD_ZBMX_HZ***F009******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F009')
begin
	print '����ָ��F009,��ָ��F009�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F009') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F009','���ȳɹ���(%)','','','','select "F009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F311"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F312"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F311"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F312"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F311,F312','11325','','','0','-1','-1','','','','','@���ȳɹ��˴�(F311)/@�����˴�(F312)','select "F009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F311"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F312"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.267: F010******************HD_ZBMX_HZ***F010******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F010')
begin
	print '����ָ��F010,��ָ��F010�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F010') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F010','��Ժ���Ժ��Ϸ�����(%)','','','','select "F010" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F310"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F010" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F310"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F310,A102','11326','','','0','-1','-1','','','','','@��Ժ���Ժ��Ϸ����˴�(F310)/@��Ժ�˴�(A102)','select "F010" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F310"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.268: F1003******************HD_ZBMX_HZ***F1003******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F1003')
begin
	print '����ָ��F1003,��ָ��F1003�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F1003') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F1003','��Ժ31������סԺ�����˴�','select ''F1003'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,cytimekey,yykey,kskey,syxh from FACT_YY_ZY_BACK15_30 a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1)',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''F1003'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,cytimekey,yykey,kskey,syxh from FACT_YY_ZY_BACK15_30 a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''F1003'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,cytimekey,yykey,kskey,syxh from FACT_YY_ZY_BACK15_30 a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12727','','','0','0','0','FACT_YY_ZY_BACK15_30','syxh','[{\"dim_key\":\"back30\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,cytimekey,yykey,kskey','','select ''F1003'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,cytimekey,yykey,kskey,syxh from FACT_YY_ZY_BACK15_30 a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.269: F100301******************HD_ZBMX_HZ***F100301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F100301')
begin
	print '����ָ��F100301,��ָ��F100301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F100301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F100301','סԺ���߳�Ժ31�����ٴ���Ժ��','','select timekey,yykey,kskey,syxh fz,0 fm from FACT_YY_ZY_BACK15_30 a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1) union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select ''F100301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''F1003'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''F100301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''F1003'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F1003,A102','12728','','','0','-1','-1','','','','timekey,yykey,kskey','@��Ժ31������סԺ�����˴�(F1003)/@��Ժ�˴�(A102)','select ''F100301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''F1003'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.270: F201******************HD_ZBMX_HZ***F201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F201')
begin
	print '����ָ��F201,��ָ��F201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F201','Ժ�ڸ�Ⱦ�˴�','select "F201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "F201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "F201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','10311','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"grbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,bqkey,kskey,yskey,zlzkey','','select "F201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.271: F202******************HD_ZBMX_HZ***F202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F202')
begin
	print '����ָ��F202,��ָ��F202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F202','ҽԺ��Ⱦ������(%)','','','','select "F202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F201"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F201"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F201,A102','11332','','','0','-1','-1','','','','','@Ժ�ڸ�Ⱦ�˴�(F201)/@��Ժ�˴�(A102)','select "F202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F201"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.272: F203******************HD_ZBMX_HZ***F203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F203')
begin
	print '����ָ��F203,��ָ��F203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F203','������Ⱦ�˴�','select ''F203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''F203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''F203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','12879','','','0','1','0','FACT_YY_ZY_CYYWLFX','ssrc','[{\"dim_key\":\"grbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select ''F203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.273: F204******************HD_ZBMX_HZ***F204******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F204')
begin
	print '����ָ��F204,��ָ��F204�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F204') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F204','������ظ�Ⱦ������(%)','','select timekey,yykey,kskey,yskey,sum(ssrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ssrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','','select ''F204'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''F203'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D007'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''F204'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''F203'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D007'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F203,D007','12893','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@������Ⱦ�˴�(F203)/@�����˴�(D007)','select ''F204'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''F203'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D007'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.274: F301******************HD_ZBMX_HZ***F301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F301')
begin
	print '����ָ��F301,��ָ��F301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F301','�ٴ�·�������뾶��(%)','','','','select "F301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F314"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F313"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F314"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F313"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F314,F313','11334','','','0','-1','-1','','','','','@�ٴ�·�������뾶�˴�(F314)/@�ٴ�·�������뾶�����˴�(F313)','select "F301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F314"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F313"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.275: F306******************HD_ZBMX_HZ***F306******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F306')
begin
	print '����ָ��F306,��ָ��F306�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F306') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F306','�ٴ�·�����˱�����(%)','','','','select "F306" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F318"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F314"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F306" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F318"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F314"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F318,F314','11339','','','0','-1','-1','','','','','@�ٴ�·�����˱���·���˴�(F318)/@�ٴ�·�������뾶�˴�(F314)','select "F306" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F318"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F314"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.276: F310******************HD_ZBMX_HZ***F310******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F310')
begin
	print '����ָ��F310,��ָ��F310�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F310') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F310','��Ժ���Ժ��Ϸ����˴�','select "F310" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,yskey,zytskey,rybqkey,rykskey,ybflkey,cyfskey,sexkey,ryzddmkey,cyzddmkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rcfhbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zytskey,rybqkey,rykskey,ybflkey,cyfskey,sexkey,ryzddmkey,cyzddmkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "F310" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zytskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rcfhbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zytskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "F310" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zytskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and rcfhbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zytskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','10312','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"rcfhbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,bqkey,kskey,yskey,zytskey','','select "F310" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zytskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and rcfhbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zytskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.277: F311******************HD_ZBMX_HZ***F311******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F311')
begin
	print '����ָ��F311,��ָ��F311�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F311') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F311','���ȳɹ��˴�','select "F311" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjcgbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "F311" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjcgbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "F311" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qjcgbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','10313','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"qjcgbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,bqkey,kskey,yskey,zlzkey','','select "F311" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qjcgbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.278: F312******************HD_ZBMX_HZ***F312******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F312')
begin
	print '����ָ��F312,��ָ��F312�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F312') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F312','�����˴�','select "F312" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "F312" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "F312" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','10314','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"qjbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,bqkey,kskey,yskey,zlzkey','','select "F312" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.279: F31201******************HD_ZBMX_HZ***F31201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F31201')
begin
	print '����ָ��F31201,��ָ��F31201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F31201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F31201','���ش���������','select "F31201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F31201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F31201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12836','','','0','1','-1','FACT_YY_ZY_CYYWLFX','sum(cyrc) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in (''3'',''4'') and qjbz=1','timekey,yykey,kskey,yskey','','select "F31201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.280: F31202******************HD_ZBMX_HZ***F31202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F31202')
begin
	print '����ָ��F31202,��ָ��F31202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F31202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F31202','���ش����Ȱٷ���','','select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,kskey,yskey','','select "F31202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F31201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F312" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F31202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F31201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F312" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F31201,F312','12837','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@���ش���������(F31201)/@�����˴�(F312)','select "F31202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F31201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F312" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.281: F313******************HD_ZBMX_HZ***F313******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F313')
begin
	print '����ָ��F313,��ָ��F313�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F313') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F313','�ٴ�·�������뾶�����˴�','select "F313" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,lcljkey,zlzkey,sum(fhljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F313" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(fhljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F313" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(fhljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10315','','','0','1','0','FACT_YY_ZY_LCLJFX','fhljzls','','timekey,yykey,kskey,lcljkey,zlzkey','','select "F313" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(fhljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.282: F314******************HD_ZBMX_HZ***F314******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F314')
begin
	print '����ָ��F314,��ָ��F314�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F314') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F314','�ٴ�·�������뾶�˴�','select "F314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,lcljkey,zlzkey,sum(rljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(rljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(rljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10316','','','0','1','0','FACT_YY_ZY_LCLJFX','rljzls','','timekey,yykey,kskey,lcljkey,zlzkey','','select "F314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(rljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.283: F318******************HD_ZBMX_HZ***F318******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F318')
begin
	print '����ָ��F318,��ָ��F318�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F318') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F318','�ٴ�·�����˱���·���˴�','select "F318" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,lcljkey,zlzkey,sum(byls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F318" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(byls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "F318" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(byls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10320','','','0','1','0','FACT_YY_ZY_LCLJFX','byls','','timekey,yykey,kskey,lcljkey,zlzkey','','select "F318" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(byls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.284: G30001******************HD_ZBMX_HZ***G30001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='G30001')
begin
	print '����ָ��G30001,��ָ��G30001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='G30001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('G30001','ҽԺ�ɹ�����ҩ��Ʒ����','select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','-1','','','0','0','0','FACT_DIM_YP','idm','[{\"dim_key\":\"gjjzcgbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','yykey,timekey,kskey','','select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.285: I017******************HD_ZBMX_HZ***I017******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='I017')
begin
	print '����ָ��I017,��ָ��I017�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='I017') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('I017','����������ҽ���Ʋ�����ҽ���Ʒ���ִ����','','','','select ''I017'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''I01701'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''I01702'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''I017'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''I01701'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''I01702'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','I01701,I01702','12754','','','0','-1','-1','','','','','@ִ����ҽ���Ʋ������Ʒ���������(I01701)/@����������ҽ���Ʋ��ֲ�����(I01702)','select ''I017'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''I01701'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''I01702'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.286: I01701******************HD_ZBMX_HZ***I01701******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='I01701')
begin
	print '����ָ��I01701,��ָ��I01701�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='I01701') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb I01701'

end
go

/************No.287: I01702******************HD_ZBMX_HZ***I01702******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='I01702')
begin
	print '����ָ��I01702,��ָ��I01702�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='I01702') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb I01702'

end
go

/************No.288: J005_WS001******************HD_ZBMX_HZ***J005_WS001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J005_WS001')
begin
	print '����ָ��J005_WS001,��ָ��J005_WS001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J005_WS001') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J005_WS001'

end
go

/************No.289: J005_WS00101******************HD_ZBMX_HZ***J005_WS00101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J005_WS00101')
begin
	print '����ָ��J005_WS00101,��ָ��J005_WS00101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J005_WS00101') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J005_WS00101'

end
go

/************No.290: J005_WS00102******************HD_ZBMX_HZ***J005_WS00102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J005_WS00102')
begin
	print '����ָ��J005_WS00102,��ָ��J005_WS00102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J005_WS00102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('J005_WS00102','ҽ������ϸ���','','','','select ''J005_WS00102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''J005_WS00101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''J005_WS001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''J005_WS00102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''J005_WS00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''J005_WS001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','J005_WS00101,J005_WS001','12779','','','0','-1','-1','','','','','@ҽ������ϸ�����(J005_WS00101)/@ҽ������������(J005_WS001)','select ''J005_WS00102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''J005_WS00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''J005_WS001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.291: ZLZB_AQ004301******************HD_ZBMX_HZ***ZLZB_AQ004301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ004301')
begin
	print '����ָ��ZLZB_AQ004301,��ָ��ZLZB_AQ004301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ004301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_AQ004301','סԺ���ߵ���/׹�������ʣ��룩','','select timekey,yykey,kskey, fz,0 fm from  a where timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and  ddzcbz =1

	group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select "ZLZB_AQ004301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_AQ0043" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_AQ004301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_AQ0043" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_AQ0043,A102','11821','','','0','-1','-1','','','','timekey,yykey,kskey','@סԺ���ߵĵ����˴�(ZLZB_AQ0043)/@��Ժ�˴�(A102)','select "ZLZB_AQ004301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_AQ0043" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.292: ZLZB_AQ00650******************HD_ZBMX_HZ***ZLZB_AQ00650******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ00650')
begin
	print '����ָ��ZLZB_AQ00650,��ָ��ZLZB_AQ00650�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ00650') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_AQ00650','������������߳�Ժ�˴Σ�����18���꣩','select ''ZLZB_AQ00650'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''ZLZB_AQ00650'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''ZLZB_AQ00650'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','11262','','','0','1','0','FACT_GZ_HZAQ_BFZ','rc','','timekey,yykey,kskey,bfzkey','','select ''ZLZB_AQ00650'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.293: ZLZB_AQ0107******************HD_ZBMX_HZ***ZLZB_AQ0107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0107')
begin
	print '����ָ��ZLZB_AQ0107,��ָ��ZLZB_AQ0107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0107') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_AQ0107','��������֢������','','','','select "ZLZB_AQ0107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_BFZ0018" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_AQ00650" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_AQ0107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_BFZ0018" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_AQ00650" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_BFZ0018,ZLZB_AQ00650','11279','','','0','-1','-1','','','','','@�����󲢷�֢�����˴�(ZLZB_BFZ0018)/@������������߳�Ժ�˴Σ�����18���꣩(ZLZB_AQ00650)','select "ZLZB_AQ0107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_BFZ0018" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_AQ00650" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.294: ZLZB_AQ0110******************HD_ZBMX_HZ***ZLZB_AQ0110******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0110')
begin
	print '����ָ��ZLZB_AQ0110,��ָ��ZLZB_AQ0110�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0110') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_AQ0110','סԺѹ���˴�','select "ZLZB_AQ0110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey,sum(rc) fz from FACT_GZ_HZAQ_YCFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_AQ0110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey,sum(rc) fz from FACT_GZ_HZAQ_YCFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_AQ0110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey,sum(rc) fz from FACT_GZ_HZAQ_YCFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10499','','','0','1','0','FACT_GZ_HZAQ_YCFX','rc','','timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey','','select "ZLZB_AQ0110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey,sum(rc) fz from FACT_GZ_HZAQ_YCFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.295: ZLZB_AQ0111******************HD_ZBMX_HZ***ZLZB_AQ0111******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0111')
begin
	print '����ָ��ZLZB_AQ0111,��ָ��ZLZB_AQ0111�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0111') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_AQ0111','סԺ����ѹ��������','','select timekey,yykey,kskey,sum(rc) fz,0 fm from FACT_GZ_HZAQ_YCFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select "ZLZB_AQ0111" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_AQ0110" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_AQ0111" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_AQ0110" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_AQ0110,A102','11450','','','0','-1','-1','','','','timekey,yykey,kskey','@סԺѹ���˴�(ZLZB_AQ0110)/@��Ժ�˴�(A102)','select "ZLZB_AQ0111" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_AQ0110" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.296: ZLZB_BFZ0018******************HD_ZBMX_HZ***ZLZB_BFZ0018******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_BFZ0018')
begin
	print '����ָ��ZLZB_BFZ0018,��ָ��ZLZB_BFZ0018�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_BFZ0018') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_BFZ0018','�����󲢷�֢�����˴�','select ''ZLZB_BFZ0018'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''ZLZB_BFZ0018'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')','select ''ZLZB_BFZ0018'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')','1','','','11278','','','0','1','0','FACT_GZ_HZAQ_BFZ','rc','','timekey,yykey,kskey,bfzkey','','select ''ZLZB_BFZ0018'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')','','0')
	
end
go

/************No.297: ZLZB_BFZ0018024******************HD_ZBMX_HZ***ZLZB_BFZ0018024******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_BFZ0018024')
begin
	print '����ָ��ZLZB_BFZ0018024,��ָ��ZLZB_BFZ0018024�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_BFZ0018024') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_BFZ0018024'

end
go

/************No.298: ZLZB_BFZ001802******************HD_ZBMX_HZ***ZLZB_BFZ001802******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_BFZ001802')
begin
	print '����ָ��ZLZB_BFZ001802,��ָ��ZLZB_BFZ001802�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_BFZ001802') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_BFZ001802','���������󲢷�֢������','select "ZLZB_BFZ001802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) and zqssbz in (1) group by timekey,yykey,kskey,bfzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_BFZ001802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) and zqssbz in (1) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_BFZ001802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) and zqssbz in (1) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12225','','','0','1','0','FACT_GZ_HZAQ_BFZ','rc','[{\"dim_key\":\"ssbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,bfzkey','','select "ZLZB_BFZ001802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) and zqssbz in (1) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.299: ZLZB_ICU000******************HD_ZBMX_HZ***ZLZB_ICU000******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ICU000')
begin
	print '����ָ��ZLZB_ICU000,��ָ��ZLZB_ICU000�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ICU000') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_ICU000','��֢ҽѧ��ת����������','select "ZLZB_ICU000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cfkey,syxh from FACT_GZ_ZZYX_ICU a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcsj > ''1900-01-01''',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_ICU000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cfkey,syxh from FACT_GZ_ZZYX_ICU a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcsj > ''1900-01-01'') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_ICU000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cfkey,syxh from FACT_GZ_ZZYX_ICU a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zcsj > ''1900-01-01'') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11234','','','0','0','0','FACT_GZ_ZZYX_ICU','syxh','[{\"dim_key\":\"zcsj\",\"relation\":\"2\",\"caliber\":\"1900-01-01\"}]','timekey,yykey,kskey,cfkey','','select "ZLZB_ICU000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cfkey,syxh from FACT_GZ_ZZYX_ICU a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zcsj > ''1900-01-01'') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.300: ZLZB_ICU0002******************HD_ZBMX_HZ***ZLZB_ICU0002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ICU0002')
begin
	print '����ָ��ZLZB_ICU0002,��ָ��ZLZB_ICU0002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ICU0002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_ICU0002','ת��ICU���ط�ICU�����˴�','select "ZLZB_ICU0002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,count(1) fz from  FACT_GZ_ZZYX_ICU a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0 group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_ICU0002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,count(1) fz from  FACT_GZ_ZZYX_ICU a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_ICU0002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,count(1) fz from  FACT_GZ_ZZYX_ICU a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12764','','','0','1','-1',' FACT_GZ_ZZYX_ICU','count(1) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0','timekey,yykey,kskey','','select "ZLZB_ICU0002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,count(1) fz from  FACT_GZ_ZZYX_ICU a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.301: ZLZB_ICU0003******************HD_ZBMX_HZ***ZLZB_ICU0003******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ICU0003')
begin
	print '����ָ��ZLZB_ICU0003,��ָ��ZLZB_ICU0003�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ICU0003') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_ICU0003'

end
go

/************No.302: ZLZB_SS0086******************HD_ZBMX_HZ***ZLZB_SS0086******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0086')
begin
	print '����ָ��ZLZB_SS0086,��ָ��ZLZB_SS0086�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0086') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_SS0086','��������������������','select "ZLZB_SS0086" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,sskey,ssjbkey,kskey,zdsskey,sum(rc) fz from FACT_GZ_HZAQ_ZDSS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zdsskey in (18) group by timekey,yykey,sskey,ssjbkey,kskey,zdsskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_SS0086" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,sskey,ssjbkey,kskey,zdsskey,sum(rc) fz from FACT_GZ_HZAQ_ZDSS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zdsskey in (18) group by timekey,yykey,sskey,ssjbkey,kskey,zdsskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_SS0086" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,sskey,ssjbkey,kskey,zdsskey,sum(rc) fz from FACT_GZ_HZAQ_ZDSS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zdsskey in (18) group by timekey,yykey,sskey,ssjbkey,kskey,zdsskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11012','','','0','1','0','FACT_GZ_HZAQ_ZDSS','rc','[{\"dim_key\":\"zdsskey\",\"relation\":\"0\",\"caliber\":\"18\"}]','timekey,yykey,sskey,ssjbkey,kskey,zdsskey','','select "ZLZB_SS0086" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,sskey,ssjbkey,kskey,zdsskey,sum(rc) fz from FACT_GZ_HZAQ_ZDSS a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zdsskey in (18) group by timekey,yykey,sskey,ssjbkey,kskey,zdsskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.303: ZLZB_WJZ001******************HD_ZBMX_HZ***ZLZB_WJZ001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_WJZ001')
begin
	print '����ָ��ZLZB_WJZ001,��ָ��ZLZB_WJZ001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_WJZ001') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_WJZ001'

end
go

/************No.304: ZLZB_WJZ00101******************HD_ZBMX_HZ***ZLZB_WJZ00101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_WJZ00101')
begin
	print '����ָ��ZLZB_WJZ00101,��ָ��ZLZB_WJZ00101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_WJZ00101') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_WJZ00101'

end
go

/************No.305: ZLZB_WJZ00102******************HD_ZBMX_HZ***ZLZB_WJZ00102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_WJZ00102')
begin
	print '����ָ��ZLZB_WJZ00102,��ָ��ZLZB_WJZ00102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_WJZ00102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_WJZ00102','Σ��ֵ��ʱ������','','','','select "ZLZB_WJZ00102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_WJZ00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_WJZ001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_WJZ00102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_WJZ00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_WJZ001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_WJZ00101,ZLZB_WJZ001','12778','','','0','-1','-1','','','','','@����Σ��ֵ��ʱ���ô���(ZLZB_WJZ00101)/@����Σ��ֵ�ܴ���(ZLZB_WJZ001)','select "ZLZB_WJZ00102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_WJZ00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_WJZ001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.306: ZLZB_YG1001******************HD_ZBMX_HZ***ZLZB_YG1001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YG1001')
begin
	print '����ָ��ZLZB_YG1001,��ָ��ZLZB_YG1001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YG1001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YG1001','�ùܻ��߳�Ժ�˴�','select "ZLZB_YG1001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YG1001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YG1001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12830','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"zgbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select "ZLZB_YG1001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.307: ZLZB_YG100101******************HD_ZBMX_HZ***ZLZB_YG100101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YG100101')
begin
	print '����ָ��ZLZB_YG100101,��ָ��ZLZB_YG100101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YG100101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YG100101','��Ժ����ҽԺ�ùܸ�Ⱦ��������','select "ZLZB_YG100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) and zggrbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YG100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) and zggrbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YG100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) and zggrbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12831','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"zgbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"zggrbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select "ZLZB_YG100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) and zggrbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.308: ZLZB_YG100102******************HD_ZBMX_HZ***ZLZB_YG100102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YG100102')
begin
	print '����ָ��ZLZB_YG100102,��ָ��ZLZB_YG100102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YG100102') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YG100102'

end
go

/************No.309: ZLZB_YY0001******************HD_ZBMX_HZ***ZLZB_YY0001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0001')
begin
	print '����ָ��ZLZB_YY0001,��ָ��ZLZB_YY0001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0001') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0001'

end
go

/************No.310: ZLZB_YY000101******************HD_ZBMX_HZ***ZLZB_YY000101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000101')
begin
	print '����ָ��ZLZB_YY000101,��ָ��ZLZB_YY000101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000101','������ͥ��������','select "ZLZB_YY000101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY000101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY000101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12842','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"jtbcbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select "ZLZB_YY000101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.311: ZLZB_YY000401******************HD_ZBMX_HZ***ZLZB_YY000401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000401')
begin
	print '����ָ��ZLZB_YY000401,��ָ��ZLZB_YY000401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000401') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000401'

end
go

/************No.312: ZLZB_YY00040103******************HD_ZBMX_HZ***ZLZB_YY00040103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040103')
begin
	print '����ָ��ZLZB_YY00040103,��ָ��ZLZB_YY00040103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040103') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY00040103'

end
go

/************No.313: ZLZB_YY00040104******************HD_ZBMX_HZ***ZLZB_YY00040104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040104')
begin
	print '����ָ��ZLZB_YY00040104,��ָ��ZLZB_YY00040104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040104','�м�����������Առ��','','','','select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY00040103,ZLZB_YY000401','12423','','','0','-1','-1','','','','','@�м�����������Ա����(ZLZB_YY00040103)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.314: ZLZB_YY00040105******************HD_ZBMX_HZ***ZLZB_YY00040105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040105')
begin
	print '����ָ��ZLZB_YY00040105,��ָ��ZLZB_YY00040105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040105') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY00040105'

end
go

/************No.315: ZLZB_YY00040106******************HD_ZBMX_HZ***ZLZB_YY00040106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040106')
begin
	print '����ָ��ZLZB_YY00040106,��ָ��ZLZB_YY00040106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040106','���߼�����������Առ��','','','','select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040105" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040105" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY00040105,ZLZB_YY000401','12424','','','0','-1','-1','','','','','@���߼�����������Ա����(ZLZB_YY00040105)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040105" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.316: ZLZB_YY00040107******************HD_ZBMX_HZ***ZLZB_YY00040107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040107')
begin
	print '����ָ��ZLZB_YY00040107,��ָ��ZLZB_YY00040107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040107') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY00040107'

end
go

/************No.317: ZLZB_YY00040108******************HD_ZBMX_HZ***ZLZB_YY00040108******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040108')
begin
	print '����ָ��ZLZB_YY00040108,��ָ��ZLZB_YY00040108�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040108') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040108','�߼�����������Առ��','','','','select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040107" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040107" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY00040107,ZLZB_YY000401','12425','','','0','-1','-1','','','','','@�߼�����������Ա����(ZLZB_YY00040107)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040107" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.318: ZLZB_YY00040109******************HD_ZBMX_HZ***ZLZB_YY00040109******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040109')
begin
	print '����ָ��ZLZB_YY00040109,��ָ��ZLZB_YY00040109�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040109') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040109','ҽ����','','','','select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0006" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0006" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0005,ZLZB_YY0006','12431','','','0','-1','-1','','','','','@����������Ա����ҽʦ��(ZLZB_YY0005)/@����������Ա����������Ա��(ZLZB_YY0006)','select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0006" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.319: ZLZB_YY00040110******************HD_ZBMX_HZ***ZLZB_YY00040110******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040110')
begin
	print '����ָ��ZLZB_YY00040110,��ָ��ZLZB_YY00040110�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040110') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY00040110'

end
go

/************No.320: ZLZB_YY00040111******************HD_ZBMX_HZ***ZLZB_YY00040111******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040111')
begin
	print '����ָ��ZLZB_YY00040111,��ָ��ZLZB_YY00040111�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040111') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY00040111'

end
go

/************No.321: ZLZB_YY00040201******************HD_ZBMX_HZ***ZLZB_YY00040201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040201')
begin
	print '����ָ��ZLZB_YY00040201,��ָ��ZLZB_YY00040201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040201') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY00040201'

end
go

/************No.322: ZLZB_YY000402******************HD_ZBMX_HZ***ZLZB_YY000402******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000402')
begin
	print '����ָ��ZLZB_YY000402,��ָ��ZLZB_YY000402�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000402') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000402'

end
go

/************No.323: ZLZB_YY000403******************HD_ZBMX_HZ***ZLZB_YY000403******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000403')
begin
	print '����ָ��ZLZB_YY000403,��ָ��ZLZB_YY000403�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000403') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000403'

end
go

/************No.324: ZLZB_YY000405******************HD_ZBMX_HZ***ZLZB_YY000405******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000405')
begin
	print '����ָ��ZLZB_YY000405,��ָ��ZLZB_YY000405�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000405') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000405'

end
go

/************No.325: ZLZB_YY000406******************HD_ZBMX_HZ***ZLZB_YY000406******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000406')
begin
	print '����ָ��ZLZB_YY000406,��ָ��ZLZB_YY000406�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000406') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000406','�����ܺ�֧��','','','','select "ZLZB_YY000406" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000405" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A112" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY000406" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000405" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A112" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY000405,A112','13212','','','0','-1','-1','','','','','@��Դ������֧��(ZLZB_YY000405)/@ʵ��ռ���ܴ�����(A112)','select "ZLZB_YY000406" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000405" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A112" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.326: ZLZB_YY000407******************HD_ZBMX_HZ***ZLZB_YY000407******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000407')
begin
	print '����ָ��ZLZB_YY000407,��ָ��ZLZB_YY000407�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000407') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000407'

end
go

/************No.327: ZLZB_YY000408******************HD_ZBMX_HZ***ZLZB_YY000408******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000408')
begin
	print '����ָ��ZLZB_YY000408,��ָ��ZLZB_YY000408�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000408') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000408','������','','','','select "ZLZB_YY000408" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000407" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY000408" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000407" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY000407,ZLZB_YY0001','13211','','','0','-1','-1','','','','','@����ע�Ụʿ����(ZLZB_YY000407)/@ʵ�ʿ��Ŵ�λ��(ZLZB_YY0001)','select "ZLZB_YY000408" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000407" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.328: ZLZB_YY000409******************HD_ZBMX_HZ***ZLZB_YY000409******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000409')
begin
	print '����ָ��ZLZB_YY000409,��ָ��ZLZB_YY000409�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000409') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000409'

end
go

/************No.329: ZLZB_YY000410******************HD_ZBMX_HZ***ZLZB_YY000410******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000410')
begin
	print '����ָ��ZLZB_YY000410,��ָ��ZLZB_YY000410�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000410') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000410'

end
go

/************No.330: ZLZB_YY0005******************HD_ZBMX_HZ***ZLZB_YY0005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0005')
begin
	print '����ָ��ZLZB_YY0005,��ָ��ZLZB_YY0005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0005') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0005'

end
go

/************No.331: ZLZB_YY000506******************HD_ZBMX_HZ***ZLZB_YY000506******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000506')
begin
	print '����ָ��ZLZB_YY000506,��ָ��ZLZB_YY000506�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000506') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000506'

end
go

/************No.332: ZLZB_YY000507******************HD_ZBMX_HZ***ZLZB_YY000507******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000507')
begin
	print '����ָ��ZLZB_YY000507,��ָ��ZLZB_YY000507�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000507') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000507','��ҽʦ��Առ��','','','','select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000506" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000506" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY000506,ZLZB_YY0005','12430','','','0','-1','-1','','','','','@��ҽʦ��Ա(ZLZB_YY000506)/@����������Ա����ҽʦ��(ZLZB_YY0005)','select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000506" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.333: ZLZB_YY0006******************HD_ZBMX_HZ***ZLZB_YY0006******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0006')
begin
	print '����ָ��ZLZB_YY0006,��ָ��ZLZB_YY0006�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0006') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0006'

end
go

/************No.334: ZLZB_YY0019******************HD_ZBMX_HZ***ZLZB_YY0019******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0019')
begin
	print '����ָ��ZLZB_YY0019,��ָ��ZLZB_YY0019�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0019') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0019'

end
go

/************No.335: ZLZB_YY001901******************HD_ZBMX_HZ***ZLZB_YY001901******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY001901')
begin
	print '����ָ��ZLZB_YY001901,��ָ��ZLZB_YY001901�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY001901') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY001901'

end
go

/************No.336: ZLZB_YY0025******************HD_ZBMX_HZ***ZLZB_YY0025******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0025')
begin
	print '����ָ��ZLZB_YY0025,��ָ��ZLZB_YY0025�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0025') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0025','�����Σ����������','select "ZLZB_YY0025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (248,251,252,263) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY0025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY0025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_YY_ZY_CYYWLFX','qjcs','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"248,251,252,263\"}]','timekey,yykey,kskey','','select "ZLZB_YY0025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.337: ZLZB_YY002501******************HD_ZBMX_HZ***ZLZB_YY002501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002501')
begin
	print '����ָ��ZLZB_YY002501,��ָ��ZLZB_YY002501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY002501','����Σ�ز������ȳɹ��˴�','select "ZLZB_YY002501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey,sum(qjcgcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (94,95,96,97,98,99,100) group by timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "ZLZB_YY002501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey,sum(qjcgcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (94,95,96,97,98,99,100) group by timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "ZLZB_YY002501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey,sum(qjcgcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (94,95,96,97,98,99,100) group by timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','12757','','','0','1','0','FACT_YY_ZY_CYYWLFX','qjcgcs','[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"94,95,96,97,98,99,100\"}]','timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey','','select "ZLZB_YY002501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey,sum(qjcgcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (94,95,96,97,98,99,100) group by timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','0')
	
end
go

/************No.338: ZLZB_YY002502******************HD_ZBMX_HZ***ZLZB_YY002502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002502')
begin
	print '����ָ��ZLZB_YY002502,��ָ��ZLZB_YY002502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002502') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY002502'

end
go

/************No.339: ZLZB_YY0026******************HD_ZBMX_HZ***ZLZB_YY0026******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0026')
begin
	print '����ָ��ZLZB_YY0026,��ָ��ZLZB_YY0026�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0026') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0026','����������סԺ������','','','','select "ZLZB_YY0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY002601" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY002602" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY002601" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY002602" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY002601,ZLZB_YY002602','11283','','','0','-1','-1','','','','','@����������סԺ�����˴�(ZLZB_YY002601)/@����������סԺ�˴�(ZLZB_YY002602)','select "ZLZB_YY0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY002601" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY002602" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.340: ZLZB_YY002601******************HD_ZBMX_HZ***ZLZB_YY002601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002601')
begin
	print '����ָ��ZLZB_YY002601,��ָ��ZLZB_YY002601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY002601','����������סԺ�����˴�','select "ZLZB_YY002601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and cyfskey in (3) group by timekey,yykey,kskey,zlzkey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY002601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and cyfskey in (3) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY002601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and cyfskey in (3) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11281','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"yebz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"3\"}]','timekey,yykey,kskey,zlzkey,yblxkey','','select "ZLZB_YY002601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and cyfskey in (3) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.341: ZLZB_YY002602******************HD_ZBMX_HZ***ZLZB_YY002602******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002602')
begin
	print '����ָ��ZLZB_YY002602,��ָ��ZLZB_YY002602�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002602') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY002602','����������סԺ�˴�','select "ZLZB_YY002602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) group by timekey,yykey,kskey,zlzkey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY002602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY002602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11282','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"yebz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,zlzkey,yblxkey','','select "ZLZB_YY002602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.342: ZLZB_YY0027******************HD_ZBMX_HZ***ZLZB_YY0027******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0027')
begin
	print '����ָ��ZLZB_YY0027,��ָ��ZLZB_YY0027�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0027') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0027','סԺΣ��������������','select "ZLZB_YY0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_YY_ZY_CYYWLFX','qjcs','[{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"3\"}]','timekey,yykey,kskey','','select "ZLZB_YY0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.343: ZLZB_YY002701******************HD_ZBMX_HZ***ZLZB_YY002701******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002701')
begin
	print '����ָ��ZLZB_YY002701,��ָ��ZLZB_YY002701�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002701') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY002701'

end
go

/************No.344: ZLZB_YY0028******************HD_ZBMX_HZ***ZLZB_YY0028******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0028')
begin
	print '����ָ��ZLZB_YY0028,��ָ��ZLZB_YY0028�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0028') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0028','�����Σ��������������','select "ZLZB_YY0028" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) and kskey in (248,251,252,263) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY0028" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY0028" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_YY_ZY_CYYWLFX','qjcs','[{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"248,251,252,263\"}]','timekey,yykey,kskey','','select "ZLZB_YY0028" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.345: ZLZB_YY002801******************HD_ZBMX_HZ***ZLZB_YY002801******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002801')
begin
	print '����ָ��ZLZB_YY002801,��ָ��ZLZB_YY002801�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002801') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY002801','������������','select "ZLZB_YY002801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(rc) fz from FACT_GZ_ZLGL_JZZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY002801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(rc) fz from FACT_GZ_ZLGL_JZZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_YY002801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(rc) fz from FACT_GZ_ZLGL_JZZY a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12762','','','0','1','0','FACT_GZ_ZLGL_JZZY','rc','[{\"dim_key\":\"swbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select "ZLZB_YY002801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(rc) fz from FACT_GZ_ZLGL_JZZY a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.346: ZLZB_YY002802******************HD_ZBMX_HZ***ZLZB_YY002802******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002802')
begin
	print '����ָ��ZLZB_YY002802,��ָ��ZLZB_YY002802�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002802') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY002802'

end
go

/************No.347: ZLZB_YY0102******************HD_ZBMX_HZ***ZLZB_YY0102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0102')
begin
	print '����ָ��ZLZB_YY0102,��ָ��ZLZB_YY0102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0102') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0102'

end
go

/************No.348: ZLZB_YY010201******************HD_ZBMX_HZ***ZLZB_YY010201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010201')
begin
	print '����ָ��ZLZB_YY010201,��ָ��ZLZB_YY010201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010201') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010201'

end
go

/************No.349: ZLZB_YY010202******************HD_ZBMX_HZ***ZLZB_YY010202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010202')
begin
	print '����ָ��ZLZB_YY010202,��ָ��ZLZB_YY010202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010202') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010202'

end
go

/************No.350: ZLZB_YY0103******************HD_ZBMX_HZ***ZLZB_YY0103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0103')
begin
	print '����ָ��ZLZB_YY0103,��ָ��ZLZB_YY0103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0103') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0103'

end
go

/************No.351: ZLZB_YY010301******************HD_ZBMX_HZ***ZLZB_YY010301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010301')
begin
	print '����ָ��ZLZB_YY010301,��ָ��ZLZB_YY010301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010301') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010301'

end
go

/************No.352: ZLZB_YY010302******************HD_ZBMX_HZ***ZLZB_YY010302******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010302')
begin
	print '����ָ��ZLZB_YY010302,��ָ��ZLZB_YY010302�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010302') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010302'

end
go

/************No.353: ZLZB_YY0104******************HD_ZBMX_HZ***ZLZB_YY0104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0104')
begin
	print '����ָ��ZLZB_YY0104,��ָ��ZLZB_YY0104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0104') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0104'

end
go

/************No.354: ZLZB_YY010401******************HD_ZBMX_HZ***ZLZB_YY010401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010401')
begin
	print '����ָ��ZLZB_YY010401,��ָ��ZLZB_YY010401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010401') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010401'

end
go

/************No.355: ZLZB_YY010402******************HD_ZBMX_HZ***ZLZB_YY010402******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010402')
begin
	print '����ָ��ZLZB_YY010402,��ָ��ZLZB_YY010402�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010402') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010402'

end
go

/************No.356: ZLZB_YY0105******************HD_ZBMX_HZ***ZLZB_YY0105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0105')
begin
	print '����ָ��ZLZB_YY0105,��ָ��ZLZB_YY0105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0105') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0105'

end
go

/************No.357: ZLZB_YY010501******************HD_ZBMX_HZ***ZLZB_YY010501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010501')
begin
	print '����ָ��ZLZB_YY010501,��ָ��ZLZB_YY010501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010501') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010501'

end
go

/************No.358: ZLZB_YY010502******************HD_ZBMX_HZ***ZLZB_YY010502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010502')
begin
	print '����ָ��ZLZB_YY010502,��ָ��ZLZB_YY010502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010502') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010502'

end
go

/************No.359: ZLZB_ZLGL_LCBL035******************HD_ZBMX_HZ***ZLZB_ZLGL_LCBL035******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL035')
begin
	print '����ָ��ZLZB_ZLGL_LCBL035,��ָ��ZLZB_ZLGL_LCBL035�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL035') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_ZLGL_LCBL035','���п��������ʯ����Ϸ��ϱ걾��','select "ZLZB_ZLGL_LCBL035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_ZLGL_LCBL035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_ZLGL_LCBL035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11791','','','0','1','-1','FACT_GZ_ZLGL_BLZY','sum(1) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1','timekey,yykey,kskey,yskey','','select "ZLZB_ZLGL_LCBL035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.360: ZLZB_ZLGL_LCBL036******************HD_ZBMX_HZ***ZLZB_ZLGL_LCBL036******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL036')
begin
	print '����ָ��ZLZB_ZLGL_LCBL036,��ָ��ZLZB_ZLGL_LCBL036�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL036') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_ZLGL_LCBL036','���п�����ϱ걾����','select "ZLZB_ZLGL_LCBL036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_ZLGL_LCBL036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZLZB_ZLGL_LCBL036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11792','','','0','1','-1','FACT_GZ_ZLGL_BLZY','sum(1) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1','timekey,yykey,kskey,yskey','','select "ZLZB_ZLGL_LCBL036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.361: ZLZB_ZLGL_LCBL037******************HD_ZBMX_HZ***ZLZB_ZLGL_LCBL037******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL037')
begin
	print '����ָ��ZLZB_ZLGL_LCBL037,��ָ��ZLZB_ZLGL_LCBL037�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL037') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_ZLGL_LCBL037','���п��������ʯ����Ϸ�����','','select timekey,yykey,kskey,yskey,sum(1) fz,0 fm from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(1) fm from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey','','select "ZLZB_ZLGL_LCBL037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_ZLGL_LCBL035" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_ZLGL_LCBL036" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_ZLGL_LCBL037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL035" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL036" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_ZLGL_LCBL035,ZLZB_ZLGL_LCBL036','11793','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@���п��������ʯ����Ϸ��ϱ걾��(ZLZB_ZLGL_LCBL035)/@���п�����ϱ걾����(ZLZB_ZLGL_LCBL036)','select "ZLZB_ZLGL_LCBL037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL035" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL036" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go


/*********No.1: A001******HD_ZBMX_HZ***A001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey'
,memo=''
,orderno='10000'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey'
,sql_start='select "A001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,nldkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A001'
,zb_name='�ż����˴�'
,zbzt='0'
 where zb_id='A001'
end
go

/*********No.2: A001002******HD_ZBMX_HZ***A001002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A001002')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select ''A001002'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12803'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A001002'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A001002'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A001002'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A001002'
,zb_name='�ӱ������ż����˴���'
,zbzt='0'
 where zb_id='A001002'
end
go

/*********No.3: A001003******HD_ZBMX_HZ***A001003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A001003')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A001002,C001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ӱ������ż����˴���(A001002)/@�ż���ҽ���˴�(C001)'
,hqsql_text='select ''A001003'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12804'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ybghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A001003'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001002'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A001003'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A001003'
,zb_name='�ӱ������ż�������˴���ռ��'
,zbzt='0'
 where zb_id='A001003'
end
go

/*********No.4: A00101******HD_ZBMX_HZ***A00101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey'
,memo=''
,orderno='10001'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey'
,sql_start='select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00101'
,zb_name='�����˴�'
,zbzt='0'
 where zb_id='A00101'
end
go

/*********No.5: A00102******HD_ZBMX_HZ***A00102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00102')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey'
,memo=''
,orderno='10002'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey'
,sql_start='select "A00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,hourkey,yykey,kskey,ybflkey,ghlbkey,yyfskey,zddmkey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00102'
,zb_name='�����˴�'
,zbzt='0'
 where zb_id='A00102'
end
go

/*********No.6: A0010502******HD_ZBMX_HZ***A0010502*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A0010502')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='patid'
,fact_table='FACT_YY_MZ_PATID'
,gspz=''
,hqsql_text='select "A0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey,ybflkey,cfzkey'
,memo=''
,orderno='10006'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)'
,sql_start='select "A0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='0'
,zb_id='A0010502'
,zb_name='�ż���ҽ������'
,zbzt='0'
 where zb_id='A0010502'
end
go

/*********No.7: A0010503******HD_ZBMX_HZ***A0010503*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A0010503')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"cfzbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='patid'
,fact_table='FACT_YY_MZ_PATID'
,gspz=''
,hqsql_text='select "A0010503" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey,ybflkey,cfzkey'
,memo=''
,orderno='10007'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1)'
,sql_start='select "A0010503" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A0010503" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A0010503" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ybflkey,cfzkey,patid from FACT_YY_MZ_PATID a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='0'
,zb_id='A0010503'
,zb_name='�ż���ҽ����������'
,zbzt='0'
 where zb_id='A0010503'
end
go

/*********No.8: A0010903******HD_ZBMX_HZ***A0010903*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A0010903')
begin
update HD_ZBMX_HZ set
condition=' inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in (''01'',''02'',''03'')'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(a.ghrc) fz'
,fact_table='FACT_YY_MZ_JZRC '
,gspz=''
,hqsql_text='select "A0010903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(a.ghrc) fz from FACT_YY_MZ_JZRC  a  inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='a.timekey,a.yykey,a.kskey,a.yskey'
,memo=''
,orderno='12782'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select a.timekey,a.yykey,a.kskey,a.yskey,sum(a.ghrc) fz from FACT_YY_MZ_JZRC  a  inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by a.timekey,a.yykey,a.kskey,a.yskey'
,sql_start='select "A0010903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A0010903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(a.ghrc) fz from FACT_YY_MZ_JZRC  a  inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A0010903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(a.ghrc) fz from FACT_YY_MZ_JZRC  a  inner join DIM_YSXX b on a.yskey=b.yskey where a.timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A0010903'
,zb_name='ר�ҳ�����ͨ�����˴�'
,zbzt='0'
 where zb_id='A0010903'
end
go

/*********No.9: A0010904******HD_ZBMX_HZ***A0010904*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A0010904')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A0010903,A00101'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ר�ҳ�����ͨ�����˴�(A0010903)/@�����˴�(A00101)'
,hqsql_text='select "A0010904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A0010903" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12783'
,proc_name=''
,sql_end=''
,sql_middle='select ,sum(a.ghrc) fz,0 fm from FACT_YY_MZ_JZRC  a where a.timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.zcdm in ("01","02","03") group by  union all select ,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by '
,sql_start=''
,sql_text='select "A0010904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A0010903" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A0010904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A0010903" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A0010904'
,zb_name='ר�ҳ�����ͨ�����˴α���'
,zbzt='0'
 where zb_id='A0010904'
end
go

/*********No.10: A0010905******HD_ZBMX_HZ***A0010905*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A0010905')
begin
update HD_ZBMX_HZ set
condition='inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'')'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(ghrc)*7/abs(datediff ( day,@kssj,@jssj)) fz'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select ''A0010905'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(ghrc)*7/abs(datediff ( day,dateadd(month,-1,@kssj),dateadd(month,-1,@jssj))) fz from FACT_YY_MZ_JZRC a inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'') group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='-1'
,kxwdz='a.timekey,a.yykey,a.kskey,a.yskey'
,memo=''
,orderno='12848'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select a.timekey,a.yykey,a.kskey,a.yskey,sum(ghrc)*7/abs(datediff ( day,@kssj,@jssj)) fz from FACT_YY_MZ_JZRC a inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'') group by a.timekey,a.yykey,a.kskey,a.yskey'
,sql_start='select ''A0010905'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A0010905'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(ghrc)*7/abs(datediff ( day,@kssj,@jssj)) fz from FACT_YY_MZ_JZRC a inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'') group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A0010905'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,a.yskey,sum(ghrc)*7/abs(datediff ( day,dateadd(year,-1,@kssj),dateadd(year,-1,@jssj))) fz from FACT_YY_MZ_JZRC a inner join DIM_YSXX b on a.yskey=b.yskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and b.zcdm in (''01'',''02'',''03'') group by a.timekey,a.yykey,a.kskey,a.yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='A0010905'
,zb_name='ר����ͨ�����ܳ������'
,zbzt='0'
 where zb_id='A0010905'
end
go

/*********No.11: A00110******HD_ZBMX_HZ***A00110*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00110')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ghlbkey\",\"relation\":\"0\",\"caliber\":\"3\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A00110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey'
,memo=''
,orderno='10013'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey'
,sql_start='select "A00110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey,mjzkey,ghlbkey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00110'
,zb_name='ר�ҹҺ��˴�'
,zbzt='0'
 where zb_id='A00110'
end
go

/*********No.12: A001105******HD_ZBMX_HZ***A001105*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A001105')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A00110,A00803'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@ר�ҹҺ��˴�(A00110)/@ר���Ű��˴�(A00803)'
,hqsql_text='select ''A001105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00110'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00803'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12786'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ghrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey in (3) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghhxzs) fm from FACT_YYGH_PBXX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A001105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00110'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00803'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A001105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00110'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00803'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A001105'
,zb_name='ר���˾�ÿ���յ��������˴�'
,zbzt='0'
 where zb_id='A001105'
end
go

/*********No.13: A00140******HD_ZBMX_HZ***A00140*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00140')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1,2\"},{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"29\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A00140" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) and kskey in (29) group by timekey,yykey,kskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ghlbkey'
,memo=''
,orderno='11187'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) and kskey in (29) group by timekey,yykey,kskey,ghlbkey'
,sql_start='select "A00140" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00140" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) and kskey in (29) group by timekey,yykey,kskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00140" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) and kskey in (29) group by timekey,yykey,kskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00140'
,zb_name='��ҽ�Һ��˴�(��ҽ�����˴���)'
,zbzt='0'
 where zb_id='A00140'
end
go

/*********No.14: A0014001******HD_ZBMX_HZ***A0014001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A0014001')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"46,53,58\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select ''A0014001'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey,yskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ghlbkey'
,memo=''
,orderno='12647'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey,yskey,ghlbkey'
,sql_start='select ''A0014001'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A0014001'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey,yskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A0014001'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ghlbkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey,yskey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A0014001'
,zb_name='������ҽ�Һ��˴�(��ҽ�����˴���)'
,zbzt='0'
 where zb_id='A0014001'
end
go

/*********No.15: A00141******HD_ZBMX_HZ***A00141*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00141')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A00140,A001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��ҽ�Һ��˴�(��ҽ�����˴���)(A00140)/@�ż����˴�(A001)'
,hqsql_text='select "A00141" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00140" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,hourkey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,yyfskey,zddmkey,sexkey,nldkey,czykey,dzkey,cfzkey'
,memo=''
,orderno='11188'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "A00141" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00140" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A00141" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00140" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A00141'
,zb_name='��ҽ�Һ��˴�ռ��'
,zbzt='0'
 where zb_id='A00141'
end
go

/*********No.16: A00142******HD_ZBMX_HZ***A00142*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00142')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyfywlfrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A00142" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yblxkey,sum(zyfywlfrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yblxkey'
,memo=''
,orderno='11203'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yblxkey,sum(zyfywlfrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yblxkey'
,sql_start='select "A00142" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00142" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yblxkey,sum(zyfywlfrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00142" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yblxkey,sum(zyfywlfrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00142'
,zb_name='��ҽ��ҩ���Ʒ������˴�'
,zbzt='0'
 where zb_id='A00142'
end
go

/*********No.17: A00143******HD_ZBMX_HZ***A00143*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00143')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A00142,A001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��ҽ��ҩ���Ʒ������˴�(A00142)/@�ż����˴�(A001)'
,hqsql_text='select "A00143" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00142" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,hourkey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,yyfskey,zddmkey,sexkey,nldkey,czykey,dzkey,cfzkey'
,memo=''
,orderno='11204'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "A00143" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00142" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A00143" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00142" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A00143'
,zb_name='��ҽ��ҩ���Ʒ������ʣ�%��'
,zbzt='0'
 where zb_id='A00143'
end
go

/*********No.18: A002******HD_ZBMX_HZ***A002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='tjrc'
,fact_table='FACT_YY_MZ_TJRC'
,gspz=''
,hqsql_text='select "A002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(tjrc) fz from FACT_YY_MZ_TJRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='10032'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(tjrc) fz from FACT_YY_MZ_TJRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start='select "A002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(tjrc) fz from FACT_YY_MZ_TJRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(tjrc) fz from FACT_YY_MZ_TJRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A002'
,zb_name='��������˴�'
,zbzt='0'
 where zb_id='A002'
end
go

/*********No.21: A002002******HD_ZBMX_HZ***A002002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A002002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A002001,A0020'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�׼���ʷ����(A002001)/@��鲡ʷ������(A0020)'
,hqsql_text='select ''A002002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A002001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A0020'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12780'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select ''A002002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A002001'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A0020'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A002002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A002001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A0020'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A002002'
,zb_name='�׼���ʷ��'
,zbzt='0'
 where zb_id='A002002'
end
go

/*********No.22: A00201******HD_ZBMX_HZ***A00201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A002,A001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��������˴�(A002)/@�ż����˴�(A001)'
,hqsql_text='select ''A00201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12870'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(tjrc) fz,0 fm from FACT_YY_MZ_TJRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A00201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A002'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A00201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A00201'
,zb_name='��������˴���ռ��'
,zbzt='0'
 where zb_id='A00201'
end
go

/*********No.25: A002102******HD_ZBMX_HZ***A002102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A002102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A002101,A0021'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ֲ����淶����ʹ�ò�����(A002101)/@���ֲ����ʹ�ò�����(A0021)'
,hqsql_text='select "A002102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A002101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A0021" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12784'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "A002102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A002101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A0021" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A002102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A002101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A0021" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A002102'
,zb_name='ֲ����淶����ʹ����'
,zbzt='0'
 where zb_id='A002102'
end
go

/*********No.26: A00301******HD_ZBMX_HZ***A00301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A00401,A001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��ЧԤԼ�����˴�(A00401)/@�ż����˴�(A001)'
,hqsql_text='select "A00301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,yyfskey'
,memo=''
,orderno='12333'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,yyfskey,sum(yxyyjzrc) fz,0 fm from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey union all select timekey,yykey,kskey,yskey,yyfskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey'
,sql_start=''
,sql_text='select "A00301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00401" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A00301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A00301'
,zb_name='����ԤԼ��(%)'
,zbzt='0'
 where zb_id='A00301'
end
go

/*********No.27: A00401******HD_ZBMX_HZ***A00401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00401')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='rc'
,fact_table='FACT_YY_MZ_JZLC'
,gspz=''
,hqsql_text='select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12332'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey'
,sql_start='select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00401'
,zb_name='��ЧԤԼ�����˴�'
,zbzt='0'
 where zb_id='A00401'
end
go

/*********No.28: A00803******HD_ZBMX_HZ***A00803*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00803')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zjysbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghhxzs'
,fact_table='FACT_YYGH_PBXX'
,gspz=''
,hqsql_text='select "A00803" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,pbkmkey,hxlxkey,sum(ghhxzs) fz from FACT_YYGH_PBXX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by yykey,timekey,kskey,pbkmkey,hxlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='yykey,timekey,kskey,pbkmkey,hxlxkey'
,memo=''
,orderno='10045'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select yykey,timekey,kskey,pbkmkey,hxlxkey,sum(ghhxzs) fz from FACT_YYGH_PBXX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by yykey,timekey,kskey,pbkmkey,hxlxkey'
,sql_start='select "A00803" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00803" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,pbkmkey,hxlxkey,sum(ghhxzs) fz from FACT_YYGH_PBXX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by yykey,timekey,kskey,pbkmkey,hxlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00803" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,pbkmkey,hxlxkey,sum(ghhxzs) fz from FACT_YYGH_PBXX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zjysbz in (1) group by yykey,timekey,kskey,pbkmkey,hxlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00803'
,zb_name='ר���Ű��˴�'
,zbzt='0'
 where zb_id='A00803'
end
go

/*********No.29: A101******HD_ZBMX_HZ***A101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ryrc'
,fact_table='FACT_YY_ZY_RYYWLFX'
,gspz=''
,hqsql_text='select "A101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ryrc) fz from FACT_YY_ZY_RYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='10054'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ryrc) fz from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ryrc) fz from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ryrc) fz from FACT_YY_ZY_RYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A101'
,zb_name='��Ժ�˴�'
,zbzt='0'
 where zb_id='A101'
end
go

/*********No.30: A10102******HD_ZBMX_HZ***A10102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A101,A001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ�˴�(A101)/@�ż����˴�(A001)'
,hqsql_text='select ''A10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='12771'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(ryrc) fz,0 fm from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start=''
,sql_text='select ''A10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A10102'
,zb_name='����סԺ��'
,zbzt='0'
 where zb_id='A10102'
end
go

/*********No.31: A10103******HD_ZBMX_HZ***A10103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10103')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='patid'
,fact_table='FACT_YY_ZY_RYYWLFX'
,gspz=''
,hqsql_text='select ''A10103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,patid from FACT_YY_ZY_RYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12776'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,patid from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))'
,sql_start='select ''A10103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A10103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,patid from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A10103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,count(distinct patid) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,patid from FACT_YY_ZY_RYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='0'
,zb_id='A10103'
,zb_name='��Ժ����'
,zbzt='0'
 where zb_id='A10103'
end
go

/*********No.32: A10104******HD_ZBMX_HZ***A10104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A101,A10103'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ�˴�(A101)/@��Ժ����(A10103)'
,hqsql_text='select ''A10104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10103'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12777'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ryrc) fz,0 fm from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,patid fm from FACT_YY_ZY_RYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))'
,sql_start=''
,sql_text='select ''A10104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10103'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A10104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10103'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A10104'
,zb_name='סԺ�˴���ͷ��'
,zbzt='0'
 where zb_id='A10104'
end
go

/*********No.33: A102******HD_ZBMX_HZ***A102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ybflkey,cyfskey'
,memo=''
,orderno='10056'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey'
,sql_start='select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A102'
,zb_name='��Ժ�˴�'
,zbzt='0'
 where zb_id='A102'
end
go

/*********No.34: A10213******HD_ZBMX_HZ***A10213*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10213')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zyypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A10213'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12652'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A10213'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A10213'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A10213'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A10213'
,zb_name='��Ժ����Ӧ����ҩ��Ƭ���˴�'
,zbzt='0'
 where zb_id='A10213'
end
go

/*********No.35: A1021301******HD_ZBMX_HZ***A1021301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A10213,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ����Ӧ����ҩ��Ƭ���˴�(A10213)/@��Ժ�˴�(A102)'
,hqsql_text='select "A1021301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A10213" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12653'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyypbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select "A1021301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A10213" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A1021301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A10213" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1021301'
,zb_name='��Ժ����Ӧ����ҩ��Ƭ�˴α���'
,zbzt='0'
 where zb_id='A1021301'
end
go

/*********No.36: A10214******HD_ZBMX_HZ***A10214*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10214')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zyhlbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A10214'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12812'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A10214'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A10214'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A10214'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A10214'
,zb_name='��Ժ����Ӧ����ҽ������������'
,zbzt='0'
 where zb_id='A10214'
end
go

/*********No.37: A1021401******HD_ZBMX_HZ***A1021401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A10214,A102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ����Ӧ����ҽ������������(A10214)/@��Ժ�˴�(A102)'
,hqsql_text='select ''A1021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10214'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12813'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyhlbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A1021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10214'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10214'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1021401'
,zb_name='סԺ������ҽ��������Ӧ����'
,zbzt='0'
 where zb_id='A1021401'
end
go

/*********No.38: A10215******HD_ZBMX_HZ***A10215*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10215')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zyzlbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12810'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A10215'
,zb_name='��Ժ��Ӧ�ù���ҽ���Ƽ�������Ա��'
,zbzt='0'
 where zb_id='A10215'
end
go

/*********No.39: A1021501******HD_ZBMX_HZ***A1021501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021501')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A10215,A102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ��Ӧ�ù���ҽ���Ƽ�������Ա��(A10215)/@��Ժ�˴�(A102)'
,hqsql_text='select ''A1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10215'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12811'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyzlbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10215'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10215'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1021501'
,zb_name='��Ժ��Ӧ����ҽ���Ƽ�����Ա����'
,zbzt='0'
 where zb_id='A1021501'
end
go

/*********No.40: A10216******HD_ZBMX_HZ***A10216*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10216')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zyyzhzlrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A10216" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12814'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A10216" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A10216" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A10216" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A10216'
,zb_name='סԺ��ҽҩ�ۺ������˴�'
,zbzt='0'
 where zb_id='A10216'
end
go

/*********No.41: A1021601******HD_ZBMX_HZ***A1021601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021601')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A10216,A102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@סԺ��ҽҩ�ۺ������˴�(A10216)/@��Ժ�˴�(A102)'
,hqsql_text='select ''A1021601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12815'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zyyzhzlbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A1021601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10216'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1021601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1021601'
,zb_name='��ҽҩ�ۺ�����ռסԺ�˴α���'
,zbzt='0'
 where zb_id='A1021601'
end
go

/*********No.42: A10217******HD_ZBMX_HZ***A10217*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10217')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zyyzhzlrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A10217" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12816'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start='select "A10217" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A10217" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A10217" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyzhzlrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A10217'
,zb_name='������ҽҩ�ۺ������˴�'
,zbzt='0'
 where zb_id='A10217'
end
go

/*********No.43: A1021701******HD_ZBMX_HZ***A1021701*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021701')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A10217,A00101'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@������ҽҩ�ۺ������˴�(A10217)/@�����˴�(A00101)'
,hqsql_text='select "A1021701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A10217" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12817'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zyyzhzlrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "A1021701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A10217" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A1021701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A10217" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1021701'
,zb_name='��ҽҩ�ۺ�����ռ�����˴α���'
,zbzt='0'
 where zb_id='A1021701'
end
go

/*********No.44: A10218******HD_ZBMX_HZ***A10218*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10218')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zyyfbjfwrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A10218" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyfbjfwrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12818'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zyyfbjfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A10218" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A10218" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyfbjfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A10218" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyyfbjfwrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A10218'
,zb_name='��ҽԤ�����������˴���'
,zbzt='0'
 where zb_id='A10218'
end
go

/*********No.45: A1021801******HD_ZBMX_HZ***A1021801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021801')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A10218,A00101'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��ҽԤ�����������˴���(A10218)/@�����˴�(A00101)'
,hqsql_text='select "A1021801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A10218" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12819'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zyyfbjfwrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "A1021801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A10218" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A1021801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A10218" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1021801'
,zb_name='��ҽԤ�����������˴�ռ�������˴α���'
,zbzt='0'
 where zb_id='A1021801'
end
go

/*********No.46: A10219******HD_ZBMX_HZ***A10219*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A10219')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zyzlxmcs'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A10219" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12820'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select "A10219" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A10219" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A10219" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A10219'
,zb_name='������ҽ���Ƽ�����Ŀ����'
,zbzt='0'
 where zb_id='A10219'
end
go

/*********No.47: A1021901******HD_ZBMX_HZ***A1021901*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021901')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A10219,A00101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@������ҽ���Ƽ�����Ŀ����(A10219)/@�����˴�(A00101)'
,hqsql_text='select ''A1021901'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A10219'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12821'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyzlxmcs) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A1021901'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A10219'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1021901'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A10219'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1021901'
,zb_name='���ﻼ���˾�Ӧ����ҽ���Ƽ�����Ŀ����'
,zbzt='0'
 where zb_id='A1021901'
end
go

/*********No.48: A1024******HD_ZBMX_HZ***A1024*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1024')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ycfbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A1024'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12764'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A1024'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A1024'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A1024'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A1024'
,zb_name='��Ժ�в����˴�'
,zbzt='0'
 where zb_id='A1024'
end
go

/*********No.49: A102401******HD_ZBMX_HZ***A102401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A102401')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ycfbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"3\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A102401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12765'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey'
,sql_start='select "A102401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A102401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A102401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A102401'
,zb_name='סԺ�����в�������'
,zbzt='0'
 where zb_id='A102401'
end
go

/*********No.50: A102402******HD_ZBMX_HZ***A102402*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A102402')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A102401,A1024'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@סԺ�����в�������(A102401)/@��Ժ�в����˴�(A1024)'
,hqsql_text='select ''A102402'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102401'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A1024'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12766'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) and cyfskey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ycfbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A102402'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102401'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A1024'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A102402'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102401'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A1024'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A102402'
,zb_name='�в���סԺ������'
,zbzt='0'
 where zb_id='A102402'
end
go

/*********No.51: A104******HD_ZBMX_HZ***A104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='sws'
,fact_table='FACT_YY_ZYBRZYL'
,gspz=''
,hqsql_text='select "A104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(sws) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='10066'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(sws) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(sws) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(sws) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A104'
,zb_name='סԺ��������'
,zbzt='0'
 where zb_id='A104'
end
go

/*********No.52: A105******HD_ZBMX_HZ***A105*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A105')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A111,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ����ʵ��ռ���ܴ���(A111)/@��Ժ�˴�(A102)'
,hqsql_text='select "A105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11511'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "A105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A105'
,zb_name='ƽ��סԺ��'
,zbzt='0'
 where zb_id='A105'
end
go

/*********No.53: A106******HD_ZBMX_HZ***A106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A102,A113'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ�˴�(A102)/@ƽ�����Ŵ�λ��(A113)'
,hqsql_text='select "A106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A113" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11655'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz, fm from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  

  group by timekey,yykey,kskey,b.count_days'
,sql_start=''
,sql_text='select "A106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A113" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A113" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A106'
,zb_name='��λ��ת����'
,zbzt='0'
 where zb_id='A106'
end
go

/*********No.54: A107******HD_ZBMX_HZ***A107*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A107')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A112,A110'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ʵ��ռ���ܴ�����(A112)/@ʵ�ʿ����ܴ�����(A110)'
,hqsql_text='select "A107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A112" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A110" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11513'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(kfcw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "A107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A112" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A110" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A112" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A110" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A107'
,zb_name='��λʹ����(%)'
,zbzt='0'
 where zb_id='A107'
end
go

/*********No.55: A108******HD_ZBMX_HZ***A108*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A108')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00102,A112'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ����(B00102)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select "A108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A112"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11514'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "A108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A112"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A112"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A108'
,zb_name='סԺ���վ�����'
,zbzt='0'
 where zb_id='A108'
end
go

/*********No.56: A109******HD_ZBMX_HZ***A109*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A109')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A112,A113'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ʵ��ռ���ܴ�����(A112)/@ƽ�����Ŵ�λ��(A113)'
,hqsql_text='select "A109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A112"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A113"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11656'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "A109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A112"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A113"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A112"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A113"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A109'
,zb_name='ƽ����λ������'
,zbzt='0'
 where zb_id='A109'
end
go

/*********No.57: A110******HD_ZBMX_HZ***A110*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A110')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='kfcw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select "A110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(kfcw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='10070'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(kfcw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(kfcw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(kfcw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A110'
,zb_name='ʵ�ʿ����ܴ�����'
,zbzt='0'
 where zb_id='A110'
end
go

/*********No.58: A111******HD_ZBMX_HZ***A111*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A111')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zyts'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='10071'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A111'
,zb_name='��Ժ����ʵ��ռ���ܴ���'
,zbzt='0'
 where zb_id='A111'
end
go

/*********No.59: A11104******HD_ZBMX_HZ***A11104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11104')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jtbcbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyts'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A11104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12843'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A11104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11104'
,zb_name='������ͥ������������'
,zbzt='0'
 where zb_id='A11104'
end
go

/*********No.60: A11105******HD_ZBMX_HZ***A11105*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11105')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11104,ZLZB_YY000101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@������ͥ������������(A11104)/@������ͥ��������(ZLZB_YY000101)'
,hqsql_text='select ''A11105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''ZLZB_YY000101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12844'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A11105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11104'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''ZLZB_YY000101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A11105'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''ZLZB_YY000101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A11105'
,zb_name='��ͥ����ƽ��������'
,zbzt='0'
 where zb_id='A11105'
end
go

/*********No.61: A1110601******HD_ZBMX_HZ***A1110601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1110601')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A111060101,A111060202'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ӱ�����סԺ������(A111060101)/@ȫԺҽ��������סԺ������(A111060202)'
,hqsql_text='select ''A1110601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A111060101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A111060202'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12809'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyts) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A1110601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A111060101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A111060202'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1110601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A111060101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A111060202'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1110601'
,zb_name='�ӱ�����סԺ�����˴���ռ��'
,zbzt='0'
 where zb_id='A1110601'
end
go

/*********No.62: A111060101******HD_ZBMX_HZ***A111060101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A111060101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyts'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A111060101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12808'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A111060101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A111060101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A111060101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (60) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A111060101'
,zb_name='�ӱ�����סԺ������'
,zbzt='0'
 where zb_id='A111060101'
end
go

/*********No.63: A1110602******HD_ZBMX_HZ***A1110602*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1110602')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A111060201,A111060202'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ�����סԺ������(A111060201)/@ȫԺҽ��������סԺ������(A111060202)'
,hqsql_text='select ''A1110602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A111060201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A111060202'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12792'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyts) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''A1110602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A111060201'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A111060202'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1110602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A111060201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A111060202'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1110602'
,zb_name='�Ǳ�����סԺ�����˴���ռ��'
,zbzt='0'
 where zb_id='A1110602'
end
go

/*********No.64: A111060201******HD_ZBMX_HZ***A111060201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A111060201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyts'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A111060201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12791'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A111060201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A111060201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A111060201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A111060201'
,zb_name='�Ǳ�����סԺ������'
,zbzt='0'
 where zb_id='A111060201'
end
go

/*********No.65: A111060202******HD_ZBMX_HZ***A111060202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A111060202')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyts'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A111060202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12790'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''A111060202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A111060202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A111060202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A111060202'
,zb_name='ȫԺҽ��������סԺ������'
,zbzt='0'
 where zb_id='A111060202'
end
go

/*********No.66: A112******HD_ZBMX_HZ***A112*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A112')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zycw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select "A112" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='10072'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A112" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A112" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A112" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A112'
,zb_name='ʵ��ռ���ܴ�����'
,zbzt='0'
 where zb_id='A112'
end
go

/*********No.68: A1120102******HD_ZBMX_HZ***A1120102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1120102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A1120101,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@ʵ�ʿ������贲����(A1120101)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1120102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A1120101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12781'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select ''A1120102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A1120101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1120102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A1120101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1120102'
,zb_name='ʵ�ʿ������贲��������'
,zbzt='0'
 where zb_id='A1120102'
end
go

/*********No.69: A11202******HD_ZBMX_HZ***A11202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11202')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"62\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zycw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select ''A11202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12731'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey'
,sql_start='select ''A11202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11202'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11202'
,zb_name='����ҽѧ��סԺʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11202'
end
go

/*********No.70: A1120201******HD_ZBMX_HZ***A1120201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1120201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11202,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ҽѧ��סԺʵ��ռ�ô���(A11202)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1120201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11202'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12732'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (62) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1120201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11202'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1120201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11202'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1120201'
,zb_name='����ҽѧ��סԺ����ռ��'
,zbzt='0'
 where zb_id='A1120201'
end
go

/*********No.71: A11203******HD_ZBMX_HZ***A11203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11203')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"46,47,48,49\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zycw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select ''A11203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12733'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey'
,sql_start='select ''A11203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11203'
,zb_name='��ҽ��סԺʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11203'
end
go

/*********No.72: A1120301******HD_ZBMX_HZ***A1120301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1120301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11203,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��ҽ��סԺʵ��ռ�ô���(A11203)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1120301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11203'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12734'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (46,47,48,49) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1120301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11203'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1120301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11203'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1120301'
,zb_name='��ҽ��סԺ����ռ��'
,zbzt='0'
 where zb_id='A1120301'
end
go

/*********No.73: A11204******HD_ZBMX_HZ***A11204*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11204')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"76\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zycw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select ''A11204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12735'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey'
,sql_start='select ''A11204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11204'
,zb_name='����סԺʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11204'
end
go

/*********No.74: A1120401******HD_ZBMX_HZ***A1120401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1120401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11204,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����סԺʵ��ռ�ô���(A11204)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1120401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11204'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12736'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (76) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1120401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11204'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1120401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11204'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1120401'
,zb_name='����סԺ����ռ��'
,zbzt='0'
 where zb_id='A1120401'
end
go

/*********No.75: A11205******HD_ZBMX_HZ***A11205*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11205')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"7\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zycw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select ''A11205'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12737'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey'
,sql_start='select ''A11205'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11205'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11205'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11205'
,zb_name='��֢ҽѧ��סԺʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11205'
end
go

/*********No.76: A1120501******HD_ZBMX_HZ***A1120501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1120501')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11205,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��֢ҽѧ��סԺʵ��ռ�ô���(A11205)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1120501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11205'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12738'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (7) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1120501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11205'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1120501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11205'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1120501'
,zb_name='��֢ҽѧ��סԺ����ռ��'
,zbzt='0'
 where zb_id='A1120501'
end
go

/*********No.77: A11206******HD_ZBMX_HZ***A11206*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11206')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"70\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zycw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select ''A11206'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12739'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey'
,sql_start='select ''A11206'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11206'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11206'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11206'
,zb_name='����סԺʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11206'
end
go

/*********No.78: A1120601******HD_ZBMX_HZ***A1120601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1120601')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11206,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����סԺʵ��ռ�ô���(A11206)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1120601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11206'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12740'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1120601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11206'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1120601'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11206'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1120601'
,zb_name='����סԺ����ռ��'
,zbzt='0'
 where zb_id='A1120601'
end
go

/*********No.79: A11208******HD_ZBMX_HZ***A11208*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11208')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"8\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zycw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select ''A11208'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12729'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey'
,sql_start='select ''A11208'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11208'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11208'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11208'
,zb_name='����ҽ�ƻ���סԺʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11208'
end
go

/*********No.80: A1120801******HD_ZBMX_HZ***A1120801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1120801')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11208,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ҽ�ƻ���סԺʵ��ռ�ô���(A11208)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1120801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11208'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12730'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (8) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1120801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11208'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1120801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11208'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1120801'
,zb_name='����ҽ�ƻ���סԺ����ռ��'
,zbzt='0'
 where zb_id='A1120801'
end
go

/*********No.81: A11209******HD_ZBMX_HZ***A11209*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11209')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A112,A001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@ʵ��ռ���ܴ�����(A112)/@�ż����˴�(A001)'
,hqsql_text='select ''A11209'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12785'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A11209'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A11209'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A11209'
,zb_name='�껯ʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11209'
end
go

/*********No.82: A11210******HD_ZBMX_HZ***A11210*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11210')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"wzrc\",\"relation\":\"2\",\"caliber\":\"0\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyts'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''A11210'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12871'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey,yskey'
,sql_start='select ''A11210'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11210'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11210'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11210'
,zb_name='��ԺΣ�ز���ռ�ô�����'
,zbzt='0'
 where zb_id='A11210'
end
go

/*********No.83: A1121001******HD_ZBMX_HZ***A1121001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1121001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11210,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��ԺΣ�ز���ռ�ô�����(A11210)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1121001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11210'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12872'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzrc > 0 group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1121001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11210'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1121001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11210'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1121001'
,zb_name='Σ�ز���ռ�ô�λ��'
,zbzt='0'
 where zb_id='A1121001'
end
go

/*********No.84: A11211******HD_ZBMX_HZ***A11211*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11211')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"70\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zycw'
,fact_table='FACT_YY_ZY_CWSYQK'
,gspz=''
,hqsql_text='select ''A11211'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12873'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey'
,sql_start='select ''A11211'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''A11211'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''A11211'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycw) fz from FACT_YY_ZY_CWSYQK a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='A11211'
,zb_name='�����סԺʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11211'
end
go

/*********No.85: A1121101******HD_ZBMX_HZ***A1121101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1121101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11211,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�����סԺʵ��ռ�ô���(A11211)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1121101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11211'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12874'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zycw) fz,0 fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1121101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11211'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1121101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11211'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1121101'
,zb_name='�����סԺ����ռ��'
,zbzt='0'
 where zb_id='A1121101'
end
go

/*********No.86: A11212******HD_ZBMX_HZ***A11212*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A11212')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yebz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"ycfbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyts'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A11212" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12876'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select "A11212" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A11212" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A11212" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A11212'
,zb_name='ĸӤͬ��ʵ��ռ�ô���'
,zbzt='0'
 where zb_id='A11212'
end
go

/*********No.87: A1121201******HD_ZBMX_HZ***A1121201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1121201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A11212,A112'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@ĸӤͬ��ʵ��ռ�ô���(A11212)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select ''A1121201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A11212'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12877'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(zyts) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and ycfbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycw) fm from FACT_YY_ZY_CWSYQK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''A1121201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A11212'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A112'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A1121201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A11212'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A112'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1121201'
,zb_name='ĸӤͬ�Ҵ���ռ��'
,zbzt='0'
 where zb_id='A1121201'
end
go

/*********No.88: A113******HD_ZBMX_HZ***A113*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A113')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text='



select "A113" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,



convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq ,



null bqkey from (  



select timekey,yykey,kskey,sum(kfcw)*1.0/b.count_days fz  



 from FACT_YY_ZY_CWSYQK a   



 left join (SELECT CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") month,COUNT(1) count_days   



 from DIM_TIME d                                                                                      



  GROUP BY  CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1")   )b   



  on (CONVERT(CHAR(8),a.timekey,120)+"1")=b.month 



  where timekey between  dateadd(month,-1,@kssj) and  dateadd(month,-1,@jssj) 



  and (a.yykey in (@yykey) or -1 in (@yykey))  group by timekey,yykey,kskey,b.count_days  )   a 



  inner join DIM_YYXX b on a.yykey=b.yykey 



  inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey 



  group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") '
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11646'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(kfcw)*1.0/b.count_days fz   



  from FACT_YY_ZY_CWSYQK a   



  left join (SELECT CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") month,COUNT(1) count_days                                                                                                   



  from DIM_TIME d                                                                                            



  GROUP BY  CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1")    



  )b   on (CONVERT(CHAR(8),a.timekey,120)+"1")=b.month  



  where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  



  group by timekey,yykey,kskey,b.count_days'
,sql_start=''
,sql_text='select "A113" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120) + "1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (



select timekey,yykey,kskey,sum(kfcw)*1.0/b.count_days fz 



from FACT_YY_ZY_CWSYQK a 



left join (SELECT CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") month,COUNT(1) count_days                                                                                                 



from DIM_TIME d                                                                                              



GROUP BY  CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") 



 )b 



on (CONVERT(CHAR(8),a.timekey,120)+"1")=b.month



where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))



group by timekey,yykey,kskey,b.count_days



)



 a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120) + "1")



'
,sql_text_first=''
,tqsql_text=' select "A113" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (



select timekey,yykey,kskey,sum(kfcw)*1.0/b.count_days fz 



from FACT_YY_ZY_CWSYQK a 



left join 



(SELECT CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1") month,COUNT(1) count_days                                                                                                  



from DIM_TIME d                                                                                       



GROUP BY  CONVERT(date,CONVERT(CHAR(8),d.timekey,120)+"1")



 )b 



on (CONVERT(CHAR(8),a.timekey,120)+"1")=b.month



where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) 



and (a.yykey in (@yykey) or -1 in (@yykey))



group by timekey,yykey,kskey,b.count_days



)



 a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")



'
,ysfs='-1'
,zb_id='A113'
,zb_name='ƽ�����Ŵ�λ��'
,zbzt='0'
 where zb_id='A113'
end
go

/*********No.89: A114******HD_ZBMX_HZ***A114*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A114')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A102,ZLZB_YY000401'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ�˴�(A102)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select ''A114'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''ZLZB_YY000401'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12885'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select ''A114'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''ZLZB_YY000401'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''A114'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''ZLZB_YY000401'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A114'
,zb_name='ƽ��ÿҽ����Ժ�˴�'
,zbzt='0'
 where zb_id='A114'
end
go

/*********No.90: A322******HD_ZBMX_HZ***A322*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A322')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='A32202,A32203'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż�������ҽ�Ʒ�����(A32202)+@סԺ����ҽ�Ʒ�����(A32203)'
,hqsql_text='select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32203" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12884'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32203" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32203" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A322'
,zb_name='����ҽ�Ʒ�����'
,zbzt='0'
 where zb_id='A322'
end
go

/*********No.91: A32201******HD_ZBMX_HZ***A32201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A32201')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='A322,A323'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����ҽ�Ʒ�����(A322)/@ҽ�Ʒ�����(A323)'
,hqsql_text='select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A322" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A323" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12520'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(txylfwrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A322" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A323" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A322" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A323" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A32201'
,zb_name='����ҽ�Ʒ�����ռ��'
,zbzt='0'
 where zb_id='A32201'
end
go

/*********No.92: A323******HD_ZBMX_HZ***A323*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A323')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='A00101,A102'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�����˴�(A00101)+@��Ժ�˴�(A102)'
,hqsql_text='select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey'
,memo='-1'
,orderno='13000'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey union all select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(-cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey'
,sql_start='-1'
,sql_text='select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A323'
,zb_name='ҽ�Ʒ�����'
,zbzt='0'
 where zb_id='A323'
end
go

/*********No.93: B001******HD_ZBMX_HZ***B001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B001')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00101,B00102'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż������(B00101)+@סԺ����(B00102)'
,hqsql_text='select ''B001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,0 fm,null czry,getdate() gxrq ,bqkey from ( select yykey,yydm,kskey,ksdm,month,fz_hq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00101'' and month between @kssj and @jssj   union all select yykey,yydm,kskey,ksdm,month,fz_hq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00102'' and month between @kssj and @jssj  )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='-1'
,memo='-1'
,orderno='11518'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select ''B001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,0 fm,null czry,getdate() gxrq ,bqkey from ( select yykey,yydm,kskey,ksdm,month,fz_tq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00101'' and month between @kssj and @jssj   union all select yykey,yydm,kskey,ksdm,month,fz_tq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00102'' and month between @kssj and @jssj  )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,ysfs='-1'
,zb_id='B001'
,zb_name='ҽԺ�ܷ���'
,zbzt='0'
 where zb_id='B001'
end
go

/*********No.94: B00101******HD_ZBMX_HZ***B00101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghfy+cffy'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey,dxmkey'
,memo=''
,orderno='10077'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey'
,sql_start='select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B00101'
,zb_name='�ż������'
,zbzt='0'
 where zb_id='B00101'
end
go

/*********No.95: B0010106******HD_ZBMX_HZ***B0010106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010106')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(ghfy cffy-ypfy) fz'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B0010106" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12769'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ghfy+cffy-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "B0010106" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0010106" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0010106" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0010106'
,zb_name='�ż��﴿ҽ�����루����ҩƷ���룩'
,zbzt='0'
 where zb_id='B0010106'
end
go

/*********No.96: B0010107******HD_ZBMX_HZ***B0010107*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010107')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"dxmkey\",\"relation\":\"0\",\"caliber\":\"5,6,7,43\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ghfy+cffy'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select ''B0010107'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12772'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey'
,sql_start='select ''B0010107'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''B0010107'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''B0010107'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='B0010107'
,zb_name='�ż���ҽ��������'
,zbzt='0'
 where zb_id='B0010107'
end
go

/*********No.97: B00102******HD_ZBMX_HZ***B00102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,dxmkey'
,memo=''
,orderno='10080'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey'
,sql_start='select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B00102'
,zb_name='סԺ����'
,zbzt='0'
 where zb_id='B00102'
end
go

/*********No.98: B0010201******HD_ZBMX_HZ***B0010201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010202,B001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��ҽ���Ƽ�����������(B0010202)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select ''B0010201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010202'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12750'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''B0010201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010202'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B0010201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010202'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B0010201'
,zb_name='��ҽ���Ƽ�����������ռҽ���������'
,zbzt='0'
 where zb_id='B0010201'
end
go

/*********No.99: B0010202******HD_ZBMX_HZ***B0010202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010203,B0010204'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż�����ҽ���Ƽ�����������(B0010203)+@סԺ��ҽ���Ƽ�����������(B0010204)'
,hqsql_text='select ''B0010202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010203'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010204'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12749'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''B0010202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010203'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010204'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B0010202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010203'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010204'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B0010202'
,zb_name='��ҽ���Ƽ�����������'
,zbzt='0'
 where zb_id='B0010202'
end
go

/*********No.100: B0010203******HD_ZBMX_HZ***B0010203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010203')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyzljsfyfy'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select ''B0010203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12747'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start='select ''B0010203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''B0010203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''B0010203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='B0010203'
,zb_name='�ż�����ҽ���Ƽ�����������'
,zbzt='0'
 where zb_id='B0010203'
end
go

/*********No.101: B0010204******HD_ZBMX_HZ***B0010204*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010204')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zyzljsfyfy'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select ''B0010204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12748'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start='select ''B0010204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''B0010204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''B0010204'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zyzljsfyfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='B0010204'
,zb_name='סԺ��ҽ���Ƽ�����������'
,zbzt='0'
 where zb_id='B0010204'
end
go

/*********No.102: B0010206******HD_ZBMX_HZ***B0010206*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010206')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(zfy-ypfy) fz'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select "B0010206" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12770'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "B0010206" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0010206" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0010206" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0010206'
,zb_name='סԺ��ҽ�����루����ҩƷ���룩'
,zbzt='0'
 where zb_id='B0010206'
end
go

/*********No.103: B0010207******HD_ZBMX_HZ***B0010207*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010207')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"dxmkey\",\"relation\":\"0\",\"caliber\":\"5,6,7,43\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select "B0010207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12773'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey'
,sql_start='select "B0010207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0010207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0010207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0010207'
,zb_name='סԺҽ��������'
,zbzt='0'
 where zb_id='B0010207'
end
go

/*********No.104: B0010208******HD_ZBMX_HZ***B0010208*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010208')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zrwfy'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select "B0010208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zrwfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12822'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zrwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "B0010208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0010208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zrwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0010208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zrwfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0010208'
,zb_name='��Ժ����ֲ�������'
,zbzt='0'
 where zb_id='B0010208'
end
go

/*********No.105: B001020801******HD_ZBMX_HZ***B001020801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B001020801')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010208,B00102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ����ֲ�������(B0010208)/@סԺ����(B00102)'
,hqsql_text='select ''B001020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010208'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12823'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zrwfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''B001020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010208'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B001020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010208'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B001020801'
,zb_name='סԺ����ֲ���������'
,zbzt='0'
 where zb_id='B001020801'
end
go

/*********No.106: B00107******HD_ZBMX_HZ***B00107*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00107')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010701,B0010702'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż���ҽ������(������ҩ��Ƭ)(B0010701)+@סԺҽ������(������ҩ��Ƭ)(B0010702)'
,hqsql_text='select "B00107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001070101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001070102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0010702" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,ybflkey'
,memo=''
,orderno='12518'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,ybflkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) and mjzkey in (1) group by timekey,yykey,kskey,ybflkey union all select timekey,yykey,kskey,ybflkey,sum(-ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) and mjzkey in (2) group by timekey,yykey,kskey,ybflkey union all select timekey,yykey,kskey,ybflkey,sum(-zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey,ybflkey'
,sql_start=''
,sql_text='select "B00107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001070101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001070102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0010702" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B00107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001070101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001070102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0010702" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00107'
,zb_name='ҽ������(������ҩ��Ƭ)'
,zbzt='0'
 where zb_id='B00107'
end
go

/*********No.107: B00110******HD_ZBMX_HZ***B00110*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00110')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010106,B0010206'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż��﴿ҽ�����루����ҩƷ���룩(B0010106)+@סԺ��ҽ�����루����ҩƷ���룩(B0010206)'
,hqsql_text='select ''B00110'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010106'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010206'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12770'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select ''B00110'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010106'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010206'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B00110'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010106'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010206'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00110'
,zb_name='�ż��﴿ҽ�����루����ҩƷ���룩'
,zbzt='0'
 where zb_id='B00110'
end
go

/*********No.108: B00111******HD_ZBMX_HZ***B00111*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00111')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010107,B0010207'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż���ҽ��������(B0010107)+@סԺҽ��������(B0010207)'
,hqsql_text='select ''B00111'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010107'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010207'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12774'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''B00111'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010107'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010207'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B00111'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010107'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010207'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00111'
,zb_name='ȫԺҽ��������'
,zbzt='0'
 where zb_id='B00111'
end
go

/*********No.109: B00112******HD_ZBMX_HZ***B00112*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00112')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00111,B001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@ȫԺҽ��������(B00111)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select ''B00112'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00111'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12775'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,6,7,43) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''B00112'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00111'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B00112'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00111'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00112'
,zb_name='ҽ��������ռ��'
,zbzt='0'
 where zb_id='B00112'
end
go

/*********No.110: B002******HD_ZBMX_HZ***B002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00201,B00202'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż���ҩƷ����(B00201)+@סԺҩƷ����(B00202)'
,hqsql_text='select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey'
,memo='-1'
,orderno='11519'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey'
,sql_start='-1'
,sql_text='select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B002'
,zb_name='ҩƷ�ܷ���'
,zbzt='0'
 where zb_id='B002'
end
go

/*********No.111: B00201******HD_ZBMX_HZ***B00201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey'
,memo=''
,orderno='10081'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey'
,sql_start='select "B00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B00201'
,zb_name='�ż���ҩƷ����'
,zbzt='0'
 where zb_id='B00201'
end
go

/*********No.112: B0020101******HD_ZBMX_HZ***B0020101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0020101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey'
,memo=''
,orderno='10082'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey'
,sql_start='select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0020101'
,zb_name='����ҩƷ����'
,zbzt='0'
 where zb_id='B0020101'
end
go

/*********No.113: B0020102******HD_ZBMX_HZ***B0020102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0020102')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey'
,memo=''
,orderno='10083'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey'
,sql_start='select "B0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0020102'
,zb_name='����ҩƷ����'
,zbzt='0'
 where zb_id='B0020102'
end
go

/*********No.114: B00202******HD_ZBMX_HZ***B00202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs='-1'
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey'
,memo=''
,orderno='10084'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey'
,sql_start='select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='B00202'
,zb_name='סԺҩƷ����'
,zbzt='0'
 where zb_id='B00202'
end
go

/*********No.115: B00205******HD_ZBMX_HZ***B00205*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00205')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0020501,B0020502'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż���ҩƷ����(������ҩ��Ƭ)(B0020501)+@סԺҩƷ����(������ҩ��Ƭ)(B0020502)'
,hqsql_text='select "B00205" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002050101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002050102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12526'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (4) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-ypfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (4) and mjzkey in (2) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-ypfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (4) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "B00205" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002050101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002050102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020502" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B00205" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002050101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002050102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00205'
,zb_name='ҩƷ����(������ҩ��Ƭ)'
,zbzt='0'
 where zb_id='B00205'
end
go

/*********No.116: B004******HD_ZBMX_HZ***B004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B004')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00401,B00402'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż���������(B00401)+@סԺ�������(B00402)'
,hqsql_text='select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00401"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='-1'
,memo='-1'
,orderno='11613'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00401"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00402"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00401"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B004'
,zb_name='�������'
,zbzt='0'
 where zb_id='B004'
end
go

/*********No.117: B0040103******HD_ZBMX_HZ***B0040103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0040103')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1,2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='lczdsjfy'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B0040103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12825'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey'
,sql_start='select "B0040103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0040103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0040103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0040103'
,zb_name='�ż����ٴ�����Լ��ɱ�֧��'
,zbzt='0'
 where zb_id='B0040103'
end
go

/*********No.118: B0040203******HD_ZBMX_HZ***B0040203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0040203')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='lczdsjfy'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select "B0040203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12824'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "B0040203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0040203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0040203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0040203'
,zb_name='סԺ�ٴ�����Լ��ɱ�֧��'
,zbzt='0'
 where zb_id='B0040203'
end
go

/*********No.119: B00404******HD_ZBMX_HZ***B00404*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00404')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0040103,B0040203'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż����ٴ�����Լ��ɱ�֧��(B0040103)+@סԺ�ٴ�����Լ��ɱ�֧��(B0040203)'
,hqsql_text='select ''B00404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0040103'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0040203'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12826'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''B00404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0040103'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0040203'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B00404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0040103'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0040203'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00404'
,zb_name='�ٴ�����Լ��ɱ�֧��'
,zbzt='0'
 where zb_id='B00404'
end
go

/*********No.120: B0040401******HD_ZBMX_HZ***B0040401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0040401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00404,B004'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ٴ�����Լ��ɱ�֧��(B00404)/@�������(B004)'
,hqsql_text='select ''B0040401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00404'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B004'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12827'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(lczdsjfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''B0040401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00404'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B004'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B0040401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00404'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B004'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B0040401'
,zb_name='�ٴ�����Լ��ɱ���'
,zbzt='0'
 where zb_id='B0040401'
end
go

/*********No.121: B005******HD_ZBMX_HZ***B005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B005')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00501,B00502'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż����������Ϸ���(B00501)+@סԺ�������Ϸ���(B00502)'
,hqsql_text='select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00501"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00502"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='-1'
,memo='-1'
,orderno='11618'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00501"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00502"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00501"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00502"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B005'
,zb_name='�������Ϸ���'
,zbzt='0'
 where zb_id='B005'
end
go

/*********No.122: B00503******HD_ZBMX_HZ***B00503*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00503')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B005,B001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�������Ϸ���(B005)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select "B00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B005"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11639'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "B00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B005"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B005"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00503'
,zb_name='�������Ϸ���ռ��(%)'
,zbzt='0'
 where zb_id='B00503'
end
go

/*********No.123: B009******HD_ZBMX_HZ***B009*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B009')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B003,B004'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@������(B003)+@�������(B004)'
,hqsql_text='select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B003"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B004"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='-1'
,memo='-1'
,orderno='11633'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum() fz from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum() fz from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B003"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B004"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B003"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B004"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B009'
,zb_name='����������'
,zbzt='0'
 where zb_id='B009'
end
go

/*********No.124: B00901******HD_ZBMX_HZ***B00901*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00901')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B009,B001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����������(B009)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select "B00901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B009"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11645'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "B00901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B009"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B00901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B009"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00901'
,zb_name='����������ռ��'
,zbzt='0'
 where zb_id='B00901'
end
go

/*********No.125: B00902******HD_ZBMX_HZ***B00902*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00902')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00301,B00401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż��������(B00301)+@�ż���������(B00401)'
,hqsql_text='select "B00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00301"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00401"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11469'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey'
,sql_start=''
,sql_text='select "B00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00301"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00401"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00301"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00401"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00902'
,zb_name='�ż������������'
,zbzt='0'
 where zb_id='B00902'
end
go

/*********No.126: B0090201******HD_ZBMX_HZ***B0090201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0090201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00902,A001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż������������(B00902)/@�ż����˴�(A001)'
,hqsql_text='select ''B0090201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00902'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,memo=''
,orderno='12799'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,sql_start=''
,sql_text='select ''B0090201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00902'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B0090201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00902'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B0090201'
,zb_name='�ż�����μ������'
,zbzt='0'
 where zb_id='B0090201'
end
go

/*********No.127: B00903******HD_ZBMX_HZ***B00903*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00903')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00302,B00402'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ������(B00302)+@סԺ�������(B00402)'
,hqsql_text='select "B00903" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00302"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11470'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey'
,sql_start=''
,sql_text='select "B00903" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00302"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00402"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B00903" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00302"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00903'
,zb_name='סԺ����������'
,zbzt='0'
 where zb_id='B00903'
end
go

/*********No.128: B0090301******HD_ZBMX_HZ***B0090301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0090301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00903,A102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@סԺ����������(B00903)/@��Ժ�˴�(A102)'
,hqsql_text='select ''B0090301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00903'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey'
,memo=''
,orderno='12800'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey'
,sql_start=''
,sql_text='select ''B0090301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00903'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B0090301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00903'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B0090301'
,zb_name='סԺ���μ��������'
,zbzt='0'
 where zb_id='B0090301'
end
go

/*********No.129: B101******HD_ZBMX_HZ***B101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00101,A001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż������(B00101)/@�ż����˴�(A001)'
,hqsql_text='select "B101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,memo=''
,orderno='11471'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,sql_start=''
,sql_text='select "B101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B101'
,zb_name='�ż�����η�'
,zbzt='0'
 where zb_id='B101'
end
go

/*********No.130: B10101******HD_ZBMX_HZ***B10101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010101,A00101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�������(B0010101)/@�����˴�(A00101)'
,hqsql_text='select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,memo=''
,orderno='12605'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,sql_start=''
,sql_text='select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B10101'
,zb_name='������η�'
,zbzt='0'
 where zb_id='B10101'
end
go

/*********No.131: B10102******HD_ZBMX_HZ***B10102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010102,A00102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�������(B0010102)/@�����˴�(A00102)'
,hqsql_text='select ''B10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,memo=''
,orderno='12606'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) and mjzkey in (2) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,sql_start=''
,sql_text='select ''B10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010102'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B10102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B10102'
,zb_name='������η�'
,zbzt='0'
 where zb_id='B10102'
end
go

/*********No.132: B102******HD_ZBMX_HZ***B102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00102,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ����(B00102)/@��Ժ�˴�(A102)'
,hqsql_text='select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey'
,memo=''
,orderno='11472'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey'
,sql_start=''
,sql_text='select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B102'
,zb_name='סԺ���η�'
,zbzt='0'
 where zb_id='B102'
end
go

/*********No.133: B103******HD_ZBMX_HZ***B103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B103')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00201,A001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż���ҩƷ����(B00201)/@�ż����˴�(A001)'
,hqsql_text='select "B103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00201"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11473'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "B103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00201"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00201"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B103'
,zb_name='�ż���ҩƷ���η�'
,zbzt='0'
 where zb_id='B103'
end
go

/*********No.134: B10301******HD_ZBMX_HZ***B10301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0020101,A00101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ҩƷ����(B0020101)/@�����˴�(A00101)'
,hqsql_text='select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0020101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey'
,memo=''
,orderno='12616'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey'
,sql_start=''
,sql_text='select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0020101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0020101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B10301'
,zb_name='����ҩƷ���η�'
,zbzt='0'
 where zb_id='B10301'
end
go

/*********No.135: B10302******HD_ZBMX_HZ***B10302*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10302')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0020102,A00102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ҩƷ����(B0020102)/@�����˴�(A00102)'
,hqsql_text='select ''B10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0020102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey'
,memo=''
,orderno='12617'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) and mjzkey in (2) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey'
,sql_start=''
,sql_text='select ''B10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0020102'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0020102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B10302'
,zb_name='����ҩƷ���η�'
,zbzt='0'
 where zb_id='B10302'
end
go

/*********No.136: B104******HD_ZBMX_HZ***B104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00202,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺҩƷ����(B00202)/@��Ժ�˴�(A102)'
,hqsql_text='select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey'
,memo=''
,orderno='11474'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey union all select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey'
,sql_start=''
,sql_text='select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B104'
,zb_name='סԺҩƷ����ҩ��'
,zbzt='0'
 where zb_id='B104'
end
go

/*********No.137: C001******HD_ZBMX_HZ***C001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ybghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "C001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(ybghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ybflkey'
,memo=''
,orderno='10176'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ybflkey,sum(ybghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey'
,sql_start='select "C001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "C001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(ybghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "C001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(ybghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='C001'
,zb_name='�ż���ҽ���˴�'
,zbzt='0'
 where zb_id='C001'
end
go

/*********No.138: C00101******HD_ZBMX_HZ***C00101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C00101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A0010503,A0010502'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż���ҽ����������(A0010503)/@�ż���ҽ������(A0010502)'
,hqsql_text='select "C00101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A0010503" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A0010502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,cfzkey,yblxkey'
,memo=''
,orderno='11533'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,cfzkey,yblxkey,patid fz,0 fm from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and cfzbz in (1) union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,ghlbkey,cfzkey,yblxkey,0 fz,patid fm from FACT_YY_MZ_PATID a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1)'
,sql_start=''
,sql_text='select "C00101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A0010503" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A0010502" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "C00101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A0010503" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A0010502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C00101'
,zb_name='�ż���ҽ��������(%)'
,zbzt='0'
 where zb_id='C00101'
end
go

/*********No.139: C00104******HD_ZBMX_HZ***C00104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C00104')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select ''C00104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12788'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C00104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C00104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C00104'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C00104'
,zb_name='�Ǳ������ż����˴���'
,zbzt='0'
 where zb_id='C00104'
end
go

/*********No.140: C0010401******HD_ZBMX_HZ***C0010401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0010401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C00104,C001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ������ż����˴���(C00104)/@�ż���ҽ���˴�(C001)'
,hqsql_text='select ''C0010401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12789'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ybghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C0010401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00104'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C0010401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C0010401'
,zb_name='�Ǳ������ż�������˴���ռ��'
,zbzt='0'
 where zb_id='C0010401'
end
go

/*********No.141: C00214******HD_ZBMX_HZ***C00214*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C00214')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzy\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select "C00214" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey'
,sql_start='select "C00214" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "C00214" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "C00214" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='C00214'
,zb_name='�Ǳ��ż��ﻼ���ܷ���'
,zbzt='0'
 where zb_id='C00214'
end
go

/*********No.142: C0021401******HD_ZBMX_HZ***C0021401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0021401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C00214,C00104'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ��ż��ﻼ���ܷ���(C00214)/@�Ǳ������ż����˴���(C00104)'
,hqsql_text='select ''C0021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00214'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12798'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzy in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C0021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00214'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00104'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C0021401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00214'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C0021401'
,zb_name='�Ǳ��ż�����η���'
,zbzt='0'
 where zb_id='C0021401'
end
go

/*********No.143: C00216******HD_ZBMX_HZ***C00216*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C00216')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zfy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C00216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12857'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C00216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C00216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C00216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C00216'
,zb_name='�Ǳ������ż���ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C00216'
end
go

/*********No.144: C0021601******HD_ZBMX_HZ***C0021601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0021601')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C0021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12856'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C0021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C0021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C0021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C0021601'
,zb_name='�Ǳ������ż����Է�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C0021601'
end
go

/*********No.145: C0021602******HD_ZBMX_HZ***C0021602*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0021602')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C0021601,C00216'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ������ż����Է�ҽҩ�����ܶ�(C0021601)/@�Ǳ������ż���ҽҩ�����ܶ�(C00216)'
,hqsql_text='select ''C0021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C0021601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12858'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C0021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C0021601'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C0021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C0021601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C0021602'
,zb_name='�Ǳ������ż���ƽ���Էѷ��ñ���'
,zbzt='0'
 where zb_id='C0021602'
end
go

/*********No.146: C0021603******HD_ZBMX_HZ***C0021603*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0021603')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ybzfy_zfje'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C0021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12859'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C0021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C0021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C0021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C0021603'
,zb_name='�Ǳ�����ҽ����Χ���ż����Ը�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C0021603'
end
go

/*********No.147: C0021604******HD_ZBMX_HZ***C0021604*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0021604')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C0021603,C00216'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ�����ҽ����Χ���ż����Ը�ҽҩ�����ܶ�(C0021603)/@�Ǳ������ż���ҽҩ�����ܶ�(C00216)'
,hqsql_text='select ''C0021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C0021603'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12860'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C0021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C0021603'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C0021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C0021603'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C0021604'
,zb_name='�Ǳ������ż���ƽ���Ը����ñ���'
,zbzt='0'
 where zb_id='C0021604'
end
go

/*********No.148: C0021605******HD_ZBMX_HZ***C0021605*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0021605')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ybzfy_zfje+zffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C0021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12861'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C0021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C0021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C0021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C0021605'
,zb_name='�Ǳ�����ҽ����Χ���ż����Ը��Է�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C0021605'
end
go

/*********No.149: C0021606******HD_ZBMX_HZ***C0021606*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0021606')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C0021605,C00216'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ�����ҽ����Χ���ż����Ը��Է�ҽҩ�����ܶ�(C0021605)/@�Ǳ������ż���ҽҩ�����ܶ�(C00216)'
,hqsql_text='select ''C0021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C0021605'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12862'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C0021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C0021605'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C0021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C0021605'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C0021606'
,zb_name='�Ǳ������ż���ƽ���Ը��Էѷ��ñ���'
,zbzt='0'
 where zb_id='C0021606'
end
go

/*********No.150: C0021702******HD_ZBMX_HZ***C0021702*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0021702')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C1021701,C10217'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ӱ�����ҽ����Χ��סԺ�Էѷ����ܶ�(C1021701)/@�ӱ�����סԺҽҩ�����ܶ�(C10217)'
,hqsql_text='select ''C0021702'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021701'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12851'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C0021702'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021701'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10217'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C0021702'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021701'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C0021702'
,zb_name='�ӱ�����סԺƽ���Էѷ��ñ���'
,zbzt='0'
 where zb_id='C0021702'
end
go

/*********No.151: C00304******HD_ZBMX_HZ***C00304*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C00304')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ypfy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C00304'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12794'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C00304'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C00304'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C00304'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C00304'
,zb_name='�Ǳ��ż���ҩƷ����'
,zbzt='0'
 where zb_id='C00304'
end
go

/*********No.152: C0030401******HD_ZBMX_HZ***C0030401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0030401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C00304,C00104'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ��ż���ҩƷ����(C00304)/@�Ǳ������ż����˴���(C00104)'
,hqsql_text='select ''C0030401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00304'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12795'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ypfy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C0030401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00304'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C00104'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C0030401'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00304'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C0030401'
,zb_name='�Ǳ��ż������ҩ��'
,zbzt='0'
 where zb_id='C0030401'
end
go

/*********No.153: C10101******HD_ZBMX_HZ***C10101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C10101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ybbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''C10101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12793'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C10101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C10101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C10101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C10101'
,zb_name='�Ǳ���Ժ�������˴�'
,zbzt='0'
 where zb_id='C10101'
end
go

/*********No.154: C10215******HD_ZBMX_HZ***C10215*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C10215')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zfy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12796'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C10215'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C10215'
,zb_name='�Ǳ�סԺ�����ܷ���'
,zbzt='0'
 where zb_id='C10215'
end
go

/*********No.155: C1021501******HD_ZBMX_HZ***C1021501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021501')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C10215,C10101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ�סԺ�����ܷ���(C10215)/@�Ǳ���Ժ�������˴�(C10101)'
,hqsql_text='select ''C1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10215'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12797'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (0) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10215'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C1021501'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10215'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C1021501'
,zb_name='�Ǳ�סԺ���η���'
,zbzt='0'
 where zb_id='C1021501'
end
go

/*********No.156: C10216******HD_ZBMX_HZ***C10216*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C10216')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zfy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C10216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12863'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C10216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C10216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C10216'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C10216'
,zb_name='�Ǳ�����סԺҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C10216'
end
go

/*********No.157: C1021601******HD_ZBMX_HZ***C1021601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021601')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C1021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12864'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C1021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C1021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C1021601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C1021601'
,zb_name='�Ǳ�����סԺ�Է�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C1021601'
end
go

/*********No.158: C1021602******HD_ZBMX_HZ***C1021602*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021602')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C1021601,C10216'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ�����סԺ�Է�ҽҩ�����ܶ�(C1021601)/@�Ǳ�����סԺҽҩ�����ܶ�(C10216)'
,hqsql_text='select ''C1021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12865'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C1021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021601'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C1021602'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C1021602'
,zb_name='�Ǳ�����סԺƽ���Էѷ��ñ���'
,zbzt='0'
 where zb_id='C1021602'
end
go

/*********No.159: C1021603******HD_ZBMX_HZ***C1021603*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021603')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ybzfy_zfje'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C1021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12866'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C1021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C1021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C1021603'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C1021603'
,zb_name='�Ǳ�����ҽ����Χ��סԺ�Ը�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C1021603'
end
go

/*********No.160: C1021604******HD_ZBMX_HZ***C1021604*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021604')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C1021603,C10216'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ�����ҽ����Χ��סԺ�Ը�ҽҩ�����ܶ�(C1021603)/@�Ǳ�����סԺҽҩ�����ܶ�(C10216)'
,hqsql_text='select ''C1021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021603'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12867'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C1021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021603'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C1021604'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021603'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C1021604'
,zb_name='�Ǳ�����סԺƽ���Ը����ñ���'
,zbzt='0'
 where zb_id='C1021604'
end
go

/*********No.161: C1021605******HD_ZBMX_HZ***C1021605*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021605')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"50\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ybzfy_zfje+zffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C1021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12868'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C1021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C1021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C1021605'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C1021605'
,zb_name='�Ǳ�����ҽ����Χ��סԺ�Ը��Է�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C1021605'
end
go

/*********No.162: C1021606******HD_ZBMX_HZ***C1021606*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021606')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C1021605,C10216'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ�����ҽ����Χ��סԺ�Ը��Է�ҽҩ�����ܶ�(C1021605)/@�Ǳ�����סԺҽҩ�����ܶ�(C10216)'
,hqsql_text='select ''C1021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021605'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12869'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (50) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C1021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021605'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10216'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C1021606'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021605'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10216'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C1021606'
,zb_name='�Ǳ�����סԺƽ���Ը��Էѷ��ñ���'
,zbzt='0'
 where zb_id='C1021606'
end
go

/*********No.163: C10217******HD_ZBMX_HZ***C10217*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C10217')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zfy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C10217'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12850'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C10217'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C10217'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C10217'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C10217'
,zb_name='�ӱ�����סԺҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C10217'
end
go

/*********No.164: C1021701******HD_ZBMX_HZ***C1021701*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021701')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C1021701'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12849'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C1021701'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C1021701'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C1021701'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C1021701'
,zb_name='�ӱ�����ҽ����Χ��סԺ�Էѷ����ܶ�'
,zbzt='0'
 where zb_id='C1021701'
end
go

/*********No.165: C1021703******HD_ZBMX_HZ***C1021703*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021703')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ybzfy_zfje'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C1021703'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12852'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C1021703'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C1021703'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C1021703'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C1021703'
,zb_name='�ӱ�����ҽ����Χ��סԺ�Ը�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C1021703'
end
go

/*********No.166: C1021704******HD_ZBMX_HZ***C1021704*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021704')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C1021703,C10217'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ӱ�����ҽ����Χ��סԺ�Ը�ҽҩ�����ܶ�(C1021703)/@�ӱ�����סԺҽҩ�����ܶ�(C10217)'
,hqsql_text='select ''C1021704'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021703'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12853'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C1021704'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021703'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10217'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C1021704'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021703'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C1021704'
,zb_name='�ӱ�����סԺƽ���Ը����ñ���'
,zbzt='0'
 where zb_id='C1021704'
end
go

/*********No.167: C1021705******HD_ZBMX_HZ***C1021705*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021705')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"60\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ybzfy_zfje+zffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C1021705'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12854'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C1021705'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C1021705'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C1021705'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C1021705'
,zb_name='�ӱ�����ҽ����Χ��סԺ�Ը��Է�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C1021705'
end
go

/*********No.168: C1021706******HD_ZBMX_HZ***C1021706*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1021706')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C1021705,C10217'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ӱ�����ҽ����Χ��סԺ�Ը��Է�ҽҩ�����ܶ�(C1021705)/@�ӱ�����סԺҽҩ�����ܶ�(C10217)'
,hqsql_text='select ''C1021706'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C1021705'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12855'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (60) and mzzykey in (2) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C1021706'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C1021705'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10217'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C1021706'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C1021705'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10217'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C1021706'
,zb_name='�ӱ�����סԺƽ���Ը��Էѷ��ñ���'
,zbzt='0'
 where zb_id='C1021706'
end
go

/*********No.169: C10303******HD_ZBMX_HZ***C10303*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C10303')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ypfy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C10303'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12801'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C10303'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C10303'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C10303'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ypfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C10303'
,zb_name='�Ǳ���Ժ����סԺҩƷ����'
,zbzt='0'
 where zb_id='C10303'
end
go

/*********No.170: C1030301******HD_ZBMX_HZ***C1030301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1030301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C10303,C10101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�Ǳ���Ժ����סԺҩƷ����(C10303)/@�Ǳ���Ժ�������˴�(C10101)'
,hqsql_text='select ''C1030301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10303'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C10101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12802'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ypfy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ybbz in (1) and yblxkey in (50) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C1030301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10303'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C10101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C1030301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10303'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C10101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C1030301'
,zb_name='�Ǳ�סԺ����ҩ��'
,zbzt='0'
 where zb_id='C1030301'
end
go

/*********No.171: C601******HD_ZBMX_HZ***C601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C601')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zfy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12805'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C601'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C601'
,zb_name='�ӱ������ż���ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C601'
end
go

/*********No.172: C60101******HD_ZBMX_HZ***C60101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C60101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C60101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12806'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C60101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C60101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C60101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C60101'
,zb_name='�ӱ�����ҽ����Χ���ż���ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C60101'
end
go

/*********No.173: C60102******HD_ZBMX_HZ***C60102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C60102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C60101,C601'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ӱ�����ҽ����Χ���ż���ҽҩ�����ܶ�(C60101)/@�ӱ������ż���ҽҩ�����ܶ�(C601)'
,hqsql_text='select ''C60102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C60101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12807'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C60102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C60101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C601'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C60102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C60101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C60102'
,zb_name='�ӱ������ż���ƽ���Էѷ��ñ���'
,zbzt='0'
 where zb_id='C60102'
end
go

/*********No.174: C60103******HD_ZBMX_HZ***C60103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C60103')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ybzfy_zfje'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C60103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12838'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C60103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C60103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C60103'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C60103'
,zb_name='�ӱ�����ҽ����Χ���ż����Ը�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C60103'
end
go

/*********No.175: C60104******HD_ZBMX_HZ***C60104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C60104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C60103,C601'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ӱ�����ҽ����Χ���ż����Ը�ҽҩ�����ܶ�(C60103)/@�ӱ������ż���ҽҩ�����ܶ�(C601)'
,hqsql_text='select ''C60104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C60103'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12839'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C60104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C60103'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C601'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C60104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C60103'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C60104'
,zb_name='�ӱ������ż���ƽ���Ը����ñ���'
,zbzt='0'
 where zb_id='C60104'
end
go

/*********No.176: C60105******HD_ZBMX_HZ***C60105*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C60105')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yblxkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ybzfy_zfje+zffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select ''C60105'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12840'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''C60105'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''C60105'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''C60105'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='C60105'
,zb_name='�ӱ�����ҽ����Χ���ż����Ը��Է�ҽҩ�����ܶ�'
,zbzt='0'
 where zb_id='C60105'
end
go

/*********No.177: C60106******HD_ZBMX_HZ***C60106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C60106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C60105,C601'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ӱ�����ҽ����Χ���ż����Ը��Է�ҽҩ�����ܶ�(C60105)/@�ӱ������ż���ҽҩ�����ܶ�(C601)'
,hqsql_text='select ''C60106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C60105'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12841'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ybzfy_zfje+zffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yblxkey in (13) and mzzykey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''C60106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C60105'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''C601'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''C60106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C60105'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''C601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C60106'
,zb_name='�ӱ������ż���ƽ���Ը��Էѷ��ñ���'
,zbzt='0'
 where zb_id='C60106'
end
go

/*********No.178: D0001******HD_ZBMX_HZ***D0001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='D001,D002'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż��������˴�(D001)+@סԺ��������(D002)'
,hqsql_text='select ''D0001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12787'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''D0001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D001'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''D0001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='D0001'
,zb_name='����������'
,zbzt='0'
 where zb_id='D0001'
end
go

/*********No.179: D001******HD_ZBMX_HZ***D001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='mzssrc'
,fact_table='FACT_YY_SS_MZSSYWLFX'
,gspz=''
,hqsql_text='select "D001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ybflkey'
,memo=''
,orderno='10205'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ybflkey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey'
,sql_start='select "D001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,sum(mzssrc) fz from FACT_YY_SS_MZSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D001'
,zb_name='�ż��������˴�'
,zbzt='0'
 where zb_id='D001'
end
go

/*********No.180: D002******HD_ZBMX_HZ***D002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ssrc'
,fact_table='FACT_YY_SS_ZYSSYWLFX'
,gspz=''
,hqsql_text='select "D002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey'
,memo=''
,orderno='10206'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey'
,sql_start='select "D002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D002'
,zb_name='��Ժ��������̨��������Ժ����������'
,zbzt='0'
 where zb_id='D002'
end
go

/*********No.181: D00201******HD_ZBMX_HZ***D00201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D00201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D00201'
,zb_name='������������'
,zbzt='0'
 where zb_id='D00201'
end
go

/*********No.182: D0020101******HD_ZBMX_HZ***D0020101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0020101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"swbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ssrc'
,fact_table='FACT_YY_SS_ZYSSYWLFX'
,gspz=''
,hqsql_text='select ''D0020101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12724'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey'
,sql_start='select ''D0020101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''D0020101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''D0020101'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='D0020101'
,zb_name='סԺ����������������'
,zbzt='0'
 where zb_id='D0020101'
end
go

/*********No.183: D0020102******HD_ZBMX_HZ***D0020102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0020102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='D0020101,D00201'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@סԺ����������������(D0020101)/@סԺ������������(D00201)'
,hqsql_text='select ''D0020102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D0020101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D00201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12725'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) and zqssbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ssrc) fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''D0020102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D0020101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D00201'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''D0020102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D0020101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D00201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='D0020102'
,zb_name='סԺ��������������'
,zbzt='0'
 where zb_id='D0020102'
end
go

/*********No.184: D0020103******HD_ZBMX_HZ***D0020103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0020103')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='D00201,D002'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@סԺ������������(D00201)/@סԺ��������(D002)'
,hqsql_text='select ''D0020103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D00201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12887'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ssrc) fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''D0020103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D00201'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''D0020103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D00201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='D0020103'
,zb_name='���������ٷ���'
,zbzt='0'
 where zb_id='D0020103'
end
go

/*********No.185: D00201******HD_ZBMX_HZ***D00201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D00201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D00201'
,zb_name='������������'
,zbzt='0'
 where zb_id='D00201'
end
go

/*********No.186: D00202******HD_ZBMX_HZ***D00202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D00202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ssrc'
,fact_table='FACT_YY_SS_RJSSYWLFX'
,gspz=''
,hqsql_text='select "D00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_RJSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey'
,memo=''
,orderno='10207'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_RJSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey'
,sql_start='select "D00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_RJSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey,sum(ssrc) fz from FACT_YY_SS_RJSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D00202'
,zb_name='�ռ���������'
,zbzt='0'
 where zb_id='D00202'
end
go

/*********No.187: D0020201******HD_ZBMX_HZ***D0020201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0020201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='D00202,D002'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ռ���������(D00202)/@סԺ��������(D002)'
,hqsql_text='select "D0020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D00202"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D002"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11549'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "D0020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D00202"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D002"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "D0020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D00202"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D002"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='D0020201'
,zb_name='�ռ������ٷ���(%)'
,zbzt='0'
 where zb_id='D0020201'
end
go

/*********No.188: D00204******HD_ZBMX_HZ***D00204*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D00204')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='D00209,D002'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���ļ���������(D00209)/@סԺ��������(D002)'
,hqsql_text='select "D00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D00209"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D002"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11551'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "D00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D00209"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D002"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "D00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D00209"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D002"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='D00204'
,zb_name='���ļ�����ռ��(%)'
,zbzt='0'
 where zb_id='D00204'
end
go

/*********No.189: D00209******HD_ZBMX_HZ***D00209*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D00209')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='sjssrc+sijssrc'
,fact_table='FACT_YY_SS_ZYSSYWLFX'
,gspz=''
,hqsql_text='select "D00209" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey,sum(sjssrc+sijssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey'
,memo=''
,orderno='10213'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey,sum(sjssrc+sijssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey'
,sql_start='select "D00209" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D00209" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey,sum(sjssrc+sijssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D00209" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey,sum(sjssrc+sijssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey,ssflkey,ssdmkey,mzfskey,qkdjkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D00209'
,zb_name='���ļ���������'
,zbzt='0'
 where zb_id='D00209'
end
go

/*********No.190: D0021001******HD_ZBMX_HZ***D0021001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0021001')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"cfssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ssrc'
,fact_table='FACT_YY_SS_ZYSSYWLFX'
,gspz=''
,hqsql_text='select "D0021001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zdyskey'
,memo=''
,orderno='12828'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey'
,sql_start='select "D0021001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D0021001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D0021001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D0021001'
,zb_name='���������ط��������ٴ���������'
,zbzt='0'
 where zb_id='D0021001'
end
go

/*********No.191: D0021002******HD_ZBMX_HZ***D0021002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0021002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='D0021001,D002'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@���������ط��������ٴ���������(D0021001)/@סԺ��������(D002)'
,hqsql_text='select ''D0021002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D0021001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,zdyskey'
,memo=''
,orderno='12829'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,zdyskey,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfssbz in (1) group by timekey,yykey,kskey,zdyskey union all select timekey,yykey,kskey,zdyskey,0 fz,sum(ssrc) fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zdyskey'
,sql_start=''
,sql_text='select ''D0021002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D0021001'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''D0021002'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D0021001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='D0021002'
,zb_name='���������ط��������ٴ������ܷ�����'
,zbzt='0'
 where zb_id='D0021002'
end
go

/*********No.192: D0021003******HD_ZBMX_HZ***D0021003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0021003')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"qkdjkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ssrc'
,fact_table='FACT_YY_SS_ZYSSYWLFX'
,gspz=''
,hqsql_text='select "D0021003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zdyskey'
,memo=''
,orderno='12845'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey'
,sql_start='select "D0021003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D0021003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D0021003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D0021003'
,zb_name='�޾��������߳�Ժ�˴�'
,zbzt='0'
 where zb_id='D0021003'
end
go

/*********No.193: D002100301******HD_ZBMX_HZ***D002100301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D002100301')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"qkdjkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"yhlb\",\"relation\":\"3\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ssrc'
,fact_table='FACT_YY_SS_ZYSSYWLFX'
,gspz=''
,hqsql_text='select "D002100301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zdyskey'
,memo=''
,orderno='12846'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey'
,sql_start='select "D002100301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D002100301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D002100301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zdyskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D002100301'
,zb_name='�޾��������߼׼���������'
,zbzt='0'
 where zb_id='D002100301'
end
go

/*********No.194: D002100302******HD_ZBMX_HZ***D002100302*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D002100302')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='D002100301,D0021003'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�޾��������߼׼���������(D002100301)/@�޾��������߳�Ժ�˴�(D0021003)'
,hqsql_text='select ''D002100302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D002100301'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D0021003'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,zdyskey'
,memo=''
,orderno='12847'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,zdyskey,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) and yhlb = 1 group by timekey,yykey,kskey,zdyskey union all select timekey,yykey,kskey,zdyskey,0 fz,sum(ssrc) fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qkdjkey in (1) group by timekey,yykey,kskey,zdyskey'
,sql_start=''
,sql_text='select ''D002100302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D002100301'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D0021003'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''D002100302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D002100301'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D0021003'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='D002100302'
,zb_name='�޾������׼�������'
,zbzt='0'
 where zb_id='D002100302'
end
go

/*********No.195: D0021004******HD_ZBMX_HZ***D0021004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D0021004')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"70,71,73\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ssrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "D0021004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12833'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by timekey,yykey,kskey,yskey'
,sql_start='select "D0021004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D0021004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D0021004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D0021004'
,zb_name='��������'
,zbzt='0'
 where zb_id='D0021004'
end
go

/*********No.196: D002100401******HD_ZBMX_HZ***D002100401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D002100401')
begin
update HD_ZBMX_HZ set
condition='join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like ''%�ʹ���%'''
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(ssrc) fz'
,fact_table='FACT_YY_SS_ZYSSYWLFX'
,gspz=''
,hqsql_text='select "D002100401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by a.timekey,a.yykey,a.kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='a.timekey,a.yykey,a.kskey'
,memo=''
,orderno='12834'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select a.timekey,a.yykey,a.kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by a.timekey,a.yykey,a.kskey'
,sql_start='select "D002100401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D002100401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by a.timekey,a.yykey,a.kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D002100401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select a.timekey,a.yykey,a.kskey,sum(ssrc) fz from FACT_YY_SS_ZYSSYWLFX a join DIM_SSXX b on a.ssdmkey=b.sskey where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by a.timekey,a.yykey,a.kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D002100401'
,zb_name='�����ʹ��������Ĳ�������'
,zbzt='0'
 where zb_id='D002100401'
end
go

/*********No.197: D002100402******HD_ZBMX_HZ***D002100402*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D002100402')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='D002100401,D0021004'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�����ʹ��������Ĳ�������(D002100401)/@��������(D0021004)'
,hqsql_text='select "D002100402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D002100401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="D0021004" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12835'
,proc_name=''
,sql_end=''
,sql_middle='select ,sum(ssrc) fz,0 fm from FACT_YY_SS_ZYSSYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and b.ssmc  like "%�ʹ���%" group by  union all select ,0 fz,sum(ssrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (70,71,73) group by '
,sql_start=''
,sql_text='select "D002100402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D002100401" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="D0021004" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "D002100402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D002100401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="D0021004" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='D002100402'
,zb_name='�ʹ�����'
,zbzt='0'
 where zb_id='D002100402'
end
go

/*********No.198: D007******HD_ZBMX_HZ***D007*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='D007')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ssrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "D007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='10215'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "D007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "D007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "D007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='D007'
,zb_name='��Ժ��������̨��������Ժ����������'
,zbzt='0'
 where zb_id='D007'
end
go

/*********No.199: E001002******HD_ZBMX_HZ***E001002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E001002')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='idm'
,fact_table='FACT_DIM_YP'
,gspz=''
,hqsql_text='select "E001002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey'
,memo=''
,orderno='11155'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)'
,sql_start='select "E001002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E001002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E001002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,ypkey,ypflkey,ypdlkey,ypjxkey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='0'
,zb_id='E001002'
,zb_name='����ҩ��Ʒ������'
,zbzt='0'
 where zb_id='E001002'
end
go

/*********No.200: E00100201******HD_ZBMX_HZ***E00100201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00100201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jybz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"zmlb\",\"relation\":\"3\",\"caliber\":\"3\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='idm'
,fact_table='FACT_DIM_YP'
,gspz=''
,hqsql_text='select ''E00100201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='yykey,timekey,kskey'
,memo=''
,orderno='12751'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3'
,sql_start='select ''E00100201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''E00100201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''E00100201'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='0'
,zb_id='E00100201'
,zb_name='����ҩ���г�ҩƷ����'
,zbzt='0'
 where zb_id='E00100201'
end
go

/*********No.201: E00100202******HD_ZBMX_HZ***E00100202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00100202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00100201,E001002'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ҩ���г�ҩƷ����(E00100201)/@����ҩ��Ʒ������(E001002)'
,hqsql_text='select ''E00100202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00100201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E001002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='yykey,timekey,kskey'
,memo=''
,orderno='12752'
,proc_name=''
,sql_end=''
,sql_middle='select yykey,timekey,kskey,idm fz,0 fm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1) and zmlb = 3 union all select yykey,timekey,kskey,0 fz,idm fm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)'
,sql_start=''
,sql_text='select ''E00100202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00100201'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E001002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E00100202'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00100201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E001002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00100202'
,zb_name='����ҩ���г�ҩ�䱸��'
,zbzt='0'
 where zb_id='E00100202'
end
go

/*********No.202: E0010402******HD_ZBMX_HZ***E0010402*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0010402')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zyfy_ypcyzj'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "E0010402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyfy_ypcyzj) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12657'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zyfy_ypcyzj) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "E0010402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E0010402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyfy_ypcyzj) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E0010402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyfy_ypcyzj) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E0010402'
,zb_name='סԺ��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���'
,zbzt='0'
 where zb_id='E0010402'
end
go

/*********No.203: E001040201******HD_ZBMX_HZ***E001040201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E001040201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0010402,B00102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@סԺ��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���(E0010402)/@סԺ����(B00102)'
,hqsql_text='select ''E001040201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E0010402'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12875'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyfy_ypcyzj) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''E001040201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E0010402'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E001040201'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E0010402'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E001040201'
,zb_name='סԺ��ҽҩ����ռסԺ���������'
,zbzt='0'
 where zb_id='E001040201'
end
go

/*********No.204: E0010403******HD_ZBMX_HZ***E0010403*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0010403')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00104,B002'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���(E00104)/@ҩƷ�ܷ���(B002)'
,hqsql_text='select ''E0010403'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12659'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zyfy_ypcyzj) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zyfy_ypcyzj) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(zyfy_ypcyzj) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''E0010403'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00104'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E0010403'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E0010403'
,zb_name='��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���ռҩƷ�������'
,zbzt='0'
 where zb_id='E0010403'
end
go

/*********No.205: E0010404******HD_ZBMX_HZ***E0010404*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0010404')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00102,E00104'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�в�ҩ����(E00102)/@��ҩ���루����ҩ��Ƭ���г�ҩ��Ժ����ҩ�Ƽ���(E00104)'
,hqsql_text='select ''E0010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12660'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyfy_ypcyzj) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyfy_ypcyzj) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(zyfy_ypcyzj) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''E0010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00102'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00104'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E0010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E0010404'
,zb_name='�в�ҩ����ռ��ҩ�������'
,zbzt='0'
 where zb_id='E0010404'
end
go

/*********No.206: E002******HD_ZBMX_HZ***E002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00201,E00202'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż��￹��ҩ�����(E00201)+@סԺ����ҩ�����(E00202)'
,hqsql_text='select "E002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey'
,memo=''
,orderno='11566'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey'
,sql_start=''
,sql_text='select "E002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00202" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E002'
,zb_name='����ҩ���ܷ���'
,zbzt='0'
 where zb_id='E002'
end
go

/*********No.207: E00201******HD_ZBMX_HZ***E00201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='kjfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "E00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,kssjbkey'
,memo=''
,orderno='10230'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,kssjbkey'
,sql_start='select "E00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E00201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E00201'
,zb_name='�ż��￹��ҩ�����'
,zbzt='0'
 where zb_id='E00201'
end
go

/*********No.208: E002010101******HD_ZBMX_HZ***E002010101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E002010101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0020102,B0020101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@���￹��ҩ�����(E0020102)/@����ҩƷ����(B0020101)'
,hqsql_text='select "E002010101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey'
,memo=''
,orderno='11568'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey union all select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey'
,sql_start=''
,sql_text='select "E002010101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E002010101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E002010101'
,zb_name='���￹��ҩ����ռҩ���ܽ��ٷֱ�'
,zbzt='0'
 where zb_id='E002010101'
end
go

/*********No.209: E002010102******HD_ZBMX_HZ***E002010102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E002010102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0020103,B0020102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@���￹��ҩ�����(E0020103)/@����ҩƷ����(B0020102)'
,hqsql_text='select "E002010102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey'
,memo=''
,orderno='11569'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey union all select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey'
,sql_start=''
,sql_text='select "E002010102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E002010102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E002010102'
,zb_name='���￹��ҩ����ռҩ���ܽ��ٷֱ�'
,zbzt='0'
 where zb_id='E002010102'
end
go

/*********No.210: E0020102******HD_ZBMX_HZ***E0020102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0020102')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='kjfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "E0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey'
,memo=''
,orderno='10231'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey'
,sql_start='select "E0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E0020102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E0020102'
,zb_name='���￹��ҩ�����'
,zbzt='0'
 where zb_id='E0020102'
end
go

/*********No.211: E0020103******HD_ZBMX_HZ***E0020103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0020103')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='kjfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "E0020103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey'
,memo=''
,orderno='10232'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey'
,sql_start='select "E0020103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E0020103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E0020103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ypkey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E0020103'
,zb_name='���￹��ҩ�����'
,zbzt='0'
 where zb_id='E0020103'
end
go

/*********No.212: E00202******HD_ZBMX_HZ***E00202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='kjfy'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "E00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey'
,memo=''
,orderno='10233'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey'
,sql_start='select "E00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey,sum(kjfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ypflkey,ypdlkey,kssjbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E00202'
,zb_name='סԺ����ҩ�����'
,zbzt='0'
 where zb_id='E00202'
end
go

/*********No.213: E00203******HD_ZBMX_HZ***E00203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00203')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00201,E00205'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż��￹��ҩ�����(E00201)/@�ż��￹��ҩ��ʹ���˴�(E00205)'
,hqsql_text='select "E00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00205" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='11570'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(sykjyrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start=''
,sql_text='select "E00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00205" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00205" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00203'
,zb_name='�ż��￹��ҩ����η�'
,zbzt='0'
 where zb_id='E00203'
end
go

/*********No.214: E0020301******HD_ZBMX_HZ***E0020301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0020301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0020102,E0020510'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���￹��ҩ�����(E0020102)/@���￹��ҩ��ʹ���˴�(E0020510)'
,hqsql_text='select "E0020301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020510" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='11571'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(sykjyrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select "E0020301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020510" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E0020301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020510" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E0020301'
,zb_name='���￹��ҩ����η�'
,zbzt='0'
 where zb_id='E0020301'
end
go

/*********No.215: E0020302******HD_ZBMX_HZ***E0020302*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0020302')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0020103,E0020511'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���￹��ҩ�����(E0020103)/@���￹��ҩ��ʹ���˴�(E0020511)'
,hqsql_text='select "E0020302" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020511" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='11572'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(sykjyrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select "E0020302" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020511" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E0020302" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020511" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E0020302'
,zb_name='���￹��ҩ����η�'
,zbzt='0'
 where zb_id='E0020302'
end
go

/*********No.216: E00204******HD_ZBMX_HZ***E00204*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00204')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00202,E00207'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ����ҩ�����(E00202)/@��Ժ���߿���ҩ��ʹ���˴�(E00207)'
,hqsql_text='select "E00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00207" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey'
,memo=''
,orderno='11573'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,sum(kjfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey union all select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,0 fz,sum(kjysyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey'
,sql_start=''
,sql_text='select "E00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00207" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00207" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00204'
,zb_name='סԺ����ҩ����η�'
,zbzt='0'
 where zb_id='E00204'
end
go

/*********No.217: E00205******HD_ZBMX_HZ***E00205*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00205')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='sykjyrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "E00205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,memo=''
,orderno='10235'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,sql_start='select "E00205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E00205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E00205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E00205'
,zb_name='�ż��￹��ҩ��ʹ���˴�'
,zbzt='0'
 where zb_id='E00205'
end
go

/*********No.218: E0020510******HD_ZBMX_HZ***E0020510*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0020510')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='sykjyrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "E0020510" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,memo=''
,orderno='10244'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,sql_start='select "E0020510" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E0020510" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E0020510" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E0020510'
,zb_name='���￹��ҩ��ʹ���˴�'
,zbzt='0'
 where zb_id='E0020510'
end
go

/*********No.219: E0020511******HD_ZBMX_HZ***E0020511*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0020511')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='sykjyrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "E0020511" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,memo=''
,orderno='10245'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,sql_start='select "E0020511" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E0020511" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E0020511" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E0020511'
,zb_name='���￹��ҩ��ʹ���˴�'
,zbzt='0'
 where zb_id='E0020511'
end
go

/*********No.220: E00206******HD_ZBMX_HZ***E00206*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00206')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00205,A001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż��￹��ҩ��ʹ���˴�(E00205)/@�ż����˴�(A001)'
,hqsql_text='select "E00206" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00205" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,memo=''
,orderno='11582'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(sykjyrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey union all select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,sql_start=''
,sql_text='select "E00206" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00205" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00206" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00205" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00206'
,zb_name='�ż��￹��ҩ��ʹ����(%)'
,zbzt='0'
 where zb_id='E00206'
end
go

/*********No.221: E0020601******HD_ZBMX_HZ***E0020601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0020601')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0020510,A00101'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���￹��ҩ��ʹ���˴�(E0020510)/@�����˴�(A00101)'
,hqsql_text='select "E0020601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020510"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11583'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "E0020601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020510"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E0020601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020510"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E0020601'
,zb_name='���￹��ҩ��ʹ����(%)'
,zbzt='0'
 where zb_id='E0020601'
end
go

/*********No.222: E0020602******HD_ZBMX_HZ***E0020602*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0020602')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0020511,A00102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���￹��ҩ��ʹ���˴�(E0020511)/@�����˴�(A00102)'
,hqsql_text='select "E0020602" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0020511"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00102"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11584'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "E0020602" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0020511"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00102"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E0020602" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0020511"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00102"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E0020602'
,zb_name='���￹��ҩ��ʹ����(%)'
,zbzt='0'
 where zb_id='E0020602'
end
go

/*********No.223: E00207******HD_ZBMX_HZ***E00207*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00207')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='kjysyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "E00207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey'
,memo=''
,orderno='10246'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey'
,sql_start='select "E00207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "E00207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "E00207" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='E00207'
,zb_name='��Ժ���߿���ҩ��ʹ���˴�'
,zbzt='0'
 where zb_id='E00207'
end
go

/*********No.224: E002070104******HD_ZBMX_HZ***E002070104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E002070104')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yfxkjysybz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"ylqkssbrbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='kjysyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "E002070104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey'
,memo=''
,orderno='10251'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey'
,sql_start='select "E002070104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "E002070104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "E002070104" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey,sum(kjysyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,bqkey,kskey,yskey,ybflkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='E002070104'
,zb_name='һ���п�Ԥ��ʹ�ÿ���ҩ��ʹ���˴�'
,zbzt='0'
 where zb_id='E002070104'
end
go

/*********No.225: E00207010404******HD_ZBMX_HZ***E00207010404*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00207010404')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00207010403,E002070104'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@һ���п�����Ԥ��ʹ�ÿ���ҩ��ѡ��һ������ͷ�߾����˴�(E00207010403)/@һ���п�Ԥ��ʹ�ÿ���ҩ��ʹ���˴�(E002070104)'
,hqsql_text='select ''E00207010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E00207010403'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E002070104'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12583'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(kjysyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) and yedtbjsypbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(kjysyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yfxkjysybz in (1) and ylqkssbrbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''E00207010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207010403'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E002070104'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E00207010404'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E00207010403'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E002070104'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00207010404'
,zb_name='һ���п�����Ԥ�����ÿ���ҩ��ѡ��һ������ͷ�߾���ʹ����'
,zbzt='0'
 where zb_id='E00207010404'
end
go

/*********No.226: E00208******HD_ZBMX_HZ***E00208*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00208')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00207,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ���߿���ҩ��ʹ���˴�(E00207)/@��Ժ�˴�(A102)'
,hqsql_text='select ''E00208'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_hq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_hq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11588'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "E00208" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00207"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E00208'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_tq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_tq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,ysfs='-1'
,zb_id='E00208'
,zb_name='��Ժ���߿���ҩ��ʹ����(%)'
,zbzt='0'
 where zb_id='E00208'
end
go

/*********No.227: E00209******HD_ZBMX_HZ***E00209*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00209')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00230,A111'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ���߿���ҩ��DDDS(E00230)/@��Ժ����ʵ��ռ���ܴ���(A111)'
,hqsql_text='select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00230" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11589'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ddds) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zyts) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00230" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00230" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00209'
,zb_name='סԺ����ҩ��ʹ��ǿ��'
,zbzt='0'
 where zb_id='E00209'
end
go

/*********No.228: E00211******HD_ZBMX_HZ***E00211*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00211')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E002070104,E00207'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@һ���п�Ԥ��ʹ�ÿ���ҩ��ʹ���˴�(E002070104)/@��Ժ���߿���ҩ��ʹ���˴�(E00207)Ժ����'
,hqsql_text='select ''E00211'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_hq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E002070104'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_hq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11593'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "E00211" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E002070104"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00207"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E00211'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_tq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E002070104'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_tq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00207'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,ysfs='-1'
,zb_id='E00211'
,zb_name='һ���п�Ԥ��ʹ�ÿ���ҩ��ʹ���ʣ�%��'
,zbzt='0'
 where zb_id='E00211'
end
go

/*********No.229: E00230******HD_ZBMX_HZ***E00230*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00230')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ddds'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey'
,memo=''
,orderno='10261'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey'
,sql_start='select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E00230'
,zb_name='��Ժ���߿���ҩ��DDDS'
,zbzt='0'
 where zb_id='E00230'
end
go

/*********No.230: E0026******HD_ZBMX_HZ***E0026*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0026')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E002,B002'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ҩ���ܷ���(E002)/@ҩƷ�ܷ���(B002)'
,hqsql_text='select "E0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey'
,memo=''
,orderno='12313'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(kjfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(kjfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey'
,sql_start=''
,sql_text='select "E0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E002" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E0026'
,zb_name='ȫԺ����ҩ��ʹ�ý��ռ��'
,zbzt='0'
 where zb_id='E0026'
end
go

/*********No.231: E003******HD_ZBMX_HZ***E003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E003')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00301,E00302'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż������ҩƷ����(E00301)+@סԺ����ҩƷ����(E00302)'
,hqsql_text='select "E003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00301"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00302"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11601'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(jbfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,sum(jbfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start=''
,sql_text='select "E003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00301"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00302"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00301"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00302"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E003'
,zb_name='����ҩƷ����'
,zbzt='0'
 where zb_id='E003'
end
go

/*********No.232: E00303******HD_ZBMX_HZ***E00303*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00303')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E003,B002'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ҩƷ����(E003)/@ҩƷ�ܷ���(B002)'
,hqsql_text='select "E00303" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E003" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='11602'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(jbfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,sum(jbfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start=''
,sql_text='select "E00303" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E003" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00303" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E003" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00303'
,zb_name='����ҩ������ռ��'
,zbzt='0'
 where zb_id='E00303'
end
go

/*********No.233: E00306******HD_ZBMX_HZ***E00306*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00306')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='G30001,E001002'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ɹ�(���)����ҩ��Ʒ����(G30001)/@����ҩ��Ʒ������(E001002)'
,hqsql_text='select ''E00306'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''G30001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E001002'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12888'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,ypdm fz,0 fm from FACT_YP_JXCFX_YK a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ykczlbkey in (1) union all select timekey,yykey,kskey,0 fz,idm fm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jybz in (1)'
,sql_start=''
,sql_text='select ''E00306'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''G30001'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E001002'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E00306'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''G30001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E001002'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00306'
,zb_name='����ҩ���䱸��'
,zbzt='0'
 where zb_id='E00306'
end
go

/*********No.234: E101******HD_ZBMX_HZ***E101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B002,B001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҩƷ�ܷ���(B002)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select ''E101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_hq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B002'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_hq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B001'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11641'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "E101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_tq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B002'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_tq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B001'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,ysfs='-1'
,zb_id='E101'
,zb_name='ҩռ��(%)'
,zbzt='0'
 where zb_id='E101'
end
go

/*********No.235: E10106******HD_ZBMX_HZ***E10106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E10106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00205,B00107'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@ҩƷ����(������ҩ��Ƭ)(B00205)/@ҽ������(������ҩ��Ƭ)(B00107)'
,hqsql_text='select ''E10106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00205'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B00107'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12527'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ypfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey not in (3) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''E10106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00205'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00107'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E10106'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00205'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B00107'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E10106'
,zb_name='ҩռ�ȣ�������ҩ��Ƭ��'
,zbzt='0'
 where zb_id='E10106'
end
go

/*********No.236: E10302******HD_ZBMX_HZ***E10302*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E10302')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00202,B00202'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ����ҩ�����(E00202)/@סԺҩƷ����(B00202)'
,hqsql_text='select ''E10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_hq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00202'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_hq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00202'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11300'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "E10302" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00202"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E10302'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,sum(fm) fm,null czry,getdate() gxrq ,bqkey from (select yykey,yydm,kskey,ksdm,month,fz_tq as fz,0 as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E00202'' and month between @kssj and @jssj  union all select yykey,yydm,kskey,ksdm,month,0 as fz,fz_tq as fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B00202'' and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,ysfs='-1'
,zb_id='E10302'
,zb_name='סԺ����ҩ��ռ��(%)'
,zbzt='0'
 where zb_id='E10302'
end
go

/*********No.237: E201******HD_ZBMX_HZ***E201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cfs'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey'
,memo=''
,orderno='10285'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey'
,sql_start='select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E201'
,zb_name='�ż��ﴦ����'
,zbzt='0'
 where zb_id='E201'
end
go

/*********No.238: E20103******HD_ZBMX_HZ***E20103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20103')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs='-1'
,dylx=''
,fact_dlz='jbypcfs'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='10288'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start='select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E20103'
,zb_name='�ż������ҩƷ������'
,zbzt='0'
 where zb_id='E20103'
end
go

/*********No.239: E201101******HD_ZBMX_HZ***E201101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201101')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='sum(kjypcfs) fz,sum(cfs) fm'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E201101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(kjypcfs) fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1 group by timekey,yykey,kskey,yskey,ybflkey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,mjzkey'
,memo=''
,orderno='12305'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(kjypcfs) fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1 group by timekey,yykey,kskey,yskey,ybflkey,mjzkey'
,sql_start='select "E201101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E201101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(kjypcfs) fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1 group by timekey,yykey,kskey,yskey,ybflkey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E201101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(kjypcfs) fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey = 1 group by timekey,yykey,kskey,yskey,ybflkey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='-1'
,zb_id='E201101'
,zb_name='���￹��ҩ�ﴦ������'
,zbzt='0'
 where zb_id='E201101'
end
go

/*********No.240: E201170301******HD_ZBMX_HZ***E201170301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201170301')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zycfs_ypcyzj'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E201170301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycfs_ypcyzj) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12634'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zycfs_ypcyzj) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start='select "E201170301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E201170301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycfs_ypcyzj) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E201170301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zycfs_ypcyzj) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E201170301'
,zb_name='������ҩ��������Ƭ���г�ҩ��Ժ���Ƽ�����'
,zbzt='0'
 where zb_id='E201170301'
end
go

/*********No.241: E201170303******HD_ZBMX_HZ***E201170303*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201170303')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E201170301,E20137'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@������ҩ��������Ƭ���г�ҩ��Ժ���Ƽ�����(E201170301)/@���ﴦ����(E20137)'
,hqsql_text='select ''E201170303'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E201170301'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E20137'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12890'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zycfs_ypcyzj) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''E201170303'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E201170301'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E20137'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E201170303'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E201170301'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E20137'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E201170303'
,zb_name='��ҩ��������Ƭ���г�ҩ��Ժ���Ƽ�����ռ�����ܴ������ı���'
,zbzt='0'
 where zb_id='E201170303'
end
go

/*********No.242: E20118******HD_ZBMX_HZ***E20118*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20118')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1,2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='caoycfs'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E20118" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey'
,memo=''
,orderno='11699'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,mjzkey'
,sql_start='select "E20118" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E20118" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E20118" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E20118'
,zb_name='�ż����ҩ������'
,zbzt='0'
 where zb_id='E20118'
end
go

/*********No.243: E2011801******HD_ZBMX_HZ***E2011801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E2011801')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='caoycfs'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E2011801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12561'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start='select "E2011801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E2011801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E2011801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(caoycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E2011801'
,zb_name='�����ҩ������'
,zbzt='0'
 where zb_id='E2011801'
end
go

/*********No.244: E201180101******HD_ZBMX_HZ***E201180101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201180101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='xbzcycfs'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E201180101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(xbzcycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12745'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(xbzcycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start='select "E201180101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E201180101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(xbzcycfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E201180101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(xbzcycfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E201180101'
,zb_name='����С��װ��ҩ��Ƭ������'
,zbzt='0'
 where zb_id='E201180101'
end
go

/*********No.245: E201180102******HD_ZBMX_HZ***E201180102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201180102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E201180101,E20137'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����С��װ��ҩ��Ƭ������(E201180101)/@���ﴦ����(E20137)'
,hqsql_text='select "E201180102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201180101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20137" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12746'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(xbzcycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "E201180102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201180101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20137" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E201180102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201180101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20137" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E201180102'
,zb_name='С��װ��ҩ��ƬӦ����'
,zbzt='0'
 where zb_id='E201180102'
end
go

/*********No.246: E201180301******HD_ZBMX_HZ***E201180301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201180301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E2011801,A0014001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�����ҩ������(E2011801)/@������ҽ�Һ��˴�(��ҽ�����˴���)(A0014001)'
,hqsql_text='select ''E201180301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E2011801'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A0014001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12650'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(caoycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and kskey in (46,53,58) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''E201180301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E2011801'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A0014001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E201180301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E2011801'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A0014001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E201180301'
,zb_name='�˾���ҽ�����˴�������ҩ��Ƭ������'
,zbzt='0'
 where zb_id='E201180301'
end
go

/*********No.247: E2011804******HD_ZBMX_HZ***E2011804*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E2011804')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E2011801,E201170301'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�����ҩ������(E2011801)/@������ҩ��������Ƭ���г�ҩ��Ժ���Ƽ�����(E201170301)'
,hqsql_text='select ''E2011804'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E2011801'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E201170301'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12741'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(caoycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zycfs_ypcyzj) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''E2011804'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E2011801'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E201170301'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E2011804'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E2011801'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E201170301'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E2011804'
,zb_name='��ҩ��Ƭ����ռ������ҩ������������'
,zbzt='0'
 where zb_id='E2011804'
end
go

/*********No.248: E20119******HD_ZBMX_HZ***E20119*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20119')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E20118,E201'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż����ҩ������(E20118)/@�ż��ﴦ����(E201)'
,hqsql_text='select "E20119" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20118" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,mjzkey'
,memo=''
,orderno='11700'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(caoycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1,2) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey union all select timekey,yykey,kskey,yskey,ybflkey,mjzkey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey'
,sql_start=''
,sql_text='select "E20119" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20118" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E20119" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20118" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E20119'
,zb_name='�ż����ҩ����ռ��'
,zbzt='0'
 where zb_id='E20119'
end
go

/*********No.249: E20137******HD_ZBMX_HZ***E20137*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20137')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cfs'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E20137" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12557'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start='select "E20137" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E20137" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E20137" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E20137'
,zb_name='���ﴦ����'
,zbzt='0'
 where zb_id='E20137'
end
go

/*********No.250: E201407******HD_ZBMX_HZ***E201407*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201407')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='hgcfs'
,fact_table='FACT_SF_MZ_CFJC'
,gspz=''
,hqsql_text='select ''E201407'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,yskey,sum(hgcfs) fz from FACT_SF_MZ_CFJC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='yykey,timekey,kskey,yskey'
,memo=''
,orderno='12743'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select yykey,timekey,kskey,yskey,sum(hgcfs) fz from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey'
,sql_start='select ''E201407'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''E201407'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,yskey,sum(hgcfs) fz from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''E201407'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,yskey,sum(hgcfs) fz from FACT_SF_MZ_CFJC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='E201407'
,zb_name='�ϸ񴦷���'
,zbzt='0'
 where zb_id='E201407'
end
go

/*********No.251: E20140701******HD_ZBMX_HZ***E20140701*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20140701')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E201407,E201'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ϸ񴦷���(E201407)/@�ż��ﴦ����(E201)'
,hqsql_text='select ''E20140701'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E201407'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='yykey,timekey,kskey,yskey'
,memo=''
,orderno='12744'
,proc_name=''
,sql_end=''
,sql_middle='select yykey,timekey,kskey,yskey,sum(hgcfs) fz,0 fm from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey union all select yykey,timekey,kskey,yskey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey,yskey'
,sql_start=''
,sql_text='select ''E20140701'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E201407'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E201'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E20140701'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E201407'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E20140701'
,zb_name='�����ϸ���'
,zbzt='0'
 where zb_id='E20140701'
end
go

/*********No.252: E20203******HD_ZBMX_HZ***E20203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20203')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E20103,E201'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż������ҩƷ������(E20103)/@�ż��ﴦ����(E201)'
,hqsql_text='select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,mjzkey'
,memo=''
,orderno='11303'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(jbypcfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey union all select timekey,yykey,kskey,yskey,ybflkey,mjzkey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey'
,sql_start=''
,sql_text='select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E20203'
,zb_name='�ż������ҩƷ������(%)'
,zbzt='0'
 where zb_id='E20203'
end
go

/*********No.253: E2020801******HD_ZBMX_HZ***E2020801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E2020801')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E2010801,E20137'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@���ﾲ����Һ������(E2010801)/@���ﴦ����(E20137)'
,hqsql_text='select ''E2020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E2010801'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E20137'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='12580'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(jmbycfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start=''
,sql_text='select ''E2020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E2010801'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E20137'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E2020801'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E2010801'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E20137'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E2020801'
,zb_name='���ﾲ����Һ������'
,zbzt='0'
 where zb_id='E2020801'
end
go

/*********No.254: E20301******HD_ZBMX_HZ***E20301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E306,A001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż���ע���ҩ���˴�(E306)/@�ż����˴�(A001)'
,hqsql_text='select "E20301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E306"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11309'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "E20301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E306"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E20301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E306"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E20301'
,zb_name='�ż���ע����(%)'
,zbzt='0'
 where zb_id='E20301'
end
go

/*********No.255: E2030103******HD_ZBMX_HZ***E2030103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E2030103')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E30601,A00101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ע���ҩ���˴�(E30601)/@�����˴�(A00101)'
,hqsql_text='select ''E2030103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E30601'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='12594'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(zslywsyrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start=''
,sql_text='select ''E2030103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E30601'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E2030103'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E30601'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E2030103'
,zb_name='����ע����(%)'
,zbzt='0'
 where zb_id='E2030103'
end
go

/*********No.256: E2030104******HD_ZBMX_HZ***E2030104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E2030104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E30602,A00102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ע���ҩ���˴�(E30602)/@�����˴�(A00102)'
,hqsql_text='select ''E2030104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''E30602'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='12595'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(zslywsyrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) and mjzkey in (2) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start=''
,sql_text='select ''E2030104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''E30602'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''E2030104'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''E30602'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E2030104'
,zb_name='����ע����(%)'
,zbzt='0'
 where zb_id='E2030104'
end
go

/*********No.257: E301******HD_ZBMX_HZ***E301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00202,A111'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺҩƷ����(B00202)/@��Ժ����ʵ��ռ���ܴ���(A111)'
,hqsql_text='select "E301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11310'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "E301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E301'
,zb_name='���վ���ҩ��'
,zbzt='0'
 where zb_id='E301'
end
go

/*********No.258: E306******HD_ZBMX_HZ***E306*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E306')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zslywsyrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "E306" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(zslywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,memo=''
,orderno='10296'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(zslywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey'
,sql_start='select "E306" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E306" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(zslywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E306" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,ghlbkey,sum(zslywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,ghlbkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E306'
,zb_name='�ż���ע���ҩ���˴�'
,zbzt='0'
 where zb_id='E306'
end
go

/*********No.259: F001******HD_ZBMX_HZ***F001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zls'
,fact_table='FACT_YY_ZYBRZYL'
,gspz=''
,hqsql_text='select "F001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zls) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='10301'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(zls) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start='select "F001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "F001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zls) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "F001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zls) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='F001'
,zb_name='�������˴�'
,zbzt='0'
 where zb_id='F001'
end
go

/*********No.260: F002******HD_ZBMX_HZ***F002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zys+hzs'
,fact_table='FACT_YY_ZYBRZYL'
,gspz=''
,hqsql_text='select "F002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zys+hzs) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='10302'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(zys+hzs) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start='select "F002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "F002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zys+hzs) fz from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "F002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ybflkey,sum(zys+hzs) fz from FACT_YY_ZYBRZYL a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='F002'
,zb_name='������ת�˴�'
,zbzt='0'
 where zb_id='F002'
end
go

/*********No.261: F00203******HD_ZBMX_HZ***F00203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F00203')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F00201,F001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�����˴�(F00201)/@�������˴�(F001)'
,hqsql_text='select ''F00203'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''F00201'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''F001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey'
,memo=''
,orderno='12726'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sum(zys) fz,0 fm from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey union all select timekey,yykey,kskey,yskey,ybflkey,0 fz,sum(zls) fm from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey'
,sql_start=''
,sql_text='select ''F00203'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''F00201'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''F001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''F00203'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''F00201'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''F001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F00203'
,zb_name='��Ժ����������'
,zbzt='0'
 where zb_id='F00203'
end
go

/*********No.262: F003******HD_ZBMX_HZ***F003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F003')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F002,F001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@������ת�˴�(F002)/@�������˴�(F001)'
,hqsql_text='select "F003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F002"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F001"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11322'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "F003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F002"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F001"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F003" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F002"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F001"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F003'
,zb_name='������ת��(%)'
,zbzt='0'
 where zb_id='F003'
end
go

/*********No.263: F004******HD_ZBMX_HZ***F004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F004')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"5\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "F004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='1'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey'
,sql_start='select "F004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "F004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "F004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='F004'
,zb_name='���������Զ���Ժ�˴�'
,zbzt='0'
 where zb_id='F004'
end
go

/*********No.264: F005******HD_ZBMX_HZ***F005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F005')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F004,F001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���������Զ���Ժ�˴�(F004)/@�������˴�(F001)'
,hqsql_text='select "F005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F004" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12892'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (5) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zls) fm from FACT_YY_ZYBRZYL a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "F005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F004" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F004" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F005'
,zb_name='���������Զ���Ժ��(%)'
,zbzt='0'
 where zb_id='F005'
end
go

/*********No.265: F006******HD_ZBMX_HZ***F006*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F006')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A104,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ��������(A104)/@��Ժ�˴�(A102)'
,hqsql_text='select "F006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A104"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11323'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "F006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A104"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A104"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F006'
,zb_name='סԺ��������(%)'
,zbzt='0'
 where zb_id='F006'
end
go

/*********No.266: F009******HD_ZBMX_HZ***F009*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F009')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F311,F312'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���ȳɹ��˴�(F311)/@�����˴�(F312)'
,hqsql_text='select "F009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F311"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F312"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11325'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "F009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F311"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F312"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F311"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F312"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F009'
,zb_name='���ȳɹ���(%)'
,zbzt='0'
 where zb_id='F009'
end
go

/*********No.267: F010******HD_ZBMX_HZ***F010*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F010')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F310,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ���Ժ��Ϸ����˴�(F310)/@��Ժ�˴�(A102)'
,hqsql_text='select "F010" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F310"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11326'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "F010" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F310"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F010" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F310"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F010'
,zb_name='��Ժ���Ժ��Ϸ�����(%)'
,zbzt='0'
 where zb_id='F010'
end
go

/*********No.268: F1003******HD_ZBMX_HZ***F1003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F1003')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"back30\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='syxh'
,fact_table='FACT_YY_ZY_BACK15_30'
,gspz=''
,hqsql_text='select ''F1003'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,cytimekey,yykey,kskey,syxh from FACT_YY_ZY_BACK15_30 a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,cytimekey,yykey,kskey'
,memo=''
,orderno='12727'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,cytimekey,yykey,kskey,syxh from FACT_YY_ZY_BACK15_30 a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1)'
,sql_start='select ''F1003'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''F1003'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,cytimekey,yykey,kskey,syxh from FACT_YY_ZY_BACK15_30 a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''F1003'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,cytimekey,yykey,kskey,syxh from FACT_YY_ZY_BACK15_30 a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='0'
,zb_id='F1003'
,zb_name='��Ժ31������סԺ�����˴�'
,zbzt='0'
 where zb_id='F1003'
end
go

/*********No.269: F100301******HD_ZBMX_HZ***F100301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F100301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F1003,A102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ31������סԺ�����˴�(F1003)/@��Ժ�˴�(A102)'
,hqsql_text='select ''F100301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''F1003'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12728'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,syxh fz,0 fm from FACT_YY_ZY_BACK15_30 a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and back30 in (1) union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select ''F100301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''F1003'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A102'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''F100301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''F1003'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A102'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F100301'
,zb_name='סԺ���߳�Ժ31�����ٴ���Ժ��'
,zbzt='0'
 where zb_id='F100301'
end
go

/*********No.270: F201******HD_ZBMX_HZ***F201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"grbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "F201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey,yskey,zlzkey'
,memo=''
,orderno='10311'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey'
,sql_start='select "F201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "F201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "F201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='F201'
,zb_name='Ժ�ڸ�Ⱦ�˴�'
,zbzt='0'
 where zb_id='F201'
end
go

/*********No.271: F202******HD_ZBMX_HZ***F202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F201,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@Ժ�ڸ�Ⱦ�˴�(F201)/@��Ժ�˴�(A102)'
,hqsql_text='select "F202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F201"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11332'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "F202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F201"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F201"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F202'
,zb_name='ҽԺ��Ⱦ������(%)'
,zbzt='0'
 where zb_id='F202'
end
go

/*********No.272: F203******HD_ZBMX_HZ***F203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F203')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"grbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='ssrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select ''F203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12879'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select ''F203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''F203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''F203'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(ssrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='F203'
,zb_name='������Ⱦ�˴�'
,zbzt='0'
 where zb_id='F203'
end
go

/*********No.273: F204******HD_ZBMX_HZ***F204*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F204')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F203,D007'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@������Ⱦ�˴�(F203)/@�����˴�(D007)'
,hqsql_text='select ''F204'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''F203'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''D007'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12893'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(ssrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and grbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ssrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select ''F204'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''F203'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''D007'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''F204'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''F203'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''D007'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F204'
,zb_name='������ظ�Ⱦ������(%)'
,zbzt='0'
 where zb_id='F204'
end
go

/*********No.274: F301******HD_ZBMX_HZ***F301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F314,F313'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ٴ�·�������뾶�˴�(F314)/@�ٴ�·�������뾶�����˴�(F313)'
,hqsql_text='select "F301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F314"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F313"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11334'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "F301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F314"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F313"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F314"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F313"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F301'
,zb_name='�ٴ�·�������뾶��(%)'
,zbzt='0'
 where zb_id='F301'
end
go

/*********No.275: F306******HD_ZBMX_HZ***F306*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F306')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F318,F314'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ٴ�·�����˱���·���˴�(F318)/@�ٴ�·�������뾶�˴�(F314)'
,hqsql_text='select "F306" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F318"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F314"   and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11339'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "F306" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F318"      and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F314"   and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F306" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F318"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F314"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F306'
,zb_name='�ٴ�·�����˱�����(%)'
,zbzt='0'
 where zb_id='F306'
end
go

/*********No.276: F310******HD_ZBMX_HZ***F310*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F310')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"rcfhbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "F310" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zytskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and rcfhbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zytskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey,yskey,zytskey'
,memo=''
,orderno='10312'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,yskey,zytskey,rybqkey,rykskey,ybflkey,cyfskey,sexkey,ryzddmkey,cyzddmkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rcfhbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zytskey,rybqkey,rykskey,ybflkey,cyfskey,sexkey,ryzddmkey,cyzddmkey'
,sql_start='select "F310" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "F310" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zytskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rcfhbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zytskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "F310" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zytskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and rcfhbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zytskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='F310'
,zb_name='��Ժ���Ժ��Ϸ����˴�'
,zbzt='0'
 where zb_id='F310'
end
go

/*********No.277: F311******HD_ZBMX_HZ***F311*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F311')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"qjcgbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "F311" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qjcgbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey,yskey,zlzkey'
,memo=''
,orderno='10313'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjcgbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey'
,sql_start='select "F311" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "F311" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjcgbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "F311" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qjcgbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='F311'
,zb_name='���ȳɹ��˴�'
,zbzt='0'
 where zb_id='F311'
end
go

/*********No.278: F312******HD_ZBMX_HZ***F312*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F312')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"qjbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "F312" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey,yskey,zlzkey'
,memo=''
,orderno='10314'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey'
,sql_start='select "F312" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "F312" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "F312" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,yskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,bqkey,kskey,yskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='F312'
,zb_name='�����˴�'
,zbzt='0'
 where zb_id='F312'
end
go

/*********No.279: F31201******HD_ZBMX_HZ***F31201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F31201')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in (''3'',''4'') and qjbz=1'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(cyrc) fz'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "F31201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12836'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey'
,sql_start='select "F31201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "F31201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "F31201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='F31201'
,zb_name='���ش���������'
,zbzt='0'
 where zb_id='F31201'
end
go

/*********No.280: F31202******HD_ZBMX_HZ***F31202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F31202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F31201,F312'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���ش���������(F31201)/@�����˴�(F312)'
,hqsql_text='select "F31202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F31201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F312" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12837'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wzjbkey in ("3","4") and qjbz=1 group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and qjbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select "F31202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F31201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F312" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F31202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F31201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F312" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F31202'
,zb_name='���ش����Ȱٷ���'
,zbzt='0'
 where zb_id='F31202'
end
go

/*********No.281: F313******HD_ZBMX_HZ***F313*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F313')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='fhljzls'
,fact_table='FACT_YY_ZY_LCLJFX'
,gspz=''
,hqsql_text='select "F313" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(fhljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,lcljkey,zlzkey'
,memo=''
,orderno='10315'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,lcljkey,zlzkey,sum(fhljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey'
,sql_start='select "F313" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "F313" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(fhljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "F313" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(fhljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='F313'
,zb_name='�ٴ�·�������뾶�����˴�'
,zbzt='0'
 where zb_id='F313'
end
go

/*********No.282: F314******HD_ZBMX_HZ***F314*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F314')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='rljzls'
,fact_table='FACT_YY_ZY_LCLJFX'
,gspz=''
,hqsql_text='select "F314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(rljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,lcljkey,zlzkey'
,memo=''
,orderno='10316'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,lcljkey,zlzkey,sum(rljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey'
,sql_start='select "F314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "F314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(rljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "F314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(rljzls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='F314'
,zb_name='�ٴ�·�������뾶�˴�'
,zbzt='0'
 where zb_id='F314'
end
go

/*********No.283: F318******HD_ZBMX_HZ***F318*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F318')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='byls'
,fact_table='FACT_YY_ZY_LCLJFX'
,gspz=''
,hqsql_text='select "F318" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(byls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,lcljkey,zlzkey'
,memo=''
,orderno='10320'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,lcljkey,zlzkey,sum(byls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey'
,sql_start='select "F318" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "F318" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(byls) fz from FACT_YY_ZY_LCLJFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "F318" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,lcljkey,zlzkey,sum(byls) fz from FACT_YY_ZY_LCLJFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,lcljkey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='F318'
,zb_name='�ٴ�·�����˱���·���˴�'
,zbzt='0'
 where zb_id='F318'
end
go

/*********No.284: G30001******HD_ZBMX_HZ***G30001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='G30001')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"gjjzcgbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='idm'
,fact_table='FACT_DIM_YP'
,gspz=''
,hqsql_text='select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='yykey,timekey,kskey'
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)'
,sql_start='select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='0'
,zb_id='G30001'
,zb_name='ҽԺ�ɹ�����ҩ��Ʒ����'
,zbzt='0'
 where zb_id='G30001'
end
go

/*********No.285: I017******HD_ZBMX_HZ***I017*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='I017')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='I01701,I01702'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@ִ����ҽ���Ʋ������Ʒ���������(I01701)/@����������ҽ���Ʋ��ֲ�����(I01702)'
,hqsql_text='select ''I017'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''I01701'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''I01702'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12754'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select ''I017'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''I01701'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''I01702'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''I017'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''I01701'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''I01702'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='I017'
,zb_name='����������ҽ���Ʋ�����ҽ���Ʒ���ִ����'
,zbzt='0'
 where zb_id='I017'
end
go

/*********No.290: J005_WS00102******HD_ZBMX_HZ***J005_WS00102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='J005_WS00102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='J005_WS00101,J005_WS001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@ҽ������ϸ�����(J005_WS00101)/@ҽ������������(J005_WS001)'
,hqsql_text='select ''J005_WS00102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''J005_WS00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''J005_WS001'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12779'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select ''J005_WS00102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''J005_WS00101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''J005_WS001'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''J005_WS00102'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''J005_WS00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''J005_WS001'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='J005_WS00102'
,zb_name='ҽ������ϸ���'
,zbzt='0'
 where zb_id='J005_WS00102'
end
go

/*********No.291: ZLZB_AQ004301******HD_ZBMX_HZ***ZLZB_AQ004301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ004301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_AQ0043,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ���ߵĵ����˴�(ZLZB_AQ0043)/@��Ժ�˴�(A102)'
,hqsql_text='select "ZLZB_AQ004301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_AQ0043" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11821'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey, fz,0 fm from  a where timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))  and  ddzcbz =1

	group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "ZLZB_AQ004301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_AQ0043" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_AQ004301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_AQ0043" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_AQ004301'
,zb_name='סԺ���ߵ���/׹�������ʣ��룩'
,zbzt='0'
 where zb_id='ZLZB_AQ004301'
end
go

/*********No.292: ZLZB_AQ00650******HD_ZBMX_HZ***ZLZB_AQ00650*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ00650')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='rc'
,fact_table='FACT_GZ_HZAQ_BFZ'
,gspz=''
,hqsql_text='select ''ZLZB_AQ00650'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,bfzkey'
,memo=''
,orderno='11262'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey'
,sql_start='select ''ZLZB_AQ00650'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''ZLZB_AQ00650'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''ZLZB_AQ00650'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='ZLZB_AQ00650'
,zb_name='������������߳�Ժ�˴Σ�����18���꣩'
,zbzt='0'
 where zb_id='ZLZB_AQ00650'
end
go

/*********No.293: ZLZB_AQ0107******HD_ZBMX_HZ***ZLZB_AQ0107*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0107')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_BFZ0018,ZLZB_AQ00650'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�����󲢷�֢�����˴�(ZLZB_BFZ0018)/@������������߳�Ժ�˴Σ�����18���꣩(ZLZB_AQ00650)'
,hqsql_text='select "ZLZB_AQ0107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_BFZ0018" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_AQ00650" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11279'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_AQ0107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_BFZ0018" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_AQ00650" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_AQ0107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_BFZ0018" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_AQ00650" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_AQ0107'
,zb_name='��������֢������'
,zbzt='0'
 where zb_id='ZLZB_AQ0107'
end
go

/*********No.294: ZLZB_AQ0110******HD_ZBMX_HZ***ZLZB_AQ0110*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0110')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='rc'
,fact_table='FACT_GZ_HZAQ_YCFX'
,gspz=''
,hqsql_text='select "ZLZB_AQ0110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey,sum(rc) fz from FACT_GZ_HZAQ_YCFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey'
,memo=''
,orderno='10499'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey,sum(rc) fz from FACT_GZ_HZAQ_YCFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey'
,sql_start='select "ZLZB_AQ0110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_AQ0110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey,sum(rc) fz from FACT_GZ_HZAQ_YCFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_AQ0110" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey,sum(rc) fz from FACT_GZ_HZAQ_YCFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ycfjkey,yclykey,ycbwkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_AQ0110'
,zb_name='סԺѹ���˴�'
,zbzt='0'
 where zb_id='ZLZB_AQ0110'
end
go

/*********No.295: ZLZB_AQ0111******HD_ZBMX_HZ***ZLZB_AQ0111*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_AQ0111')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_AQ0110,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺѹ���˴�(ZLZB_AQ0110)/@��Ժ�˴�(A102)'
,hqsql_text='select "ZLZB_AQ0111" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_AQ0110" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11450'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(rc) fz,0 fm from FACT_GZ_HZAQ_YCFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "ZLZB_AQ0111" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_AQ0110" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_AQ0111" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_AQ0110" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_AQ0111'
,zb_name='סԺ����ѹ��������'
,zbzt='0'
 where zb_id='ZLZB_AQ0111'
end
go

/*********No.296: ZLZB_BFZ0018******HD_ZBMX_HZ***ZLZB_BFZ0018*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_BFZ0018')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='rc'
,fact_table='FACT_GZ_HZAQ_BFZ'
,gspz=''
,hqsql_text='select ''ZLZB_BFZ0018'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+''1'')'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,bfzkey'
,memo=''
,orderno='11278'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_middle='select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey'
,sql_start='select ''ZLZB_BFZ0018'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select ''ZLZB_BFZ0018'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='select ''ZLZB_BFZ0018'' zbmx_id,a.yykey,isnull(b.yydm,''01'') yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'') month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='ZLZB_BFZ0018'
,zb_name='�����󲢷�֢�����˴�'
,zbzt='0'
 where zb_id='ZLZB_BFZ0018'
end
go

/*********No.298: ZLZB_BFZ001802******HD_ZBMX_HZ***ZLZB_BFZ001802*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_BFZ001802')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ssbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='rc'
,fact_table='FACT_GZ_HZAQ_BFZ'
,gspz=''
,hqsql_text='select "ZLZB_BFZ001802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) and zqssbz in (1) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,bfzkey'
,memo=''
,orderno='12225'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) and zqssbz in (1) group by timekey,yykey,kskey,bfzkey'
,sql_start='select "ZLZB_BFZ001802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_BFZ001802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) and zqssbz in (1) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_BFZ001802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,bfzkey,sum(rc) fz from FACT_GZ_HZAQ_BFZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) and zqssbz in (1) group by timekey,yykey,kskey,bfzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_BFZ001802'
,zb_name='���������󲢷�֢������'
,zbzt='0'
 where zb_id='ZLZB_BFZ001802'
end
go

/*********No.299: ZLZB_ICU000******HD_ZBMX_HZ***ZLZB_ICU000*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ICU000')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zcsj\",\"relation\":\"2\",\"caliber\":\"1900-01-01\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='syxh'
,fact_table='FACT_GZ_ZZYX_ICU'
,gspz=''
,hqsql_text='select "ZLZB_ICU000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cfkey,syxh from FACT_GZ_ZZYX_ICU a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zcsj > ''1900-01-01'') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,cfkey'
,memo=''
,orderno='11234'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cfkey,syxh from FACT_GZ_ZZYX_ICU a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcsj > ''1900-01-01'''
,sql_start='select "ZLZB_ICU000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_ICU000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cfkey,syxh from FACT_GZ_ZZYX_ICU a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcsj > ''1900-01-01'') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_ICU000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct syxh) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cfkey,syxh from FACT_GZ_ZZYX_ICU a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zcsj > ''1900-01-01'') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='0'
,zb_id='ZLZB_ICU000'
,zb_name='��֢ҽѧ��ת����������'
,zbzt='0'
 where zb_id='ZLZB_ICU000'
end
go

/*********No.300: ZLZB_ICU0002******HD_ZBMX_HZ***ZLZB_ICU0002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ICU0002')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='count(1) fz'
,fact_table=' FACT_GZ_ZZYX_ICU'
,gspz=''
,hqsql_text='select "ZLZB_ICU0002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,count(1) fz from  FACT_GZ_ZZYX_ICU a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12764'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,count(1) fz from  FACT_GZ_ZZYX_ICU a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0 group by timekey,yykey,kskey'
,sql_start='select "ZLZB_ICU0002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_ICU0002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,count(1) fz from  FACT_GZ_ZZYX_ICU a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_ICU0002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,count(1) fz from  FACT_GZ_ZZYX_ICU a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cfkey>0 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_ICU0002'
,zb_name='ת��ICU���ط�ICU�����˴�'
,zbzt='0'
 where zb_id='ZLZB_ICU0002'
end
go

/*********No.302: ZLZB_SS0086******HD_ZBMX_HZ***ZLZB_SS0086*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0086')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zdsskey\",\"relation\":\"0\",\"caliber\":\"18\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='rc'
,fact_table='FACT_GZ_HZAQ_ZDSS'
,gspz=''
,hqsql_text='select "ZLZB_SS0086" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,sskey,ssjbkey,kskey,zdsskey,sum(rc) fz from FACT_GZ_HZAQ_ZDSS a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zdsskey in (18) group by timekey,yykey,sskey,ssjbkey,kskey,zdsskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,sskey,ssjbkey,kskey,zdsskey'
,memo=''
,orderno='11012'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,sskey,ssjbkey,kskey,zdsskey,sum(rc) fz from FACT_GZ_HZAQ_ZDSS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zdsskey in (18) group by timekey,yykey,sskey,ssjbkey,kskey,zdsskey'
,sql_start='select "ZLZB_SS0086" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_SS0086" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,sskey,ssjbkey,kskey,zdsskey,sum(rc) fz from FACT_GZ_HZAQ_ZDSS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zdsskey in (18) group by timekey,yykey,sskey,ssjbkey,kskey,zdsskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_SS0086" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,sskey,ssjbkey,kskey,zdsskey,sum(rc) fz from FACT_GZ_HZAQ_ZDSS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zdsskey in (18) group by timekey,yykey,sskey,ssjbkey,kskey,zdsskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_SS0086'
,zb_name='��������������������'
,zbzt='0'
 where zb_id='ZLZB_SS0086'
end
go

/*********No.305: ZLZB_WJZ00102******HD_ZBMX_HZ***ZLZB_WJZ00102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_WJZ00102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_WJZ00101,ZLZB_WJZ001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����Σ��ֵ��ʱ���ô���(ZLZB_WJZ00101)/@����Σ��ֵ�ܴ���(ZLZB_WJZ001)'
,hqsql_text='select "ZLZB_WJZ00102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_WJZ00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_WJZ001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12778'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_WJZ00102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_WJZ00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_WJZ001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_WJZ00102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_WJZ00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_WJZ001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_WJZ00102'
,zb_name='Σ��ֵ��ʱ������'
,zbzt='0'
 where zb_id='ZLZB_WJZ00102'
end
go

/*********No.306: ZLZB_YG1001******HD_ZBMX_HZ***ZLZB_YG1001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YG1001')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zgbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YG1001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12830'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select "ZLZB_YG1001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YG1001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YG1001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YG1001'
,zb_name='�ùܻ��߳�Ժ�˴�'
,zbzt='0'
 where zb_id='ZLZB_YG1001'
end
go

/*********No.307: ZLZB_YG100101******HD_ZBMX_HZ***ZLZB_YG100101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YG100101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zgbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"zggrbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YG100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) and zggrbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12831'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) and zggrbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select "ZLZB_YG100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YG100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) and zggrbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YG100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zgbz in (1) and zggrbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YG100101'
,zb_name='��Ժ����ҽԺ�ùܸ�Ⱦ��������'
,zbzt='0'
 where zb_id='ZLZB_YG100101'
end
go

/*********No.310: ZLZB_YY000101******HD_ZBMX_HZ***ZLZB_YY000101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jtbcbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YY000101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12842'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select "ZLZB_YY000101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YY000101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jtbcbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YY000101'
,zb_name='������ͥ��������'
,zbzt='0'
 where zb_id='ZLZB_YY000101'
end
go

/*********No.313: ZLZB_YY00040104******HD_ZBMX_HZ***ZLZB_YY00040104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY00040103,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�м�����������Ա����(ZLZB_YY00040103)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12423'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040104'
,zb_name='�м�����������Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY00040104'
end
go

/*********No.315: ZLZB_YY00040106******HD_ZBMX_HZ***ZLZB_YY00040106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY00040105,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���߼�����������Ա����(ZLZB_YY00040105)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040105" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12424'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040105" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040105" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040106'
,zb_name='���߼�����������Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY00040106'
end
go

/*********No.317: ZLZB_YY00040108******HD_ZBMX_HZ***ZLZB_YY00040108*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040108')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY00040107,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�߼�����������Ա����(ZLZB_YY00040107)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040107" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12425'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040107" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040107" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040108'
,zb_name='�߼�����������Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY00040108'
end
go

/*********No.318: ZLZB_YY00040109******HD_ZBMX_HZ***ZLZB_YY00040109*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040109')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0005,ZLZB_YY0006'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����������Ա����ҽʦ��(ZLZB_YY0005)/@����������Ա����������Ա��(ZLZB_YY0006)'
,hqsql_text='select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0006" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12431'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0006" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0006" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040109'
,zb_name='ҽ����'
,zbzt='0'
 where zb_id='ZLZB_YY00040109'
end
go

/*********No.325: ZLZB_YY000406******HD_ZBMX_HZ***ZLZB_YY000406*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000406')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY000405,A112'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��Դ������֧��(ZLZB_YY000405)/@ʵ��ռ���ܴ�����(A112)'
,hqsql_text='select "ZLZB_YY000406" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000405" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A112" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13212'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY000406" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000405" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A112" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000406" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000405" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A112" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY000406'
,zb_name='�����ܺ�֧��'
,zbzt='0'
 where zb_id='ZLZB_YY000406'
end
go

/*********No.327: ZLZB_YY000408******HD_ZBMX_HZ***ZLZB_YY000408*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000408')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY000407,ZLZB_YY0001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����ע�Ụʿ����(ZLZB_YY000407)/@ʵ�ʿ��Ŵ�λ��(ZLZB_YY0001)'
,hqsql_text='select "ZLZB_YY000408" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000407" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13211'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY000408" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000407" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000408" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000407" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY000408'
,zb_name='������'
,zbzt='0'
 where zb_id='ZLZB_YY000408'
end
go

/*********No.332: ZLZB_YY000507******HD_ZBMX_HZ***ZLZB_YY000507*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000507')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY000506,ZLZB_YY0005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��ҽʦ��Ա(ZLZB_YY000506)/@����������Ա����ҽʦ��(ZLZB_YY0005)'
,hqsql_text='select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000506" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12430'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000506" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000506" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY000507'
,zb_name='��ҽʦ��Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY000507'
end
go

/*********No.336: ZLZB_YY0025******HD_ZBMX_HZ***ZLZB_YY0025*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0025')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"248,251,252,263\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='qjcs'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YY0025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (248,251,252,263) group by timekey,yykey,kskey'
,sql_start='select "ZLZB_YY0025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YY0025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YY0025'
,zb_name='�����Σ����������'
,zbzt='0'
 where zb_id='ZLZB_YY0025'
end
go

/*********No.337: ZLZB_YY002501******HD_ZBMX_HZ***ZLZB_YY002501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002501')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"94,95,96,97,98,99,100\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='qjcgcs'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YY002501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey,sum(qjcgcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (94,95,96,97,98,99,100) group by timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey'
,memo=''
,orderno='12757'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey,sum(qjcgcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (94,95,96,97,98,99,100) group by timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey'
,sql_start='select "ZLZB_YY002501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "ZLZB_YY002501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey,sum(qjcgcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (94,95,96,97,98,99,100) group by timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY002501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey,sum(qjcgcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and kskey in (94,95,96,97,98,99,100) group by timekey,yykey,rybqkey,bqkey,rykskey,kskey,yskey,qztskey,ybflkey,cyfskey,ryzddmkey,cyzddmkey,mzzddmkey,sexkey,zytskey,zlzkey,zcelbkey,wzjbkey,tjybflkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='ZLZB_YY002501'
,zb_name='����Σ�ز������ȳɹ��˴�'
,zbzt='0'
 where zb_id='ZLZB_YY002501'
end
go

/*********No.339: ZLZB_YY0026******HD_ZBMX_HZ***ZLZB_YY0026*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0026')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY002601,ZLZB_YY002602'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����������סԺ�����˴�(ZLZB_YY002601)/@����������סԺ�˴�(ZLZB_YY002602)'
,hqsql_text='select "ZLZB_YY0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY002601" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY002602" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='11283'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY002601" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY002602" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY002601" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY002602" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0026'
,zb_name='����������סԺ������'
,zbzt='0'
 where zb_id='ZLZB_YY0026'
end
go

/*********No.340: ZLZB_YY002601******HD_ZBMX_HZ***ZLZB_YY002601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002601')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yebz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"3\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YY002601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and cyfskey in (3) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zlzkey,yblxkey'
,memo=''
,orderno='11281'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and cyfskey in (3) group by timekey,yykey,kskey,zlzkey,yblxkey'
,sql_start='select "ZLZB_YY002601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YY002601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and cyfskey in (3) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY002601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) and cyfskey in (3) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YY002601'
,zb_name='����������סԺ�����˴�'
,zbzt='0'
 where zb_id='ZLZB_YY002601'
end
go

/*********No.341: ZLZB_YY002602******HD_ZBMX_HZ***ZLZB_YY002602*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002602')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yebz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YY002602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zlzkey,yblxkey'
,memo=''
,orderno='11282'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) group by timekey,yykey,kskey,zlzkey,yblxkey'
,sql_start='select "ZLZB_YY002602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YY002602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY002602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,yblxkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yebz in (1) group by timekey,yykey,kskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YY002602'
,zb_name='����������סԺ�˴�'
,zbzt='0'
 where zb_id='ZLZB_YY002602'
end
go

/*********No.342: ZLZB_YY0027******HD_ZBMX_HZ***ZLZB_YY0027*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0027')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"3\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='qjcs'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YY0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) group by timekey,yykey,kskey'
,sql_start='select "ZLZB_YY0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YY0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YY0027'
,zb_name='סԺΣ��������������'
,zbzt='0'
 where zb_id='ZLZB_YY0027'
end
go

/*********No.344: ZLZB_YY0028******HD_ZBMX_HZ***ZLZB_YY0028*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0028')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"cyfskey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"kskey\",\"relation\":\"0\",\"caliber\":\"248,251,252,263\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='qjcs'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "ZLZB_YY0028" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) and kskey in (248,251,252,263) group by timekey,yykey,kskey'
,sql_start='select "ZLZB_YY0028" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YY0028" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0028" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(qjcs) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and cyfskey in (3) and kskey in (248,251,252,263) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YY0028'
,zb_name='�����Σ��������������'
,zbzt='0'
 where zb_id='ZLZB_YY0028'
end
go

/*********No.345: ZLZB_YY002801******HD_ZBMX_HZ***ZLZB_YY002801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY002801')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"swbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='rc'
,fact_table='FACT_GZ_ZLGL_JZZY'
,gspz=''
,hqsql_text='select "ZLZB_YY002801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(rc) fz from FACT_GZ_ZLGL_JZZY a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12762'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(rc) fz from FACT_GZ_ZLGL_JZZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select "ZLZB_YY002801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_YY002801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(rc) fz from FACT_GZ_ZLGL_JZZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY002801" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(rc) fz from FACT_GZ_ZLGL_JZZY a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and swbz in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_YY002801'
,zb_name='������������'
,zbzt='0'
 where zb_id='ZLZB_YY002801'
end
go

/*********No.359: ZLZB_ZLGL_LCBL035******HD_ZBMX_HZ***ZLZB_ZLGL_LCBL035*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL035')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(1) fz'
,fact_table='FACT_GZ_ZLGL_BLZY'
,gspz=''
,hqsql_text='select "ZLZB_ZLGL_LCBL035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='11791'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey'
,sql_start='select "ZLZB_ZLGL_LCBL035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_ZLGL_LCBL035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_ZLGL_LCBL035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_ZLGL_LCBL035'
,zb_name='���п��������ʯ����Ϸ��ϱ걾��'
,zbzt='0'
 where zb_id='ZLZB_ZLGL_LCBL035'
end
go

/*********No.360: ZLZB_ZLGL_LCBL036******HD_ZBMX_HZ***ZLZB_ZLGL_LCBL036*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL036')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(1) fz'
,fact_table='FACT_GZ_ZLGL_BLZY'
,gspz=''
,hqsql_text='select "ZLZB_ZLGL_LCBL036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='11792'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey'
,sql_start='select "ZLZB_ZLGL_LCBL036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZLZB_ZLGL_LCBL036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZLZB_ZLGL_LCBL036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(1) fz from FACT_GZ_ZLGL_BLZY a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZLZB_ZLGL_LCBL036'
,zb_name='���п�����ϱ걾����'
,zbzt='0'
 where zb_id='ZLZB_ZLGL_LCBL036'
end
go

/*********No.361: ZLZB_ZLGL_LCBL037******HD_ZBMX_HZ***ZLZB_ZLGL_LCBL037*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL037')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_ZLGL_LCBL035,ZLZB_ZLGL_LCBL036'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���п��������ʯ����Ϸ��ϱ걾��(ZLZB_ZLGL_LCBL035)/@���п�����ϱ걾����(ZLZB_ZLGL_LCBL036)'
,hqsql_text='select "ZLZB_ZLGL_LCBL037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL035" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL036" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='11793'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(1) fz,0 fm from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 and szzdfhbz=1 group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(1) fm from FACT_GZ_ZLGL_BLZY a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and szkszdbz=1 group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select "ZLZB_ZLGL_LCBL037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_ZLGL_LCBL035" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_ZLGL_LCBL036" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_ZLGL_LCBL037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL035" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL036" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_ZLGL_LCBL037'
,zb_name='���п��������ʯ����Ϸ�����'
,zbzt='0'
 where zb_id='ZLZB_ZLGL_LCBL037'
end
go
