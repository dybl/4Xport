/************No.1: A32001******************HD_ZBMX_HZ***A32001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A32001')
begin
	print '����ָ��A32001,��ָ��A32001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A32001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A32001','�����˴������Ժ�˴�����','-1','select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(ghrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey union all select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey','-1','select "A32001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A32001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','A00101,A102','12398','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey','@�����˴�(A00101)/@��Ժ�˴�(A102)','select "A32001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.2: A00101******************HD_ZBMX_HZ***A00101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00101')
begin
	print '����ָ��A00101,��ָ��A00101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00101','�����˴�','select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10001','','','0','1','0','FACT_YY_MZ_JZRC','ghrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey','','select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.3: A102******************HD_ZBMX_HZ***A102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A102')
begin
	print '����ָ��A102,��ָ��A102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A102','��Ժ�˴�','select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10056','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','','timekey,yykey,kskey,ybflkey,cyfskey','','select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.4: A321******************HD_ZBMX_HZ***A321******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A321')
begin
	print '����ָ��A321,��ָ��A321�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A321') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A321','��ת�����˴�����','','','','select "A321" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A321" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A32101,A32102','0','','','0','-1','-1','','','','','@������ת�����˴���(A32101)+@סԺ��ת�����˴���(A32102)','select "A321" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.5: A32101******************HD_ZBMX_HZ***A32101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A32101')
begin
	print '����ָ��A32101,��ָ��A32101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A32101') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb A32101'

end
go

/************No.6: A32102******************HD_ZBMX_HZ***A32102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A32102')
begin
	print '����ָ��A32102,��ָ��A32102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A32102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A32102','סԺ��ת�����˴���','select "A32102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and lyfskey in (3) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A32102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and lyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A32102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and lyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12399','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"lyfskey\",\"relation\":\"0\",\"caliber\":\"3\"}]','timekey,yykey,kskey','','select "A32102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and lyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.7: BA_D0025******************HD_ZBMX_HZ***BA_D0025******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0025')
begin
	print '����ָ��BA_D0025,��ָ��BA_D0025�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0025') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0025','�ռ���������ռ����������������','-1','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey','-1','select "BA_D0025" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0023" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0024" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "BA_D0025" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0023" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0024" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','BA_D0023,BA_D0024','12899','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,cyfskey','@�ռ�����̨�������ռ�����������(BA_D0023)/@��Ժ��������������̨��������Ժ����������������(BA_D0024)','select "BA_D0025" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0023" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0024" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.8: BA_D0023******************HD_ZBMX_HZ***BA_D0023******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0023')
begin
	print '����ָ��BA_D0023,��ָ��BA_D0023�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0023') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0023','�ռ�����̨�������ռ�����������','select "BA_D0023" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0023" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0023" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12897','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"rjssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "BA_D0023" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.9: BA_D0024******************HD_ZBMX_HZ***BA_D0024******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0024')
begin
	print '����ָ��BA_D0024,��ָ��BA_D0024�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0024') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0024','��Ժ��������������','select "BA_D0024" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0024" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0024" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12898','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "BA_D0024" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.10: BA_D0028******************HD_ZBMX_HZ***BA_D0028******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0028')
begin
	print '����ָ��BA_D0028,��ָ��BA_D0028�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0028') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0028','��Ժ��������ռ��','-1','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey','-1','select "BA_D0028" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0026" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0027" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "BA_D0028" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0027" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','BA_D0026,BA_D0027','12902','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,cyfskey','@��Ժ��������(BA_D0026)/@��Ժ����(BA_D0027)','select "BA_D0028" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0027" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.11: BA_D0026******************HD_ZBMX_HZ***BA_D0026******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0026')
begin
	print '����ָ��BA_D0026,��ָ��BA_D0026�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0026') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0026','��Ժ��������','select "BA_D0026" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0026" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0026" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12900','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"ssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "BA_D0026" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.12: BA_D0027******************HD_ZBMX_HZ***BA_D0027******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0027')
begin
	print '����ָ��BA_D0027,��ָ��BA_D0027�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0027') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0027','��Ժ����','select "BA_D0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12901','','','0','1','1','FACT_BA_CYYWLFX','cyrs','','timekey,yykey,kskey,cyfskey','','select "BA_D0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.13: BA_D0030******************HD_ZBMX_HZ***BA_D0030******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0030')
begin
	print '����ָ��BA_D0030,��ָ��BA_D0030�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0030') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0030','��Ժ����΢������ռ��','-1','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey','-1','select "BA_D0030" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0029" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0026" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "BA_D0030" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0029" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','BA_D0029,BA_D0026','12904','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,cyfskey','@΢����������(BA_D0029)/@��Ժ��������(BA_D0026)','select "BA_D0030" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0029" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.14: BA_D0029******************HD_ZBMX_HZ***BA_D0029******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0029')
begin
	print '����ָ��BA_D0029,��ָ��BA_D0029�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0029') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0029','΢����������','select "BA_D0029" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0029" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0029" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12903','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"wcssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "BA_D0029" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.15: BA_D0032******************HD_ZBMX_HZ***BA_D0032******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0032')
begin
	print '����ָ��BA_D0032,��ָ��BA_D0032�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0032') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0032','��Ժ�����ļ���������','-1','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey','-1','select "BA_D0032" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0031" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0026" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "BA_D0032" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0031" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','BA_D0031,BA_D0026','12906','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,cyfskey','@��Ժ�ļ�������������(BA_D0031)/@��Ժ��������(BA_D0026)','select "BA_D0032" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0031" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.16: BA_D0031******************HD_ZBMX_HZ***BA_D0031******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0031')
begin
	print '����ָ��BA_D0031,��ָ��BA_D0031�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0031') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0031','��Ժ�ļ�������������','select "BA_D0031" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0031" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0031" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12905','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"sjssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "BA_D0031" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.17: A32201******************HD_ZBMX_HZ***A32201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A32201')
begin
	print '����ָ��A32201,��ָ��A32201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A32201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A32201','����ҽ�Ʒ�����ռ��','-1','select timekey,yykey,kskey,sum(txylfwrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','-1','select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A322" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A323" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A322" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A323" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','A322,A323','12520','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@����ҽ�Ʒ�����(A322)/@ҽ�Ʒ�����(A323)','select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A322" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A323" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.18: A322******************HD_ZBMX_HZ***A322******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A322')
begin
	print '����ָ��A322,��ָ��A322�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A322') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A322','����ҽ�Ʒ�����','-1','select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey','-1','select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32203" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32203" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','A32202,A32203','12884','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�ż�������ҽ�Ʒ�����(A32202)+@סԺ����ҽ�Ʒ�����(A32203)','select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32203" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.19: A32202******************HD_ZBMX_HZ***A32202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A32202')
begin
	print '����ָ��A32202,��ָ��A32202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A32202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A32202','�������ﻼ���˴���','select "A32202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A32202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A32202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_YY_MZ_JZRC','txylfwrc','','timekey,yykey,kskey','','select "A32202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.20: A32203******************HD_ZBMX_HZ***A32203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A32203')
begin
	print '����ָ��A32203,��ָ��A32203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A32203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A32203','��Ժ������������ҽ�Ʒ����˴���','select "A32203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A32203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A32203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"txbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "A32203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.21: A323******************HD_ZBMX_HZ***A323******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A323')
begin
	print '����ָ��A323,��ָ��A323�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A323') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A323','ҽ�Ʒ�����','-1','select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey union all select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(-cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey','-1','select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','A00101,A102','13000','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey','@�����˴�(A00101)+@��Ժ�˴�(A102)','select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.22: B10901******************HD_ZBMX_HZ***B10901******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10901')
begin
	print '����ָ��B10901,��ָ��B10901�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10901') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10901','����ҽ�Ʒ�������ռ��','-1','select timekey,yykey,kskey,sum(txylfwfy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(txylfwfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','-1','select "B10901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B109" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B10901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B109" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B109,B001','12519','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@����ҽ�Ʒ�������(B109)/@ҽԺ�ܷ���(B001)','select "B10901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B109" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.23: B109******************HD_ZBMX_HZ***B109******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B109')
begin
	print '����ָ��B109,��ָ��B109�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B109') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B109','����ҽ�Ʒ�������','-1','select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','-1','select "B109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B10902" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B10903" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B10902" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B10903" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B10902,B10903','13039','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�ż�������ҽ�Ʒ�������(B10902)+@סԺ����ҽ�Ʒ�������(B10903)','select "B109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B10902" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B10903" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.24: B10902******************HD_ZBMX_HZ***B10902******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10902')
begin
	print '����ָ��B10902,��ָ��B10902�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10902') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10902','�����ż���ҽ�Ʒ�������','select "B10902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B10902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B10902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_FY_MZ_FYFX','txylfwfy','','timekey,yykey,kskey','','select "B10902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.25: B10903******************HD_ZBMX_HZ***B10903******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10903')
begin
	print '����ָ��B10903,��ָ��B10903�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10903') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10903','סԺ������������ҽ�Ʒ�������','select "B10903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B10903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B10903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_FY_ZY_FYFX','txylfwfy','','timekey,yykey,kskey','','select "B10903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.26: B001******************HD_ZBMX_HZ***B001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B001')
begin
	print '����ָ��B001,��ָ��B001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B001','ҽԺ�ܷ���','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,0 fm,null czry,getdate() gxrq ,bqkey from ( select yykey,yydm,kskey,ksdm,month,fz_tq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00101'' and month between @kssj and @jssj   union all select yykey,yydm,kskey,ksdm,month,fz_tq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00102'' and month between @kssj and @jssj  )t group by yykey,yydm,kskey,ksdm,month ,bqkey','1','-1','B00101,B00102','11518','-1','-1','0','-1','-1','-1','-1','-1','-1','@�ż������(B00101)+@סԺ����(B00102)','select ''B001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,0 fm,null czry,getdate() gxrq ,bqkey from ( select yykey,yydm,kskey,ksdm,month,fz_hq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00101'' and month between @kssj and @jssj   union all select yykey,yydm,kskey,ksdm,month,fz_hq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00102'' and month between @kssj and @jssj  )t group by yykey,yydm,kskey,ksdm,month ,bqkey','-1','-1')
	
end
go

/************No.27: BA_D0034******************HD_ZBMX_HZ***BA_D0034******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0034')
begin
	print '����ָ��BA_D0034,��ָ��BA_D0034�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0034') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0034','�������߲���֢������','-1','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey','-1','select "BA_D0034" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0033" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0026" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "BA_D0034" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0033" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','BA_D0033,BA_D0026','12908','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,cyfskey','@�������߲���֢��������(BA_D0033)/@��Ժ��������(BA_D0026)','select "BA_D0034" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0033" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.28: BA_D0033******************HD_ZBMX_HZ***BA_D0033******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0033')
begin
	print '����ָ��BA_D0033,��ָ��BA_D0033�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0033') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0033','�������߲���֢��������','select "BA_D0033" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0033" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0033" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12907','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"ssbfzbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "BA_D0033" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.29: BA_D0037******************HD_ZBMX_HZ***BA_D0037******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0037')
begin
	print '����ָ��BA_D0037,��ָ��BA_D0037�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0037') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0037','I���п�������λ��Ⱦ��','-1','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey','-1','select "BA_D0037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0036" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0035" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "BA_D0037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0036" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0035" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','BA_D0036,BA_D0035','12911','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,cyfskey','@I���п�������λ��Ⱦ�˴���(BA_D0036)/@I���п�����̨����(BA_D0035)','select "BA_D0037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0036" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0035" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.30: BA_D0036******************HD_ZBMX_HZ***BA_D0036******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0036')
begin
	print '����ָ��BA_D0036,��ָ��BA_D0036�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0036') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0036','I���п�������λ��Ⱦ�˴���','select "BA_D0036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12910','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"ylssgrbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "BA_D0036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.31: BA_D0035******************HD_ZBMX_HZ***BA_D0035******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0035')
begin
	print '����ָ��BA_D0035,��ָ��BA_D0035�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0035') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('BA_D0035','I���п�����̨����','select "BA_D0035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "BA_D0035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12909','','','0','1','1','FACT_BA_CYYWLFX','cyrs','[{\"dim_key\":\"ylssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,cyfskey','','select "BA_D0035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.32: JXHK_DBZ004******************HD_ZBMX_HZ***JXHK_DBZ004******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ004')
begin
	print '����ָ��JXHK_DBZ004,��ָ��JXHK_DBZ004�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ004') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXHK_DBZ004','�������ܷ���','select "JXHK_DBZ004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,jxkhdbzkey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12916','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,jxkhdbzkey','','select "JXHK_DBZ004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.33: JXHK_DBZ005******************HD_ZBMX_HZ***JXHK_DBZ005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ005')
begin
	print '����ָ��JXHK_DBZ005,��ָ��JXHK_DBZ005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ005') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXHK_DBZ005','��������ǰƽ��סԺ����','','select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey union all select timekey,yykey,kskey,jxkhdbzkey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey','','select "JXHK_DBZ005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXHK_DBZ007" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXHK_DBZ001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXHK_DBZ005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXHK_DBZ007" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXHK_DBZ001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','JXHK_DBZ007,JXHK_DBZ001','12924','','','0','-1','-1','','','','timekey,yykey,kskey,jxkhdbzkey','@��������ǰ��סԺ����(JXHK_DBZ007)/@����������(JXHK_DBZ001)','select "JXHK_DBZ005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXHK_DBZ007" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXHK_DBZ001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.34: JXHK_DBZ007******************HD_ZBMX_HZ***JXHK_DBZ007******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ007')
begin
	print '����ָ��JXHK_DBZ007,��ָ��JXHK_DBZ007�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ007') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXHK_DBZ007','��������ǰ��סԺ����','select "JXHK_DBZ007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12923','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','sqddts','[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,jxkhdbzkey','','select "JXHK_DBZ007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.35: JXHK_DBZ006******************HD_ZBMX_HZ***JXHK_DBZ006******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ006')
begin
	print '����ָ��JXHK_DBZ006,��ָ��JXHK_DBZ006�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ006') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXHK_DBZ006','��������ҩ��','select "JXHK_DBZ006" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,jxkhdbzkey,sum(ypfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ006" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ypfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ006" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ypfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12918','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ypfy','[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,jxkhdbzkey','','select "JXHK_DBZ006" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ypfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.36: JXHK_DBZ001******************HD_ZBMX_HZ***JXHK_DBZ001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ001')
begin
	print '����ָ��JXHK_DBZ001,��ָ��JXHK_DBZ001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXHK_DBZ001','����������','select "JXHK_DBZ001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,jxkhdbzkey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12912','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,jxkhdbzkey','','select "JXHK_DBZ001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.37: JXHK_DBZ002******************HD_ZBMX_HZ***JXHK_DBZ002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ002')
begin
	print '����ָ��JXHK_DBZ002,��ָ��JXHK_DBZ002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXHK_DBZ002','��������������','select "JXHK_DBZ002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,jxkhdbzkey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12914','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,jxkhdbzkey','','select "JXHK_DBZ002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.38: JXHK_DBZ003******************HD_ZBMX_HZ***JXHK_DBZ003******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ003')
begin
	print '����ָ��JXHK_DBZ003,��ָ��JXHK_DBZ003�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ003') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXHK_DBZ003','��������סԺ����','select "JXHK_DBZ003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXHK_DBZ003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12915','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,jxkhdbzkey','','select "JXHK_DBZ003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.39: JXKH_DBZ100******************HD_ZBMX_HZ***JXKH_DBZ100******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ100')
begin
	print '����ָ��JXKH_DBZ100,��ָ��JXKH_DBZ100�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ100') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ100','�����ļ�������������','select "JXKH_DBZ100" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ100" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ100" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12913','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ100" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.40: JXKH_DBZ101******************HD_ZBMX_HZ***JXKH_DBZ101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ101')
begin
	print '����ָ��JXKH_DBZ101,��ָ��JXKH_DBZ101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ101','�����ļ�����ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ103" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ102,JXKH_DBZ103','12927','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�����ļ�������Ժ����ռ���ܴ�����(JXKH_DBZ102)/@�����ļ������ܳ�Ժ����(JXKH_DBZ103)','select "JXKH_DBZ101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.41: JXKH_DBZ102******************HD_ZBMX_HZ***JXKH_DBZ102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ102')
begin
	print '����ָ��JXKH_DBZ102,��ָ��JXKH_DBZ102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ102','�����ļ�������Ժ����ռ���ܴ�����','select "JXKH_DBZ102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12919','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,jxkhdbzkey','','select "JXKH_DBZ102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.42: JXKH_DBZ103******************HD_ZBMX_HZ***JXKH_DBZ103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ103')
begin
	print '����ָ��JXKH_DBZ103,��ָ��JXKH_DBZ103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ103','�����ļ������ܳ�Ժ����','select "JXKH_DBZ103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12926','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.43: JXKH_DBZ104******************HD_ZBMX_HZ***JXKH_DBZ104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ104')
begin
	print '����ָ��JXKH_DBZ104,��ָ��JXKH_DBZ104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ104','�����ļ������ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ105" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ100" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ105" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ100" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ105,JXKH_DBZ100','12986','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�����ļ������ܳ�Ժ����(JXKH_DBZ105)/@�����ļ�������������(JXKH_DBZ100)','select "JXKH_DBZ104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ105" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ100" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.44: JXKH_DBZ105******************HD_ZBMX_HZ***JXKH_DBZ105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ105')
begin
	print '����ָ��JXKH_DBZ105,��ָ��JXKH_DBZ105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ105') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ105','�����ļ������ܳ�Ժ����','select "JXKH_DBZ105" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ105" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ105" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12928','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ105" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.45: JXKH_DBZ107******************HD_ZBMX_HZ***JXKH_DBZ107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ107')
begin
	print '����ָ��JXKH_DBZ107,��ָ��JXKH_DBZ107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ107') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ107','�����ļ�����������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ108" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ100" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ108" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ100" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ108,JXKH_DBZ100','12931','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�����ļ�������������(JXKH_DBZ108)/@�����ļ�������������(JXKH_DBZ100)','select "JXKH_DBZ107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ108" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ100" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.46: JXKH_DBZ108******************HD_ZBMX_HZ***JXKH_DBZ108******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ108')
begin
	print '����ָ��JXKH_DBZ108,��ָ��JXKH_DBZ108�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ108') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ108','�����ļ�������������','select "JXKH_DBZ108" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ108" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ108" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12930','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ108" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.47: JXKH_DBZ200******************HD_ZBMX_HZ***JXKH_DBZ200******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ200')
begin
	print '����ָ��JXKH_DBZ200,��ָ��JXKH_DBZ200�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ200') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ200','����˥�߲�������','select "JXKH_DBZ200" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ200" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ200" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12932','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"12\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ200" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.48: JXKH_DBZ201******************HD_ZBMX_HZ***JXKH_DBZ201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ201')
begin
	print '����ָ��JXKH_DBZ201,��ָ��JXKH_DBZ201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ201','����˥��ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ200" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ202,JXKH_DBZ200','12934','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@����˥�߳�Ժ����ռ���ܴ�����(JXKH_DBZ202)/@����˥�߲�������(JXKH_DBZ200)','select "JXKH_DBZ201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.49: JXKH_DBZ202******************HD_ZBMX_HZ***JXKH_DBZ202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ202')
begin
	print '����ָ��JXKH_DBZ202,��ָ��JXKH_DBZ202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ202','����˥�߳�Ժ����ռ���ܴ�����','select "JXKH_DBZ202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12933','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"12\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.50: JXKH_DBZ204******************HD_ZBMX_HZ***JXKH_DBZ204******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ204')
begin
	print '����ָ��JXKH_DBZ204,��ָ��JXKH_DBZ204�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ204') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ204','����˥�ߴξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ205" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ200" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ205" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ205,JXKH_DBZ200','12987','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@����˥���ܳ�Ժ����(JXKH_DBZ205)/@����˥�߲�������(JXKH_DBZ200)','select "JXKH_DBZ204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ205" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.51: JXKH_DBZ205******************HD_ZBMX_HZ***JXKH_DBZ205******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ205')
begin
	print '����ָ��JXKH_DBZ205,��ָ��JXKH_DBZ205�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ205') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ205','����˥���ܳ�Ժ����','select "JXKH_DBZ205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12935','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"12\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.52: JXKH_DBZ207******************HD_ZBMX_HZ***JXKH_DBZ207******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ207')
begin
	print '����ָ��JXKH_DBZ207,��ָ��JXKH_DBZ207�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ207') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ207','����˥�߲�����','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ207" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ208" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ200" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ207" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ208" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ208,JXKH_DBZ200','12937','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@����˥����������(JXKH_DBZ208)/@����˥�߲�������(JXKH_DBZ200)','select "JXKH_DBZ207" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ208" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.53: JXKH_DBZ208******************HD_ZBMX_HZ***JXKH_DBZ208******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ208')
begin
	print '����ָ��JXKH_DBZ208,��ָ��JXKH_DBZ208�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ208') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ208','����˥����������','select "JXKH_DBZ208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12936','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"12\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.54: JXKH_DBZ300******************HD_ZBMX_HZ***JXKH_DBZ300******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ300')
begin
	print '����ָ��JXKH_DBZ300,��ָ��JXKH_DBZ300�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ300') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ300','���ף�סԺ�����ˣ���������','select "JXKH_DBZ300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12938','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.55: JXKH_DBZ301******************HD_ZBMX_HZ***JXKH_DBZ301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ301')
begin
	print '����ָ��JXKH_DBZ301,��ָ��JXKH_DBZ301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ301','���ף�סԺ�����ˣ�ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ302" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ300" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ302" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ302,JXKH_DBZ300','12940','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���ף�סԺ�����ˣ���Ժ����ռ���ܴ�����(JXKH_DBZ302)/@���ף�סԺ�����ˣ���������(JXKH_DBZ300)','select "JXKH_DBZ301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ302" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.56: JXKH_DBZ302******************HD_ZBMX_HZ***JXKH_DBZ302******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ302')
begin
	print '����ָ��JXKH_DBZ302,��ָ��JXKH_DBZ302�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ302') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ302','���ף�סԺ�����ˣ���Ժ����ռ���ܴ�����','select "JXKH_DBZ302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12939','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.57: JXKH_DBZ304******************HD_ZBMX_HZ***JXKH_DBZ304******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ304')
begin
	print '����ָ��JXKH_DBZ304,��ָ��JXKH_DBZ304�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ304') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ304','���ף�סԺ�����ˣ��ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ304" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ305" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ300" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ304" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ305" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ305,JXKH_DBZ300','12988','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���ף�סԺ�����ˣ��ܳ�Ժ����(JXKH_DBZ305)/@���ף�סԺ�����ˣ���������(JXKH_DBZ300)','select "JXKH_DBZ304" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ305" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.58: JXKH_DBZ305******************HD_ZBMX_HZ***JXKH_DBZ305******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ305')
begin
	print '����ָ��JXKH_DBZ305,��ָ��JXKH_DBZ305�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ305') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ305','���ף�סԺ�����ˣ��ܳ�Ժ����','select "JXKH_DBZ305" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ305" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ305" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12941','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ305" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.59: JXKH_DBZ307******************HD_ZBMX_HZ***JXKH_DBZ307******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ307')
begin
	print '����ָ��JXKH_DBZ307,��ָ��JXKH_DBZ307�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ307') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ307','���ף�סԺ�����ˣ�������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ307" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ308" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ300" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ307" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ308" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ308,JXKH_DBZ300','12943','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���ף�סԺ�����ˣ���������(JXKH_DBZ308)/@���ף�סԺ�����ˣ���������(JXKH_DBZ300)','select "JXKH_DBZ307" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ308" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.60: JXKH_DBZ308******************HD_ZBMX_HZ***JXKH_DBZ308******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ308')
begin
	print '����ָ��JXKH_DBZ308,��ָ��JXKH_DBZ308�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ308') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ308','���ף�סԺ�����ˣ���������','select "JXKH_DBZ308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12942','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.61: JXKH_DBZ400******************HD_ZBMX_HZ***JXKH_DBZ400******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ400')
begin
	print '����ָ��JXKH_DBZ400,��ָ��JXKH_DBZ400�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ400') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ400','���ף�סԺ����ͯ����������','select "JXKH_DBZ400" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ400" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ400" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12944','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"7\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ400" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.62: JXKH_DBZ401******************HD_ZBMX_HZ***JXKH_DBZ401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ401')
begin
	print '����ָ��JXKH_DBZ401,��ָ��JXKH_DBZ401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ401','���ף�סԺ����ͯ��ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ401" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ402" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ400" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ401" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ402" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ402,JXKH_DBZ400','12946','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���ף�סԺ����ͯ����Ժ����ռ���ܴ�����(JXKH_DBZ402)/@���ף�סԺ����ͯ����������(JXKH_DBZ400)','select "JXKH_DBZ401" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ402" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.63: JXKH_DBZ402******************HD_ZBMX_HZ***JXKH_DBZ402******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ402')
begin
	print '����ָ��JXKH_DBZ402,��ָ��JXKH_DBZ402�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ402') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ402','���ף�סԺ����ͯ����Ժ����ռ���ܴ�����','select "JXKH_DBZ402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12945','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"7\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.64: JXKH_DBZ404******************HD_ZBMX_HZ***JXKH_DBZ404******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ404')
begin
	print '����ָ��JXKH_DBZ404,��ָ��JXKH_DBZ404�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ404') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ404','���ף�סԺ����ͯ���ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ404" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ405" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ400" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ404" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ405" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ405,JXKH_DBZ400','12989','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���ף�סԺ����ͯ���ܳ�Ժ����(JXKH_DBZ405)/@���ף�סԺ����ͯ����������(JXKH_DBZ400)','select "JXKH_DBZ404" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ405" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.65: JXKH_DBZ405******************HD_ZBMX_HZ***JXKH_DBZ405******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ405')
begin
	print '����ָ��JXKH_DBZ405,��ָ��JXKH_DBZ405�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ405') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ405','���ף�סԺ����ͯ���ܳ�Ժ����','select "JXKH_DBZ405" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ405" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ405" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12947','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"7\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ405" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.66: JXKH_DBZ407******************HD_ZBMX_HZ***JXKH_DBZ407******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ407')
begin
	print '����ָ��JXKH_DBZ407,��ָ��JXKH_DBZ407�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ407') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ407','���ף�סԺ����ͯ��������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ407" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ408" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ400" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ407" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ408" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ408,JXKH_DBZ400','12949','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���ף�סԺ����ͯ����������(JXKH_DBZ408)/@���ף�סԺ����ͯ����������(JXKH_DBZ400)','select "JXKH_DBZ407" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ408" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.67: JXKH_DBZ408******************HD_ZBMX_HZ***JXKH_DBZ408******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ408')
begin
	print '����ָ��JXKH_DBZ408,��ָ��JXKH_DBZ408�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ408') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ408','���ף�סԺ����ͯ����������','select "JXKH_DBZ408" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ408" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ408" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12948','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"7\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ408" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.68: JXKH_DBZ500******************HD_ZBMX_HZ***JXKH_DBZ500******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ500')
begin
	print '����ָ��JXKH_DBZ500,��ָ��JXKH_DBZ500�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ500') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ500','�Թ�����������','select "JXKH_DBZ500" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ500" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ500" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12950','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"4\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ500" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.69: JXKH_DBZ501******************HD_ZBMX_HZ***JXKH_DBZ501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ501')
begin
	print '����ָ��JXKH_DBZ501,��ָ��JXKH_DBZ501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ501','�Թ���ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ502" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ500" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ502,JXKH_DBZ500','12952','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�Թ�����Ժ����ռ���ܴ�����(JXKH_DBZ502)/@�Թ�����������(JXKH_DBZ500)','select "JXKH_DBZ501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.70: JXKH_DBZ502******************HD_ZBMX_HZ***JXKH_DBZ502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ502')
begin
	print '����ָ��JXKH_DBZ502,��ָ��JXKH_DBZ502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ502') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ502','�Թ�����Ժ����ռ���ܴ�����','select "JXKH_DBZ502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12951','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"4\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.71: JXKH_DBZ504******************HD_ZBMX_HZ***JXKH_DBZ504******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ504')
begin
	print '����ָ��JXKH_DBZ504,��ָ��JXKH_DBZ504�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ504') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ504','�Թ����ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ505" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ500" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ505" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ505,JXKH_DBZ500','12990','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�Թ����ܳ�Ժ����(JXKH_DBZ505)/@�Թ�����������(JXKH_DBZ500)','select "JXKH_DBZ504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ505" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.72: JXKH_DBZ505******************HD_ZBMX_HZ***JXKH_DBZ505******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ505')
begin
	print '����ָ��JXKH_DBZ505,��ָ��JXKH_DBZ505�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ505') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ505','�Թ����ܳ�Ժ����','select "JXKH_DBZ505" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ505" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ505" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12953','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"4\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ505" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.73: JXKH_DBZ507******************HD_ZBMX_HZ***JXKH_DBZ507******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ507')
begin
	print '����ָ��JXKH_DBZ507,��ָ��JXKH_DBZ507�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ507') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ507','�Թ���������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ508" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ500" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ508" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ508,JXKH_DBZ500','12955','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�Թ�����������(JXKH_DBZ508)/@�Թ�����������(JXKH_DBZ500)','select "JXKH_DBZ507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ508" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.74: JXKH_DBZ508******************HD_ZBMX_HZ***JXKH_DBZ508******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ508')
begin
	print '����ָ��JXKH_DBZ508,��ָ��JXKH_DBZ508�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ508') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ508','�Թ�����������','select "JXKH_DBZ508" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ508" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ508" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12954','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"4\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ508" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.75: JXKH_DBZ600******************HD_ZBMX_HZ***JXKH_DBZ600******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ600')
begin
	print '����ָ��JXKH_DBZ600,��ָ��JXKH_DBZ600�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ600') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ600','�Źؽ��û�����������','select "JXKH_DBZ600" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ600" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ600" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12956','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ600" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.76: JXKH_DBZ601******************HD_ZBMX_HZ***JXKH_DBZ601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ601')
begin
	print '����ָ��JXKH_DBZ601,��ָ��JXKH_DBZ601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ601','�Źؽ��û���ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ602" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ600" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ602" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ602,JXKH_DBZ600','12958','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�Źؽ��û�����Ժ����ռ���ܴ�����(JXKH_DBZ602)/@�Źؽ��û�����������(JXKH_DBZ600)','select "JXKH_DBZ601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ602" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.77: JXKH_DBZ602******************HD_ZBMX_HZ***JXKH_DBZ602******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ602')
begin
	print '����ָ��JXKH_DBZ602,��ָ��JXKH_DBZ602�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ602') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ602','�Źؽ��û�����Ժ����ռ���ܴ�����','select "JXKH_DBZ602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12957','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.78: JXKH_DBZ604******************HD_ZBMX_HZ***JXKH_DBZ604******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ604')
begin
	print '����ָ��JXKH_DBZ604,��ָ��JXKH_DBZ604�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ604') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ604','�Źؽ��û����ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ604" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ605" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ600" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ604" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ605" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ605,JXKH_DBZ600','12991','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�Źؽ��û����ܳ�Ժ����(JXKH_DBZ605)/@�Źؽ��û�����������(JXKH_DBZ600)','select "JXKH_DBZ604" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ605" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.79: JXKH_DBZ605******************HD_ZBMX_HZ***JXKH_DBZ605******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ605')
begin
	print '����ָ��JXKH_DBZ605,��ָ��JXKH_DBZ605�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ605') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ605','�Źؽ��û����ܳ�Ժ����','select "JXKH_DBZ605" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ605" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ605" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12959','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ605" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.80: JXKH_DBZ607******************HD_ZBMX_HZ***JXKH_DBZ607******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ607')
begin
	print '����ָ��JXKH_DBZ607,��ָ��JXKH_DBZ607�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ607') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ607','�Źؽ��û���������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ607" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ608" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ600" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ607" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ608" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ608,JXKH_DBZ600','12961','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�Źؽ��û�����������(JXKH_DBZ608)/@�Źؽ��û�����������(JXKH_DBZ600)','select "JXKH_DBZ607" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ608" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.81: JXKH_DBZ608******************HD_ZBMX_HZ***JXKH_DBZ608******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ608')
begin
	print '����ָ��JXKH_DBZ608,��ָ��JXKH_DBZ608�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ608') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ608','�Źؽ��û�����������','select "JXKH_DBZ608" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ608" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ608" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12960','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ608" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.82: JXKH_DBZ700******************HD_ZBMX_HZ***JXKH_DBZ700******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ700')
begin
	print '����ָ��JXKH_DBZ700,��ָ��JXKH_DBZ700�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ700') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ700','ϥ�ؽ��û�����������','select "JXKH_DBZ700" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ700" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ700" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12962','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"14\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ700" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.83: JXKH_DBZ701******************HD_ZBMX_HZ***JXKH_DBZ701******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ701')
begin
	print '����ָ��JXKH_DBZ701,��ָ��JXKH_DBZ701�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ701') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ701','ϥ�ؽ��û���ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ702" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ700" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ702" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ702,JXKH_DBZ700','12964','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@ϥ�ؽ��û�����Ժ����ռ���ܴ�����(JXKH_DBZ702)/@ϥ�ؽ��û�����������(JXKH_DBZ700)','select "JXKH_DBZ701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ702" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.84: JXKH_DBZ702******************HD_ZBMX_HZ***JXKH_DBZ702******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ702')
begin
	print '����ָ��JXKH_DBZ702,��ָ��JXKH_DBZ702�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ702') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ702','ϥ�ؽ��û�����Ժ����ռ���ܴ�����','select "JXKH_DBZ702" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ702" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ702" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12963','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"14\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ702" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.85: JXKH_DBZ704******************HD_ZBMX_HZ***JXKH_DBZ704******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ704')
begin
	print '����ָ��JXKH_DBZ704,��ָ��JXKH_DBZ704�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ704') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ704','ϥ�ؽ��û����ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ704" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ705" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ700" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ704" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ705" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ705,JXKH_DBZ700','12992','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@ϥ�ؽ��û����ܳ�Ժ����(JXKH_DBZ705)/@ϥ�ؽ��û�����������(JXKH_DBZ700)','select "JXKH_DBZ704" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ705" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.86: JXKH_DBZ705******************HD_ZBMX_HZ***JXKH_DBZ705******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ705')
begin
	print '����ָ��JXKH_DBZ705,��ָ��JXKH_DBZ705�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ705') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ705','ϥ�ؽ��û����ܳ�Ժ����','select "JXKH_DBZ705" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ705" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ705" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12965','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"14\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ705" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.87: JXKH_DBZ707******************HD_ZBMX_HZ***JXKH_DBZ707******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ707')
begin
	print '����ָ��JXKH_DBZ707,��ָ��JXKH_DBZ707�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ707') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ707','ϥ�ؽ��û���������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ707" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ708" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ700" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ707" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ708" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ708,JXKH_DBZ700','12967','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@ϥ�ؽ��û�����������(JXKH_DBZ708)/@ϥ�ؽ��û�����������(JXKH_DBZ700)','select "JXKH_DBZ707" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ708" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.88: JXKH_DBZ708******************HD_ZBMX_HZ***JXKH_DBZ708******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ708')
begin
	print '����ָ��JXKH_DBZ708,��ָ��JXKH_DBZ708�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ708') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ708','ϥ�ؽ��û�����������','select "JXKH_DBZ708" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ708" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ708" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12966','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"14\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ708" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.89: JXKH_DBZ800******************HD_ZBMX_HZ***JXKH_DBZ800******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ800')
begin
	print '����ָ��JXKH_DBZ800,��ָ��JXKH_DBZ800�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ800') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ800','��״������·��ֲ����������','select "JXKH_DBZ800" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ800" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ800" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12968','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"6\"},{\"dim_key\":\"zlzbsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ800" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.90: JXKH_DBZ801******************HD_ZBMX_HZ***JXKH_DBZ801******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ801')
begin
	print '����ָ��JXKH_DBZ801,��ָ��JXKH_DBZ801�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ801') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ801','��״������·��ֲ��ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ802" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ800" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ802" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ802,JXKH_DBZ800','12970','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@��״������·��ֲ����Ժ����ռ���ܴ�����(JXKH_DBZ802)/@��״������·��ֲ����������(JXKH_DBZ800)','select "JXKH_DBZ801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ802" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.91: JXKH_DBZ802******************HD_ZBMX_HZ***JXKH_DBZ802******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ802')
begin
	print '����ָ��JXKH_DBZ802,��ָ��JXKH_DBZ802�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ802') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ802','��״������·��ֲ����Ժ����ռ���ܴ�����','select "JXKH_DBZ802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12969','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"6\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.92: JXKH_DBZ804******************HD_ZBMX_HZ***JXKH_DBZ804******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ804')
begin
	print '����ָ��JXKH_DBZ804,��ָ��JXKH_DBZ804�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ804') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ804','��״������·��ֲ���ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ804" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ805" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ800" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ804" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ805" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ805,JXKH_DBZ800','12993','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@��״������·��ֲ���ܳ�Ժ����(JXKH_DBZ805)/@��״������·��ֲ����������(JXKH_DBZ800)','select "JXKH_DBZ804" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ805" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.93: JXKH_DBZ805******************HD_ZBMX_HZ***JXKH_DBZ805******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ805')
begin
	print '����ָ��JXKH_DBZ805,��ָ��JXKH_DBZ805�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ805') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ805','��״������·��ֲ���ܳ�Ժ����','select "JXKH_DBZ805" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ805" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ805" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12971','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"6\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ805" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.94: JXKH_DBZ807******************HD_ZBMX_HZ***JXKH_DBZ807******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ807')
begin
	print '����ָ��JXKH_DBZ807,��ָ��JXKH_DBZ807�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ807') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ807','��״������·��ֲ��������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ807" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ808" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ800" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ807" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ808" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ808,JXKH_DBZ800','12973','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@��״������·��ֲ����������(JXKH_DBZ808)/@��״������·��ֲ����������(JXKH_DBZ800)','select "JXKH_DBZ807" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ808" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.95: JXKH_DBZ808******************HD_ZBMX_HZ***JXKH_DBZ808******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ808')
begin
	print '����ָ��JXKH_DBZ808,��ָ��JXKH_DBZ808�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ808') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ808','��״������·��ֲ����������','select "JXKH_DBZ808" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ808" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ808" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12972','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"6\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ808" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.96: JXKH_DBZ900******************HD_ZBMX_HZ***JXKH_DBZ900******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ900')
begin
	print '����ָ��JXKH_DBZ900,��ָ��JXKH_DBZ900�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ900') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ900','�ʹ�����������','select "JXKH_DBZ900" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ900" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ900" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12974','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"9\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ900" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.97: JXKH_DBZ901******************HD_ZBMX_HZ***JXKH_DBZ901******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ901')
begin
	print '����ָ��JXKH_DBZ901,��ָ��JXKH_DBZ901�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ901') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ901','�ʹ���ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ902" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ900" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ902" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ902,JXKH_DBZ900','12976','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�ʹ�����Ժ����ռ���ܴ�����(JXKH_DBZ902)/@�ʹ�����������(JXKH_DBZ900)','select "JXKH_DBZ901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ902" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.98: JXKH_DBZ902******************HD_ZBMX_HZ***JXKH_DBZ902******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ902')
begin
	print '����ָ��JXKH_DBZ902,��ָ��JXKH_DBZ902�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ902') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ902','�ʹ�����Ժ����ռ���ܴ�����','select "JXKH_DBZ902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12975','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"9\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.99: JXKH_DBZ904******************HD_ZBMX_HZ***JXKH_DBZ904******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ904')
begin
	print '����ָ��JXKH_DBZ904,��ָ��JXKH_DBZ904�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ904') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ904','�ʹ����ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ905" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ900" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ905" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ905,JXKH_DBZ900','12994','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�ʹ����ܳ�Ժ����(JXKH_DBZ905)/@�ʹ�����������(JXKH_DBZ900)','select "JXKH_DBZ904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ905" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.100: JXKH_DBZ905******************HD_ZBMX_HZ***JXKH_DBZ905******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ905')
begin
	print '����ָ��JXKH_DBZ905,��ָ��JXKH_DBZ905�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ905') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ905','�ʹ����ܳ�Ժ����','select "JXKH_DBZ905" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ905" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ905" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12977','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"9\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ905" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.101: JXKH_DBZ907******************HD_ZBMX_HZ***JXKH_DBZ907******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ907')
begin
	print '����ָ��JXKH_DBZ907,��ָ��JXKH_DBZ907�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ907') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ907','�ʹ���������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ907" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ908" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ900" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ907" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ908" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ908,JXKH_DBZ900','12979','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�ʹ�����������(JXKH_DBZ908)/@�ʹ�����������(JXKH_DBZ900)','select "JXKH_DBZ907" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ908" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.102: JXKH_DBZ908******************HD_ZBMX_HZ***JXKH_DBZ908******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ908')
begin
	print '����ָ��JXKH_DBZ908,��ָ��JXKH_DBZ908�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ908') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ908','�ʹ�����������','select "JXKH_DBZ908" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ908" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ908" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12978','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"9\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ908" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.103: JXKH_DBZ1000******************HD_ZBMX_HZ***JXKH_DBZ1000******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1000')
begin
	print '����ָ��JXKH_DBZ1000,��ָ��JXKH_DBZ1000�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1000') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ1000','���������Էμ�����������','select "JXKH_DBZ1000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ1000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ1000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12980','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','ls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"10\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ1000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.104: JXKH_DBZ1001******************HD_ZBMX_HZ***JXKH_DBZ1001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1001')
begin
	print '����ָ��JXKH_DBZ1001,��ָ��JXKH_DBZ1001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ1001','���������Էμ���ƽ��סԺ��','-1','select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ1001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1002" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1000" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ1001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ1002,JXKH_DBZ1000','12982','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���������Էμ�����Ժ����ռ���ܴ�����(JXKH_DBZ1002)/@���������Էμ�����������(JXKH_DBZ1000)','select "JXKH_DBZ1001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.105: JXKH_DBZ1002******************HD_ZBMX_HZ***JXKH_DBZ1002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1002')
begin
	print '����ָ��JXKH_DBZ1002,��ָ��JXKH_DBZ1002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ1002','���������Էμ�����Ժ����ռ���ܴ�����','select "JXKH_DBZ1002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ1002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ1002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12981','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zzyts','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"10\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ1002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.106: JXKH_DBZ1004******************HD_ZBMX_HZ***JXKH_DBZ1004******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1004')
begin
	print '����ָ��JXKH_DBZ1004,��ָ��JXKH_DBZ1004�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1004') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ1004','���������Էμ����ξ�����','-1','select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ1004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1005" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1000" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ1004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ1005,JXKH_DBZ1000','12995','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���������Էμ����ܳ�Ժ����(JXKH_DBZ1005)/@���������Էμ�����������(JXKH_DBZ1000)','select "JXKH_DBZ1004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.107: JXKH_DBZ1005******************HD_ZBMX_HZ***JXKH_DBZ1005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1005')
begin
	print '����ָ��JXKH_DBZ1005,��ָ��JXKH_DBZ1005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1005') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ1005','���������Էμ����ܳ�Ժ����','select "JXKH_DBZ1005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ1005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ1005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12983','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','zfy','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"10\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ1005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.108: JXKH_DBZ1007******************HD_ZBMX_HZ***JXKH_DBZ1007******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1007')
begin
	print '����ָ��JXKH_DBZ1007,��ָ��JXKH_DBZ1007�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1007') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ1007','���������Էμ���������','-1','select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey','-1','select "JXKH_DBZ1007" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1008" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1000" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "JXKH_DBZ1007" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1008" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','JXKH_DBZ1008,JXKH_DBZ1000','12985','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@���������Էμ�����������(JXKH_DBZ1008)/@���������Էμ�����������(JXKH_DBZ1000)','select "JXKH_DBZ1007" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1008" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.109: JXKH_DBZ1008******************HD_ZBMX_HZ***JXKH_DBZ1008******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1008')
begin
	print '����ָ��JXKH_DBZ1008,��ָ��JXKH_DBZ1008�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1008') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('JXKH_DBZ1008','���������Էμ�����������','select "JXKH_DBZ1008" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ1008" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "JXKH_DBZ1008" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12984','','','0','1','1','FACT_ZLZB_JBBZ_DBZ','swls','[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"10\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "JXKH_DBZ1008" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.110: J108******************HD_ZBMX_HZ***J108******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J108')
begin
	print '����ָ��J108,��ָ��J108�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J108') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('J108','����ҽ��Ӱ���豸����������(CT��MRI��DSA��SPECT��PET_CT)','','','','select "J108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J10901" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J109" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "J108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J10901" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J109" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','J10901,J109','0','','','0','-1','-1','','','','','@����ҽ���豸�����������(J10901)/@����ҽ���豸���������(J109)','select "J108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J10901" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J109" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.111: J10901******************HD_ZBMX_HZ***J10901******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J10901')
begin
	print '����ָ��J10901,��ָ��J10901�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J10901') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J10901'

end
go

/************No.112: J109******************HD_ZBMX_HZ***J109******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J109')
begin
	print '����ָ��J109,��ָ��J109�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J109') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J109'

end
go

/************No.113: J00304******************HD_ZBMX_HZ***J00304******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J00304')
begin
	print '����ָ��J00304,��ָ��J00304�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J00304') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J00304'

end
go

/************No.114: J0030106******************HD_ZBMX_HZ***J0030106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J0030106')
begin
	print '����ָ��J0030106,��ָ��J0030106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J0030106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('J0030106','�Ҽ�������Ŀ�μ���','','','','select "J0030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J0030107" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J0030109" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "J0030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J0030107" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J0030109" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','J0030107,J0030109','13147','','','0','-1','-1','','','','','@�μӹ����ٴ�����������֯���Ҽ������ļ�����Ŀ��(J0030107)/@ͬ��ʵ�����ѿ�չ��ͬʱ�����ٴ�������������֯���Ҽ�����������Ŀ����(J0030109)','select "J0030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J0030107" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J0030109" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.115: J0030107******************HD_ZBMX_HZ***J0030107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J0030107')
begin
	print '����ָ��J0030107,��ָ��J0030107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J0030107') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J0030107'

end
go

/************No.116: J0030109******************HD_ZBMX_HZ***J0030109******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J0030109')
begin
	print '����ָ��J0030109,��ָ��J0030109�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J0030109') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J0030109'

end
go

/************No.117: J0030110******************HD_ZBMX_HZ***J0030110******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J0030110')
begin
	print '����ָ��J0030110,��ָ��J0030110�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J0030110') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('J0030110','�Ҽ�������Ŀ�ϸ���','','','','select "J0030110" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J0030111" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J0030112" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "J0030110" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J0030111" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J0030112" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','J0030111,J0030112','13146','','','0','-1','-1','','','','','@�μӹ����ٴ�����������֯���Ҽ������ɼ��ϸ������Ŀ��(J0030111)/@ͬ�ڲμӹ����ٴ�����������֯���Ҽ������ļ�����Ŀ����(J0030112)','select "J0030110" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J0030111" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J0030112" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.118: J0030111******************HD_ZBMX_HZ***J0030111******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J0030111')
begin
	print '����ָ��J0030111,��ָ��J0030111�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J0030111') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J0030111'

end
go

/************No.119: J0030112******************HD_ZBMX_HZ***J0030112******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='J0030112')
begin
	print '����ָ��J0030112,��ָ��J0030112�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='J0030112') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb J0030112'

end
go

/************No.120: ZBZL_YXZB_DRGS0020502******************HD_ZBMX_HZ***ZBZL_YXZB_DRGS0020502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020502')
begin
	print '����ָ��ZBZL_YXZB_DRGS0020502,��ָ��ZBZL_YXZB_DRGS0020502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020502') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZBZL_YXZB_DRGS0020502','�ͷ���DRG��������','-1','select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz,0 fm from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey union all select timekey,yykey,kskey,yskey,drgskey,0 fz,drgskey fm from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")','-1','select "ZBZL_YXZB_DRGS0020502" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZBZL_YXZB_DRGS0020501" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZBZL_YXZB_DRGS00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZBZL_YXZB_DRGS0020502" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS0020501" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','ZBZL_YXZB_DRGS0020501,ZBZL_YXZB_DRGS00101','13001','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,drgskey','@�ͷ���DRG����������(ZBZL_YXZB_DRGS0020501)/@�ͷ���DRG����(ZBZL_YXZB_DRGS00101)','select "ZBZL_YXZB_DRGS0020502" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS0020501" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.121: ZBZL_YXZB_DRGS0020501******************HD_ZBMX_HZ***ZBZL_YXZB_DRGS0020501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020501')
begin
	print '����ָ��ZBZL_YXZB_DRGS0020501,��ָ��ZBZL_YXZB_DRGS0020501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZBZL_YXZB_DRGS0020501','�ͷ���DRG����������','select "ZBZL_YXZB_DRGS0020501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZBZL_YXZB_DRGS0020501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZBZL_YXZB_DRGS0020501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11864','','','0','1','0','FACT_GZ_YXZB_DRGS','swls','[{\"dim_key\":\"fxpgdjkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey,drgskey','','select "ZBZL_YXZB_DRGS0020501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.122: ZBZL_YXZB_DRGS00101******************HD_ZBMX_HZ***ZBZL_YXZB_DRGS00101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS00101')
begin
	print '����ָ��ZBZL_YXZB_DRGS00101,��ָ��ZBZL_YXZB_DRGS00101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS00101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZBZL_YXZB_DRGS00101','�ͷ���DRG����','select "ZBZL_YXZB_DRGS00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct drgskey) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,fxpgdjkey,drgskey from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZBZL_YXZB_DRGS00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct drgskey) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,fxpgdjkey,drgskey from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZBZL_YXZB_DRGS00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct drgskey) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,fxpgdjkey,drgskey from FACT_GZ_YXZB_DRGS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','-1','','11878','-1','-1','0','-1','-1','FACT_GZ_YXZB_DRGS','drgskey','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in (''1'')','timekey,yykey,kskey,yskey,fxpgdjkey','-1','select "ZBZL_YXZB_DRGS00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct drgskey) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,fxpgdjkey,drgskey from FACT_GZ_YXZB_DRGS a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','-1','2')
	
end
go

/************No.123: F50002******************HD_ZBMX_HZ***F50002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F50002')
begin
	print '����ָ��F50002,��ָ��F50002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F50002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('F50002','���ʻ������񲡷�������','','','','select "F50002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F50001" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F500" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "F50002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F50001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F500" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','F50001,F500','12401','','','0','-1','-1','','','','','@�Ѿ���չ���ʻ�������Ĳ�����(F50001)/@��������(F500)','select "F50002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F50001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F500" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.124: F50001******************HD_ZBMX_HZ***F50001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F50001')
begin
	print '����ָ��F50001,��ָ��F50001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F50001') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb F50001'

end
go

/************No.125: F500******************HD_ZBMX_HZ***F500******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F500')
begin
	print '����ָ��F500,��ָ��F500�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F500') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb F500'

end
go

/************No.126: E20122******************HD_ZBMX_HZ***E20122******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20122')
begin
	print '����ָ��E20122,��ָ��E20122�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20122') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20122','������������','-1','select yykey,timekey,kskey,sum(jccfzs) fz,0 fm from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey union all select yykey,timekey,kskey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey','-1','select "E20122" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20121" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E20122" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20121" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','E20121,E201','12433','-1','-1','0','-1','-1','-1','-1','-1','yykey,timekey,kskey','@����������(E20121)/@�ż��ﴦ����(E201)','select "E20122" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20121" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.127: E20121******************HD_ZBMX_HZ***E20121******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20121')
begin
	print '����ָ��E20121,��ָ��E20121�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20121') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20121','����������','select "E20121" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select yykey,timekey,kskey,sum(jccfzs) fz from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20121" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,sum(jccfzs) fz from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20121" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,sum(jccfzs) fz from FACT_SF_MZ_CFJC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12432','','','0','1','0','FACT_SF_MZ_CFJC','jccfzs','','yykey,timekey,kskey','','select "E20121" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,sum(jccfzs) fz from FACT_SF_MZ_CFJC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.128: E201******************HD_ZBMX_HZ***E201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E201')
begin
	print '����ָ��E201,��ָ��E201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E201','�ż��ﴦ����','select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10285','','','0','1','0','FACT_YP_CFLFX','cfs','','timekey,yykey,kskey,mjzkey','','select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.129: A1026******************HD_ZBMX_HZ***A1026******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1026')
begin
	print '����ָ��A1026,��ָ��A1026�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1026') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1026','����������ҽ������������������','-1','select timekey,yykey,bqkey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey union all select timekey,yykey,bqkey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey','-1','select "A1026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A1025" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A1026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A1025" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','A1025,A102','12921','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,bqkey,kskey','@����������ҽ����������(ҽ�������˴�)(A1025)/@��Ժ�˴�(A102)','select "A1026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A1025" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.130: A1025******************HD_ZBMX_HZ***A1025******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1025')
begin
	print '����ָ��A1025,��ָ��A1025�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1025') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1025','����������ҽ����������(ҽ�������˴�)','select "A1025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "A1025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "A1025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','12920','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"yzdpbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,bqkey,kskey','','select "A1025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.131: E00209******************HD_ZBMX_HZ***E00209******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00209')
begin
	print '����ָ��E00209,��ָ��E00209�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00209') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00209','סԺ����ҩ��ʹ��ǿ��','','select timekey,yykey,kskey,sum(ddds) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zyts) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00230" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00230" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00230,A111','11589','','','0','-1','-1','','','','timekey,yykey,kskey','@��Ժ���߿���ҩ��DDDS(E00230)/@��Ժ����ʵ��ռ���ܴ���(A111)','select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00230" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.132: E00230******************HD_ZBMX_HZ***E00230******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00230')
begin
	print '����ָ��E00230,��ָ��E00230�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00230') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00230','��Ժ���߿���ҩ��DDDS','select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10261','','','0','1','0','FACT_YP_ZY_FYFX','ddds','','timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey','','select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.133: A111******************HD_ZBMX_HZ***A111******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A111')
begin
	print '����ָ��A111,��ָ��A111�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A111') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A111','��Ժ����ʵ��ռ���ܴ���','select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10071','','','0','1','0','FACT_YY_ZY_CYYWLFX','zyts','','timekey,yykey,kskey','','select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.134: E20203******************HD_ZBMX_HZ***E20203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20203')
begin
	print '����ָ��E20203,��ָ��E20203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20203','�ż������ҩƷ������(%)','','select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(jbypcfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey union all select timekey,yykey,kskey,yskey,ybflkey,mjzkey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey','','select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E20103,E201','11303','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,mjzkey','@�ż������ҩƷ������(E20103)/@�ż��ﴦ����(E201)','select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.135: E20103******************HD_ZBMX_HZ***E20103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E20103')
begin
	print '����ָ��E20103,��ָ��E20103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E20103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E20103','�ż������ҩƷ������','select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10288','','','0','1','0','FACT_YP_CFLFX','jbypcfs','','timekey,yykey,kskey,yskey','','select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','-1','')
	
end
go

/************No.136: E00310******************HD_ZBMX_HZ***E00310******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00310')
begin
	print '����ָ��E00310,��ָ��E00310�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00310') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00310','�ż������ҩ���˴�ռ��','-1','select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(yprc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey','-1','select "E00310" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00308" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="G005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00310" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00308" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="G005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','E00308,G005','11606','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey','@�ż������ҩ��ʹ���˴�(E00308)/@�ż���ҩƷ�˴�(G005)','select "E00310" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00308" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="G005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.137: E00308******************HD_ZBMX_HZ***E00308******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00308')
begin
	print '����ָ��E00308,��ָ��E00308�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00308') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00308','�ż������ҩ��ʹ���˴�','select "E00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10276','','','0','1','0','FACT_YY_MZ_JZRC','jbywsyrc','','timekey,yykey,kskey,yskey','','select "E00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','-1','')
	
end
go

/************No.138: G005******************HD_ZBMX_HZ***G005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='G005')
begin
	print '����ָ��G005,��ָ��G005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='G005') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('G005','�ż���ҩƷ�˴�','select "G005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,mjzkey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10329','','','0','1','0','FACT_YY_MZ_JZRC','yprc','','timekey,yykey,kskey,yskey,mjzkey','','select "G005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.139: E00902******************HD_ZBMX_HZ***E00902******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00902')
begin
	print '����ָ��E00902,��ָ��E00902�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00902') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00902','סԺ���߻���ҩ��ʹ����','','select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey union all select timekey,yykey,bqkey,kskey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey','','select "E00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00901" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A1027" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00901" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A1027" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00901,A1027','13154','','','0','-1','-1','','','','timekey,yykey,bqkey,kskey,zlzkey','@סԺ���߻���ҩ��ʹ���˴�(E00901)/@��Ժ���˴�����������δ��ҩ���ߣ�(A1027)','select "E00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00901" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A1027" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.140: E00901******************HD_ZBMX_HZ***E00901******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00901')
begin
	print '����ָ��E00901,��ָ��E00901�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00901') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00901','סԺ���߻���ҩ��ʹ���˴�','select "E00901" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "E00901" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "E00901" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','12402','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"jbywsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,bqkey,kskey,zlzkey','','select "E00901" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.141: A1027******************HD_ZBMX_HZ***A1027******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1027')
begin
	print '����ָ��A1027,��ָ��A1027�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1027') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1027','��Ժ���˴�����������δ��ҩ���ߣ�','select "A1027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "A1027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "A1027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','12922','','','0','1','0','FACT_YY_ZY_CYYWLFX','cyrc','[{\"dim_key\":\"ypsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,bqkey,kskey,zlzkey','','select "A1027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.142: G30002******************HD_ZBMX_HZ***G30002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='G30002')
begin
	print '����ָ��G30002,��ָ��G30002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='G30002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('G30002','����ҩ��ɹ�Ʒ����ռ��','','','','select "G30002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="G30001" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="G300" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "G30002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="G30001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="G300" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','G30001,G300','12406','','','0','-1','-1','','','','','@ҽԺ�ɹ�����ҩ��Ʒ����(G30001)/@�ɹ�ҩ��Ʒ����(G300)','select "G30002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="G30001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="G300" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.143: G30001******************HD_ZBMX_HZ***G30001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='G30001')
begin
	print '����ָ��G30001,��ָ��G30001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='G30001') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('G30001','ҽԺ�ɹ�����ҩ��Ʒ����','select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','-1','','','0','0','0','FACT_DIM_YP','idm','[{\"dim_key\":\"gjjzcgbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','yykey,timekey,kskey','','select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.144: G300******************HD_ZBMX_HZ***G300******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='G300')
begin
	print '����ָ��G300,��ָ��G300�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='G300') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('G300','�ɹ�ҩ��Ʒ����','select "G300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1)',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','-1','','','0','0','0','FACT_DIM_YP','idm','[{\"dim_key\":\"gjjzcgbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','yykey,timekey,kskey','','select "G300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.145: E00504******************HD_ZBMX_HZ***E00504******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00504')
begin
	print '����ָ��E00504,��ָ��E00504�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00504') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00504','������֯ҩƷ���вɹ��б�ҩƷʹ�ñ���','','select timekey,yykey,kskey,sum(ypsyl) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ypsyl) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ypsyl) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ypsyl) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select "E00504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00503" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00503" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00503,E005','13171','','','0','-1','-1','','','','timekey,yykey,kskey','@������֯ҩƷ���вɹ��б�ҩƷ����(E00503)/@ҩƷ����(E005)','select "E00504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00503" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.146: E00503******************HD_ZBMX_HZ***E00503******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00503')
begin
	print '����ָ��E00503,��ָ��E00503�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00503') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00503','������֯ҩƷ���вɹ��б�ҩƷ����','','select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey','','select "E00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0050301" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0050302" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0050301" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0050302" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0050301,E0050302','','','','0','-1','-1','','','','timekey,yykey,kskey','@�ż��������֯ҩƷ���вɹ��б�ҩƷ����(E0050301)+@סԺ������֯ҩƷ���вɹ��б�ҩƷ����(E0050302)','select "E00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0050301" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0050302" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.147: E0050301******************HD_ZBMX_HZ***E0050301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0050301')
begin
	print '����ָ��E0050301,��ָ��E0050301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0050301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0050301','�ż��������֯ҩƷ���вɹ��б�ҩƷ����','select "E0050301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0050301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0050301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','13158','','','0','1','0','FACT_YP_MZ_FYFX','ypsyl','[{\"dim_key\":\"gjjzcgbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey','','select "E0050301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.148: E005******************HD_ZBMX_HZ***E005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E005')
begin
	print '����ָ��E005,��ָ��E005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E005') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E005','ҩƷ����','','select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','','select "E005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00501" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00502" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00501" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E00501,E00502','','','','0','-1','-1','','','','timekey,yykey,kskey','@�ż���ҩƷ����(E00501)+@סԺҩƷ����(E00502)','select "E005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00501" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.149: E00501******************HD_ZBMX_HZ***E00501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00501')
begin
	print '����ָ��E00501,��ָ��E00501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00501','�ż���ҩƷ����','select "E00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_YP_MZ_FYFX','ypsyl','','timekey,yykey,kskey','','select "E00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.150: E00502******************HD_ZBMX_HZ***E00502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E00502')
begin
	print '����ָ��E00502,��ָ��E00502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E00502') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E00502','סԺҩƷ����','select "E00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','0','','','0','1','0','FACT_YP_ZY_FYFX','ypsyl','','timekey,yykey,kskey','','select "E00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.151: A006******************HD_ZBMX_HZ***A006******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A006')
begin
	print '����ָ��A006,��ָ��A006�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A006') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A006','ԤԼ������','','select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz,0 fm from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey union all select timekey,yykey,kskey,yskey,yyfskey,0 fz,sum(yyrc) fm from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey','','select "A006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A004" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A003" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A004" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A003" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A004,A003','11508','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,yyfskey','@ԤԼ�����˴�(A004)/@����ԤԼ�˴�(A003)','select "A006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A004" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A003" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.152: A004******************HD_ZBMX_HZ***A004******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A004')
begin
	print '����ָ��A004,��ָ��A004�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A004') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A004','ԤԼ�����˴�','select "A004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz from FACT_YY_MZ_YYRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10040','','','0','1','0','FACT_YY_MZ_YYRC','yyjzrc','','timekey,yykey,kskey,yskey,yyfskey','','select "A004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz from FACT_YY_MZ_YYRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','-1','')
	
end
go

/************No.153: A003******************HD_ZBMX_HZ***A003******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A003')
begin
	print '����ָ��A003,��ָ��A003�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A003') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A003','����ԤԼ�˴�','select "A003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey,sum(yyrc) fz from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey,sum(yyrc) fz from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey,sum(yyrc) fz from FACT_YY_MZ_YYRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10033','','','0','1','0','FACT_YY_MZ_YYRC','yyrc','','timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey','','select "A003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey,sum(yyrc) fz from FACT_YY_MZ_YYRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.154: A00309******************HD_ZBMX_HZ***A00309******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00309')
begin
	print '����ָ��A00309,��ָ��A00309�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00309') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00309','����ԤԼ����ƽ������ʱ��','','select timekey,yykey,kskey,sum(ddjzsc) fz,0 fm from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(rc) fm from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey','','select "A00309" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00308" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A00309" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00308" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A00308,A00401','12436','','','0','-1','-1','','','','timekey,yykey,kskey','@����ԤԼ���ߺ���ʱ��(A00308)/@��ЧԤԼ�����˴�(A00401)','select "A00309" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00308" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.155: A00308******************HD_ZBMX_HZ***A00308******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00308')
begin
	print '����ָ��A00308,��ָ��A00308�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00308') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00308','����ԤԼ���ߺ���ʱ��','select "A00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ddjzsc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ddjzsc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ddjzsc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','-1','','','0','1','0','FACT_YY_MZ_JZLC','ddjzsc','[{\"dim_key\":\"yybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "A00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ddjzsc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.156: A00401******************HD_ZBMX_HZ***A00401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A00401')
begin
	print '����ָ��A00401,��ָ��A00401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A00401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A00401','��ЧԤԼ�����˴�','select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12332','','','0','1','0','FACT_YY_MZ_JZLC','rc','[{\"dim_key\":\"yybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.157: ZLZB_YY0091******************HD_ZBMX_HZ***ZLZB_YY0091******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0091')
begin
	print '����ָ��ZLZB_YY0091,��ָ��ZLZB_YY0091�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0091') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0091'

end
go

/************No.158: A115******************HD_ZBMX_HZ***A115******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A115')
begin
	print '����ָ��A115,��ָ��A115�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A115') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A115','ÿ��ִҵҽʦ�վ�סԺ��������','','','','select "A115" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A115" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A111,ZLZB_YY0005','12407','','','0','-1','-1','','','','','@��Ժ����ʵ��ռ���ܴ���(A111)/@����������Ա����ҽʦ��(ZLZB_YY0005)','select "A115" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.159: ZLZB_YY0005******************HD_ZBMX_HZ***ZLZB_YY0005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0005')
begin
	print '����ָ��ZLZB_YY0005,��ָ��ZLZB_YY0005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0005') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0005'

end
go

/************No.160: ZLZB_YY006601******************HD_ZBMX_HZ***ZLZB_YY006601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY006601')
begin
	print '����ָ��ZLZB_YY006601,��ָ��ZLZB_YY006601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY006601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY006601','ÿ���Ų���ҩʦ����','','','','select "ZLZB_YY006601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0066" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY006601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0066" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0066,ZLZB_YY0001','12408','','','0','-1','-1','','','','','@ҩѧרҵ������Ա(ZLZB_YY0066)*100/@ʵ�ʿ��Ŵ�λ(ZLZB_YY0001)','select "ZLZB_YY006601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0066" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.161: ZLZB_YY0066******************HD_ZBMX_HZ***ZLZB_YY0066******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0066')
begin
	print '����ָ��ZLZB_YY0066,��ָ��ZLZB_YY0066�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0066') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0066'

end
go

/************No.162: ZLZB_YY0001******************HD_ZBMX_HZ***ZLZB_YY0001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0001')
begin
	print '����ָ��ZLZB_YY0001,��ָ��ZLZB_YY0001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0001') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0001'

end
go

/************No.163: B00103******************HD_ZBMX_HZ***B00103******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00103')
begin
	print '����ָ��B00103,��ָ��B00103�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00103') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00103','�ż������ռ��','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B00103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00101,B001','12409','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','@�ż������(B00101)/@ҽԺ�ܷ���(B001)','select "B00103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.164: B00101******************HD_ZBMX_HZ***B00101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00101')
begin
	print '����ָ��B00101,��ָ��B00101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00101','�ż������','select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10077','','','0','1','0','FACT_FY_MZ_FYFX','ghfy+cffy','','timekey,yykey,kskey,mjzkey,dxmkey','','select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.165: C002020102******************HD_ZBMX_HZ***C002020102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C002020102')
begin
	print '����ָ��C002020102,��ָ��C002020102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C002020102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C002020102','��������������ҽ������ı���','-1','select timekey,yykey,kskey,ybflkey,yskey,sum(ybzffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey union all select timekey,yykey,kskey,ybflkey,yskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,yskey','-1','select "C002020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C0020201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "C002020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C0020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','C0020201,B00101','12411','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,ybflkey,yskey','@�ż���ҽ��֧�����(�ɱ����)(C0020201)/@�ż������(B00101)','select "C002020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C0020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.166: C0020201******************HD_ZBMX_HZ***C0020201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C0020201')
begin
	print '����ָ��C0020201,��ָ��C0020201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C0020201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C0020201','�ż���ҽ��֧�����(�ɱ����)','select "C0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "C0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "C0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10181','','','0','1','0','FACT_YB_YBZKFX','ybzffy','[{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,ybflkey,yskey,yblxkey','','select "C0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.167: B00104******************HD_ZBMX_HZ***B00104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00104')
begin
	print '����ָ��B00104,��ָ��B00104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00104','סԺ����ռ��','-1','select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey','-1','select "B00104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00102,B001','12410','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey','@סԺ����(B00102)/@ҽԺ�ܷ���(B001)','select "B00104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.168: B00102******************HD_ZBMX_HZ***B00102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00102')
begin
	print '����ָ��B00102,��ָ��B00102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00102','סԺ����','select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10080','','','0','1','0','FACT_FY_ZY_FYFX','zfy','','timekey,yykey,kskey,dxmkey','','select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.169: C102020102******************HD_ZBMX_HZ***C102020102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C102020102')
begin
	print '����ָ��C102020102,��ָ��C102020102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C102020102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C102020102','סԺ����������ҽ������ı���','-1','select timekey,yykey,kskey,ybflkey,yskey,zlzkey,sum(ybzffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey union all select timekey,yykey,kskey,ybflkey,yskey,zlzkey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey','-1','select "C102020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C1020201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "C102020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C1020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','C1020201,B00102','12412','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,ybflkey,yskey,zlzkey','@סԺҽ��֧�����(�ɱ����)(C1020201)/@סԺ����(B00102)','select "C102020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C1020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.170: C1020201******************HD_ZBMX_HZ***C1020201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C1020201')
begin
	print '����ָ��C1020201,��ָ��C1020201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C1020201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C1020201','סԺҽ��֧�����(�ɱ����)','select "C1020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "C1020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "C1020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10190','','','0','1','0','FACT_YB_YBZKFX','ybzffy','[{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey','','select "C1020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.171: C701******************HD_ZBMX_HZ***C701******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C701')
begin
	print '����ָ��C701,��ָ��C701�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C701') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C701','ҽ������ؿ���','','','','select "C701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C702" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C3020201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "C701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C702" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C3020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','C702,C3020201','0','','','0','-1','-1','','','','','@��ҽ�������յ��Ŀ���(C702)/@ҽ��֧�����(�ɱ����)(C3020201)','select "C701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C702" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C3020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.172: C702******************HD_ZBMX_HZ***C702******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C702')
begin
	print '����ָ��C702,��ָ��C702�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C702') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb C702'

end
go

/************No.173: C3020201******************HD_ZBMX_HZ***C3020201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='C3020201')
begin
	print '����ָ��C3020201,��ָ��C3020201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='C3020201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('C3020201','ҽ��֧�����(�ɱ����)','-1','select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey union all select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(-ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey','-1','select "C3020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C1020201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C0020201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "C3020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C1020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C0020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','C1020201,C0020201','13002','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,ybflkey,yskey,yblxkey','@סԺҽ��֧�����(�ɱ����)(C1020201)+@�ż���ҽ��֧�����(�ɱ����)(C0020201)','select "C3020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C1020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C0020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.174: B00106******************HD_ZBMX_HZ***B00106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00106')
begin
	print '����ָ��B00106,��ָ��B00106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00106','ҽ�Ʒ������루����ҩƷ���Ĳġ����������룩ռҽ���������','','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,7) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','','select "B00106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00105" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00105" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00105,B001','12415','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','@ҽ�Ʒ������루����ҩƷ���Ĳġ����������룩(B00105)/@ҽԺ�ܷ���(B001)','select "B00106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00105" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.175: B00105******************HD_ZBMX_HZ***B00105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00105')
begin
	print '����ָ��B00105,��ָ��B00105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00105') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00105','ҽ�Ʒ������루����ҩƷ���Ĳġ����������룩','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,sum(-zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey union all ','-1','select "B00105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B004" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B005" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B009" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B004" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B009" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B001,B002,B004,B005,B009','13160','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,dxmkey,ybflkey','@ҽԺ�ܷ���(B001)-@ҩƷ�ܷ���(B002)-@�������(B004)-@�������Ϸ���(B005)-@����������(B009)','select "B00105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B004" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B009" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.176: B0010501******************HD_ZBMX_HZ***B0010501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010501')
begin
	print '����ָ��B0010501,��ָ��B0010501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010501','�ż���ҽ�Ʒ������루����ҩƷ���Ĳġ����������룩','select "B0010501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12413','','','1','1','0','FACT_FY_MZ_FYFX','ghfy+cffy','[{\"dim_key\":\"dxmkey\",\"relation\":\"0\",\"caliber\":\"0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68\"}]','timekey,yykey,kskey','','select "B0010501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.177: B0010502******************HD_ZBMX_HZ***B0010502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010502')
begin
	print '����ָ��B0010502,��ָ��B0010502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010502') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010502','סԺҽ�Ʒ������루����ҩƷ���Ĳġ����������룩','select "B0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12414','','','1','1','0','FACT_FY_ZY_FYFX','zfy','[{\"dim_key\":\"dxmkey\",\"relation\":\"0\",\"caliber\":\"0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71\"}]','timekey,yykey,kskey','','select "B0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.178: B002******************HD_ZBMX_HZ***B002******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002')
begin
	print '����ָ��B002,��ָ��B002�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002','ҩƷ�ܷ���','-1','select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey','-1','select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00201,B00202','11519','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey','@�ż���ҩƷ����(B00201)+@סԺҩƷ����(B00202)','select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.179: B005******************HD_ZBMX_HZ***B005******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B005')
begin
	print '����ָ��B005,��ָ��B005�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B005') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B005','�������Ϸ���','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00501"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00502"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00501"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00502"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00501,B00502','11618','-1','-1','0','-1','-1','-1','-1','-1','-1','@�ż����������Ϸ���(B00501)+@סԺ�������Ϸ���(B00502)','select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00501"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00502"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.180: B009******************HD_ZBMX_HZ***B009******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B009')
begin
	print '����ָ��B009,��ָ��B009�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B009') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B009','����������','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum() fz from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum() fz from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B003"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B004"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B003"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B004"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B003,B004','11633','-1','-1','0','-1','-1','-1','-1','-1','-1','@������(B003)+@�������(B004)','select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B003"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B004"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.181: B004******************HD_ZBMX_HZ***B004******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B004')
begin
	print '����ָ��B004,��ָ��B004�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B004') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B004','�������','-1','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey','-1','select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00401"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00402"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00401"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00401,B00402','11613','-1','-1','0','-1','-1','-1','-1','-1','-1','@�ż���������(B00401)+@סԺ�������(B00402)','select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00401"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.182: B00204******************HD_ZBMX_HZ***B00204******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00204')
begin
	print '����ָ��B00204,��ָ��B00204�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00204') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00204','����ҩƷ�ܷ���ռ��','-1','select timekey,yykey,kskey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey','-1','select "B00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00203" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00203" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00203,B002','12420','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@����ҩƷ�ܷ���(B00203)/@ҩƷ�ܷ���(B002)','select "B00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00203" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.183: B00203******************HD_ZBMX_HZ***B00203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00203')
begin
	print '����ָ��B00203,��ָ��B00203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00203') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00203','����ҩƷ�ܷ���','-1','select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey','-1','select "B00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020301" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020302" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020301" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020302" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B0020301,B0020302','12419','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey','@�ż��︨��ҩƷ�ܷ���(B0020301)+@סԺ����ҩƷ�ܷ���(B0020302)','select "B00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020301" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020302" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.184: B0020301******************HD_ZBMX_HZ***B0020301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0020301')
begin
	print '����ָ��B0020301,��ָ��B0020301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0020301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0020301','�ż��︨��ҩƷ�ܷ���','select "B0020301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12417','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"fzypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "B0020301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.185: B002030101******************HD_ZBMX_HZ***B002030101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002030101')
begin
	print '����ָ��B002030101,��ָ��B002030101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002030101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002030101','���︨��ҩƷ�ܷ���','select "B002030101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002030101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002030101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12553','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"fzypbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "B002030101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.186: B002030102******************HD_ZBMX_HZ***B002030102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002030102')
begin
	print '����ָ��B002030102,��ָ��B002030102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002030102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002030102','���︨��ҩƷ�ܷ���','select "B002030102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (2) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002030102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002030102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12554','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"fzypbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey','','select "B002030102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.187: B0020302******************HD_ZBMX_HZ***B0020302******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0020302')
begin
	print '����ָ��B0020302,��ָ��B0020302�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0020302') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0020302','סԺ����ҩƷ�ܷ���','select "B0020302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12418','','','0','1','0','FACT_YP_ZY_FYFX','ypfy','[{\"dim_key\":\"fzypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "B0020302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.188: ZLZB_YY009202******************HD_ZBMX_HZ***ZLZB_YY009202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009202')
begin
	print '����ָ��ZLZB_YY009202,��ָ��ZLZB_YY009202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY009202','��Ա֧��ռҵ��֧������','','','','select "ZLZB_YY009202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0092" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY009202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0092" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY009201,ZLZB_YY0092','12421','','','0','-1','-1','','','','','@��Ա����֧��(ZLZB_YY009201)/@ҵ����֧��(ZLZB_YY0092)','select "ZLZB_YY009202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0092" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.189: ZLZB_YY009201******************HD_ZBMX_HZ***ZLZB_YY009201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009201')
begin
	print '����ָ��ZLZB_YY009201,��ָ��ZLZB_YY009201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009201') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY009201'

end
go

/************No.190: ZLZB_YY0092******************HD_ZBMX_HZ***ZLZB_YY0092******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0092')
begin
	print '����ָ��ZLZB_YY0092,��ָ��ZLZB_YY0092�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0092') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0092'

end
go

/************No.191: ZLZB_YY009204******************HD_ZBMX_HZ***ZLZB_YY009204******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009204')
begin
	print '����ָ��ZLZB_YY009204,��ָ��ZLZB_YY009204�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009204') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY009204'

end
go

/************No.192: ZLZB_YY009203******************HD_ZBMX_HZ***ZLZB_YY009203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009203')
begin
	print '����ָ��ZLZB_YY009203,��ָ��ZLZB_YY009203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009203') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY009203'

end
go

/************No.193: B000******************HD_ZBMX_HZ***B000******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B000')
begin
	print '����ָ��B000,��ָ��B000�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B000') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B000','������','','','','select "B000" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B303" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B306" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B312" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B309" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B000" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B303" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B306" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B312" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B309" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B001,B303,B306,B312,B309','13164','','','0','-1','-1','','','','','@ҽԺ�ܷ���(B001)+@����������������(B303)+@��������(B306)+@�ƽ���Ŀ����(B312)+@������Ŀ֧����������(B309)','select "B000" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B303" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B306" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B312" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B309" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.194: ZLZB_YY0093******************HD_ZBMX_HZ***ZLZB_YY0093******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0093')
begin
	print '����ָ��ZLZB_YY0093,��ָ��ZLZB_YY0093�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0093') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0093','��֧����','','','','select "ZLZB_YY0093" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B321" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B301" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B308" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B311" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0093" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B321" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B301" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B308" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B311" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B301,B308,B311','13165','','','0','-1','-1','','','','','@ҵ����֧����(B301)+@������Ŀ������֧��ת���ࣩ(B308)+@�ƽ���Ŀ��֧��ת���ࣩ(B311)','select "ZLZB_YY0093" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B321" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B301" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B308" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B311" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.195: B301******************HD_ZBMX_HZ***B301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B301')
begin
	print '����ָ��B301,��ָ��B301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B301','ҵ����֧����','','','','select "B301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B321" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B306" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B307" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B321" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B306" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B307" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B321,B306,B307','-1','','','0','-1','-1','','','','','@ҽ����֧����(B321)+@��������(B306)-@����֧��(B307)','select "B301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B321" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B306" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B307" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.196: B303******************HD_ZBMX_HZ***B303******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B303')
begin
	print '����ָ��B303,��ָ��B303�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B303') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B303'

end
go

/************No.197: B304******************HD_ZBMX_HZ***B304******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B304')
begin
	print '����ָ��B304,��ָ��B304�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B304') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B304'

end
go

/************No.198: B305******************HD_ZBMX_HZ***B305******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B305')
begin
	print '����ָ��B305,��ָ��B305�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B305') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B305'

end
go

/************No.199: B306******************HD_ZBMX_HZ***B306******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B306')
begin
	print '����ָ��B306,��ָ��B306�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B306') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B306'

end
go

/************No.200: B307******************HD_ZBMX_HZ***B307******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B307')
begin
	print '����ָ��B307,��ָ��B307�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B307') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B307'

end
go

/************No.201: B308******************HD_ZBMX_HZ***B308******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B308')
begin
	print '����ָ��B308,��ָ��B308�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B308') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B308','������Ŀ������֧��ת���ࣩ','','','','select "B308" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B309" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B310" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B308" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B309" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B310" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B309,B310','-1','','','0','-1','-1','','','','','@������Ŀ֧����������(B309)-@������Ŀ����֧��(B310)','select "B308" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B309" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B310" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.202: B309******************HD_ZBMX_HZ***B309******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B309')
begin
	print '����ָ��B309,��ָ��B309�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B309') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B309'

end
go

/************No.203: B310******************HD_ZBMX_HZ***B310******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B310')
begin
	print '����ָ��B310,��ָ��B310�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B310') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B310'

end
go

/************No.204: B311******************HD_ZBMX_HZ***B311******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B311')
begin
	print '����ָ��B311,��ָ��B311�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B311') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B311','�ƽ���Ŀ��֧��ת���ࣩ','','','','select "B311" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B312" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B313" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B311" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B312" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B313" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B312,B313','13162','','','0','-1','-1','','','','','@�ƽ���Ŀ����(B312)-@�ƽ���Ŀ֧��(B313)','select "B311" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B312" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B313" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.205: B312******************HD_ZBMX_HZ***B312******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B312')
begin
	print '����ָ��B312,��ָ��B312�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B312') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B312'

end
go

/************No.206: B313******************HD_ZBMX_HZ***B313******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B313')
begin
	print '����ָ��B313,��ָ��B313�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B313') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B313'

end
go

/************No.207: ZLZB_YY0041******************HD_ZBMX_HZ***ZLZB_YY0041******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0041')
begin
	print '����ָ��ZLZB_YY0041,��ָ��ZLZB_YY0041�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0041') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0041','�ʲ���ծ��','','','','select "ZLZB_YY0041" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY004102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY004101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0041" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY004102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY004101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY004102,ZLZB_YY004101','0','','','0','-1','-1','','','','','@��ծ�ܶ�(ZLZB_YY004102)/@�ʲ��ܶ�(ZLZB_YY004101)','select "ZLZB_YY0041" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY004102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY004101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.208: ZLZB_YY004101******************HD_ZBMX_HZ***ZLZB_YY004101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY004101')
begin
	print '����ָ��ZLZB_YY004101,��ָ��ZLZB_YY004101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY004101') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY004101'

end
go

/************No.209: ZLZB_YY004102******************HD_ZBMX_HZ***ZLZB_YY004102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY004102')
begin
	print '����ָ��ZLZB_YY004102,��ָ��ZLZB_YY004102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY004102') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY004102'

end
go

/************No.210: B317******************HD_ZBMX_HZ***B317******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B317')
begin
	print '����ָ��B317,��ָ��B317�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B317') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb B317'

end
go

/************No.211: B316******************HD_ZBMX_HZ***B316******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B316')
begin
	print '����ָ��B316,��ָ��B316�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B316') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B316','�������ҽ��Ŀ¼��̸����ҩ������','-1','select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey','-1','select "B316" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B314" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B315" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B316" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B314,B315','12998','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey','@�ż����������ҽ��Ŀ¼��̸����ҩ������(B314)/@סԺ�������ҽ��Ŀ¼��̸����ҩ������(B315)','select "B316" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.212: B314******************HD_ZBMX_HZ***B314******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B314')
begin
	print '����ָ��B314,��ָ��B314�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B314') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B314','�ż����������ҽ��Ŀ¼��̸����ҩ������','select "B314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12996','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"tpypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey','','select "B314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.213: B315******************HD_ZBMX_HZ***B315******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B315')
begin
	print '����ָ��B315,��ָ��B315�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B315') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B315','סԺ�������ҽ��Ŀ¼��̸����ҩ������','select "B315" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "B315" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "B315" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','12997','','','0','1','0','FACT_YP_ZY_FYFX','ypfy','[{\"dim_key\":\"tpypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey','','select "B315" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','','')
	
end
go

/************No.214: B318******************HD_ZBMX_HZ***B318******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B318')
begin
	print '����ָ��B318,��ָ��B318�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B318') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B318','�޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩','-1','select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey','-1','select "B318" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0010201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B314" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0010202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B315" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B318" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0010201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0010202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B319,B320','13157','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey','@�ż����޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩(B319)+@סԺ�޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩(B320)','select "B318" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0010201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0010202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.215: B319******************HD_ZBMX_HZ***B319******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B319')
begin
	print '����ָ��B319,��ָ��B319�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B319') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B319','�ż����޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩','-1','select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey','-1','select "B319" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0010201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B314" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B319" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0010201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00101,E0010201,B314','13155','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey','@�ż������(B00101)-@ �ż����в�ҩ����(E0010201)-@�ż����������ҽ��Ŀ¼��̸����ҩ������(B314)','select "B319" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0010201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.216: B320******************HD_ZBMX_HZ***B320******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B320')
begin
	print '����ָ��B320,��ָ��B320�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B320') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B320','סԺ�޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩','-1','select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey','-1','select "B320" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0010202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B315" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B320" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0010202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','-1','B00102,E0010202,B315','13156','-1','-1','0','-1','-1','-1','-1','-1','timekey,yykey,kskey,yskey','@סԺ����(B00102)-@סԺ�в�ҩ����(E0010202)-@סԺ�������ҽ��Ŀ¼��̸����ҩ������(B315)','select "B320" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0010202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','-1','-1')
	
end
go

/************No.217: B10101******************HD_ZBMX_HZ***B10101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10101')
begin
	print '����ָ��B10101,��ָ��B10101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10101','������η�','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','','select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0010101,A00101','12605','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey','@�������(B0010101)/@�����˴�(A00101)','select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.218: B0010101******************HD_ZBMX_HZ***B0010101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0010101')
begin
	print '����ָ��B0010101,��ָ��B0010101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0010101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0010101','�������','select "B0010101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0010101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10078','','','0','1','0','FACT_FY_MZ_FYFX','ghfy+cffy','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey','','select "B0010101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.219: B10301******************HD_ZBMX_HZ***B10301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B10301')
begin
	print '����ָ��B10301,��ָ��B10301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B10301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B10301','����ҩƷ���η�','','select timekey,yykey,kskey,yskey,mjzkey,ybflkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey','','select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0020101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0020101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B0020101,A00101','12616','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,mjzkey,ybflkey','@����ҩƷ����(B0020101)/@�����˴�(A00101)','select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0020101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.220: B0020101******************HD_ZBMX_HZ***B0020101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B0020101')
begin
	print '����ָ��B0020101,��ָ��B0020101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B0020101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B0020101','����ҩƷ����','select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','10082','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey','','select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.221: B102******************HD_ZBMX_HZ***B102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B102')
begin
	print '����ָ��B102,��ָ��B102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B102','סԺ���η�','','select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey','','select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00102,A102','11472','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey','@סԺ����(B00102)/@��Ժ�˴�(A102)','select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.222: B104******************HD_ZBMX_HZ***B104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B104')
begin
	print '����ָ��B104,��ָ��B104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B104','סԺҩƷ����ҩ��','','select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey union all select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey','','select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B00202,A102','11474','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey','@סԺҩƷ����(B00202)/@��Ժ�˴�(A102)','select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.223: B00202******************HD_ZBMX_HZ***B00202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B00202')
begin
	print '����ָ��B00202,��ָ��B00202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B00202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B00202','סԺҩƷ����','select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (','select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey','select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey','1','','','10084','','','0','1','0','FACT_YP_ZY_FYFX','ypfy','','timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey','','select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey','-1','')
	
end
go

/************No.224: ZLZB_YY00040102******************HD_ZBMX_HZ***ZLZB_YY00040102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040102')
begin
	print '����ָ��ZLZB_YY00040102,��ָ��ZLZB_YY00040102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040102','��������������Առ��','','','','select "ZLZB_YY00040102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY00040101,ZLZB_YY000401','12422','','','0','-1','-1','','','','','@��������������Ա����(ZLZB_YY00040101)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY00040102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.225: ZLZB_YY0004010201******************HD_ZBMX_HZ***ZLZB_YY0004010201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0004010201')
begin
	print '����ָ��ZLZB_YY0004010201,��ָ��ZLZB_YY0004010201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0004010201') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0004010201'

end
go

/************No.226: ZLZB_YY000401******************HD_ZBMX_HZ***ZLZB_YY000401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000401')
begin
	print '����ָ��ZLZB_YY000401,��ָ��ZLZB_YY000401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000401') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000401'

end
go

/************No.227: ZLZB_YY00040104******************HD_ZBMX_HZ***ZLZB_YY00040104******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040104')
begin
	print '����ָ��ZLZB_YY00040104,��ָ��ZLZB_YY00040104�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040104') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040104','�м�����������Առ��','','','','select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY00040103,ZLZB_YY000401','12423','','','0','-1','-1','','','','','@�м�����������Ա����(ZLZB_YY00040103)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.228: ZLZB_YY0004010203******************HD_ZBMX_HZ***ZLZB_YY0004010203******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0004010203')
begin
	print '����ָ��ZLZB_YY0004010203,��ָ��ZLZB_YY0004010203�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0004010203') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0004010203'

end
go

/************No.229: ZLZB_YY00040106******************HD_ZBMX_HZ***ZLZB_YY00040106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040106')
begin
	print '����ָ��ZLZB_YY00040106,��ָ��ZLZB_YY00040106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040106','���߼�����������Առ��','','','','select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040105" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040105" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY00040105,ZLZB_YY000401','12424','','','0','-1','-1','','','','','@���߼�����������Ա����(ZLZB_YY00040105)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040105" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.230: ZLZB_YY0004010205******************HD_ZBMX_HZ***ZLZB_YY0004010205******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0004010205')
begin
	print '����ָ��ZLZB_YY0004010205,��ָ��ZLZB_YY0004010205�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0004010205') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0004010205'

end
go

/************No.231: ZLZB_YY00040108******************HD_ZBMX_HZ***ZLZB_YY00040108******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040108')
begin
	print '����ָ��ZLZB_YY00040108,��ָ��ZLZB_YY00040108�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040108') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040108','�߼�����������Առ��','','','','select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040107" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040107" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY00040107,ZLZB_YY000401','12425','','','0','-1','-1','','','','','@�߼�����������Ա����(ZLZB_YY00040107)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040107" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.232: ZLZB_YY00040107******************HD_ZBMX_HZ***ZLZB_YY00040107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040107')
begin
	print '����ָ��ZLZB_YY00040107,��ָ��ZLZB_YY00040107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040107') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY00040107'

end
go

/************No.233: ZLZB_YY005801******************HD_ZBMX_HZ***ZLZB_YY005801******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY005801')
begin
	print '����ָ��ZLZB_YY005801,��ָ��ZLZB_YY005801�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY005801') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY005801','���������ơ���֢����������ҽҽʦռ��','','','','select "ZLZB_YY005801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0058" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY005801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0058" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0058,ZLZB_YY0005','13148','','','0','-1','-1','','','','','@ҽԺע������������ơ���֢����������ҽ�ڸ�ҽʦ��(ZLZB_YY0058)/@����������Ա����ҽʦ��(ZLZB_YY0005)','select "ZLZB_YY005801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0058" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.234: ZLZB_YY0058******************HD_ZBMX_HZ***ZLZB_YY0058******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0058')
begin
	print '����ָ��ZLZB_YY0058,��ָ��ZLZB_YY0058�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0058') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0058'

end
go

/************No.235: ZLZB_YY000501******************HD_ZBMX_HZ***ZLZB_YY000501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000501')
begin
	print '����ָ��ZLZB_YY000501,��ָ��ZLZB_YY000501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000501','����ҽʦ��Առ��','','','','select "ZLZB_YY000501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0057" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY000501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0057" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0057,ZLZB_YY0005','12426','','','0','-1','-1','','','','','@����ҽʦ��Ա(ZLZB_YY0057)/@����������Ա����ҽʦ��(ZLZB_YY0005)','select "ZLZB_YY000501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0057" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.236: ZLZB_YY0057******************HD_ZBMX_HZ***ZLZB_YY0057******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0057')
begin
	print '����ָ��ZLZB_YY0057,��ָ��ZLZB_YY0057�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0057') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0057'

end
go

/************No.237: ZLZB_YY000503******************HD_ZBMX_HZ***ZLZB_YY000503******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000503')
begin
	print '����ָ��ZLZB_YY000503,��ָ��ZLZB_YY000503�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000503') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000503','����ҽʦ��Առ��','','','','select "ZLZB_YY000503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000502" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY000503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY000502,ZLZB_YY0005','12427','','','0','-1','-1','','','','','@����ҽʦ��Ա(ZLZB_YY000502)/@����������Ա����ҽʦ��(ZLZB_YY0005)','select "ZLZB_YY000503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.238: ZLZB_YY000502******************HD_ZBMX_HZ***ZLZB_YY000502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000502')
begin
	print '����ָ��ZLZB_YY000502,��ָ��ZLZB_YY000502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000502') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000502'

end
go

/************No.239: ZLZB_YY000504******************HD_ZBMX_HZ***ZLZB_YY000504******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000504')
begin
	print '����ָ��ZLZB_YY000504,��ָ��ZLZB_YY000504�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000504') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000504','��֢ҽʦ��Առ��','','','','select "ZLZB_YY000504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0052" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY000504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0052" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0052,ZLZB_YY0005','12428','','','0','-1','-1','','','','','@��֢ҽѧ��ҽʦ��(ZLZB_YY0052)/@����������Ա����ҽʦ��(ZLZB_YY0005)','select "ZLZB_YY000504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0052" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.240: ZLZB_YY0052******************HD_ZBMX_HZ***ZLZB_YY0052******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0052')
begin
	print '����ָ��ZLZB_YY0052,��ָ��ZLZB_YY0052�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0052') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0052'

end
go

/************No.241: ZLZB_YY000505******************HD_ZBMX_HZ***ZLZB_YY000505******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000505')
begin
	print '����ָ��ZLZB_YY000505,��ָ��ZLZB_YY000505�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000505') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000505','����ҽʦ��Առ��','','','','select "ZLZB_YY000505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_ZLGL_LCBL001" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY000505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_ZLGL_LCBL001,ZLZB_YY0005','12429','','','0','-1','-1','','','','','@����ҽʦ��(ZLZB_ZLGL_LCBL001)/@����������Ա����ҽʦ��(ZLZB_YY0005)','select "ZLZB_YY000505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.242: ZLZB_ZLGL_LCBL001******************HD_ZBMX_HZ***ZLZB_ZLGL_LCBL001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL001')
begin
	print '����ָ��ZLZB_ZLGL_LCBL001,��ָ��ZLZB_ZLGL_LCBL001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_ZLGL_LCBL001') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_ZLGL_LCBL001'

end
go

/************No.243: ZLZB_YY000507******************HD_ZBMX_HZ***ZLZB_YY000507******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000507')
begin
	print '����ָ��ZLZB_YY000507,��ָ��ZLZB_YY000507�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000507') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY000507','��ҽʦ��Առ��','','','','select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000506" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000506" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY000506,ZLZB_YY0005','12430','','','0','-1','-1','','','','','@��ҽʦ��Ա(ZLZB_YY000506)/@����������Ա����ҽʦ��(ZLZB_YY0005)','select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000506" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.244: ZLZB_YY000506******************HD_ZBMX_HZ***ZLZB_YY000506******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000506')
begin
	print '����ָ��ZLZB_YY000506,��ָ��ZLZB_YY000506�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000506') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY000506'

end
go

/************No.245: ZLZB_YY00040109******************HD_ZBMX_HZ***ZLZB_YY00040109******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040109')
begin
	print '����ָ��ZLZB_YY00040109,��ָ��ZLZB_YY00040109�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040109') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00040109','ҽ����','','','','select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0006" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0006" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0005,ZLZB_YY0006','12431','','','0','-1','-1','','','','','@����������Ա����ҽʦ��(ZLZB_YY0005)/@����������Ա����������Ա��(ZLZB_YY0006)','select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0006" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.246: ZLZB_YY0006******************HD_ZBMX_HZ***ZLZB_YY0006******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0006')
begin
	print '����ָ��ZLZB_YY0006,��ָ��ZLZB_YY0006�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0006') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0006'

end
go

/************No.247: ZLZB_YY0094******************HD_ZBMX_HZ***ZLZB_YY0094******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0094')
begin
	print '����ָ��ZLZB_YY0094,��ָ��ZLZB_YY0094�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0094') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0094','ҽԺ��������ҽԺ������Կ�֧ԮҽԺ��ҽ������ҽԺ�����޲�����ԭҽԺ������������ռ��','','','','select "ZLZB_YY0094" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009402" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0112" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0094" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009402" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0112" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY009402,ZLZB_YY0112','13149','','','0','-1','-1','','','','','@ҽԺ��������ҽԺ������Կ�֧ԮҽԺ��ҽ������ҽԺ�����޲�����ԭҽԺ������������(ZLZB_YY009402)/@ҽԺͬ�����ս���������(ZLZB_YY0112)','select "ZLZB_YY0094" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009402" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0112" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.248: ZLZB_YY0106******************HD_ZBMX_HZ***ZLZB_YY0106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0106')
begin
	print '����ָ��ZLZB_YY0106,��ָ��ZLZB_YY0106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0106') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0106'

end
go

/************No.249: ZLZB_YY0107******************HD_ZBMX_HZ***ZLZB_YY0107******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0107')
begin
	print '����ָ��ZLZB_YY0107,��ָ��ZLZB_YY0107�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0107') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0107'

end
go

/************No.250: ZLZB_YY0108******************HD_ZBMX_HZ***ZLZB_YY0108******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0108')
begin
	print '����ָ��ZLZB_YY0108,��ָ��ZLZB_YY0108�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0108') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0108'

end
go

/************No.251: ZLZB_YY0109******************HD_ZBMX_HZ***ZLZB_YY0109******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0109')
begin
	print '����ָ��ZLZB_YY0109,��ָ��ZLZB_YY0109�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0109') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0109'

end
go

/************No.252: ZLZB_YY0110******************HD_ZBMX_HZ***ZLZB_YY0110******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0110')
begin
	print '����ָ��ZLZB_YY0110,��ָ��ZLZB_YY0110�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0110') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0110'

end
go

/************No.253: ZLZB_YY0111******************HD_ZBMX_HZ***ZLZB_YY0111******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0111')
begin
	print '����ָ��ZLZB_YY0111,��ָ��ZLZB_YY0111�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0111') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0111'

end
go

/************No.254: ZLZB_YY0112******************HD_ZBMX_HZ***ZLZB_YY0112******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0112')
begin
	print '����ָ��ZLZB_YY0112,��ָ��ZLZB_YY0112�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0112') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0112'

end
go

/************No.255: ZLZB_YY0095******************HD_ZBMX_HZ***ZLZB_YY0095******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0095')
begin
	print '����ָ��ZLZB_YY0095,��ָ��ZLZB_YY0095�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0095') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0095','ҽԺסԺҽʦ�״βμ�ҽʦ�ʸ���ͨ����','','','','select "ZLZB_YY0095" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009502" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009501" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0095" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009501" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY009502,ZLZB_YY009501','0','','','0','-1','-1','','','','','@ҽԺסԺҽʦ�״βμ�ҽʦ�ʸ���ͨ������(ZLZB_YY009502)/@ҽԺסԺҽʦ�״βμ�ҽʦ�ʸ�������(ZLZB_YY009501)','select "ZLZB_YY0095" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009501" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.256: ZLZB_YY009502******************HD_ZBMX_HZ***ZLZB_YY009502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009502')
begin
	print '����ָ��ZLZB_YY009502,��ָ��ZLZB_YY009502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009502') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY009502'

end
go

/************No.257: ZLZB_YY009501******************HD_ZBMX_HZ***ZLZB_YY009501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009501')
begin
	print '����ָ��ZLZB_YY009501,��ָ��ZLZB_YY009501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009501') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY009501'

end
go

/************No.258: ZLZB_YY0113******************HD_ZBMX_HZ***ZLZB_YY0113******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0113')
begin
	print '����ָ��ZLZB_YY0113,��ָ��ZLZB_YY0113�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0113') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0113','ҽԺ��ҽѧ�˲���������ľ���Ͷ��ռ��','','','','select "ZLZB_YY0113" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00920101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0117" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0113" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00920101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0117" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY00920101,ZLZB_YY0117','13152','','','0','-1','-1','','','','','@ҽѧ�˲���������(ZLZB_YY00920101)/@ҽԺ�����ܾ���֧��(ZLZB_YY0117)','select "ZLZB_YY0113" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00920101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0117" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.259: ZLZB_YY00920101******************HD_ZBMX_HZ***ZLZB_YY00920101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00920101')
begin
	print '����ָ��ZLZB_YY00920101,��ָ��ZLZB_YY00920101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00920101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY00920101','ҽѧ�˲���������','','','','select "ZLZB_YY00920101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0114" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0115" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0116" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY00920101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0114" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0115" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0116" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0114,ZLZB_YY0115,ZLZB_YY0116','13151','','','0','-1','-1','','','','','@����ԺУ��ѧ����Ͷ��(ZLZB_YY0114)+@��ҵ��ҽѧ��������Ͷ��(ZLZB_YY0115)+@����ҽѧ��������Ͷ��(ZLZB_YY0116)','select "ZLZB_YY00920101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0114" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0115" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0116" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.260: ZLZB_YY0114******************HD_ZBMX_HZ***ZLZB_YY0114******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0114')
begin
	print '����ָ��ZLZB_YY0114,��ָ��ZLZB_YY0114�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0114') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0114'

end
go

/************No.261: ZLZB_YY0115******************HD_ZBMX_HZ***ZLZB_YY0115******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0115')
begin
	print '����ָ��ZLZB_YY0115,��ָ��ZLZB_YY0115�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0115') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0115'

end
go

/************No.262: ZLZB_YY0116******************HD_ZBMX_HZ***ZLZB_YY0116******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0116')
begin
	print '����ָ��ZLZB_YY0116,��ָ��ZLZB_YY0116�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0116') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0116'

end
go

/************No.263: ZLZB_YY0117******************HD_ZBMX_HZ***ZLZB_YY0117******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0117')
begin
	print '����ָ��ZLZB_YY0117,��ָ��ZLZB_YY0117�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0117') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0117','ҽԺ�����ܾ���֧��','','','','select "ZLZB_YY0117" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B304" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B313" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0117" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B304" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B313" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','B304,B313','-1','','','0','-1','-1','','','','','@ҽ��֧����ҽ��ҵ��ɱ���(B304)+@�ƽ���Ŀ֧��(B313)','select "ZLZB_YY0117" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B304" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B313" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.264: ZLZB_YY0096******************HD_ZBMX_HZ***ZLZB_YY0096******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0096')
begin
	print '����ָ��ZLZB_YY0096,��ָ��ZLZB_YY0096�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0096') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0096','�ٴ����̽�ʦ��ָ��ҽʦ���ܽ�����ѧ��ѵ�˴���','','','','select "ZLZB_YY0096" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0118" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0119" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0096" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0118" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0119" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0118,ZLZB_YY0119','-1','','','0','-1','-1','','','','','@������ѧ��ѵ�˴���(ZLZB_YY0118)+@ȡ��ʡ��������ʦ����ѵ�ϸ�֤�������(ZLZB_YY0119)','select "ZLZB_YY0096" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0118" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0119" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.265: ZLZB_YY0118******************HD_ZBMX_HZ***ZLZB_YY0118******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0118')
begin
	print '����ָ��ZLZB_YY0118,��ָ��ZLZB_YY0118�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0118') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0118'

end
go

/************No.266: ZLZB_YY0119******************HD_ZBMX_HZ***ZLZB_YY0119******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0119')
begin
	print '����ָ��ZLZB_YY0119,��ָ��ZLZB_YY0119�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0119') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0119'

end
go

/************No.267: ZLZB_YY0097******************HD_ZBMX_HZ***ZLZB_YY0097******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0097')
begin
	print '����ָ��ZLZB_YY0097,��ָ��ZLZB_YY0097�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0097') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0097','�е�ҽѧ����������','','','','select "ZLZB_YY0097" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0120" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0121" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0122" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0097" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0120" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0121" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0122" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY0120,ZLZB_YY0121,ZLZB_YY0122','-1','','','0','-1','-1','','','','','@ҽԺרְ����ԺУҽѧ��������(ZLZB_YY0120)+@��ҵ��ҽѧ��������(ZLZB_YY0121)+@����ҽѧ��������(ZLZB_YY0122)','select "ZLZB_YY0097" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0120" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0121" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0122" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.268: ZLZB_YY0120******************HD_ZBMX_HZ***ZLZB_YY0120******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0120')
begin
	print '����ָ��ZLZB_YY0120,��ָ��ZLZB_YY0120�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0120') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0120'

end
go

/************No.269: ZLZB_YY0121******************HD_ZBMX_HZ***ZLZB_YY0121******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0121')
begin
	print '����ָ��ZLZB_YY0121,��ָ��ZLZB_YY0121�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0121') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0121'

end
go

/************No.270: ZLZB_YY0122******************HD_ZBMX_HZ***ZLZB_YY0122******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0122')
begin
	print '����ָ��ZLZB_YY0122,��ָ��ZLZB_YY0122�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0122') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0122'

end
go

/************No.271: ZLZB_YY0098******************HD_ZBMX_HZ***ZLZB_YY0098******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0098')
begin
	print '����ָ��ZLZB_YY0098,��ָ��ZLZB_YY0098�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0098') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0098'

end
go

/************No.272: ZLZB_YY0099******************HD_ZBMX_HZ***ZLZB_YY0099******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0099')
begin
	print '����ָ��ZLZB_YY0099,��ָ��ZLZB_YY0099�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0099') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0099','ÿ��������������Ա������Ŀ����','','','','select "ZLZB_YY0099" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009901" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0099" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009901" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY009901,ZLZB_YY000401','0','','','0','-1','-1','','','','','@������Ŀ����*100(ZLZB_YY009901)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY0099" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009901" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.273: ZLZB_YY009901******************HD_ZBMX_HZ***ZLZB_YY009901******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009901')
begin
	print '����ָ��ZLZB_YY009901,��ָ��ZLZB_YY009901�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009901') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY009901'

end
go

/************No.274: ZLZB_YY0100******************HD_ZBMX_HZ***ZLZB_YY0100******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0100')
begin
	print '����ָ��ZLZB_YY0100,��ָ��ZLZB_YY0100�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0100') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZLZB_YY0100','ÿ��������������Ա���гɹ�ת�����','','','','select "ZLZB_YY0100" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY010001" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZLZB_YY0100" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY010001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZLZB_YY010001,ZLZB_YY000401','0','','','0','-1','-1','','','','','@���гɹ�ת�����*100(ZLZB_YY010001)/@����������Ա����(ZLZB_YY000401)','select "ZLZB_YY0100" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY010001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.275: ZLZB_YY010001******************HD_ZBMX_HZ***ZLZB_YY010001******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010001')
begin
	print '����ָ��ZLZB_YY010001,��ָ��ZLZB_YY010001�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY010001') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY010001'

end
go

/************No.276: ZLZB_YY0101******************HD_ZBMX_HZ***ZLZB_YY0101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0101')
begin
	print '����ָ��ZLZB_YY0101,��ָ��ZLZB_YY0101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0101') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb ZLZB_YY0101'

end
go

/************No.277: F501******************HD_ZBMX_HZ***F501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F501')
begin
	print '����ָ��F501,��ָ��F501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F501') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb F501'

end
go

/************No.278: F502******************HD_ZBMX_HZ***F502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F502')
begin
	print '����ָ��F502,��ָ��F502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F502') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb F502'

end
go

/************No.279: F503******************HD_ZBMX_HZ***F503******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='F503')
begin
	print '����ָ��F503,��ָ��F503�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='F503') 
begin 
	print 'This table HD_ZBMX_HZ  do not have the zb F503'

end
go

/************No.280: G00501******************HD_ZBMX_HZ***G00501******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='G00501')
begin
	print '����ָ��G00501,��ָ��G00501�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='G00501') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('G00501','����ҩƷ�շ��˴�','select "G00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12318','','','0','1','0','FACT_YY_MZ_JZRC','yprc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,yskey','','select "G00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.281: G00502******************HD_ZBMX_HZ***G00502******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='G00502')
begin
	print '����ָ��G00502,��ָ��G00502�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='G00502') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('G00502','����ҩƷ�շ��˴�','select "G00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "G00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12319','','','0','1','0','FACT_YY_MZ_JZRC','yprc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey','','select "G00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.282: ZBZL_YXZB_DRGS0020505******************HD_ZBMX_HZ***ZBZL_YXZB_DRGS0020505******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020505')
begin
	print '����ָ��ZBZL_YXZB_DRGS0020505,��ָ��ZBZL_YXZB_DRGS0020505�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020505') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZBZL_YXZB_DRGS0020505','�еͷ���DRG��������','','select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz,0 fm from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey union all select timekey,yykey,kskey,yskey,drgskey,0 fz,sum(rzls) fm from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey','','select "ZBZL_YXZB_DRGS0020505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZBZL_YXZB_DRGS0020201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZBZL_YXZB_DRGS00202" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "ZBZL_YXZB_DRGS0020505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS0020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','ZBZL_YXZB_DRGS0020201,ZBZL_YXZB_DRGS00202','0','','','0','-1','-1','','','','timekey,yykey,kskey,yskey,drgskey','@�еͷ�������������(ZBZL_YXZB_DRGS0020201)/@�еͷ���DRG����������(ZBZL_YXZB_DRGS00202)','select "ZBZL_YXZB_DRGS0020505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS0020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.283: ZBZL_YXZB_DRGS0020201******************HD_ZBMX_HZ***ZBZL_YXZB_DRGS0020201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020201')
begin
	print '����ָ��ZBZL_YXZB_DRGS0020201,��ָ��ZBZL_YXZB_DRGS0020201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('ZBZL_YXZB_DRGS0020201','�еͷ�������������','select "ZBZL_YXZB_DRGS0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZBZL_YXZB_DRGS0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "ZBZL_YXZB_DRGS0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','13166','','','0','1','0','FACT_GZ_YXZB_DRGS','swls','[{\"dim_key\":\"fxpgdjkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey,yskey,drgskey','','select "ZBZL_YXZB_DRGS0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.284: E3110201******************HD_ZBMX_HZ***E3110201******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E3110201')
begin
	print '����ָ��E3110201,��ָ��E3110201�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E3110201') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E3110201','����ʹ����ҩע���ҩ���˴�','select "E3110201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E3110201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E3110201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12597','','','0','1','0','FACT_YY_MZ_JZRC','zcyzsjrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "E3110201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.285: A1021101******************HD_ZBMX_HZ***A1021101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021101')
begin
	print '����ָ��A1021101,��ָ��A1021101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021101','סԺ������ҩ������Һʹ���˴�','select "A1021101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A1021101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "A1021101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12603','','','0','1','0','FACT_YY_ZY_CYYWLFX','zsjywsyrc','[{\"dim_key\":\"zcybz\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey,zlzkey','','select "A1021101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.286: A1021102******************HD_ZBMX_HZ***A1021102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='A1021102')
begin
	print '����ָ��A1021102,��ָ��A1021102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='A1021102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('A1021102','סԺ������ҩ������Һʹ����','','select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey union all select timekey,yykey,kskey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zlzkey','','select "A1021102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A1021101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "A1021102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A1021101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','A1021101,A102','12604','','','0','-1','-1','','','','timekey,yykey,kskey,zlzkey','@סԺ������ҩ������Һʹ���˴�(A1021101)/@��Ժ�˴�(A102)','select "A1021102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A1021101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','')
	
end
go

/************No.287: E2030105******************HD_ZBMX_HZ***E2030105******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E2030105')
begin
	print '����ָ��E2030105,��ָ��E2030105�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E2030105') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E2030105','����ʹ����ҩע����(%)','','select timekey,yykey,kskey,yskey,sum(zcyzsjrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey','','select "E2030105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E3110201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E2030105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E3110201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E3110201,A00101','12600','','','0','-1','-1','','','','timekey,yykey,kskey,yskey','@����ʹ����ҩע���ҩ���˴�(E3110201)/@�����˴�(A00101)','select "E2030105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E3110201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.288: E2030106******************HD_ZBMX_HZ***E2030106******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E2030106')
begin
	print '����ָ��E2030106,��ָ��E2030106�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E2030106') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E2030106','����ʹ����ҩע����(%)','','select timekey,yykey,kskey,ybflkey,sum(zcyzsjrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ybflkey union all select timekey,yykey,kskey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) and mjzkey in (2) group by timekey,yykey,kskey,ybflkey','','select "E2030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E3110202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E2030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E3110202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E3110202,A00102','12601','','','0','-1','-1','','','','timekey,yykey,kskey,ybflkey','@����ʹ����ҩע���ҩ���˴�(E3110202)/@�����˴�(A00102)','select "E2030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E3110202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.289: E31102******************HD_ZBMX_HZ***E31102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E31102')
begin
	print '����ָ��E31102,��ָ��E31102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E31102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E31102','�ż���ʹ����ҩע���ҩ���˴�','select "E31102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,mjzkey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E31102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E31102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12599','','','0','1','0','FACT_YY_MZ_JZRC','zcyzsjrc','','timekey,yykey,kskey,mjzkey','','select "E31102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.290: E3110202******************HD_ZBMX_HZ***E3110202******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E3110202')
begin
	print '����ָ��E3110202,��ָ��E3110202�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E3110202') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E3110202','����ʹ����ҩע���ҩ���˴�','select "E3110202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E3110202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E3110202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12598','','','0','1','0','FACT_YY_MZ_JZRC','zcyzsjrc','[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey','','select "E3110202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.291: E0030402******************HD_ZBMX_HZ***E0030402******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0030402')
begin
	print '����ָ��E0030402,��ָ��E0030402�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0030402') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0030402','�ż���ʹ����ѡҩ��Ʒ����ռҩ��Ʒ����������','','select timekey,yykey,kskey,idm fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0) union all select timekey,yykey,kskey,0 fz,idm fm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))','','select "E0030402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0030401" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey','select "E0030402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0030401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','1','','E0030401,E001','11712','','','0','-1','-1','','','','timekey,yykey,kskey','@�ż���ʹ����ѡҩ��Ʒ����(E0030401)/@ҩ��Ʒ������(������ҩ)(E001)','select "E0030402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0030401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey','','0')
	
end
go

/************No.292: E0030401******************HD_ZBMX_HZ***E0030401******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='E0030401')
begin
	print '����ָ��E0030401,��ָ��E0030401�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='E0030401') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('E0030401','�ż���ʹ����ѡҩ��Ʒ����','select "E0030401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,idm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0)',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0030401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,idm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "E0030401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,idm from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','11704','','','0','0','0','FACT_YP_MZ_FYFX','idm','[{\"dim_key\":\"jbywbz\",\"relation\":\"0\",\"caliber\":\"0\"}]','timekey,yykey,kskey','','select "E0030401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,idm from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','0')
	
end
go

/************No.293: B002090101******************HD_ZBMX_HZ***B002090101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002090101')
begin
	print '����ָ��B002090101,��ָ��B002090101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002090101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002090101','����ҩƷ���루������ҩ��Ƭ�����촦��ҩƷ��','select "B002090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) and dxmkey not in (4) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12670','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"yscfbz\",\"relation\":\"0\",\"caliber\":\"0\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"dxmkey\",\"relation\":\"1\",\"caliber\":\"4\"}]','timekey,yykey,kskey','','select "B002090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','ypfy-zyfy_ypcyzj','')
	
end
go

/************No.294: B001090101******************HD_ZBMX_HZ***B001090101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B001090101')
begin
	print '����ָ��B001090101,��ָ��B001090101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B001090101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B001090101','����ҽ�����루������ҩ��Ƭ�����촦��ҩƷ��','select "B001090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ghfy cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1 group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B001090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B001090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12666','','','0','1','-1','FACT_FY_MZ_FYFX','sum(ghfy cffy-yscffy) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1','timekey,yykey,kskey','','select "B001090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.295: B001090102******************HD_ZBMX_HZ***B001090102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B001090102')
begin
	print '����ָ��B001090102,��ָ��B001090102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B001090102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B001090102','����ҽ�����루������ҩ��Ƭ�����촦��ҩƷ��','select "B001090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ghfy cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2 group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B001090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B001090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12667','','','0','1','-1','FACT_FY_MZ_FYFX','sum(ghfy cffy-yscffy) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2','timekey,yykey,kskey','','select "B001090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.296: B001090301******************HD_ZBMX_HZ***B001090301******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B001090301')
begin
	print '����ָ��B001090301,��ָ��B001090301�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B001090301') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B001090301','����ҽ�����루�������촦����','select "B001090301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B001090301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B001090301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12678','','','0','1','-1','FACT_FY_MZ_FYFX','sum(zfy-yscffy) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1','timekey,yykey,kskey','','select "B001090301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.297: B001090302******************HD_ZBMX_HZ***B001090302******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B001090302')
begin
	print '����ָ��B001090302,��ָ��B001090302�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B001090302') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B001090302','����ҽ�����루�������촦����','select "B001090302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B001090302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B001090302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12679','','','0','1','-1','FACT_FY_MZ_FYFX','sum(zfy-yscffy) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2','timekey,yykey,kskey','','select "B001090302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.298: B002010601******************HD_ZBMX_HZ***B002010601******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002010601')
begin
	print '����ָ��B002010601,��ָ��B002010601�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002010601') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002010601','���ﴦ�����루�������촦����','select "B002010601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002010601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002010601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12690','','','0','1','-1','FACT_FY_MZ_FYFX','sum(cffy-yscffy) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1','timekey,yykey,kskey','','select "B002010601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.299: B002010602******************HD_ZBMX_HZ***B002010602******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002010602')
begin
	print '����ָ��B002010602,��ָ��B002010602�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002010602') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002010602','���ﴦ�����루�������촦����','select "B002010602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002010602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002010602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12691','','','0','1','-1','FACT_FY_MZ_FYFX','sum(cffy-yscffy) fz','where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2','timekey,yykey,kskey','','select "B002010602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','1')
	
end
go

/************No.300: B002090102******************HD_ZBMX_HZ***B002090102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002090102')
begin
	print '����ָ��B002090102,��ָ��B002090102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002090102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002090102','����ҩƷ���루������ҩ��Ƭ�����촦��ҩƷ��','select "B002090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) and dxmkey not in (4) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12671','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"yscfbz\",\"relation\":\"0\",\"caliber\":\"0\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"},{\"dim_key\":\"dxmkey\",\"relation\":\"1\",\"caliber\":\"4\"}]','timekey,yykey,kskey','','select "B002090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','ypfy-zyfy_ypcyzj','')
	
end
go

/************No.301: B002100101******************HD_ZBMX_HZ***B002100101******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002100101')
begin
	print '����ָ��B002100101,��ָ��B002100101�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002100101') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002100101','����ҩƷ���루�������촦����','select "B002100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12683','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"yscfbz\",\"relation\":\"0\",\"caliber\":\"0\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]','timekey,yykey,kskey','','select "B002100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go

/************No.302: B002100102******************HD_ZBMX_HZ***B002100102******************************/

if exists(select 1 from HD_ZBMX_HZ where zb_id='B002100102')
begin
	print '����ָ��B002100102,��ָ��B002100102�Ѵ����ڱ�HD_ZBMX_HZ��,��˲�!'
end
if not exists(select 1 from HD_ZBMX_HZ where zb_id='B002100102') 
begin 
	INSERT HD_ZBMX_HZ ( zb_id,zb_name,sql_start,sql_middle,sql_end,sql_text,tqsql_text,jlzt,memo,dependindex,orderno,sql_text_first,proc_name,zbzt,ysfs,kslx,fact_table,fact_dlz,condition,kxwdz,gspz,hqsql_text,dlzgs,dylx)
	values('B002100102','����ҩƷ���루�������촦����','select "B002100102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (','select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) group by timekey,yykey,kskey',') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002100102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")','select "B002100102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")','1','','','12684','','','0','1','0','FACT_YP_MZ_FYFX','ypfy','[{\"dim_key\":\"yscfbz\",\"relation\":\"0\",\"caliber\":\"0\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]','timekey,yykey,kskey','','select "B002100102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")','','')
	
end
go


/*********No.1: A32001******HD_ZBMX_HZ***A32001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A32001')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='A00101,A102'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�����˴�(A00101)/@��Ժ�˴�(A102)'
,hqsql_text='select "A32001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey'
,memo='-1'
,orderno='12398'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(ghrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey union all select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey'
,sql_start='-1'
,sql_text='select "A32001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "A32001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A32001'
,zb_name='�����˴������Ժ�˴�����'
,zbzt='0'
 where zb_id='A32001'
end
go

/*********No.2: A00101******HD_ZBMX_HZ***A00101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey'
,memo=''
,orderno='10001'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey'
,sql_start='select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,hourkey,yykey,kskey,yskey,ybflkey,ghlbkey,yyfskey,nldkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00101'
,zb_name='�����˴�'
,zbzt='0'
 where zb_id='A00101'
end
go

/*********No.3: A102******HD_ZBMX_HZ***A102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ybflkey,cyfskey'
,memo=''
,orderno='10056'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey'
,sql_start='select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,cyfskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A102'
,zb_name='��Ժ�˴�'
,zbzt='0'
 where zb_id='A102'
end
go

/*********No.4: A321******HD_ZBMX_HZ***A321*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A321')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A32101,A32102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@������ת�����˴���(A32101)+@סԺ��ת�����˴���(A32102)'
,hqsql_text='select "A321" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='0'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "A321" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A321" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A321'
,zb_name='��ת�����˴�����'
,zbzt='0'
 where zb_id='A321'
end
go

/*********No.6: A32102******HD_ZBMX_HZ***A32102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A32102')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"lyfskey\",\"relation\":\"0\",\"caliber\":\"3\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "A32102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and lyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12399'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and lyfskey in (3) group by timekey,yykey,kskey'
,sql_start='select "A32102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A32102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and lyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A32102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and lyfskey in (3) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A32102'
,zb_name='סԺ��ת�����˴���'
,zbzt='0'
 where zb_id='A32102'
end
go

/*********No.7: BA_D0025******HD_ZBMX_HZ***BA_D0025*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0025')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='BA_D0023,BA_D0024'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ռ�����̨�������ռ�����������(BA_D0023)/@��Ժ��������������̨��������Ժ����������������(BA_D0024)'
,hqsql_text='select "BA_D0025" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0023" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0024" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo='-1'
,orderno='12899'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='-1'
,sql_text='select "BA_D0025" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0023" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0024" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "BA_D0025" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0023" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0024" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='BA_D0025'
,zb_name='�ռ���������ռ����������������'
,zbzt='0'
 where zb_id='BA_D0025'
end
go

/*********No.8: BA_D0023******HD_ZBMX_HZ***BA_D0023*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0023')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"rjssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0023" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12897'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0023" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0023" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0023" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and rjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0023'
,zb_name='�ռ�����̨�������ռ�����������'
,zbzt='0'
 where zb_id='BA_D0023'
end
go

/*********No.9: BA_D0024******HD_ZBMX_HZ***BA_D0024*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0024')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zqssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0024" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12898'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0024" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0024" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0024" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zqssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0024'
,zb_name='��Ժ��������������'
,zbzt='0'
 where zb_id='BA_D0024'
end
go

/*********No.10: BA_D0028******HD_ZBMX_HZ***BA_D0028*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0028')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='BA_D0026,BA_D0027'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@��Ժ��������(BA_D0026)/@��Ժ����(BA_D0027)'
,hqsql_text='select "BA_D0028" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0027" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo='-1'
,orderno='12902'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey'
,sql_start='-1'
,sql_text='select "BA_D0028" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0026" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0027" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "BA_D0028" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0027" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='BA_D0028'
,zb_name='��Ժ��������ռ��'
,zbzt='0'
 where zb_id='BA_D0028'
end
go

/*********No.11: BA_D0026******HD_ZBMX_HZ***BA_D0026*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0026')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0026" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12900'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0026" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0026" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0026" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0026'
,zb_name='��Ժ��������'
,zbzt='0'
 where zb_id='BA_D0026'
end
go

/*********No.12: BA_D0027******HD_ZBMX_HZ***BA_D0027*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0027')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12901'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0027'
,zb_name='��Ժ����'
,zbzt='0'
 where zb_id='BA_D0027'
end
go

/*********No.13: BA_D0030******HD_ZBMX_HZ***BA_D0030*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0030')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='BA_D0029,BA_D0026'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@΢����������(BA_D0029)/@��Ժ��������(BA_D0026)'
,hqsql_text='select "BA_D0030" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0029" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo='-1'
,orderno='12904'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='-1'
,sql_text='select "BA_D0030" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0029" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0026" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "BA_D0030" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0029" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='BA_D0030'
,zb_name='��Ժ����΢������ռ��'
,zbzt='0'
 where zb_id='BA_D0030'
end
go

/*********No.14: BA_D0029******HD_ZBMX_HZ***BA_D0029*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0029')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"wcssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0029" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12903'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0029" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0029" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0029" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and wcssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0029'
,zb_name='΢����������'
,zbzt='0'
 where zb_id='BA_D0029'
end
go

/*********No.15: BA_D0032******HD_ZBMX_HZ***BA_D0032*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0032')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='BA_D0031,BA_D0026'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@��Ժ�ļ�������������(BA_D0031)/@��Ժ��������(BA_D0026)'
,hqsql_text='select "BA_D0032" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0031" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo='-1'
,orderno='12906'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='-1'
,sql_text='select "BA_D0032" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0031" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0026" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "BA_D0032" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0031" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='BA_D0032'
,zb_name='��Ժ�����ļ���������'
,zbzt='0'
 where zb_id='BA_D0032'
end
go

/*********No.16: BA_D0031******HD_ZBMX_HZ***BA_D0031*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0031')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"sjssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0031" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12905'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0031" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0031" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0031" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and sjssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0031'
,zb_name='��Ժ�ļ�������������'
,zbzt='0'
 where zb_id='BA_D0031'
end
go

/*********No.17: A32201******HD_ZBMX_HZ***A32201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A32201')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='A322,A323'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����ҽ�Ʒ�����(A322)/@ҽ�Ʒ�����(A323)'
,hqsql_text='select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A322" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A323" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12520'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(txylfwrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A322" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A323" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "A32201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A322" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A323" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A32201'
,zb_name='����ҽ�Ʒ�����ռ��'
,zbzt='0'
 where zb_id='A32201'
end
go

/*********No.18: A322******HD_ZBMX_HZ***A322*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A322')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='A32202,A32203'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż�������ҽ�Ʒ�����(A32202)+@סԺ����ҽ�Ʒ�����(A32203)'
,hqsql_text='select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A32203" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12884'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A32203" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "A322" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A32203" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A322'
,zb_name='����ҽ�Ʒ�����'
,zbzt='0'
 where zb_id='A322'
end
go

/*********No.19: A32202******HD_ZBMX_HZ***A32202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A32202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='txylfwrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "A32202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A32202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A32202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A32202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A32202'
,zb_name='�������ﻼ���˴���'
,zbzt='0'
 where zb_id='A32202'
end
go

/*********No.20: A32203******HD_ZBMX_HZ***A32203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A32203')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"txbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A32203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey'
,sql_start='select "A32203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A32203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A32203" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and txbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A32203'
,zb_name='��Ժ������������ҽ�Ʒ����˴���'
,zbzt='0'
 where zb_id='A32203'
end
go

/*********No.21: A323******HD_ZBMX_HZ***A323*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A323')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='A00101,A102'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�����˴�(A00101)+@��Ժ�˴�(A102)'
,hqsql_text='select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey'
,memo='-1'
,orderno='13000'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(ghrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey union all select timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey,sum(-cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,sexkey,yblxkey'
,sql_start='-1'
,sql_text='select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "A323" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A323'
,zb_name='ҽ�Ʒ�����'
,zbzt='0'
 where zb_id='A323'
end
go

/*********No.22: B10901******HD_ZBMX_HZ***B10901*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10901')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B109,B001'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����ҽ�Ʒ�������(B109)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select "B10901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B109" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12519'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(txylfwfy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(txylfwfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "B10901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B109" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B10901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B109" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B10901'
,zb_name='����ҽ�Ʒ�������ռ��'
,zbzt='0'
 where zb_id='B10901'
end
go

/*********No.23: B109******HD_ZBMX_HZ***B109*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B109')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B10902,B10903'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż�������ҽ�Ʒ�������(B10902)+@סԺ����ҽ�Ʒ�������(B10903)'
,hqsql_text='select "B109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B10902" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B10903" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='13039'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "B109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B10902" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B10903" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B10902" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B10903" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B109'
,zb_name='����ҽ�Ʒ�������'
,zbzt='0'
 where zb_id='B109'
end
go

/*********No.24: B10902******HD_ZBMX_HZ***B10902*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10902')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='txylfwfy'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B10902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "B10902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B10902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B10902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B10902'
,zb_name='�����ż���ҽ�Ʒ�������'
,zbzt='0'
 where zb_id='B10902'
end
go

/*********No.25: B10903******HD_ZBMX_HZ***B10903*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10903')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='txylfwfy'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select "B10903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "B10903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B10903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B10903" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(txylfwfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B10903'
,zb_name='סԺ������������ҽ�Ʒ�������'
,zbzt='0'
 where zb_id='B10903'
end
go

/*********No.26: B001******HD_ZBMX_HZ***B001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B001')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00101,B00102'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż������(B00101)+@סԺ����(B00102)'
,hqsql_text='select ''B001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,0 fm,null czry,getdate() gxrq ,bqkey from ( select yykey,yydm,kskey,ksdm,month,fz_hq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00101'' and month between @kssj and @jssj   union all select yykey,yydm,kskey,ksdm,month,fz_hq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00102'' and month between @kssj and @jssj  )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='-1'
,memo='-1'
,orderno='11518'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select ''B001'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz ,0 fm,null czry,getdate() gxrq ,bqkey from ( select yykey,yydm,kskey,ksdm,month,fz_tq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00101'' and month between @kssj and @jssj   union all select yykey,yydm,kskey,ksdm,month,fz_tq fz,0 fm  ,bqkey from FACT_RESULT_KS_VALUE_M  where zbmx_id =''B00102'' and month between @kssj and @jssj  )t group by yykey,yydm,kskey,ksdm,month ,bqkey'
,ysfs='-1'
,zb_id='B001'
,zb_name='ҽԺ�ܷ���'
,zbzt='0'
 where zb_id='B001'
end
go

/*********No.27: BA_D0034******HD_ZBMX_HZ***BA_D0034*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0034')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='BA_D0033,BA_D0026'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�������߲���֢��������(BA_D0033)/@��Ժ��������(BA_D0026)'
,hqsql_text='select "BA_D0034" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0033" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo='-1'
,orderno='12908'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='-1'
,sql_text='select "BA_D0034" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0033" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0026" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "BA_D0034" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0033" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0026" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='BA_D0034'
,zb_name='�������߲���֢������'
,zbzt='0'
 where zb_id='BA_D0034'
end
go

/*********No.28: BA_D0033******HD_ZBMX_HZ***BA_D0033*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0033')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ssbfzbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0033" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12907'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0033" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0033" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0033" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ssbfzbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0033'
,zb_name='�������߲���֢��������'
,zbzt='0'
 where zb_id='BA_D0033'
end
go

/*********No.29: BA_D0037******HD_ZBMX_HZ***BA_D0037*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0037')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='BA_D0036,BA_D0035'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@I���п�������λ��Ⱦ�˴���(BA_D0036)/@I���п�����̨����(BA_D0035)'
,hqsql_text='select "BA_D0037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0036" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="BA_D0035" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo='-1'
,orderno='12911'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz,0 fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey union all select timekey,yykey,kskey,cyfskey,0 fz,sum(cyrs) fm from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='-1'
,sql_text='select "BA_D0037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0036" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="BA_D0035" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "BA_D0037" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0036" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="BA_D0035" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='BA_D0037'
,zb_name='I���п�������λ��Ⱦ��'
,zbzt='0'
 where zb_id='BA_D0037'
end
go

/*********No.30: BA_D0036******HD_ZBMX_HZ***BA_D0036*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0036')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ylssgrbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12910'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0036" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssgrbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0036'
,zb_name='I���п�������λ��Ⱦ�˴���'
,zbzt='0'
 where zb_id='BA_D0036'
end
go

/*********No.31: BA_D0035******HD_ZBMX_HZ***BA_D0035*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='BA_D0035')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ylssbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrs'
,fact_table='FACT_BA_CYYWLFX'
,gspz=''
,hqsql_text='select "BA_D0035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,cyfskey'
,memo=''
,orderno='12909'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey'
,sql_start='select "BA_D0035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "BA_D0035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "BA_D0035" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,cyfskey,sum(cyrs) fz from FACT_BA_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ylssbz in (1) group by timekey,yykey,kskey,cyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='BA_D0035'
,zb_name='I���п�����̨����'
,zbzt='0'
 where zb_id='BA_D0035'
end
go

/*********No.32: JXHK_DBZ004******HD_ZBMX_HZ***JXHK_DBZ004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ004')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXHK_DBZ004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,jxkhdbzkey'
,memo=''
,orderno='12916'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,jxkhdbzkey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey'
,sql_start='select "JXHK_DBZ004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXHK_DBZ004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXHK_DBZ004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXHK_DBZ004'
,zb_name='�������ܷ���'
,zbzt='0'
 where zb_id='JXHK_DBZ004'
end
go

/*********No.33: JXHK_DBZ005******HD_ZBMX_HZ***JXHK_DBZ005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ005')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='JXHK_DBZ007,JXHK_DBZ001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��������ǰ��סԺ����(JXHK_DBZ007)/@����������(JXHK_DBZ001)'
,hqsql_text='select "JXHK_DBZ005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXHK_DBZ007" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXHK_DBZ001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,jxkhdbzkey'
,memo=''
,orderno='12924'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey union all select timekey,yykey,kskey,jxkhdbzkey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey'
,sql_start=''
,sql_text='select "JXHK_DBZ005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXHK_DBZ007" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXHK_DBZ001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "JXHK_DBZ005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXHK_DBZ007" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXHK_DBZ001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXHK_DBZ005'
,zb_name='��������ǰƽ��סԺ����'
,zbzt='0'
 where zb_id='JXHK_DBZ005'
end
go

/*********No.34: JXHK_DBZ007******HD_ZBMX_HZ***JXHK_DBZ007*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ007')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='sqddts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXHK_DBZ007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,jxkhdbzkey'
,memo=''
,orderno='12923'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey'
,sql_start='select "JXHK_DBZ007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXHK_DBZ007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXHK_DBZ007" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(sqddts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXHK_DBZ007'
,zb_name='��������ǰ��סԺ����'
,zbzt='0'
 where zb_id='JXHK_DBZ007'
end
go

/*********No.35: JXHK_DBZ006******HD_ZBMX_HZ***JXHK_DBZ006*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ006')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXHK_DBZ006" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ypfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,jxkhdbzkey'
,memo=''
,orderno='12918'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,jxkhdbzkey,sum(ypfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey'
,sql_start='select "JXHK_DBZ006" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXHK_DBZ006" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ypfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXHK_DBZ006" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ypfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXHK_DBZ006'
,zb_name='��������ҩ��'
,zbzt='0'
 where zb_id='JXHK_DBZ006'
end
go

/*********No.36: JXHK_DBZ001******HD_ZBMX_HZ***JXHK_DBZ001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ001')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXHK_DBZ001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,jxkhdbzkey'
,memo=''
,orderno='12912'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,jxkhdbzkey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey'
,sql_start='select "JXHK_DBZ001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXHK_DBZ001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXHK_DBZ001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXHK_DBZ001'
,zb_name='����������'
,zbzt='0'
 where zb_id='JXHK_DBZ001'
end
go

/*********No.37: JXHK_DBZ002******HD_ZBMX_HZ***JXHK_DBZ002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ002')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXHK_DBZ002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,jxkhdbzkey'
,memo=''
,orderno='12914'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,jxkhdbzkey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey'
,sql_start='select "JXHK_DBZ002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXHK_DBZ002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXHK_DBZ002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXHK_DBZ002'
,zb_name='��������������'
,zbzt='0'
 where zb_id='JXHK_DBZ002'
end
go

/*********No.38: JXHK_DBZ003******HD_ZBMX_HZ***JXHK_DBZ003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXHK_DBZ003')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXHK_DBZ003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,jxkhdbzkey'
,memo=''
,orderno='12915'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey'
,sql_start='select "JXHK_DBZ003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXHK_DBZ003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXHK_DBZ003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXHK_DBZ003'
,zb_name='��������סԺ����'
,zbzt='0'
 where zb_id='JXHK_DBZ003'
end
go

/*********No.39: JXKH_DBZ100******HD_ZBMX_HZ***JXKH_DBZ100*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ100')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ100" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12913'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ100" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ100" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ100" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ100'
,zb_name='�����ļ�������������'
,zbzt='0'
 where zb_id='JXKH_DBZ100'
end
go

/*********No.40: JXKH_DBZ101******HD_ZBMX_HZ***JXKH_DBZ101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ101')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ102,JXKH_DBZ103'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�����ļ�������Ժ����ռ���ܴ�����(JXKH_DBZ102)/@�����ļ������ܳ�Ժ����(JXKH_DBZ103)'
,hqsql_text='select "JXKH_DBZ101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12927'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ103" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ101'
,zb_name='�����ļ�����ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ101'
end
go

/*********No.41: JXKH_DBZ102******HD_ZBMX_HZ***JXKH_DBZ102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ102')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey,jxkhdbzkey'
,memo=''
,orderno='12919'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey'
,sql_start='select "JXKH_DBZ102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,jxkhdbzkey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey,jxkhdbzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ102'
,zb_name='�����ļ�������Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ102'
end
go

/*********No.42: JXKH_DBZ103******HD_ZBMX_HZ***JXKH_DBZ103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ103')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12926'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ103'
,zb_name='�����ļ������ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ103'
end
go

/*********No.43: JXKH_DBZ104******HD_ZBMX_HZ***JXKH_DBZ104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ104')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ105,JXKH_DBZ100'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�����ļ������ܳ�Ժ����(JXKH_DBZ105)/@�����ļ�������������(JXKH_DBZ100)'
,hqsql_text='select "JXKH_DBZ104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ105" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ100" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12986'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ105" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ100" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ105" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ100" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ104'
,zb_name='�����ļ������ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ104'
end
go

/*********No.44: JXKH_DBZ105******HD_ZBMX_HZ***JXKH_DBZ105*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ105')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ105" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12928'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ105" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ105" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ105" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ105'
,zb_name='�����ļ������ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ105'
end
go

/*********No.45: JXKH_DBZ107******HD_ZBMX_HZ***JXKH_DBZ107*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ107')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ108,JXKH_DBZ100'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�����ļ�������������(JXKH_DBZ108)/@�����ļ�������������(JXKH_DBZ100)'
,hqsql_text='select "JXKH_DBZ107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ108" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ100" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12931'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ108" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ100" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ107" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ108" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ100" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ107'
,zb_name='�����ļ�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ107'
end
go

/*********No.46: JXKH_DBZ108******HD_ZBMX_HZ***JXKH_DBZ108*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ108')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ108" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12930'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ108" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ108" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ108" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (1) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ108'
,zb_name='�����ļ�������������'
,zbzt='0'
 where zb_id='JXKH_DBZ108'
end
go

/*********No.47: JXKH_DBZ200******HD_ZBMX_HZ***JXKH_DBZ200*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ200')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"12\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ200" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12932'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ200" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ200" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ200" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ200'
,zb_name='����˥�߲�������'
,zbzt='0'
 where zb_id='JXKH_DBZ200'
end
go

/*********No.48: JXKH_DBZ201******HD_ZBMX_HZ***JXKH_DBZ201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ201')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ202,JXKH_DBZ200'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����˥�߳�Ժ����ռ���ܴ�����(JXKH_DBZ202)/@����˥�߲�������(JXKH_DBZ200)'
,hqsql_text='select "JXKH_DBZ201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12934'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ200" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ201'
,zb_name='����˥��ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ201'
end
go

/*********No.49: JXKH_DBZ202******HD_ZBMX_HZ***JXKH_DBZ202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ202')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"12\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12933'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ202'
,zb_name='����˥�߳�Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ202'
end
go

/*********No.50: JXKH_DBZ204******HD_ZBMX_HZ***JXKH_DBZ204*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ204')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ205,JXKH_DBZ200'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����˥���ܳ�Ժ����(JXKH_DBZ205)/@����˥�߲�������(JXKH_DBZ200)'
,hqsql_text='select "JXKH_DBZ204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ205" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12987'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ205" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ200" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ205" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ204'
,zb_name='����˥�ߴξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ204'
end
go

/*********No.51: JXKH_DBZ205******HD_ZBMX_HZ***JXKH_DBZ205*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ205')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"12\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12935'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ205" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ205'
,zb_name='����˥���ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ205'
end
go

/*********No.52: JXKH_DBZ207******HD_ZBMX_HZ***JXKH_DBZ207*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ207')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ208,JXKH_DBZ200'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����˥����������(JXKH_DBZ208)/@����˥�߲�������(JXKH_DBZ200)'
,hqsql_text='select "JXKH_DBZ207" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ208" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12937'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ207" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ208" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ200" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ207" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ208" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ200" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ207'
,zb_name='����˥�߲�����'
,zbzt='0'
 where zb_id='JXKH_DBZ207'
end
go

/*********No.53: JXKH_DBZ208******HD_ZBMX_HZ***JXKH_DBZ208*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ208')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"12\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12936'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ208" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (12) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ208'
,zb_name='����˥����������'
,zbzt='0'
 where zb_id='JXKH_DBZ208'
end
go

/*********No.54: JXKH_DBZ300******HD_ZBMX_HZ***JXKH_DBZ300*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ300')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12938'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ300'
,zb_name='���ף�סԺ�����ˣ���������'
,zbzt='0'
 where zb_id='JXKH_DBZ300'
end
go

/*********No.55: JXKH_DBZ301******HD_ZBMX_HZ***JXKH_DBZ301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ301')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ302,JXKH_DBZ300'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���ף�סԺ�����ˣ���Ժ����ռ���ܴ�����(JXKH_DBZ302)/@���ף�סԺ�����ˣ���������(JXKH_DBZ300)'
,hqsql_text='select "JXKH_DBZ301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ302" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12940'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ302" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ300" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ302" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ301'
,zb_name='���ף�סԺ�����ˣ�ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ301'
end
go

/*********No.56: JXKH_DBZ302******HD_ZBMX_HZ***JXKH_DBZ302*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ302')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12939'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ302'
,zb_name='���ף�סԺ�����ˣ���Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ302'
end
go

/*********No.57: JXKH_DBZ304******HD_ZBMX_HZ***JXKH_DBZ304*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ304')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ305,JXKH_DBZ300'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���ף�סԺ�����ˣ��ܳ�Ժ����(JXKH_DBZ305)/@���ף�סԺ�����ˣ���������(JXKH_DBZ300)'
,hqsql_text='select "JXKH_DBZ304" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ305" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12988'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ304" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ305" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ300" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ304" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ305" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ304'
,zb_name='���ף�סԺ�����ˣ��ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ304'
end
go

/*********No.58: JXKH_DBZ305******HD_ZBMX_HZ***JXKH_DBZ305*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ305')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ305" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12941'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ305" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ305" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ305" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ305'
,zb_name='���ף�סԺ�����ˣ��ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ305'
end
go

/*********No.59: JXKH_DBZ307******HD_ZBMX_HZ***JXKH_DBZ307*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ307')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ308,JXKH_DBZ300'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���ף�סԺ�����ˣ���������(JXKH_DBZ308)/@���ף�סԺ�����ˣ���������(JXKH_DBZ300)'
,hqsql_text='select "JXKH_DBZ307" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ308" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12943'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ307" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ308" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ300" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ307" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ308" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ300" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ307'
,zb_name='���ף�סԺ�����ˣ�������'
,zbzt='0'
 where zb_id='JXKH_DBZ307'
end
go

/*********No.60: JXKH_DBZ308******HD_ZBMX_HZ***JXKH_DBZ308*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ308')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"3\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12942'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (3) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ308'
,zb_name='���ף�סԺ�����ˣ���������'
,zbzt='0'
 where zb_id='JXKH_DBZ308'
end
go

/*********No.61: JXKH_DBZ400******HD_ZBMX_HZ***JXKH_DBZ400*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ400')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"7\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ400" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12944'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ400" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ400" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ400" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ400'
,zb_name='���ף�סԺ����ͯ����������'
,zbzt='0'
 where zb_id='JXKH_DBZ400'
end
go

/*********No.62: JXKH_DBZ401******HD_ZBMX_HZ***JXKH_DBZ401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ401')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ402,JXKH_DBZ400'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���ף�סԺ����ͯ����Ժ����ռ���ܴ�����(JXKH_DBZ402)/@���ף�סԺ����ͯ����������(JXKH_DBZ400)'
,hqsql_text='select "JXKH_DBZ401" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ402" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12946'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ401" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ402" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ400" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ401" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ402" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ401'
,zb_name='���ף�סԺ����ͯ��ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ401'
end
go

/*********No.63: JXKH_DBZ402******HD_ZBMX_HZ***JXKH_DBZ402*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ402')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"7\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12945'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ402" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ402'
,zb_name='���ף�סԺ����ͯ����Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ402'
end
go

/*********No.64: JXKH_DBZ404******HD_ZBMX_HZ***JXKH_DBZ404*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ404')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ405,JXKH_DBZ400'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���ף�סԺ����ͯ���ܳ�Ժ����(JXKH_DBZ405)/@���ף�סԺ����ͯ����������(JXKH_DBZ400)'
,hqsql_text='select "JXKH_DBZ404" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ405" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12989'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ404" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ405" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ400" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ404" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ405" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ404'
,zb_name='���ף�סԺ����ͯ���ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ404'
end
go

/*********No.65: JXKH_DBZ405******HD_ZBMX_HZ***JXKH_DBZ405*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ405')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"7\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ405" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12947'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ405" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ405" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ405" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ405'
,zb_name='���ף�סԺ����ͯ���ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ405'
end
go

/*********No.66: JXKH_DBZ407******HD_ZBMX_HZ***JXKH_DBZ407*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ407')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ408,JXKH_DBZ400'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���ף�סԺ����ͯ����������(JXKH_DBZ408)/@���ף�סԺ����ͯ����������(JXKH_DBZ400)'
,hqsql_text='select "JXKH_DBZ407" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ408" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12949'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ407" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ408" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ400" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ407" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ408" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ400" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ407'
,zb_name='���ף�סԺ����ͯ��������'
,zbzt='0'
 where zb_id='JXKH_DBZ407'
end
go

/*********No.67: JXKH_DBZ408******HD_ZBMX_HZ***JXKH_DBZ408*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ408')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"7\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ408" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12948'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ408" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ408" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ408" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (7) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ408'
,zb_name='���ף�סԺ����ͯ����������'
,zbzt='0'
 where zb_id='JXKH_DBZ408'
end
go

/*********No.68: JXKH_DBZ500******HD_ZBMX_HZ***JXKH_DBZ500*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ500')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"4\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ500" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12950'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ500" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ500" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ500" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ500'
,zb_name='�Թ�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ500'
end
go

/*********No.69: JXKH_DBZ501******HD_ZBMX_HZ***JXKH_DBZ501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ501')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ502,JXKH_DBZ500'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�Թ�����Ժ����ռ���ܴ�����(JXKH_DBZ502)/@�Թ�����������(JXKH_DBZ500)'
,hqsql_text='select "JXKH_DBZ501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12952'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ502" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ500" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ501'
,zb_name='�Թ���ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ501'
end
go

/*********No.70: JXKH_DBZ502******HD_ZBMX_HZ***JXKH_DBZ502*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ502')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"4\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12951'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ502'
,zb_name='�Թ�����Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ502'
end
go

/*********No.71: JXKH_DBZ504******HD_ZBMX_HZ***JXKH_DBZ504*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ504')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ505,JXKH_DBZ500'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�Թ����ܳ�Ժ����(JXKH_DBZ505)/@�Թ�����������(JXKH_DBZ500)'
,hqsql_text='select "JXKH_DBZ504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ505" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12990'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ505" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ500" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ505" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ504'
,zb_name='�Թ����ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ504'
end
go

/*********No.72: JXKH_DBZ505******HD_ZBMX_HZ***JXKH_DBZ505*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ505')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"4\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ505" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12953'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ505" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ505" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ505" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ505'
,zb_name='�Թ����ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ505'
end
go

/*********No.73: JXKH_DBZ507******HD_ZBMX_HZ***JXKH_DBZ507*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ507')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ508,JXKH_DBZ500'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�Թ�����������(JXKH_DBZ508)/@�Թ�����������(JXKH_DBZ500)'
,hqsql_text='select "JXKH_DBZ507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ508" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12955'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ508" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ500" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ508" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ500" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ507'
,zb_name='�Թ���������'
,zbzt='0'
 where zb_id='JXKH_DBZ507'
end
go

/*********No.74: JXKH_DBZ508******HD_ZBMX_HZ***JXKH_DBZ508*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ508')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"4\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ508" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12954'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ508" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ508" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ508" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (4) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ508'
,zb_name='�Թ�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ508'
end
go

/*********No.75: JXKH_DBZ600******HD_ZBMX_HZ***JXKH_DBZ600*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ600')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ600" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12956'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ600" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ600" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ600" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ600'
,zb_name='�Źؽ��û�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ600'
end
go

/*********No.76: JXKH_DBZ601******HD_ZBMX_HZ***JXKH_DBZ601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ601')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ602,JXKH_DBZ600'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�Źؽ��û�����Ժ����ռ���ܴ�����(JXKH_DBZ602)/@�Źؽ��û�����������(JXKH_DBZ600)'
,hqsql_text='select "JXKH_DBZ601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ602" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12958'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ602" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ600" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ602" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ601'
,zb_name='�Źؽ��û���ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ601'
end
go

/*********No.77: JXKH_DBZ602******HD_ZBMX_HZ***JXKH_DBZ602*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ602')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12957'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ602'
,zb_name='�Źؽ��û�����Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ602'
end
go

/*********No.78: JXKH_DBZ604******HD_ZBMX_HZ***JXKH_DBZ604*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ604')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ605,JXKH_DBZ600'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�Źؽ��û����ܳ�Ժ����(JXKH_DBZ605)/@�Źؽ��û�����������(JXKH_DBZ600)'
,hqsql_text='select "JXKH_DBZ604" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ605" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12991'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ604" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ605" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ600" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ604" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ605" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ604'
,zb_name='�Źؽ��û����ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ604'
end
go

/*********No.79: JXKH_DBZ605******HD_ZBMX_HZ***JXKH_DBZ605*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ605')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ605" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12959'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ605" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ605" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ605" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ605'
,zb_name='�Źؽ��û����ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ605'
end
go

/*********No.80: JXKH_DBZ607******HD_ZBMX_HZ***JXKH_DBZ607*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ607')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ608,JXKH_DBZ600'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�Źؽ��û�����������(JXKH_DBZ608)/@�Źؽ��û�����������(JXKH_DBZ600)'
,hqsql_text='select "JXKH_DBZ607" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ608" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12961'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ607" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ608" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ600" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ607" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ608" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ600" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ607'
,zb_name='�Źؽ��û���������'
,zbzt='0'
 where zb_id='JXKH_DBZ607'
end
go

/*********No.81: JXKH_DBZ608******HD_ZBMX_HZ***JXKH_DBZ608*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ608')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"13\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ608" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12960'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ608" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ608" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ608" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (13) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ608'
,zb_name='�Źؽ��û�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ608'
end
go

/*********No.82: JXKH_DBZ700******HD_ZBMX_HZ***JXKH_DBZ700*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ700')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"14\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ700" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12962'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ700" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ700" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ700" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ700'
,zb_name='ϥ�ؽ��û�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ700'
end
go

/*********No.83: JXKH_DBZ701******HD_ZBMX_HZ***JXKH_DBZ701*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ701')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ702,JXKH_DBZ700'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@ϥ�ؽ��û�����Ժ����ռ���ܴ�����(JXKH_DBZ702)/@ϥ�ؽ��û�����������(JXKH_DBZ700)'
,hqsql_text='select "JXKH_DBZ701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ702" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12964'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ702" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ700" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ702" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ701'
,zb_name='ϥ�ؽ��û���ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ701'
end
go

/*********No.84: JXKH_DBZ702******HD_ZBMX_HZ***JXKH_DBZ702*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ702')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"14\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ702" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12963'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ702" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ702" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ702" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ702'
,zb_name='ϥ�ؽ��û�����Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ702'
end
go

/*********No.85: JXKH_DBZ704******HD_ZBMX_HZ***JXKH_DBZ704*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ704')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ705,JXKH_DBZ700'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@ϥ�ؽ��û����ܳ�Ժ����(JXKH_DBZ705)/@ϥ�ؽ��û�����������(JXKH_DBZ700)'
,hqsql_text='select "JXKH_DBZ704" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ705" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12992'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ704" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ705" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ700" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ704" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ705" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ704'
,zb_name='ϥ�ؽ��û����ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ704'
end
go

/*********No.86: JXKH_DBZ705******HD_ZBMX_HZ***JXKH_DBZ705*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ705')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"14\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ705" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12965'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ705" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ705" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ705" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ705'
,zb_name='ϥ�ؽ��û����ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ705'
end
go

/*********No.87: JXKH_DBZ707******HD_ZBMX_HZ***JXKH_DBZ707*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ707')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ708,JXKH_DBZ700'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@ϥ�ؽ��û�����������(JXKH_DBZ708)/@ϥ�ؽ��û�����������(JXKH_DBZ700)'
,hqsql_text='select "JXKH_DBZ707" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ708" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12967'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ707" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ708" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ700" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ707" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ708" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ700" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ707'
,zb_name='ϥ�ؽ��û���������'
,zbzt='0'
 where zb_id='JXKH_DBZ707'
end
go

/*********No.88: JXKH_DBZ708******HD_ZBMX_HZ***JXKH_DBZ708*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ708')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"14\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ708" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12966'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ708" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ708" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ708" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (14) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ708'
,zb_name='ϥ�ؽ��û�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ708'
end
go

/*********No.89: JXKH_DBZ800******HD_ZBMX_HZ***JXKH_DBZ800*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ800')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"6\"},{\"dim_key\":\"zlzbsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ800" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12968'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ800" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ800" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ800" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ800'
,zb_name='��״������·��ֲ����������'
,zbzt='0'
 where zb_id='JXKH_DBZ800'
end
go

/*********No.90: JXKH_DBZ801******HD_ZBMX_HZ***JXKH_DBZ801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ801')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ802,JXKH_DBZ800'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@��״������·��ֲ����Ժ����ռ���ܴ�����(JXKH_DBZ802)/@��״������·��ֲ����������(JXKH_DBZ800)'
,hqsql_text='select "JXKH_DBZ801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ802" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12970'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ802" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ800" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ802" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ801'
,zb_name='��״������·��ֲ��ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ801'
end
go

/*********No.91: JXKH_DBZ802******HD_ZBMX_HZ***JXKH_DBZ802*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ802')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"6\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12969'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ802" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ802'
,zb_name='��״������·��ֲ����Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ802'
end
go

/*********No.92: JXKH_DBZ804******HD_ZBMX_HZ***JXKH_DBZ804*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ804')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ805,JXKH_DBZ800'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@��״������·��ֲ���ܳ�Ժ����(JXKH_DBZ805)/@��״������·��ֲ����������(JXKH_DBZ800)'
,hqsql_text='select "JXKH_DBZ804" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ805" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12993'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ804" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ805" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ800" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ804" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ805" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ804'
,zb_name='��״������·��ֲ���ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ804'
end
go

/*********No.93: JXKH_DBZ805******HD_ZBMX_HZ***JXKH_DBZ805*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ805')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"6\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ805" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12971'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ805" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ805" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ805" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ805'
,zb_name='��״������·��ֲ���ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ805'
end
go

/*********No.94: JXKH_DBZ807******HD_ZBMX_HZ***JXKH_DBZ807*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ807')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ808,JXKH_DBZ800'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@��״������·��ֲ����������(JXKH_DBZ808)/@��״������·��ֲ����������(JXKH_DBZ800)'
,hqsql_text='select "JXKH_DBZ807" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ808" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12973'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and zlzbsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ807" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ808" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ800" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ807" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ808" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ800" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ807'
,zb_name='��״������·��ֲ��������'
,zbzt='0'
 where zb_id='JXKH_DBZ807'
end
go

/*********No.95: JXKH_DBZ808******HD_ZBMX_HZ***JXKH_DBZ808*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ808')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"6\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ808" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12972'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ808" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ808" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ808" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (6) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ808'
,zb_name='��״������·��ֲ����������'
,zbzt='0'
 where zb_id='JXKH_DBZ808'
end
go

/*********No.96: JXKH_DBZ900******HD_ZBMX_HZ***JXKH_DBZ900*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ900')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"9\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ900" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12974'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ900" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ900" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ900" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ900'
,zb_name='�ʹ�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ900'
end
go

/*********No.97: JXKH_DBZ901******HD_ZBMX_HZ***JXKH_DBZ901*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ901')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ902,JXKH_DBZ900'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ʹ�����Ժ����ռ���ܴ�����(JXKH_DBZ902)/@�ʹ�����������(JXKH_DBZ900)'
,hqsql_text='select "JXKH_DBZ901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ902" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12976'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ902" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ900" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ901" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ902" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ901'
,zb_name='�ʹ���ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ901'
end
go

/*********No.98: JXKH_DBZ902******HD_ZBMX_HZ***JXKH_DBZ902*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ902')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"9\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12975'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ902" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ902'
,zb_name='�ʹ�����Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ902'
end
go

/*********No.99: JXKH_DBZ904******HD_ZBMX_HZ***JXKH_DBZ904*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ904')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ905,JXKH_DBZ900'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ʹ����ܳ�Ժ����(JXKH_DBZ905)/@�ʹ�����������(JXKH_DBZ900)'
,hqsql_text='select "JXKH_DBZ904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ905" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12994'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ905" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ900" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ904" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ905" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ904'
,zb_name='�ʹ����ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ904'
end
go

/*********No.100: JXKH_DBZ905******HD_ZBMX_HZ***JXKH_DBZ905*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ905')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"9\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ905" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12977'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ905" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ905" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ905" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ905'
,zb_name='�ʹ����ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ905'
end
go

/*********No.101: JXKH_DBZ907******HD_ZBMX_HZ***JXKH_DBZ907*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ907')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ908,JXKH_DBZ900'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ʹ�����������(JXKH_DBZ908)/@�ʹ�����������(JXKH_DBZ900)'
,hqsql_text='select "JXKH_DBZ907" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ908" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12979'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ907" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ908" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ900" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ907" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ908" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ900" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ907'
,zb_name='�ʹ���������'
,zbzt='0'
 where zb_id='JXKH_DBZ907'
end
go

/*********No.102: JXKH_DBZ908******HD_ZBMX_HZ***JXKH_DBZ908*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ908')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"9\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ908" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12978'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ908" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ908" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ908" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (9) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ908'
,zb_name='�ʹ�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ908'
end
go

/*********No.103: JXKH_DBZ1000******HD_ZBMX_HZ***JXKH_DBZ1000*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1000')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"10\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ1000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12980'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ1000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ1000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ1000" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ1000'
,zb_name='���������Էμ�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ1000'
end
go

/*********No.104: JXKH_DBZ1001******HD_ZBMX_HZ***JXKH_DBZ1001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1001')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ1002,JXKH_DBZ1000'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���������Էμ�����Ժ����ռ���ܴ�����(JXKH_DBZ1002)/@���������Էμ�����������(JXKH_DBZ1000)'
,hqsql_text='select "JXKH_DBZ1001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12982'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ1001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1002" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1000" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ1001" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ1001'
,zb_name='���������Էμ���ƽ��סԺ��'
,zbzt='0'
 where zb_id='JXKH_DBZ1001'
end
go

/*********No.105: JXKH_DBZ1002******HD_ZBMX_HZ***JXKH_DBZ1002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1002')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"10\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zzyts'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ1002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12981'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ1002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ1002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ1002" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zzyts) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ1002'
,zb_name='���������Էμ�����Ժ����ռ���ܴ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ1002'
end
go

/*********No.106: JXKH_DBZ1004******HD_ZBMX_HZ***JXKH_DBZ1004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1004')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ1005,JXKH_DBZ1000'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���������Էμ����ܳ�Ժ����(JXKH_DBZ1005)/@���������Էμ�����������(JXKH_DBZ1000)'
,hqsql_text='select "JXKH_DBZ1004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12995'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ1004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1005" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1000" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ1004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ1004'
,zb_name='���������Էμ����ξ�����'
,zbzt='0'
 where zb_id='JXKH_DBZ1004'
end
go

/*********No.107: JXKH_DBZ1005******HD_ZBMX_HZ***JXKH_DBZ1005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1005')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"10\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ1005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12983'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ1005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ1005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ1005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ1005'
,zb_name='���������Էμ����ܳ�Ժ����'
,zbzt='0'
 where zb_id='JXKH_DBZ1005'
end
go

/*********No.108: JXKH_DBZ1007******HD_ZBMX_HZ***JXKH_DBZ1007*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1007')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='JXKH_DBZ1008,JXKH_DBZ1000'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@���������Էμ�����������(JXKH_DBZ1008)/@���������Էμ�����������(JXKH_DBZ1000)'
,hqsql_text='select "JXKH_DBZ1007" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1008" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12985'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz,0 fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ls) fm from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "JXKH_DBZ1007" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1008" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="JXKH_DBZ1000" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "JXKH_DBZ1007" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1008" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="JXKH_DBZ1000" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='JXKH_DBZ1007'
,zb_name='���������Էμ���������'
,zbzt='0'
 where zb_id='JXKH_DBZ1007'
end
go

/*********No.109: JXKH_DBZ1008******HD_ZBMX_HZ***JXKH_DBZ1008*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='JXKH_DBZ1008')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jxkhdbzkey\",\"relation\":\"0\",\"caliber\":\"10\"},{\"dim_key\":\"jxkhsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_ZLZB_JBBZ_DBZ'
,gspz=''
,hqsql_text='select "JXKH_DBZ1008" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12984'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey'
,sql_start='select "JXKH_DBZ1008" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "JXKH_DBZ1008" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "JXKH_DBZ1008" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(swls) fz from FACT_ZLZB_JBBZ_DBZ a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jxkhdbzkey in (10) and jxkhsybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX_BA c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='JXKH_DBZ1008'
,zb_name='���������Էμ�����������'
,zbzt='0'
 where zb_id='JXKH_DBZ1008'
end
go

/*********No.110: J108******HD_ZBMX_HZ***J108*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='J108')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='J10901,J109'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����ҽ���豸�����������(J10901)/@����ҽ���豸���������(J109)'
,hqsql_text='select "J108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J10901" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J109" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='0'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "J108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J10901" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J109" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "J108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J10901" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J109" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='J108'
,zb_name='����ҽ��Ӱ���豸����������(CT��MRI��DSA��SPECT��PET_CT)'
,zbzt='0'
 where zb_id='J108'
end
go

/*********No.114: J0030106******HD_ZBMX_HZ***J0030106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='J0030106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='J0030107,J0030109'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�μӹ����ٴ�����������֯���Ҽ������ļ�����Ŀ��(J0030107)/@ͬ��ʵ�����ѿ�չ��ͬʱ�����ٴ�������������֯���Ҽ�����������Ŀ����(J0030109)'
,hqsql_text='select "J0030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J0030107" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J0030109" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13147'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "J0030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J0030107" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J0030109" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "J0030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J0030107" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J0030109" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='J0030106'
,zb_name='�Ҽ�������Ŀ�μ���'
,zbzt='0'
 where zb_id='J0030106'
end
go

/*********No.117: J0030110******HD_ZBMX_HZ***J0030110*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='J0030110')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='J0030111,J0030112'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�μӹ����ٴ�����������֯���Ҽ������ɼ��ϸ������Ŀ��(J0030111)/@ͬ�ڲμӹ����ٴ�����������֯���Ҽ������ļ�����Ŀ����(J0030112)'
,hqsql_text='select "J0030110" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J0030111" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="J0030112" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13146'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "J0030110" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J0030111" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="J0030112" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "J0030110" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J0030111" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="J0030112" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='J0030110'
,zb_name='�Ҽ�������Ŀ�ϸ���'
,zbzt='0'
 where zb_id='J0030110'
end
go

/*********No.120: ZBZL_YXZB_DRGS0020502******HD_ZBMX_HZ***ZBZL_YXZB_DRGS0020502*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020502')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='ZBZL_YXZB_DRGS0020501,ZBZL_YXZB_DRGS00101'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ͷ���DRG����������(ZBZL_YXZB_DRGS0020501)/@�ͷ���DRG����(ZBZL_YXZB_DRGS00101)'
,hqsql_text='select "ZBZL_YXZB_DRGS0020502" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS0020501" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,drgskey'
,memo='-1'
,orderno='13001'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz,0 fm from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey union all select timekey,yykey,kskey,yskey,drgskey,0 fz,drgskey fm from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")'
,sql_start='-1'
,sql_text='select "ZBZL_YXZB_DRGS0020502" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZBZL_YXZB_DRGS0020501" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZBZL_YXZB_DRGS00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "ZBZL_YXZB_DRGS0020502" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS0020501" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZBZL_YXZB_DRGS0020502'
,zb_name='�ͷ���DRG��������'
,zbzt='0'
 where zb_id='ZBZL_YXZB_DRGS0020502'
end
go

/*********No.121: ZBZL_YXZB_DRGS0020501******HD_ZBMX_HZ***ZBZL_YXZB_DRGS0020501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020501')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"fxpgdjkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='swls'
,fact_table='FACT_GZ_YXZB_DRGS'
,gspz=''
,hqsql_text='select "ZBZL_YXZB_DRGS0020501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,drgskey'
,memo=''
,orderno='11864'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey'
,sql_start='select "ZBZL_YXZB_DRGS0020501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZBZL_YXZB_DRGS0020501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZBZL_YXZB_DRGS0020501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (1) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZBZL_YXZB_DRGS0020501'
,zb_name='�ͷ���DRG����������'
,zbzt='0'
 where zb_id='ZBZL_YXZB_DRGS0020501'
end
go

/*********No.122: ZBZL_YXZB_DRGS00101******HD_ZBMX_HZ***ZBZL_YXZB_DRGS00101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS00101')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in (''1'')'
,dependindex=''
,dlzgs='-1'
,dylx='2'
,fact_dlz='drgskey'
,fact_table='FACT_GZ_YXZB_DRGS'
,gspz='-1'
,hqsql_text='select "ZBZL_YXZB_DRGS00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct drgskey) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,fxpgdjkey,drgskey from FACT_GZ_YXZB_DRGS a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,fxpgdjkey'
,memo='-1'
,orderno='11878'
,proc_name='-1'
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,fxpgdjkey,drgskey from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")'
,sql_start='select "ZBZL_YXZB_DRGS00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct drgskey) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZBZL_YXZB_DRGS00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct drgskey) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,fxpgdjkey,drgskey from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first='-1'
,tqsql_text='select "ZBZL_YXZB_DRGS00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct drgskey) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,fxpgdjkey,drgskey from FACT_GZ_YXZB_DRGS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))and fxpgdjkey in ("1")) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='-1'
,zb_id='ZBZL_YXZB_DRGS00101'
,zb_name='�ͷ���DRG����'
,zbzt='0'
 where zb_id='ZBZL_YXZB_DRGS00101'
end
go

/*********No.123: F50002******HD_ZBMX_HZ***F50002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='F50002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='F50001,F500'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�Ѿ���չ���ʻ�������Ĳ�����(F50001)/@��������(F500)'
,hqsql_text='select "F50002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F50001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="F500" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12401'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "F50002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F50001" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="F500" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "F50002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F50001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="F500" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='F50002'
,zb_name='���ʻ������񲡷�������'
,zbzt='0'
 where zb_id='F50002'
end
go

/*********No.126: E20122******HD_ZBMX_HZ***E20122*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20122')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='E20121,E201'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����������(E20121)/@�ż��ﴦ����(E201)'
,hqsql_text='select "E20122" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20121" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='yykey,timekey,kskey'
,memo='-1'
,orderno='12433'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select yykey,timekey,kskey,sum(jccfzs) fz,0 fm from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey union all select yykey,timekey,kskey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey'
,sql_start='-1'
,sql_text='select "E20122" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20121" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "E20122" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20121" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E20122'
,zb_name='������������'
,zbzt='0'
 where zb_id='E20122'
end
go

/*********No.127: E20121******HD_ZBMX_HZ***E20121*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20121')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='jccfzs'
,fact_table='FACT_SF_MZ_CFJC'
,gspz=''
,hqsql_text='select "E20121" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,sum(jccfzs) fz from FACT_SF_MZ_CFJC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='yykey,timekey,kskey'
,memo=''
,orderno='12432'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select yykey,timekey,kskey,sum(jccfzs) fz from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey'
,sql_start='select "E20121" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E20121" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,sum(jccfzs) fz from FACT_SF_MZ_CFJC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E20121" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,sum(jccfzs) fz from FACT_SF_MZ_CFJC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by yykey,timekey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E20121'
,zb_name='����������'
,zbzt='0'
 where zb_id='E20121'
end
go

/*********No.128: E201******HD_ZBMX_HZ***E201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cfs'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey'
,memo=''
,orderno='10285'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey'
,sql_start='select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(cfs) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E201'
,zb_name='�ż��ﴦ����'
,zbzt='0'
 where zb_id='E201'
end
go

/*********No.129: A1026******HD_ZBMX_HZ***A1026*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1026')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='A1025,A102'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����������ҽ����������(ҽ�������˴�)(A1025)/@��Ժ�˴�(A102)'
,hqsql_text='select "A1026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A1025" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,bqkey,kskey'
,memo='-1'
,orderno='12921'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,bqkey,kskey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey union all select timekey,yykey,bqkey,kskey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,bqkey,kskey'
,sql_start='-1'
,sql_text='select "A1026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A1025" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "A1026" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A1025" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1026'
,zb_name='����������ҽ������������������'
,zbzt='0'
 where zb_id='A1026'
end
go

/*********No.130: A1025******HD_ZBMX_HZ***A1025*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1025')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yzdpbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A1025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey'
,memo=''
,orderno='12920'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey'
,sql_start='select "A1025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "A1025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "A1025" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yzdpbz in (1) group by timekey,yykey,bqkey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='A1025'
,zb_name='����������ҽ����������(ҽ�������˴�)'
,zbzt='0'
 where zb_id='A1025'
end
go

/*********No.131: E00209******HD_ZBMX_HZ***E00209*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00209')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00230,A111'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ���߿���ҩ��DDDS(E00230)/@��Ժ����ʵ��ռ���ܴ���(A111)'
,hqsql_text='select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00230" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11589'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ddds) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(zyts) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00230" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00209" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00230" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00209'
,zb_name='סԺ����ҩ��ʹ��ǿ��'
,zbzt='0'
 where zb_id='E00209'
end
go

/*********No.132: E00230******HD_ZBMX_HZ***E00230*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00230')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ddds'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey'
,memo=''
,orderno='10261'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey'
,sql_start='select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E00230" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey,sum(ddds) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ypkey,zlzkey,ypflkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E00230'
,zb_name='��Ժ���߿���ҩ��DDDS'
,zbzt='0'
 where zb_id='E00230'
end
go

/*********No.133: A111******HD_ZBMX_HZ***A111*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A111')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zyts'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='10071'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A111" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zyts) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A111'
,zb_name='��Ժ����ʵ��ռ���ܴ���'
,zbzt='0'
 where zb_id='A111'
end
go

/*********No.134: E20203******HD_ZBMX_HZ***E20203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20203')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E20103,E201'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż������ҩƷ������(E20103)/@�ż��ﴦ����(E201)'
,hqsql_text='select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E20103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,mjzkey'
,memo=''
,orderno='11303'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,mjzkey,sum(jbypcfs) fz,0 fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey union all select timekey,yykey,kskey,yskey,ybflkey,mjzkey,0 fz,sum(cfs) fm from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,mjzkey'
,sql_start=''
,sql_text='select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E20103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E20203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E20103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E20203'
,zb_name='�ż������ҩƷ������(%)'
,zbzt='0'
 where zb_id='E20203'
end
go

/*********No.135: E20103******HD_ZBMX_HZ***E20103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E20103')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs='-1'
,dylx=''
,fact_dlz='jbypcfs'
,fact_table='FACT_YP_CFLFX'
,gspz=''
,hqsql_text='select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='10288'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start='select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E20103" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(-1) fz from FACT_YP_CFLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E20103'
,zb_name='�ż������ҩƷ������'
,zbzt='0'
 where zb_id='E20103'
end
go

/*********No.136: E00310******HD_ZBMX_HZ***E00310*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00310')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='E00308,G005'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż������ҩ��ʹ���˴�(E00308)/@�ż���ҩƷ�˴�(G005)'
,hqsql_text='select "E00310" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00308" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="G005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo='-1'
,orderno='11606'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(yprc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start='-1'
,sql_text='select "E00310" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00308" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="G005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "E00310" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00308" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="G005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00310'
,zb_name='�ż������ҩ���˴�ռ��'
,zbzt='0'
 where zb_id='E00310'
end
go

/*********No.137: E00308******HD_ZBMX_HZ***E00308*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00308')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs='-1'
,dylx=''
,fact_dlz='jbywsyrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "E00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='10276'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey'
,sql_start='select "E00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(jbywsyrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E00308'
,zb_name='�ż������ҩ��ʹ���˴�'
,zbzt='0'
 where zb_id='E00308'
end
go

/*********No.138: G005******HD_ZBMX_HZ***G005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='G005')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='yprc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "G005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey'
,memo=''
,orderno='10329'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey'
,sql_start='select "G005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "G005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "G005" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='G005'
,zb_name='�ż���ҩƷ�˴�'
,zbzt='0'
 where zb_id='G005'
end
go

/*********No.139: E00902******HD_ZBMX_HZ***E00902*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00902')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00901,A1027'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ���߻���ҩ��ʹ���˴�(E00901)/@��Ժ���˴�����������δ��ҩ���ߣ�(A1027)'
,hqsql_text='select "E00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00901" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A1027" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,bqkey,kskey,zlzkey'
,memo=''
,orderno='13154'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey union all select timekey,yykey,bqkey,kskey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey'
,sql_start=''
,sql_text='select "E00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00901" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A1027" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00902" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00901" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A1027" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00902'
,zb_name='סԺ���߻���ҩ��ʹ����'
,zbzt='0'
 where zb_id='E00902'
end
go

/*********No.140: E00901******HD_ZBMX_HZ***E00901*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00901')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jbywsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "E00901" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey,zlzkey'
,memo=''
,orderno='12402'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey'
,sql_start='select "E00901" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "E00901" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "E00901" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='E00901'
,zb_name='סԺ���߻���ҩ��ʹ���˴�'
,zbzt='0'
 where zb_id='E00901'
end
go

/*********No.141: A1027******HD_ZBMX_HZ***A1027*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1027')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"ypsybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='cyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A1027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,bqkey,kskey,zlzkey'
,memo=''
,orderno='12922'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey'
,sql_start='select "A1027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "A1027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "A1027" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,bqkey,kskey,zlzkey,sum(cyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and ypsybz in (1) group by timekey,yykey,bqkey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='A1027'
,zb_name='��Ժ���˴�����������δ��ҩ���ߣ�'
,zbzt='0'
 where zb_id='A1027'
end
go

/*********No.142: G30002******HD_ZBMX_HZ***G30002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='G30002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='G30001,G300'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽԺ�ɹ�����ҩ��Ʒ����(G30001)/@�ɹ�ҩ��Ʒ����(G300)'
,hqsql_text='select "G30002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="G30001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="G300" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12406'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "G30002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="G30001" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="G300" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "G30002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="G30001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="G300" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='G30002'
,zb_name='����ҩ��ɹ�Ʒ����ռ��'
,zbzt='0'
 where zb_id='G30002'
end
go

/*********No.143: G30001******HD_ZBMX_HZ***G30001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='G30001')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"gjjzcgbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"jybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='idm'
,fact_table='FACT_DIM_YP'
,gspz=''
,hqsql_text='select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='yykey,timekey,kskey'
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)'
,sql_start='select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "G30001" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) and jybz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='0'
,zb_id='G30001'
,zb_name='ҽԺ�ɹ�����ҩ��Ʒ����'
,zbzt='0'
 where zb_id='G30001'
end
go

/*********No.144: G300******HD_ZBMX_HZ***G300*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='G300')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"gjjzcgbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='idm'
,fact_table='FACT_DIM_YP'
,gspz=''
,hqsql_text='select "G300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='yykey,timekey,kskey'
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1)'
,sql_start='select "G300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "G300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "G300" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select yykey,timekey,kskey,idm from FACT_DIM_YP a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='0'
,zb_id='G300'
,zb_name='�ɹ�ҩ��Ʒ����'
,zbzt='0'
 where zb_id='G300'
end
go

/*********No.145: E00504******HD_ZBMX_HZ***E00504*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00504')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00503,E005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@������֯ҩƷ���вɹ��б�ҩƷ����(E00503)/@ҩƷ����(E005)'
,hqsql_text='select "E00504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00503" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='13171'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ypsyl) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ypsyl) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ypsyl) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ypsyl) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "E00504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00503" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00503" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00504'
,zb_name='������֯ҩƷ���вɹ��б�ҩƷʹ�ñ���'
,zbzt='0'
 where zb_id='E00504'
end
go

/*********No.146: E00503******HD_ZBMX_HZ***E00503*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00503')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0050301,E0050302'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż��������֯ҩƷ���вɹ��б�ҩƷ����(E0050301)+@סԺ������֯ҩƷ���вɹ��б�ҩƷ����(E0050302)'
,hqsql_text='select "E00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0050301" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0050302" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno=''
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "E00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0050301" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0050302" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E00503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0050301" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0050302" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E00503'
,zb_name='������֯ҩƷ���вɹ��б�ҩƷ����'
,zbzt='0'
 where zb_id='E00503'
end
go

/*********No.147: E0050301******HD_ZBMX_HZ***E0050301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0050301')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"gjjzcgbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypsyl'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "E0050301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey'
,memo=''
,orderno='13158'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey'
,sql_start='select "E0050301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E0050301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E0050301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and gjjzcgbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E0050301'
,zb_name='�ż��������֯ҩƷ���вɹ��б�ҩƷ����'
,zbzt='0'
 where zb_id='E0050301'
end
go

/*********No.148: E005******HD_ZBMX_HZ***E005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E005')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E00501,E00502'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ż���ҩƷ����(E00501)+@סԺҩƷ����(E00502)'
,hqsql_text='select "E005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00501" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E00502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno=''
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(-ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "E005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00501" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E00502" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00501" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E00502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E005'
,zb_name='ҩƷ����'
,zbzt='0'
 where zb_id='E005'
end
go

/*********No.149: E00501******HD_ZBMX_HZ***E00501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00501')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypsyl'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "E00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "E00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E00501'
,zb_name='�ż���ҩƷ����'
,zbzt='0'
 where zb_id='E00501'
end
go

/*********No.150: E00502******HD_ZBMX_HZ***E00502*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E00502')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypsyl'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "E00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='select "E00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypsyl) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E00502'
,zb_name='סԺҩƷ����'
,zbzt='0'
 where zb_id='E00502'
end
go

/*********No.151: A006******HD_ZBMX_HZ***A006*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A006')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A004,A003'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ԤԼ�����˴�(A004)/@����ԤԼ�˴�(A003)'
,hqsql_text='select "A006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A004" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A003" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,yyfskey'
,memo=''
,orderno='11508'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz,0 fm from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey union all select timekey,yykey,kskey,yskey,yyfskey,0 fz,sum(yyrc) fm from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey'
,sql_start=''
,sql_text='select "A006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A004" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A003" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A006" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A004" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A003" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A006'
,zb_name='ԤԼ������'
,zbzt='0'
 where zb_id='A006'
end
go

/*********No.152: A004******HD_ZBMX_HZ***A004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A004')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs='-1'
,dylx=''
,fact_dlz='yyjzrc'
,fact_table='FACT_YY_MZ_YYRC'
,gspz=''
,hqsql_text='select "A004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz from FACT_YY_MZ_YYRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,yyfskey'
,memo=''
,orderno='10040'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey'
,sql_start='select "A004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A004" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,sum(yyjzrc) fz from FACT_YY_MZ_YYRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A004'
,zb_name='ԤԼ�����˴�'
,zbzt='0'
 where zb_id='A004'
end
go

/*********No.153: A003******HD_ZBMX_HZ***A003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A003')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='yyrc'
,fact_table='FACT_YY_MZ_YYRC'
,gspz=''
,hqsql_text='select "A003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey,sum(yyrc) fz from FACT_YY_MZ_YYRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey'
,memo=''
,orderno='10033'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey,sum(yyrc) fz from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey'
,sql_start='select "A003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey,sum(yyrc) fz from FACT_YY_MZ_YYRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A003" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey,sum(yyrc) fz from FACT_YY_MZ_YYRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,yyfskey,ghyysjckey,ghlbkey,sjdkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A003'
,zb_name='����ԤԼ�˴�'
,zbzt='0'
 where zb_id='A003'
end
go

/*********No.154: A00309******HD_ZBMX_HZ***A00309*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00309')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A00308,A00401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����ԤԼ���ߺ���ʱ��(A00308)/@��ЧԤԼ�����˴�(A00401)'
,hqsql_text='select "A00309" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00308" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12436'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,sum(ddjzsc) fz,0 fm from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(rc) fm from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey'
,sql_start=''
,sql_text='select "A00309" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00308" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A00309" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00308" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A00309'
,zb_name='����ԤԼ����ƽ������ʱ��'
,zbzt='0'
 where zb_id='A00309'
end
go

/*********No.155: A00308******HD_ZBMX_HZ***A00308*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00308')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ddjzsc'
,fact_table='FACT_YY_MZ_JZLC'
,gspz=''
,hqsql_text='select "A00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ddjzsc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ddjzsc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey'
,sql_start='select "A00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ddjzsc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00308" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ddjzsc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00308'
,zb_name='����ԤԼ���ߺ���ʱ��'
,zbzt='0'
 where zb_id='A00308'
end
go

/*********No.156: A00401******HD_ZBMX_HZ***A00401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A00401')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='rc'
,fact_table='FACT_YY_MZ_JZLC'
,gspz=''
,hqsql_text='select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12332'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey'
,sql_start='select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A00401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(rc) fz from FACT_YY_MZ_JZLC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yybz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A00401'
,zb_name='��ЧԤԼ�����˴�'
,zbzt='0'
 where zb_id='A00401'
end
go

/*********No.158: A115******HD_ZBMX_HZ***A115*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A115')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A111,ZLZB_YY0005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��Ժ����ʵ��ռ���ܴ���(A111)/@����������Ա����ҽʦ��(ZLZB_YY0005)'
,hqsql_text='select "A115" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12407'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "A115" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A111" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A115" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A111" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A115'
,zb_name='ÿ��ִҵҽʦ�վ�סԺ��������'
,zbzt='0'
 where zb_id='A115'
end
go

/*********No.160: ZLZB_YY006601******HD_ZBMX_HZ***ZLZB_YY006601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY006601')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0066,ZLZB_YY0001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҩѧרҵ������Ա(ZLZB_YY0066)*100/@ʵ�ʿ��Ŵ�λ(ZLZB_YY0001)'
,hqsql_text='select "ZLZB_YY006601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0066" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12408'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY006601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0066" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY006601" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0066" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY006601'
,zb_name='ÿ���Ų���ҩʦ����'
,zbzt='0'
 where zb_id='ZLZB_YY006601'
end
go

/*********No.163: B00103******HD_ZBMX_HZ***B00103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00103')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00101,B001'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż������(B00101)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select "B00103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,memo='-1'
,orderno='12409'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B00103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B00103" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00103'
,zb_name='�ż������ռ��'
,zbzt='0'
 where zb_id='B00103'
end
go

/*********No.164: B00101******HD_ZBMX_HZ***B00101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghfy+cffy'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey,dxmkey'
,memo=''
,orderno='10077'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey'
,sql_start='select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B00101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,dxmkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B00101'
,zb_name='�ż������'
,zbzt='0'
 where zb_id='B00101'
end
go

/*********No.165: C002020102******HD_ZBMX_HZ***C002020102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C002020102')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='C0020201,B00101'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż���ҽ��֧�����(�ɱ����)(C0020201)/@�ż������(B00101)'
,hqsql_text='select "C002020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C0020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,ybflkey,yskey'
,memo='-1'
,orderno='12411'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,ybflkey,yskey,sum(ybzffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey union all select timekey,yykey,kskey,ybflkey,yskey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,yskey'
,sql_start='-1'
,sql_text='select "C002020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C0020201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "C002020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C0020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C002020102'
,zb_name='��������������ҽ������ı���'
,zbzt='0'
 where zb_id='C002020102'
end
go

/*********No.166: C0020201******HD_ZBMX_HZ***C0020201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C0020201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ybzffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select "C0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ybflkey,yskey,yblxkey'
,memo=''
,orderno='10181'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey'
,sql_start='select "C0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "C0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "C0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='C0020201'
,zb_name='�ż���ҽ��֧�����(�ɱ����)'
,zbzt='0'
 where zb_id='C0020201'
end
go

/*********No.167: B00104******HD_ZBMX_HZ***B00104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00104')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00102,B001'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@סԺ����(B00102)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select "B00104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey'
,memo='-1'
,orderno='12410'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,dxmkey,bqkey,sjbqkey,zddmkey,zlzkey'
,sql_start='-1'
,sql_text='select "B00104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B00104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00104'
,zb_name='סԺ����ռ��'
,zbzt='0'
 where zb_id='B00104'
end
go

/*********No.168: B00102******HD_ZBMX_HZ***B00102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,dxmkey'
,memo=''
,orderno='10080'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey'
,sql_start='select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B00102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,dxmkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B00102'
,zb_name='סԺ����'
,zbzt='0'
 where zb_id='B00102'
end
go

/*********No.169: C102020102******HD_ZBMX_HZ***C102020102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C102020102')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='C1020201,B00102'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@סԺҽ��֧�����(�ɱ����)(C1020201)/@סԺ����(B00102)'
,hqsql_text='select "C102020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C1020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,ybflkey,yskey,zlzkey'
,memo='-1'
,orderno='12412'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,ybflkey,yskey,zlzkey,sum(ybzffy) fz,0 fm from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey union all select timekey,yykey,kskey,ybflkey,yskey,zlzkey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey'
,sql_start='-1'
,sql_text='select "C102020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C1020201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "C102020102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C1020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C102020102'
,zb_name='סԺ����������ҽ������ı���'
,zbzt='0'
 where zb_id='C102020102'
end
go

/*********No.170: C1020201******HD_ZBMX_HZ***C1020201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C1020201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mzzykey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ybzffy'
,fact_table='FACT_YB_YBZKFX'
,gspz=''
,hqsql_text='select "C1020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey'
,memo=''
,orderno='10190'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey'
,sql_start='select "C1020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "C1020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "C1020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,zlzkey,yblxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='C1020201'
,zb_name='סԺҽ��֧�����(�ɱ����)'
,zbzt='0'
 where zb_id='C1020201'
end
go

/*********No.171: C701******HD_ZBMX_HZ***C701*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C701')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='C702,C3020201'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��ҽ�������յ��Ŀ���(C702)/@ҽ��֧�����(�ɱ����)(C3020201)'
,hqsql_text='select "C701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C702" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C3020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='0'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "C701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C702" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C3020201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "C701" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C702" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C3020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C701'
,zb_name='ҽ������ؿ���'
,zbzt='0'
 where zb_id='C701'
end
go

/*********No.173: C3020201******HD_ZBMX_HZ***C3020201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='C3020201')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='C1020201,C0020201'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@סԺҽ��֧�����(�ɱ����)(C1020201)+@�ż���ҽ��֧�����(�ɱ����)(C0020201)'
,hqsql_text='select "C3020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C1020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="C0020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,ybflkey,yskey,yblxkey'
,memo='-1'
,orderno='13002'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (2) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey union all select timekey,yykey,kskey,ybflkey,yskey,yblxkey,sum(-ybzffy) fz from FACT_YB_YBZKFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mzzykey in (1) group by timekey,yykey,kskey,ybflkey,yskey,yblxkey'
,sql_start='-1'
,sql_text='select "C3020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C1020201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="C0020201" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "C3020201" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C1020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="C0020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='C3020201'
,zb_name='ҽ��֧�����(�ɱ����)'
,zbzt='0'
 where zb_id='C3020201'
end
go

/*********No.174: B00106******HD_ZBMX_HZ***B00106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00105,B001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽ�Ʒ������루����ҩƷ���Ĳġ����������룩(B00105)/@ҽԺ�ܷ���(B001)'
,hqsql_text='select "B00106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00105" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,memo=''
,orderno='12415'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (5,7) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,0 fz,sum(ghfy+cffy) fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,0 fz,sum(zfy) fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start=''
,sql_text='select "B00106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00105" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B00106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00105" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00106'
,zb_name='ҽ�Ʒ������루����ҩƷ���Ĳġ����������룩ռҽ���������'
,zbzt='0'
 where zb_id='B00106'
end
go

/*********No.175: B00105******HD_ZBMX_HZ***B00105*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00105')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B001,B002,B004,B005,B009'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@ҽԺ�ܷ���(B001)-@ҩƷ�ܷ���(B002)-@�������(B004)-@�������Ϸ���(B005)-@����������(B009)'
,hqsql_text='select "B00105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B004" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B009" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ybflkey'
,memo='-1'
,orderno='13160'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,sum(-zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey union all '
,sql_start='-1'
,sql_text='select "B00105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B004" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B005" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B009" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B00105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B004" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B009" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00105'
,zb_name='ҽ�Ʒ������루����ҩƷ���Ĳġ����������룩'
,zbzt='0'
 where zb_id='B00105'
end
go

/*********No.176: B0010501******HD_ZBMX_HZ***B0010501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010501')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"dxmkey\",\"relation\":\"0\",\"caliber\":\"0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghfy+cffy'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B0010501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12413'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68) group by timekey,yykey,kskey'
,sql_start='select "B0010501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0010501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0010501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,5,7,8,43,44,45,46,47,48,49,59,62,64,65,66,68) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0010501'
,zb_name='�ż���ҽ�Ʒ������루����ҩƷ���Ĳġ����������룩'
,zbzt='1'
 where zb_id='B0010501'
end
go

/*********No.177: B0010502******HD_ZBMX_HZ***B0010502*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010502')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"dxmkey\",\"relation\":\"0\",\"caliber\":\"0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zfy'
,fact_table='FACT_FY_ZY_FYFX'
,gspz=''
,hqsql_text='select "B0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12414'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71) group by timekey,yykey,kskey'
,sql_start='select "B0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0010502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (0,4,5,6,7,8,36,37,40,42,43,44,45,46,47,48,49,59,64,65,68,71) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0010502'
,zb_name='סԺҽ�Ʒ������루����ҩƷ���Ĳġ����������룩'
,zbzt='1'
 where zb_id='B0010502'
end
go

/*********No.178: B002******HD_ZBMX_HZ***B002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00201,B00202'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż���ҩƷ����(B00201)+@סԺҩƷ����(B00202)'
,hqsql_text='select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey'
,memo='-1'
,orderno='11519'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey'
,sql_start='-1'
,sql_text='select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B002" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B002'
,zb_name='ҩƷ�ܷ���'
,zbzt='0'
 where zb_id='B002'
end
go

/*********No.179: B005******HD_ZBMX_HZ***B005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B005')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00501,B00502'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż����������Ϸ���(B00501)+@סԺ�������Ϸ���(B00502)'
,hqsql_text='select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00501"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00502"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='-1'
,memo='-1'
,orderno='11618'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (9) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00501"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00502"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B005" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00501"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00502"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B005'
,zb_name='�������Ϸ���'
,zbzt='0'
 where zb_id='B005'
end
go

/*********No.180: B009******HD_ZBMX_HZ***B009*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B009')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B003,B004'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@������(B003)+@�������(B004)'
,hqsql_text='select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B003"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B004"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='-1'
,memo='-1'
,orderno='11633'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum() fz from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (8) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum() fz from  a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B003"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B004"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B009" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B003"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B004"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B009'
,zb_name='����������'
,zbzt='0'
 where zb_id='B009'
end
go

/*********No.181: B004******HD_ZBMX_HZ***B004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B004')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00401,B00402'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż���������(B00401)+@סԺ�������(B00402)'
,hqsql_text='select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00401"     and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='-1'
,memo='-1'
,orderno='11613'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey union all select timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (10) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,zddmkey'
,sql_start='-1'
,sql_text='select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00401"     and month between @kssj and @jssj UNION ALL select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00402"    and month between @kssj and @jssj )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B004" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00401"     and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00402"    and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B004'
,zb_name='�������'
,zbzt='0'
 where zb_id='B004'
end
go

/*********No.182: B00204******HD_ZBMX_HZ***B00204*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00204')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00203,B002'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@����ҩƷ�ܷ���(B00203)/@ҩƷ�ܷ���(B002)'
,hqsql_text='select "B00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00203" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12420'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ypfy) fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey union all select timekey,yykey,kskey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "B00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00203" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B002" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B00204" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00203" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B002" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00204'
,zb_name='����ҩƷ�ܷ���ռ��'
,zbzt='0'
 where zb_id='B00204'
end
go

/*********No.183: B00203******HD_ZBMX_HZ***B00203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00203')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B0020301,B0020302'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż��︨��ҩƷ�ܷ���(B0020301)+@סԺ����ҩƷ�ܷ���(B0020302)'
,hqsql_text='select "B00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020301" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B0020302" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo='-1'
,orderno='12419'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey union all select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey'
,sql_start='-1'
,sql_text='select "B00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020301" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B0020302" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B00203" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020301" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B0020302" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B00203'
,zb_name='����ҩƷ�ܷ���'
,zbzt='0'
 where zb_id='B00203'
end
go

/*********No.184: B0020301******HD_ZBMX_HZ***B0020301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0020301')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"fzypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B0020301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12417'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey'
,sql_start='select "B0020301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0020301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0020301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0020301'
,zb_name='�ż��︨��ҩƷ�ܷ���'
,zbzt='0'
 where zb_id='B0020301'
end
go

/*********No.185: B002030101******HD_ZBMX_HZ***B002030101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002030101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"fzypbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B002030101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12553'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start='select "B002030101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B002030101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B002030101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B002030101'
,zb_name='���︨��ҩƷ�ܷ���'
,zbzt='0'
 where zb_id='B002030101'
end
go

/*********No.186: B002030102******HD_ZBMX_HZ***B002030102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002030102')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"fzypbz\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B002030102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12554'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (2) group by timekey,yykey,kskey'
,sql_start='select "B002030102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B002030102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B002030102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B002030102'
,zb_name='���︨��ҩƷ�ܷ���'
,zbzt='0'
 where zb_id='B002030102'
end
go

/*********No.187: B0020302******HD_ZBMX_HZ***B0020302*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0020302')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"fzypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "B0020302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12418'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey'
,sql_start='select "B0020302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0020302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0020302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fzypbz in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0020302'
,zb_name='סԺ����ҩƷ�ܷ���'
,zbzt='0'
 where zb_id='B0020302'
end
go

/*********No.188: ZLZB_YY009202******HD_ZBMX_HZ***ZLZB_YY009202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY009202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY009201,ZLZB_YY0092'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��Ա����֧��(ZLZB_YY009201)/@ҵ����֧��(ZLZB_YY0092)'
,hqsql_text='select "ZLZB_YY009202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0092" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12421'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY009202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0092" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY009202" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0092" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY009202'
,zb_name='��Ա֧��ռҵ��֧������'
,zbzt='0'
 where zb_id='ZLZB_YY009202'
end
go

/*********No.193: B000******HD_ZBMX_HZ***B000*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B000')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B001,B303,B306,B312,B309'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽԺ�ܷ���(B001)+@����������������(B303)+@��������(B306)+@�ƽ���Ŀ����(B312)+@������Ŀ֧����������(B309)'
,hqsql_text='select "B000" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B303" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B306" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B312" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B309" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13164'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "B000" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B303" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B306" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B312" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B309" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B000" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B303" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B306" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B312" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B309" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B000'
,zb_name='������'
,zbzt='0'
 where zb_id='B000'
end
go

/*********No.194: ZLZB_YY0093******HD_ZBMX_HZ***ZLZB_YY0093*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0093')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B301,B308,B311'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҵ����֧����(B301)+@������Ŀ������֧��ת���ࣩ(B308)+@�ƽ���Ŀ��֧��ת���ࣩ(B311)'
,hqsql_text='select "ZLZB_YY0093" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B321" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B301" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B308" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B311" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13165'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0093" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B321" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B301" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B308" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B311" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0093" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B321" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B301" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B308" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B311" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0093'
,zb_name='��֧����'
,zbzt='0'
 where zb_id='ZLZB_YY0093'
end
go

/*********No.195: B301******HD_ZBMX_HZ***B301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B321,B306,B307'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽ����֧����(B321)+@��������(B306)-@����֧��(B307)'
,hqsql_text='select "B301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B321" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B306" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B307" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "B301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B321" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B306" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B307" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B301" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B321" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B306" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B307" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B301'
,zb_name='ҵ����֧����'
,zbzt='0'
 where zb_id='B301'
end
go

/*********No.201: B308******HD_ZBMX_HZ***B308*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B308')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B309,B310'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@������Ŀ֧����������(B309)-@������Ŀ����֧��(B310)'
,hqsql_text='select "B308" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B309" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B310" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "B308" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B309" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B310" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B308" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B309" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B310" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B308'
,zb_name='������Ŀ������֧��ת���ࣩ'
,zbzt='0'
 where zb_id='B308'
end
go

/*********No.204: B311******HD_ZBMX_HZ***B311*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B311')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B312,B313'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�ƽ���Ŀ����(B312)-@�ƽ���Ŀ֧��(B313)'
,hqsql_text='select "B311" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B312" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B313" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13162'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "B311" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B312" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B313" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B311" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B312" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B313" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B311'
,zb_name='�ƽ���Ŀ��֧��ת���ࣩ'
,zbzt='0'
 where zb_id='B311'
end
go

/*********No.207: ZLZB_YY0041******HD_ZBMX_HZ***ZLZB_YY0041*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0041')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY004102,ZLZB_YY004101'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��ծ�ܶ�(ZLZB_YY004102)/@�ʲ��ܶ�(ZLZB_YY004101)'
,hqsql_text='select "ZLZB_YY0041" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY004102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY004101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='0'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0041" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY004102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY004101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0041" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY004102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY004101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0041'
,zb_name='�ʲ���ծ��'
,zbzt='0'
 where zb_id='ZLZB_YY0041'
end
go

/*********No.211: B316******HD_ZBMX_HZ***B316*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B316')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B314,B315'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż����������ҽ��Ŀ¼��̸����ҩ������(B314)/@סԺ�������ҽ��Ŀ¼��̸����ҩ������(B315)'
,hqsql_text='select "B316" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey'
,memo='-1'
,orderno='12998'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey union all select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,0 fz,sum(ypfy) fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey'
,sql_start='-1'
,sql_text='select "B316" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B314" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B315" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B316" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B316'
,zb_name='�������ҽ��Ŀ¼��̸����ҩ������'
,zbzt='0'
 where zb_id='B316'
end
go

/*********No.212: B314******HD_ZBMX_HZ***B314*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B314')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"tpypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey'
,memo=''
,orderno='12996'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey'
,sql_start='select "B314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B314" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ypkey,ybflkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,gyskey,kssjbkey,tsypbzkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B314'
,zb_name='�ż����������ҽ��Ŀ¼��̸����ҩ������'
,zbzt='0'
 where zb_id='B314'
end
go

/*********No.213: B315******HD_ZBMX_HZ***B315*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B315')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"tpypbz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "B315" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey'
,memo=''
,orderno='12997'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey'
,sql_start='select "B315" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "B315" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "B315" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey,dxmkey,ypkey,ybflkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,ymlxkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='B315'
,zb_name='סԺ�������ҽ��Ŀ¼��̸����ҩ������'
,zbzt='0'
 where zb_id='B315'
end
go

/*********No.214: B318******HD_ZBMX_HZ***B318*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B318')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B319,B320'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż����޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩(B319)+@סԺ�޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩(B320)'
,hqsql_text='select "B318" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0010201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0010202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo='-1'
,orderno='13157'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='-1'
,sql_text='select "B318" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0010201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B314" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0010202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B315" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B318" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0010201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0010202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B318'
,zb_name='�޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩'
,zbzt='0'
 where zb_id='B318'
end
go

/*********No.215: B319******HD_ZBMX_HZ***B319*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B319')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00101,E0010201,B314'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@�ż������(B00101)-@ �ż����в�ҩ����(E0010201)-@�ż����������ҽ��Ŀ¼��̸����ҩ������(B314)'
,hqsql_text='select "B319" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0010201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo='-1'
,orderno='13155'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='-1'
,sql_text='select "B319" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0010201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B314" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B319" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0010201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B314" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B319'
,zb_name='�ż����޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩'
,zbzt='0'
 where zb_id='B319'
end
go

/*********No.216: B320******HD_ZBMX_HZ***B320*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B320')
begin
update HD_ZBMX_HZ set
condition='-1'
,dependindex='B00102,E0010202,B315'
,dlzgs='-1'
,dylx='-1'
,fact_dlz='-1'
,fact_table='-1'
,gspz='@סԺ����(B00102)-@סԺ�в�ҩ����(E0010202)-@סԺ�������ҽ��Ŀ¼��̸����ҩ������(B315)'
,hqsql_text='select "B320" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0010202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo='-1'
,orderno='13156'
,proc_name='-1'
,sql_end='-1'
,sql_middle='select timekey,yykey,kskey,yskey,sum(zfy) fz from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and dxmkey in (3) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,sum(-ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and tpypbz in (1) group by timekey,yykey,kskey,yskey'
,sql_start='-1'
,sql_text='select "B320" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0010202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B315" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first='-1'
,tqsql_text='select "B320" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0010202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,-fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B315" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B320'
,zb_name='סԺ�޳��й�����ҽ�����루��ҩ��Ƭ������������ҽ��Ŀ¼��̸����ҩ�����룩'
,zbzt='0'
 where zb_id='B320'
end
go

/*********No.217: B10101******HD_ZBMX_HZ***B10101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0010101,A00101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�������(B0010101)/@�����˴�(A00101)'
,hqsql_text='select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0010101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,memo=''
,orderno='12605'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz,0 fm from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey,zddmkey,czykey'
,sql_start=''
,sql_text='select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0010101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B10101'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0010101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B10101'
,zb_name='������η�'
,zbzt='0'
 where zb_id='B10101'
end
go

/*********No.218: B0010101******HD_ZBMX_HZ***B0010101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0010101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ghfy+cffy'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B0010101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey'
,memo=''
,orderno='10078'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey'
,sql_start='select "B0010101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0010101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0010101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey,sum(ghfy+cffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,dxmkey,ybflkey,zddmkey,czykey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0010101'
,zb_name='�������'
,zbzt='0'
 where zb_id='B0010101'
end
go

/*********No.219: B10301******HD_ZBMX_HZ***B10301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B10301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B0020101,A00101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ҩƷ����(B0020101)/@�����˴�(A00101)'
,hqsql_text='select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''B0020101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,mjzkey,ybflkey'
,memo=''
,orderno='12616'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,mjzkey,ybflkey,sum(ypfy) fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey union all select timekey,yykey,kskey,yskey,mjzkey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) and ghlbkey not in (6,8,9) group by timekey,yykey,kskey,yskey,mjzkey,ybflkey'
,sql_start=''
,sql_text='select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''B0020101'' and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id =''A00101'' and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select ''B10301'' zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''B0020101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id =''A00101'' and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B10301'
,zb_name='����ҩƷ���η�'
,zbzt='0'
 where zb_id='B10301'
end
go

/*********No.220: B0020101******HD_ZBMX_HZ***B0020101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B0020101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey'
,memo=''
,orderno='10082'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey'
,sql_start='select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B0020101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,dxmkey,ypyfkey,ypjxkey,ypflkey,ypdlkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B0020101'
,zb_name='����ҩƷ����'
,zbzt='0'
 where zb_id='B0020101'
end
go

/*********No.221: B102******HD_ZBMX_HZ***B102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00102,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ����(B00102)/@��Ժ�˴�(A102)'
,hqsql_text='select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey'
,memo=''
,orderno='11472'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,sum(zfy) fz,0 fm from FACT_FY_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey union all select timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,bqkey,zlzkey'
,sql_start=''
,sql_text='select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00102" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B102'
,zb_name='סԺ���η�'
,zbzt='0'
 where zb_id='B102'
end
go

/*********No.222: B104******HD_ZBMX_HZ***B104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B00202,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺҩƷ����(B00202)/@��Ժ�˴�(A102)'
,hqsql_text='select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey'
,memo=''
,orderno='11474'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,sum(ypfy) fz,0 fm from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey union all select timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,ybflkey,zlzkey,bqkey'
,sql_start=''
,sql_text='select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B00202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "B104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='B104'
,zb_name='סԺҩƷ����ҩ��'
,zbzt='0'
 where zb_id='B104'
end
go

/*********No.223: B00202******HD_ZBMX_HZ***B00202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B00202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs='-1'
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_ZY_FYFX'
,gspz=''
,hqsql_text='select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1"),a.bqkey'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey'
,memo=''
,orderno='10084'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_middle='select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey'
,sql_start='select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from ('
,sql_text='select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1"),a.bqkey'
,sql_text_first=''
,tqsql_text='select "B00202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,a.bqkey from (select timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey,sum(ypfy) fz from FACT_YP_ZY_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,yskey,dxmkey,ybflkey,ypkey,zlzkey,yymdkey,ypyfkey,ypflkey,ypdlkey,gyskey,ypjxkey,kssjbkey,tsypbzkey,bqkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1"),a.bqkey'
,ysfs='1'
,zb_id='B00202'
,zb_name='סԺҩƷ����'
,zbzt='0'
 where zb_id='B00202'
end
go

/*********No.224: ZLZB_YY00040102******HD_ZBMX_HZ***ZLZB_YY00040102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY00040101,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��������������Ա����(ZLZB_YY00040101)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY00040102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12422'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040102'
,zb_name='��������������Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY00040102'
end
go

/*********No.227: ZLZB_YY00040104******HD_ZBMX_HZ***ZLZB_YY00040104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY00040103,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�м�����������Ա����(ZLZB_YY00040103)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040103" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12423'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040103" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040104" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040103" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040104'
,zb_name='�м�����������Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY00040104'
end
go

/*********No.229: ZLZB_YY00040106******HD_ZBMX_HZ***ZLZB_YY00040106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY00040105,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���߼�����������Ա����(ZLZB_YY00040105)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040105" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12424'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040105" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040105" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040106'
,zb_name='���߼�����������Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY00040106'
end
go

/*********No.231: ZLZB_YY00040108******HD_ZBMX_HZ***ZLZB_YY00040108*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040108')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY00040107,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@�߼�����������Ա����(ZLZB_YY00040107)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00040107" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12425'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00040107" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040108" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00040107" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040108'
,zb_name='�߼�����������Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY00040108'
end
go

/*********No.233: ZLZB_YY005801******HD_ZBMX_HZ***ZLZB_YY005801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY005801')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0058,ZLZB_YY0005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽԺע������������ơ���֢����������ҽ�ڸ�ҽʦ��(ZLZB_YY0058)/@����������Ա����ҽʦ��(ZLZB_YY0005)'
,hqsql_text='select "ZLZB_YY005801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0058" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13148'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY005801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0058" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY005801" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0058" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY005801'
,zb_name='���������ơ���֢����������ҽҽʦռ��'
,zbzt='0'
 where zb_id='ZLZB_YY005801'
end
go

/*********No.235: ZLZB_YY000501******HD_ZBMX_HZ***ZLZB_YY000501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000501')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0057,ZLZB_YY0005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����ҽʦ��Ա(ZLZB_YY0057)/@����������Ա����ҽʦ��(ZLZB_YY0005)'
,hqsql_text='select "ZLZB_YY000501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0057" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12426'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY000501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0057" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000501" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0057" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY000501'
,zb_name='����ҽʦ��Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY000501'
end
go

/*********No.237: ZLZB_YY000503******HD_ZBMX_HZ***ZLZB_YY000503*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000503')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY000502,ZLZB_YY0005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����ҽʦ��Ա(ZLZB_YY000502)/@����������Ա����ҽʦ��(ZLZB_YY0005)'
,hqsql_text='select "ZLZB_YY000503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12427'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY000503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000502" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000503" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY000503'
,zb_name='����ҽʦ��Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY000503'
end
go

/*********No.239: ZLZB_YY000504******HD_ZBMX_HZ***ZLZB_YY000504*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000504')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0052,ZLZB_YY0005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��֢ҽѧ��ҽʦ��(ZLZB_YY0052)/@����������Ա����ҽʦ��(ZLZB_YY0005)'
,hqsql_text='select "ZLZB_YY000504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0052" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12428'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY000504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0052" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000504" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0052" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY000504'
,zb_name='��֢ҽʦ��Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY000504'
end
go

/*********No.241: ZLZB_YY000505******HD_ZBMX_HZ***ZLZB_YY000505*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000505')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_ZLGL_LCBL001,ZLZB_YY0005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����ҽʦ��(ZLZB_ZLGL_LCBL001)/@����������Ա����ҽʦ��(ZLZB_YY0005)'
,hqsql_text='select "ZLZB_YY000505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12429'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY000505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_ZLGL_LCBL001" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_ZLGL_LCBL001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY000505'
,zb_name='����ҽʦ��Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY000505'
end
go

/*********No.243: ZLZB_YY000507******HD_ZBMX_HZ***ZLZB_YY000507*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY000507')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY000506,ZLZB_YY0005'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@��ҽʦ��Ա(ZLZB_YY000506)/@����������Ա����ҽʦ��(ZLZB_YY0005)'
,hqsql_text='select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000506" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12430'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000506" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY000507" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000506" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY000507'
,zb_name='��ҽʦ��Առ��'
,zbzt='0'
 where zb_id='ZLZB_YY000507'
end
go

/*********No.245: ZLZB_YY00040109******HD_ZBMX_HZ***ZLZB_YY00040109*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00040109')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0005,ZLZB_YY0006'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����������Ա����ҽʦ��(ZLZB_YY0005)/@����������Ա����������Ա��(ZLZB_YY0006)'
,hqsql_text='select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0006" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='12431'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0005" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0006" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00040109" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0005" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0006" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00040109'
,zb_name='ҽ����'
,zbzt='0'
 where zb_id='ZLZB_YY00040109'
end
go

/*********No.247: ZLZB_YY0094******HD_ZBMX_HZ***ZLZB_YY0094*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0094')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY009402,ZLZB_YY0112'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽԺ��������ҽԺ������Կ�֧ԮҽԺ��ҽ������ҽԺ�����޲�����ԭҽԺ������������(ZLZB_YY009402)/@ҽԺͬ�����ս���������(ZLZB_YY0112)'
,hqsql_text='select "ZLZB_YY0094" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009402" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0112" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13149'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0094" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009402" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0112" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0094" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009402" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0112" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0094'
,zb_name='ҽԺ��������ҽԺ������Կ�֧ԮҽԺ��ҽ������ҽԺ�����޲�����ԭҽԺ������������ռ��'
,zbzt='0'
 where zb_id='ZLZB_YY0094'
end
go

/*********No.255: ZLZB_YY0095******HD_ZBMX_HZ***ZLZB_YY0095*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0095')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY009502,ZLZB_YY009501'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽԺסԺҽʦ�״βμ�ҽʦ�ʸ���ͨ������(ZLZB_YY009502)/@ҽԺסԺҽʦ�״βμ�ҽʦ�ʸ�������(ZLZB_YY009501)'
,hqsql_text='select "ZLZB_YY0095" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009502" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009501" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='0'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0095" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009502" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009501" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0095" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009502" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009501" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0095'
,zb_name='ҽԺסԺҽʦ�״βμ�ҽʦ�ʸ���ͨ����'
,zbzt='0'
 where zb_id='ZLZB_YY0095'
end
go

/*********No.258: ZLZB_YY0113******HD_ZBMX_HZ***ZLZB_YY0113*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0113')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY00920101,ZLZB_YY0117'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽѧ�˲���������(ZLZB_YY00920101)/@ҽԺ�����ܾ���֧��(ZLZB_YY0117)'
,hqsql_text='select "ZLZB_YY0113" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY00920101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0117" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13152'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0113" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY00920101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0117" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0113" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY00920101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0117" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0113'
,zb_name='ҽԺ��ҽѧ�˲���������ľ���Ͷ��ռ��'
,zbzt='0'
 where zb_id='ZLZB_YY0113'
end
go

/*********No.259: ZLZB_YY00920101******HD_ZBMX_HZ***ZLZB_YY00920101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY00920101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0114,ZLZB_YY0115,ZLZB_YY0116'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@����ԺУ��ѧ����Ͷ��(ZLZB_YY0114)+@��ҵ��ҽѧ��������Ͷ��(ZLZB_YY0115)+@����ҽѧ��������Ͷ��(ZLZB_YY0116)'
,hqsql_text='select "ZLZB_YY00920101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0114" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0115" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0116" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='13151'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY00920101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0114" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0115" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0116" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY00920101" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0114" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0115" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0116" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY00920101'
,zb_name='ҽѧ�˲���������'
,zbzt='0'
 where zb_id='ZLZB_YY00920101'
end
go

/*********No.263: ZLZB_YY0117******HD_ZBMX_HZ***ZLZB_YY0117*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0117')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='B304,B313'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽ��֧����ҽ��ҵ��ɱ���(B304)+@�ƽ���Ŀ֧��(B313)'
,hqsql_text='select "ZLZB_YY0117" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B304" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="B313" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0117" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B304" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="B313" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0117" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B304" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="B313" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0117'
,zb_name='ҽԺ�����ܾ���֧��'
,zbzt='0'
 where zb_id='ZLZB_YY0117'
end
go

/*********No.264: ZLZB_YY0096******HD_ZBMX_HZ***ZLZB_YY0096*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0096')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0118,ZLZB_YY0119'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@������ѧ��ѵ�˴���(ZLZB_YY0118)+@ȡ��ʡ��������ʦ����ѵ�ϸ�֤�������(ZLZB_YY0119)'
,hqsql_text='select "ZLZB_YY0096" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0118" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0119" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0096" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0118" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0119" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0096" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0118" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0119" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0096'
,zb_name='�ٴ����̽�ʦ��ָ��ҽʦ���ܽ�����ѧ��ѵ�˴���'
,zbzt='0'
 where zb_id='ZLZB_YY0096'
end
go

/*********No.267: ZLZB_YY0097******HD_ZBMX_HZ***ZLZB_YY0097*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0097')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY0120,ZLZB_YY0121,ZLZB_YY0122'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@ҽԺרְ����ԺУҽѧ��������(ZLZB_YY0120)+@��ҵ��ҽѧ��������(ZLZB_YY0121)+@����ҽѧ��������(ZLZB_YY0122)'
,hqsql_text='select "ZLZB_YY0097" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0120" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0121" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY0122" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='-1'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0097" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0120" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0121" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY0122" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0097" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,0 fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0120" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0121" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY0122" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0097'
,zb_name='�е�ҽѧ����������'
,zbzt='0'
 where zb_id='ZLZB_YY0097'
end
go

/*********No.272: ZLZB_YY0099******HD_ZBMX_HZ***ZLZB_YY0099*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0099')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY009901,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@������Ŀ����*100(ZLZB_YY009901)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY0099" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY009901" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='0'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0099" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY009901" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0099" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY009901" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0099'
,zb_name='ÿ��������������Ա������Ŀ����'
,zbzt='0'
 where zb_id='ZLZB_YY0099'
end
go

/*********No.274: ZLZB_YY0100******HD_ZBMX_HZ***ZLZB_YY0100*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_YY0100')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_YY010001,ZLZB_YY000401'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@���гɹ�ת�����*100(ZLZB_YY010001)/@����������Ա����(ZLZB_YY000401)'
,hqsql_text='select "ZLZB_YY0100" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY010001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz=''
,memo=''
,orderno='0'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='select "ZLZB_YY0100" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY010001" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZLZB_YY000401" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZLZB_YY0100" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY010001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZLZB_YY000401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZLZB_YY0100'
,zb_name='ÿ��������������Ա���гɹ�ת�����'
,zbzt='0'
 where zb_id='ZLZB_YY0100'
end
go

/*********No.280: G00501******HD_ZBMX_HZ***G00501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='G00501')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='yprc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "G00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12318'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start='select "G00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "G00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "G00501" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='G00501'
,zb_name='����ҩƷ�շ��˴�'
,zbzt='0'
 where zb_id='G00501'
end
go

/*********No.281: G00502******HD_ZBMX_HZ***G00502*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='G00502')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='yprc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "G00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12319'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey'
,sql_start='select "G00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "G00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "G00502" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,sum(yprc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='G00502'
,zb_name='����ҩƷ�շ��˴�'
,zbzt='0'
 where zb_id='G00502'
end
go

/*********No.282: ZBZL_YXZB_DRGS0020505******HD_ZBMX_HZ***ZBZL_YXZB_DRGS0020505*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020505')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZBZL_YXZB_DRGS0020201,ZBZL_YXZB_DRGS00202'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�еͷ�������������(ZBZL_YXZB_DRGS0020201)/@�еͷ���DRG����������(ZBZL_YXZB_DRGS00202)'
,hqsql_text='select "ZBZL_YXZB_DRGS0020505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS0020201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS00202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey,drgskey'
,memo=''
,orderno='0'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz,0 fm from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey union all select timekey,yykey,kskey,yskey,drgskey,0 fz,sum(rzls) fm from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey'
,sql_start=''
,sql_text='select "ZBZL_YXZB_DRGS0020505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZBZL_YXZB_DRGS0020201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="ZBZL_YXZB_DRGS00202" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "ZBZL_YXZB_DRGS0020505" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS0020201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="ZBZL_YXZB_DRGS00202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='ZBZL_YXZB_DRGS0020505'
,zb_name='�еͷ���DRG��������'
,zbzt='0'
 where zb_id='ZBZL_YXZB_DRGS0020505'
end
go

/*********No.283: ZBZL_YXZB_DRGS0020201******HD_ZBMX_HZ***ZBZL_YXZB_DRGS0020201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZBZL_YXZB_DRGS0020201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"fxpgdjkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='swls'
,fact_table='FACT_GZ_YXZB_DRGS'
,gspz=''
,hqsql_text='select "ZBZL_YXZB_DRGS0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,yskey,drgskey'
,memo=''
,orderno='13166'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey'
,sql_start='select "ZBZL_YXZB_DRGS0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "ZBZL_YXZB_DRGS0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "ZBZL_YXZB_DRGS0020201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,yskey,drgskey,sum(swls) fz from FACT_GZ_YXZB_DRGS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and fxpgdjkey in (2) group by timekey,yykey,kskey,yskey,drgskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='ZBZL_YXZB_DRGS0020201'
,zb_name='�еͷ�������������'
,zbzt='0'
 where zb_id='ZBZL_YXZB_DRGS0020201'
end
go

/*********No.284: E3110201******HD_ZBMX_HZ***E3110201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E3110201')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zcyzsjrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "E3110201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12597'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start='select "E3110201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E3110201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E3110201" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E3110201'
,zb_name='����ʹ����ҩע���ҩ���˴�'
,zbzt='0'
 where zb_id='E3110201'
end
go

/*********No.285: A1021101******HD_ZBMX_HZ***A1021101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"zcybz\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zsjywsyrc'
,fact_table='FACT_YY_ZY_CYYWLFX'
,gspz=''
,hqsql_text='select "A1021101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,zlzkey'
,memo=''
,orderno='12603'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey'
,sql_start='select "A1021101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "A1021101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "A1021101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz from FACT_YY_ZY_CYYWLFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='A1021101'
,zb_name='סԺ������ҩ������Һʹ���˴�'
,zbzt='0'
 where zb_id='A1021101'
end
go

/*********No.286: A1021102******HD_ZBMX_HZ***A1021102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='A1021102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A1021101,A102'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz='@סԺ������ҩ������Һʹ���˴�(A1021101)/@��Ժ�˴�(A102)'
,hqsql_text='select "A1021102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A1021101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,zlzkey'
,memo=''
,orderno='12604'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,zlzkey,sum(zsjywsyrc) fz,0 fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and zcybz in (1) group by timekey,yykey,kskey,zlzkey union all select timekey,yykey,kskey,zlzkey,0 fz,sum(cyrc) fm from FACT_YY_ZY_CYYWLFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,zlzkey'
,sql_start=''
,sql_text='select "A1021102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A1021101" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "A1021102" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A1021101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='A1021102'
,zb_name='סԺ������ҩ������Һʹ����'
,zbzt='0'
 where zb_id='A1021102'
end
go

/*********No.287: E2030105******HD_ZBMX_HZ***E2030105*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E2030105')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E3110201,A00101'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ʹ����ҩע���ҩ���˴�(E3110201)/@�����˴�(A00101)'
,hqsql_text='select "E2030105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E3110201" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,yskey'
,memo=''
,orderno='12600'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,yskey,sum(zcyzsjrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,yskey union all select timekey,yykey,kskey,yskey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (1) group by timekey,yykey,kskey,yskey'
,sql_start=''
,sql_text='select "E2030105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E3110201" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00101" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E2030105" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E3110201" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00101" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E2030105'
,zb_name='����ʹ����ҩע����(%)'
,zbzt='0'
 where zb_id='E2030105'
end
go

/*********No.288: E2030106******HD_ZBMX_HZ***E2030106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E2030106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E3110202,A00102'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@����ʹ����ҩע���ҩ���˴�(E3110202)/@�����˴�(A00102)'
,hqsql_text='select "E2030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E3110202" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="A00102" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey,ybflkey'
,memo=''
,orderno='12601'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,ybflkey,sum(zcyzsjrc) fz,0 fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey,ybflkey union all select timekey,yykey,kskey,ybflkey,0 fz,sum(ghrc) fm from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and ghlbkey not in (6,8,9) and mjzkey in (2) group by timekey,yykey,kskey,ybflkey'
,sql_start=''
,sql_text='select "E2030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E3110202" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="A00102" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E2030106" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E3110202" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="A00102" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E2030106'
,zb_name='����ʹ����ҩע����(%)'
,zbzt='0'
 where zb_id='E2030106'
end
go

/*********No.289: E31102******HD_ZBMX_HZ***E31102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E31102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='zcyzsjrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "E31102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey,mjzkey'
,memo=''
,orderno='12599'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,mjzkey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey'
,sql_start='select "E31102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E31102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E31102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,mjzkey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) group by timekey,yykey,kskey,mjzkey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E31102'
,zb_name='�ż���ʹ����ҩע���ҩ���˴�'
,zbzt='0'
 where zb_id='E31102'
end
go

/*********No.290: E3110202******HD_ZBMX_HZ***E3110202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E3110202')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='zcyzsjrc'
,fact_table='FACT_YY_MZ_JZRC'
,gspz=''
,hqsql_text='select "E3110202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12598'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey'
,sql_start='select "E3110202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E3110202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E3110202" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zcyzsjrc) fz from FACT_YY_MZ_JZRC a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='E3110202'
,zb_name='����ʹ����ҩע���ҩ���˴�'
,zbzt='0'
 where zb_id='E3110202'
end
go

/*********No.291: E0030402******HD_ZBMX_HZ***E0030402*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0030402')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='E0030401,E001'
,dlzgs=''
,dylx='0'
,fact_dlz=''
,fact_table=''
,gspz='@�ż���ʹ����ѡҩ��Ʒ����(E0030401)/@ҩ��Ʒ������(������ҩ)(E001)'
,hqsql_text='select "E0030402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E0030401" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(month,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(month,1,month) < getdate() and zbmx_id ="E001" and month between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11712'
,proc_name=''
,sql_end=''
,sql_middle='select timekey,yykey,kskey,idm fz,0 fm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0) union all select timekey,yykey,kskey,0 fz,idm fm from FACT_DIM_YP a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))'
,sql_start=''
,sql_text='select "E0030402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E0030401" and month between @kssj and @jssj union all select yykey,yydm,kskey,ksdm,month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where zbmx_id ="E001" and month between @kssj and @jssj)t group by yykey,yydm,kskey,ksdm,month,bqkey'
,sql_text_first=''
,tqsql_text='select "E0030402" zbmx_id,yykey,yydm,kskey,ksdm,month,sum(fz) fz,sum(fm) fm,null czry,getdate() gxrq,bqkey from (select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E0030401" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) union all select yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm,bqkey from FACT_RESULT_KS_VALUE_M where dateadd(year,1,month) < getdate() and zbmx_id ="E001" and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj))t group by yykey,yydm,kskey,ksdm,month,bqkey'
,ysfs='-1'
,zb_id='E0030402'
,zb_name='�ż���ʹ����ѡҩ��Ʒ����ռҩ��Ʒ����������'
,zbzt='0'
 where zb_id='E0030402'
end
go

/*********No.292: E0030401******HD_ZBMX_HZ***E0030401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='E0030401')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"jbywbz\",\"relation\":\"0\",\"caliber\":\"0\"}]'
,dependindex=''
,dlzgs=''
,dylx='0'
,fact_dlz='idm'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "E0030401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,idm from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='11704'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,idm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0)'
,sql_start='select "E0030401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "E0030401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,idm from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "E0030401" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,count(distinct idm) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,idm from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and jbywbz in (0)) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='0'
,zb_id='E0030401'
,zb_name='�ż���ʹ����ѡҩ��Ʒ����'
,zbzt='0'
 where zb_id='E0030401'
end
go

/*********No.293: B002090101******HD_ZBMX_HZ***B002090101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002090101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yscfbz\",\"relation\":\"0\",\"caliber\":\"0\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"},{\"dim_key\":\"dxmkey\",\"relation\":\"1\",\"caliber\":\"4\"}]'
,dependindex=''
,dlzgs='ypfy-zyfy_ypcyzj'
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B002090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12670'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) and dxmkey not in (4) group by timekey,yykey,kskey'
,sql_start='select "B002090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B002090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B002090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B002090101'
,zb_name='����ҩƷ���루������ҩ��Ƭ�����촦��ҩƷ��'
,zbzt='0'
 where zb_id='B002090101'
end
go

/*********No.294: B001090101******HD_ZBMX_HZ***B001090101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B001090101')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(ghfy cffy-yscffy) fz'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B001090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12666'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ghfy cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1 group by timekey,yykey,kskey'
,sql_start='select "B001090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B001090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B001090101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B001090101'
,zb_name='����ҽ�����루������ҩ��Ƭ�����촦��ҩƷ��'
,zbzt='0'
 where zb_id='B001090101'
end
go

/*********No.295: B001090102******HD_ZBMX_HZ***B001090102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B001090102')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(ghfy cffy-yscffy) fz'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B001090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12667'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ghfy cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2 group by timekey,yykey,kskey'
,sql_start='select "B001090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B001090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B001090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ghfy+cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and a.dxmkey<>4 and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B001090102'
,zb_name='����ҽ�����루������ҩ��Ƭ�����촦��ҩƷ��'
,zbzt='0'
 where zb_id='B001090102'
end
go

/*********No.296: B001090301******HD_ZBMX_HZ***B001090301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B001090301')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(zfy-yscffy) fz'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B001090301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12678'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey'
,sql_start='select "B001090301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B001090301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B001090301" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B001090301'
,zb_name='����ҽ�����루�������촦����'
,zbzt='0'
 where zb_id='B001090301'
end
go

/*********No.297: B001090302******HD_ZBMX_HZ***B001090302*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B001090302')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(zfy-yscffy) fz'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B001090302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12679'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey'
,sql_start='select "B001090302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B001090302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B001090302" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(zfy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B001090302'
,zb_name='����ҽ�����루�������촦����'
,zbzt='0'
 where zb_id='B001090302'
end
go

/*********No.298: B002010601******HD_ZBMX_HZ***B002010601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002010601')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(cffy-yscffy) fz'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B002010601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12690'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey'
,sql_start='select "B002010601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B002010601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B002010601" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=1 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B002010601'
,zb_name='���ﴦ�����루�������촦����'
,zbzt='0'
 where zb_id='B002010601'
end
go

/*********No.299: B002010602******HD_ZBMX_HZ***B002010602*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002010602')
begin
update HD_ZBMX_HZ set
condition='where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2'
,dependindex=''
,dlzgs=''
,dylx='1'
,fact_dlz='sum(cffy-yscffy) fz'
,fact_table='FACT_FY_MZ_FYFX'
,gspz=''
,hqsql_text='select "B002010602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='-1'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12691'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey'
,sql_start='select "B002010602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B002010602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B002010602" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(cffy-yscffy) fz from FACT_FY_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and mjzkey=2 group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B002010602'
,zb_name='���ﴦ�����루�������촦����'
,zbzt='0'
 where zb_id='B002010602'
end
go

/*********No.300: B002090102******HD_ZBMX_HZ***B002090102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002090102')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yscfbz\",\"relation\":\"0\",\"caliber\":\"0\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"},{\"dim_key\":\"dxmkey\",\"relation\":\"1\",\"caliber\":\"4\"}]'
,dependindex=''
,dlzgs='ypfy-zyfy_ypcyzj'
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B002090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12671'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) and dxmkey not in (4) group by timekey,yykey,kskey'
,sql_start='select "B002090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B002090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B002090102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy-zyfy_ypcyzj) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) and dxmkey not in (4) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B002090102'
,zb_name='����ҩƷ���루������ҩ��Ƭ�����촦��ҩƷ��'
,zbzt='0'
 where zb_id='B002090102'
end
go

/*********No.301: B002100101******HD_ZBMX_HZ***B002100101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002100101')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yscfbz\",\"relation\":\"0\",\"caliber\":\"0\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"1\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B002100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12683'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) group by timekey,yykey,kskey'
,sql_start='select "B002100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B002100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B002100101" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (1) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B002100101'
,zb_name='����ҩƷ���루�������촦����'
,zbzt='0'
 where zb_id='B002100101'
end
go

/*********No.302: B002100102******HD_ZBMX_HZ***B002100102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='B002100102')
begin
update HD_ZBMX_HZ set
condition='[{\"dim_key\":\"yscfbz\",\"relation\":\"0\",\"caliber\":\"0\"},{\"dim_key\":\"mjzkey\",\"relation\":\"0\",\"caliber\":\"2\"}]'
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz='ypfy'
,fact_table='FACT_YP_MZ_FYFX'
,gspz=''
,hqsql_text='select "B002100102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(month,-1,@kssj) and dateadd(month,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(month,1,timekey),120)+"1")'
,jlzt='1'
,kslx='0'
,kxwdz='timekey,yykey,kskey'
,memo=''
,orderno='12684'
,proc_name=''
,sql_end=') a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_middle='select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) group by timekey,yykey,kskey'
,sql_start='select "B002100102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from ('
,sql_text='select "B002100102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between @kssj and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),timekey,120)+"1")'
,sql_text_first=''
,tqsql_text='select "B002100102" zbmx_id,a.yykey,isnull(b.yydm,"01") yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1") month,sum(fz) fz,0 fm,null czry,getdate() gxrq,null bqkey from (select timekey,yykey,kskey,sum(ypfy) fz from FACT_YP_MZ_FYFX a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) and yscfbz in (0) and mjzkey in (2) group by timekey,yykey,kskey) a inner join DIM_YYXX b on a.yykey=b.yykey inner join DIM_KSXX c on a.kskey=c.kskey and a.yykey=c.yykey group by a.yykey,b.yydm,a.kskey,c.ksdm,convert(date,convert(char(8),dateadd(year,1,timekey),120)+"1")'
,ysfs='1'
,zb_id='B002100102'
,zb_name='����ҩƷ���루�������촦����'
,zbzt='0'
 where zb_id='B002100102'
end
go
