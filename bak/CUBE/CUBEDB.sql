
/*********No.1: ZLZB_SS0103******ZBMX***ZLZB_SS0103*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0103')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0103'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺叶切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0103'
end
go

/*********No.1: ZLZB_SS0103******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0103*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0103')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0103'
 where zb_id='ZLZB_SS0103'
end
go

/*********No.1: ZLZB_SS0103******HD_ZBMX_HZ***ZLZB_SS0103*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0103')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11040'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0103'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0103'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0103'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=21    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0103'
,zb_name='肺叶切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0103'
end
go

/*********No.1: ZLZB_SS0103******ZB_FACT_DIM_YS***ZLZB_SS0103*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0103')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0103'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0103'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0103'
end
go

/*********No.2: ZLZB_SS0207******ZBMX***ZLZB_SS0207*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0207')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0207'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌保留乳房术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0207'
end
go

/*********No.2: ZLZB_SS0207******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0207*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0207')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0207'
 where zb_id='ZLZB_SS0207'
end
go

/*********No.2: ZLZB_SS0207******HD_ZBMX_HZ***ZLZB_SS0207*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0207')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11165'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0207'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0207'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0207'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=42  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0207'
,zb_name='乳腺癌保留乳房术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0207'
end
go

/*********No.2: ZLZB_SS0207******ZB_FACT_DIM_YS***ZLZB_SS0207*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0207')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0207'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0207'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0207'
end
go

/*********No.3: ZLZB_SS0208******ZBMX***ZLZB_SS0208*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0208')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0208'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌保留乳房术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0208'
end
go

/*********No.3: ZLZB_SS0208******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0208*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0208')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0208'
 where zb_id='ZLZB_SS0208'
end
go

/*********No.3: ZLZB_SS0208******HD_ZBMX_HZ***ZLZB_SS0208*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0208')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11166'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0208'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0208'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0208'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=42    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0208'
,zb_name='乳腺癌保留乳房术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0208'
end
go

/*********No.3: ZLZB_SS0208******ZB_FACT_DIM_YS***ZLZB_SS0208*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0208')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0208'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0208'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0208'
end
go

/*********No.4: ZLZB_SS0209******ZBMX***ZLZB_SS0209*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0209')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0209'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌保留乳房术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0209'
end
go

/*********No.4: ZLZB_SS0209******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0209*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0209')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0209'
 where zb_id='ZLZB_SS0209'
end
go

/*********No.4: ZLZB_SS0209******HD_ZBMX_HZ***ZLZB_SS0209*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0209')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11167'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0209'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0209'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0209'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=42    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0209'
,zb_name='乳腺癌保留乳房术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0209'
end
go

/*********No.4: ZLZB_SS0209******ZB_FACT_DIM_YS***ZLZB_SS0209*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0209')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0209'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0209'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0209'
end
go

/*********No.5: ZLZB_SS0210******ZBMX***ZLZB_SS0210*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0210')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0210'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌保留乳房术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0210'
end
go

/*********No.5: ZLZB_SS0210******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0210*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0210')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0210'
 where zb_id='ZLZB_SS0210'
end
go

/*********No.5: ZLZB_SS0210******HD_ZBMX_HZ***ZLZB_SS0210*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0210')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11168'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0210'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0210'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0210'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=42    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0210'
,zb_name='乳腺癌保留乳房术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0210'
end
go

/*********No.5: ZLZB_SS0210******ZB_FACT_DIM_YS***ZLZB_SS0210*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0210')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0210'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0210'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0210'
end
go

/*********No.6: ZLZB_SS0211******ZBMX***ZLZB_SS0211*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0211')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0211'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾癌根治术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0211'
end
go

/*********No.6: ZLZB_SS0211******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0211*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0211')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0211'
 where zb_id='ZLZB_SS0211'
end
go

/*********No.6: ZLZB_SS0211******HD_ZBMX_HZ***ZLZB_SS0211*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0211')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11170'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0211'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0211'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0211'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=43   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0211'
,zb_name='肾癌根治术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0211'
end
go

/*********No.6: ZLZB_SS0211******ZB_FACT_DIM_YS***ZLZB_SS0211*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0211')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0211'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0211'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0211'
end
go

/*********No.7: ZLZB_SS0212******ZBMX***ZLZB_SS0212*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0212')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0212'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾癌根治术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0212'
end
go

/*********No.7: ZLZB_SS0212******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0212*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0212')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0212'
 where zb_id='ZLZB_SS0212'
end
go

/*********No.7: ZLZB_SS0212******HD_ZBMX_HZ***ZLZB_SS0212*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0212')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11171'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0212'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0212'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0212'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=43  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0212'
,zb_name='肾癌根治术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0212'
end
go

/*********No.7: ZLZB_SS0212******ZB_FACT_DIM_YS***ZLZB_SS0212*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0212')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0212'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0212'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0212'
end
go

/*********No.8: ZLZB_SS0213******ZBMX***ZLZB_SS0213*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0213')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0213'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾癌根治术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0213'
end
go

/*********No.8: ZLZB_SS0213******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0213*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0213')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0213'
 where zb_id='ZLZB_SS0213'
end
go

/*********No.8: ZLZB_SS0213******HD_ZBMX_HZ***ZLZB_SS0213*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0213')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11172'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0213'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0213'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0213'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=43    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0213'
,zb_name='肾癌根治术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0213'
end
go

/*********No.8: ZLZB_SS0213******ZB_FACT_DIM_YS***ZLZB_SS0213*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0213')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0213'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0213'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0213'
end
go

/*********No.9: ZLZB_SS0214******ZBMX***ZLZB_SS0214*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0214')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0214'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾癌根治术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0214'
end
go

/*********No.9: ZLZB_SS0214******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0214*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0214')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0214'
 where zb_id='ZLZB_SS0214'
end
go

/*********No.9: ZLZB_SS0214******HD_ZBMX_HZ***ZLZB_SS0214*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0214')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11173'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0214'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0214'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0214'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=43    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0214'
,zb_name='肾癌根治术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0214'
end
go

/*********No.9: ZLZB_SS0214******ZB_FACT_DIM_YS***ZLZB_SS0214*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0214')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0214'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0214'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0214'
end
go

/*********No.10: ZLZB_SS0215******ZBMX***ZLZB_SS0215*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0215')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0215'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾癌根治术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0215'
end
go

/*********No.10: ZLZB_SS0215******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0215*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0215')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0215'
 where zb_id='ZLZB_SS0215'
end
go

/*********No.10: ZLZB_SS0215******HD_ZBMX_HZ***ZLZB_SS0215*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0215')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11174'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0215'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0215'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0215'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=43    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0215'
,zb_name='肾癌根治术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0215'
end
go

/*********No.10: ZLZB_SS0215******ZB_FACT_DIM_YS***ZLZB_SS0215*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0215')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0215'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0215'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0215'
end
go

/*********No.11: ZLZB_SS00011******ZBMX***ZLZB_SS00011*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00011')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00011'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00011'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的总例数(男)'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00011'
end
go

/*********No.11: ZLZB_SS00011******HD_ZBMX_HZ***ZLZB_SS00011*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00011')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10908'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00011'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1   and sexkey =1  and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00011'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1   and sexkey =1  and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00011'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=1   and sexkey =1  and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00011'
,zb_name='髋、膝关节置换术的总例数(男)'
,zbzt='0'
 where zb_id='ZLZB_SS00011'
end
go

/*********No.11: ZLZB_SS00011******ZB_FACT_DIM_YS***ZLZB_SS00011*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS00011')
begin
update ZB_FACT_DIM_YS set
dim_table='重返类型'
,dim_table_name='DIM_CFLX'
,dim_table_val='cfmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS00011'
,fz_fact_val='1'
,join_code='cflxkey'
,next_join_code='cflxkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS00011'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS00011'
end
go

/*********No.12: ZLZB_SS00012******ZBMX***ZLZB_SS00012*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00012')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00012'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00012'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的总例数(女)'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00012'
end
go

/*********No.12: ZLZB_SS00012******HD_ZBMX_HZ***ZLZB_SS00012*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00012')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10909'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00012'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1   and sexkey =2  and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00012'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1   and sexkey =2  and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00012'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=1   and sexkey =2  and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00012'
,zb_name='髋、膝关节置换术的总例数(女)'
,zbzt='0'
 where zb_id='ZLZB_SS00012'
end
go

/*********No.12: ZLZB_SS00012******ZB_FACT_DIM_YS***ZLZB_SS00012*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS00012')
begin
update ZB_FACT_DIM_YS set
dim_table='重返类型'
,dim_table_name='DIM_CFLX'
,dim_table_val='cfmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS00012'
,fz_fact_val='1'
,join_code='cflxkey'
,next_join_code='cflxkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS00012'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS00012'
end
go

/*********No.13: ZLZB_SS0028******ZBMX***ZLZB_SS0028*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0028')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0028'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='冠状动脉旁路移植术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0028'
end
go

/*********No.13: ZLZB_SS0028******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0028*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0028')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0028'
 where zb_id='ZLZB_SS0028'
end
go

/*********No.13: ZLZB_SS0028******HD_ZBMX_HZ***ZLZB_SS0028*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0028')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10942'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0028'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0028'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0028'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=6    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0028'
,zb_name='冠状动脉旁路移植术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0028'
end
go

/*********No.13: ZLZB_SS0028******ZB_FACT_DIM_YS***ZLZB_SS0028*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0028')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0028'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0028'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0028'
end
go

/*********No.14: ZLZB_SS0051******ZBMX***ZLZB_SS0051*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0051')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0051'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='阴道分娩的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0051'
end
go

/*********No.14: ZLZB_SS0051******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0051*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0051')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0051'
 where zb_id='ZLZB_SS0051'
end
go

/*********No.14: ZLZB_SS0051******HD_ZBMX_HZ***ZLZB_SS0051*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0051')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10970'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0051'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=11   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0051'
,zb_name='阴道分娩的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0051'
end
go

/*********No.14: ZLZB_SS0051******ZB_FACT_DIM_YS***ZLZB_SS0051*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0051')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0051'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0051'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0051'
end
go

/*********No.15: ZLZB_SS0076******ZBMX***ZLZB_SS0076*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0076')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0076'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾与前列腺相关手术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0076'
end
go

/*********No.15: ZLZB_SS0076******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0076*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0076')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0076'
 where zb_id='ZLZB_SS0076'
end
go

/*********No.15: ZLZB_SS0076******HD_ZBMX_HZ***ZLZB_SS0076*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0076')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11000'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0076'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0076'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0076'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=16   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0076'
,zb_name='肾与前列腺相关手术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0076'
end
go

/*********No.15: ZLZB_SS0076******ZB_FACT_DIM_YS***ZLZB_SS0076*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0076')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0076'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0076'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0076'
end
go

/*********No.16: ZLZB_SS0089******ZBMX***ZLZB_SS0089*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0089')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0089'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='恶性肿瘤手术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0089'
end
go

/*********No.16: ZLZB_SS0089******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0089*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0089')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0089'
 where zb_id='ZLZB_SS0089'
end
go

/*********No.16: ZLZB_SS0089******HD_ZBMX_HZ***ZLZB_SS0089*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0089')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11015'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0089'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0089'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0089'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=18    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0089'
,zb_name='恶性肿瘤手术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0089'
end
go

/*********No.16: ZLZB_SS0089******ZB_FACT_DIM_YS***ZLZB_SS0089*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0089')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0089'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0089'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0089'
end
go

/*********No.17: ZLZB_SS0094******ZBMX***ZLZB_SS0094*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0094')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0094'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='甲状腺癌联合根治术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0094'
end
go

/*********No.17: ZLZB_SS0094******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0094*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0094')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0094'
 where zb_id='ZLZB_SS0094'
end
go

/*********No.17: ZLZB_SS0094******HD_ZBMX_HZ***ZLZB_SS0094*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0094')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11021'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0094'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0094'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0094'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=19    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0094'
,zb_name='甲状腺癌联合根治术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0094'
end
go

/*********No.17: ZLZB_SS0094******ZB_FACT_DIM_YS***ZLZB_SS0094*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0094')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0094'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0094'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0094'
end
go

/*********No.18: ZLZB_SS0096******ZBMX***ZLZB_SS0096*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0096')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0096'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='喉癌联合根治术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0096'
end
go

/*********No.18: ZLZB_SS0096******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0096*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0096')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0096'
 where zb_id='ZLZB_SS0096'
end
go

/*********No.18: ZLZB_SS0096******HD_ZBMX_HZ***ZLZB_SS0096*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0096')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11024'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0096'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0096'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0096'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=20   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0096'
,zb_name='喉癌联合根治术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0096'
end
go

/*********No.18: ZLZB_SS0096******ZB_FACT_DIM_YS***ZLZB_SS0096*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0096')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0096'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0096'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0096'
end
go

/*********No.19: ZLZB_SS0101******ZBMX***ZLZB_SS0101*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0101')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0101'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺叶切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0101'
end
go

/*********No.19: ZLZB_SS0101******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0101*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0101')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0101'
 where zb_id='ZLZB_SS0101'
end
go

/*********No.19: ZLZB_SS0101******HD_ZBMX_HZ***ZLZB_SS0101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11037'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0101'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0101'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0101'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=21   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0101'
,zb_name='肺叶切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0101'
end
go

/*********No.19: ZLZB_SS0101******ZB_FACT_DIM_YS***ZLZB_SS0101*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0101')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0101'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0101'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0101'
end
go

/*********No.20: ZLZB_SS0102******ZBMX***ZLZB_SS0102*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0102')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0102'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺叶切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0102'
end
go

/*********No.20: ZLZB_SS0102******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0102*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0102')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0102'
 where zb_id='ZLZB_SS0102'
end
go

/*********No.20: ZLZB_SS0102******HD_ZBMX_HZ***ZLZB_SS0102*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0102')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11039'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0102'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0102'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0102'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=21  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0102'
,zb_name='肺叶切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0102'
end
go

/*********No.20: ZLZB_SS0102******ZB_FACT_DIM_YS***ZLZB_SS0102*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0102')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0102'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0102'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0102'
end
go

/*********No.21: ZLZB_SS0216******ZBMX***ZLZB_SS0216*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0216')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0216'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾肿瘤保留肾单位手术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0216'
end
go

/*********No.21: ZLZB_SS0216******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0216*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0216')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0216'
 where zb_id='ZLZB_SS0216'
end
go

/*********No.21: ZLZB_SS0216******HD_ZBMX_HZ***ZLZB_SS0216*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0216')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11176'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0216'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0216'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0216'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=44   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0216'
,zb_name='肾肿瘤保留肾单位手术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0216'
end
go

/*********No.21: ZLZB_SS0216******ZB_FACT_DIM_YS***ZLZB_SS0216*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0216')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0216'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0216'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0216'
end
go

/*********No.22: ZLZB_SS0217******ZBMX***ZLZB_SS0217*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0217')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0217'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾肿瘤保留肾单位手术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0217'
end
go

/*********No.22: ZLZB_SS0217******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0217*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0217')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0217'
 where zb_id='ZLZB_SS0217'
end
go

/*********No.22: ZLZB_SS0217******HD_ZBMX_HZ***ZLZB_SS0217*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0217')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11177'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0217'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0217'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0217'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=44  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0217'
,zb_name='肾肿瘤保留肾单位手术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0217'
end
go

/*********No.22: ZLZB_SS0217******ZB_FACT_DIM_YS***ZLZB_SS0217*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0217')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0217'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0217'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0217'
end
go

/*********No.23: ZLZB_SS0218******ZBMX***ZLZB_SS0218*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0218')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0218'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾肿瘤保留肾单位手术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0218'
end
go

/*********No.23: ZLZB_SS0218******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0218*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0218')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0218'
 where zb_id='ZLZB_SS0218'
end
go

/*********No.23: ZLZB_SS0218******HD_ZBMX_HZ***ZLZB_SS0218*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0218')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11178'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0218'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0218'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0218'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=44    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0218'
,zb_name='肾肿瘤保留肾单位手术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0218'
end
go

/*********No.23: ZLZB_SS0218******ZB_FACT_DIM_YS***ZLZB_SS0218*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0218')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0218'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0218'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0218'
end
go

/*********No.24: ZLZB_SS0219******ZBMX***ZLZB_SS0219*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0219')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0219'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾肿瘤保留肾单位手术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0219'
end
go

/*********No.24: ZLZB_SS0219******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0219*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0219')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0219'
 where zb_id='ZLZB_SS0219'
end
go

/*********No.24: ZLZB_SS0219******HD_ZBMX_HZ***ZLZB_SS0219*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0219')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11179'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0219'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0219'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0219'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=44    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0219'
,zb_name='肾肿瘤保留肾单位手术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0219'
end
go

/*********No.24: ZLZB_SS0219******ZB_FACT_DIM_YS***ZLZB_SS0219*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0219')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0219'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0219'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0219'
end
go

/*********No.25: ZLZB_SS0220******ZBMX***ZLZB_SS0220*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0220')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0220'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾肿瘤保留肾单位手术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0220'
end
go

/*********No.25: ZLZB_SS0220******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0220*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0220')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0220'
 where zb_id='ZLZB_SS0220'
end
go

/*********No.25: ZLZB_SS0220******HD_ZBMX_HZ***ZLZB_SS0220*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0220')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11180'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0220'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0220'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0220'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=44    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0220'
,zb_name='肾肿瘤保留肾单位手术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0220'
end
go

/*********No.25: ZLZB_SS0220******ZB_FACT_DIM_YS***ZLZB_SS0220*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0220')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0220'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0220'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0220'
end
go

/*********No.26: ZLZB_SS0221******ZBMX***ZLZB_SS0221*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0221')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0221'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='前列腺癌根治术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0221'
end
go

/*********No.26: ZLZB_SS0221******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0221*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0221')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0221'
 where zb_id='ZLZB_SS0221'
end
go

/*********No.26: ZLZB_SS0221******HD_ZBMX_HZ***ZLZB_SS0221*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0221')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11182'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0221'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0221'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0221'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=45   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0221'
,zb_name='前列腺癌根治术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0221'
end
go

/*********No.26: ZLZB_SS0221******ZB_FACT_DIM_YS***ZLZB_SS0221*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0221')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0221'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0221'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0221'
end
go

/*********No.27: ZLZB_SS0222******ZBMX***ZLZB_SS0222*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0222')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0222'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='前列腺癌根治术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0222'
end
go

/*********No.27: ZLZB_SS0222******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0222*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0222')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0222'
 where zb_id='ZLZB_SS0222'
end
go

/*********No.27: ZLZB_SS0222******HD_ZBMX_HZ***ZLZB_SS0222*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0222')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11183'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0222'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0222'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0222'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=45  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0222'
,zb_name='前列腺癌根治术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0222'
end
go

/*********No.27: ZLZB_SS0222******ZB_FACT_DIM_YS***ZLZB_SS0222*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0222')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0222'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0222'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0222'
end
go

/*********No.28: ZLZB_SS0223******ZBMX***ZLZB_SS0223*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0223')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0223'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='前列腺癌根治术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0223'
end
go

/*********No.28: ZLZB_SS0223******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0223*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0223')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0223'
 where zb_id='ZLZB_SS0223'
end
go

/*********No.28: ZLZB_SS0223******HD_ZBMX_HZ***ZLZB_SS0223*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0223')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11184'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0223'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0223'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0223'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=45    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0223'
,zb_name='前列腺癌根治术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0223'
end
go

/*********No.28: ZLZB_SS0223******ZB_FACT_DIM_YS***ZLZB_SS0223*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0223')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0223'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0223'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0223'
end
go

/*********No.29: ZLZB_SS0224******ZBMX***ZLZB_SS0224*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0224')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0224'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='前列腺癌根治术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0224'
end
go

/*********No.29: ZLZB_SS0224******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0224*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0224')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0224'
 where zb_id='ZLZB_SS0224'
end
go

/*********No.29: ZLZB_SS0224******HD_ZBMX_HZ***ZLZB_SS0224*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0224')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11185'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0224'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0224'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0224'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=45    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0224'
,zb_name='前列腺癌根治术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0224'
end
go

/*********No.29: ZLZB_SS0224******ZB_FACT_DIM_YS***ZLZB_SS0224*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0224')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0224'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0224'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0224'
end
go

/*********No.30: ZLZB_SS0225******ZBMX***ZLZB_SS0225*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0225')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0225'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='前列腺癌根治术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0225'
end
go

/*********No.30: ZLZB_SS0225******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0225*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0225')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0225'
 where zb_id='ZLZB_SS0225'
end
go

/*********No.30: ZLZB_SS0225******HD_ZBMX_HZ***ZLZB_SS0225*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0225')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11186'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0225'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0225'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0225'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=45    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0225'
,zb_name='前列腺癌根治术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0225'
end
go

/*********No.30: ZLZB_SS0225******ZB_FACT_DIM_YS***ZLZB_SS0225*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0225')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0225'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0225'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0225'
end
go

/*********No.31: ZLZB_SS0226******ZBMX***ZLZB_SS0226*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0226')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0226'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性膀胱切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0226'
end
go

/*********No.31: ZLZB_SS0226******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0226*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0226')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0226'
 where zb_id='ZLZB_SS0226'
end
go

/*********No.31: ZLZB_SS0226******HD_ZBMX_HZ***ZLZB_SS0226*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0226')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11188'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0226'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0226'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0226'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=46   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0226'
,zb_name='根治性膀胱切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0226'
end
go

/*********No.31: ZLZB_SS0226******ZB_FACT_DIM_YS***ZLZB_SS0226*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0226')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0226'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0226'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0226'
end
go

/*********No.32: ZLZB_SS0227******ZBMX***ZLZB_SS0227*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0227')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0227'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性膀胱切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0227'
end
go

/*********No.32: ZLZB_SS0227******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0227*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0227')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0227'
 where zb_id='ZLZB_SS0227'
end
go

/*********No.32: ZLZB_SS0227******HD_ZBMX_HZ***ZLZB_SS0227*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0227')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11189'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0227'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0227'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0227'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=46  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0227'
,zb_name='根治性膀胱切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0227'
end
go

/*********No.32: ZLZB_SS0227******ZB_FACT_DIM_YS***ZLZB_SS0227*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0227')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0227'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0227'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0227'
end
go

/*********No.33: ZLZB_SS0228******ZBMX***ZLZB_SS0228*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0228')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0228'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性膀胱切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0228'
end
go

/*********No.33: ZLZB_SS0228******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0228*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0228')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0228'
 where zb_id='ZLZB_SS0228'
end
go

/*********No.33: ZLZB_SS0228******HD_ZBMX_HZ***ZLZB_SS0228*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0228')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11190'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0228'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0228'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0228'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=46    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0228'
,zb_name='根治性膀胱切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0228'
end
go

/*********No.33: ZLZB_SS0228******ZB_FACT_DIM_YS***ZLZB_SS0228*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0228')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0228'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0228'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0228'
end
go

/*********No.34: ZLZB_SS0229******ZBMX***ZLZB_SS0229*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0229')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0229'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性膀胱切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0229'
end
go

/*********No.34: ZLZB_SS0229******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0229*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0229')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0229'
 where zb_id='ZLZB_SS0229'
end
go

/*********No.34: ZLZB_SS0229******HD_ZBMX_HZ***ZLZB_SS0229*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0229')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11191'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0229'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0229'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0229'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=46    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0229'
,zb_name='根治性膀胱切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0229'
end
go

/*********No.34: ZLZB_SS0229******ZB_FACT_DIM_YS***ZLZB_SS0229*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0229')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0229'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0229'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0229'
end
go

/*********No.35: ZLZB_SS0230******ZBMX***ZLZB_SS0230*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0230')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0230'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性膀胱切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0230'
end
go

/*********No.35: ZLZB_SS0230******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0230*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0230')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0230'
 where zb_id='ZLZB_SS0230'
end
go

/*********No.35: ZLZB_SS0230******HD_ZBMX_HZ***ZLZB_SS0230*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0230')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11192'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0230'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0230'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0230'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=46    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0230'
,zb_name='根治性膀胱切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0230'
end
go

/*********No.35: ZLZB_SS0230******ZB_FACT_DIM_YS***ZLZB_SS0230*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0230')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0230'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0230'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0230'
end
go

/*********No.36: ZLZB_SS0231******ZBMX***ZLZB_SS0231*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0231')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0231'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='双侧输卵管-卵癌切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0231'
end
go

/*********No.36: ZLZB_SS0231******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0231*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0231')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0231'
 where zb_id='ZLZB_SS0231'
end
go

/*********No.36: ZLZB_SS0231******HD_ZBMX_HZ***ZLZB_SS0231*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0231')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11194'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0231'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0231'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0231'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=47   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0231'
,zb_name='双侧输卵管-卵癌切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0231'
end
go

/*********No.36: ZLZB_SS0231******ZB_FACT_DIM_YS***ZLZB_SS0231*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0231')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0231'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0231'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0231'
end
go

/*********No.37: ZLZB_SS0232******ZBMX***ZLZB_SS0232*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0232')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0232'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='双侧输卵管-卵癌切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0232'
end
go

/*********No.37: ZLZB_SS0232******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0232*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0232')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0232'
 where zb_id='ZLZB_SS0232'
end
go

/*********No.37: ZLZB_SS0232******HD_ZBMX_HZ***ZLZB_SS0232*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0232')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11195'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0232'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0232'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0232'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=47  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0232'
,zb_name='双侧输卵管-卵癌切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0232'
end
go

/*********No.37: ZLZB_SS0232******ZB_FACT_DIM_YS***ZLZB_SS0232*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0232')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0232'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0232'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0232'
end
go

/*********No.38: ZLZB_SS0233******ZBMX***ZLZB_SS0233*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0233')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0233'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='双侧输卵管-卵癌切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0233'
end
go

/*********No.38: ZLZB_SS0233******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0233*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0233')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0233'
 where zb_id='ZLZB_SS0233'
end
go

/*********No.38: ZLZB_SS0233******HD_ZBMX_HZ***ZLZB_SS0233*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0233')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11196'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0233'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0233'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0233'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=47    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0233'
,zb_name='双侧输卵管-卵癌切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0233'
end
go

/*********No.38: ZLZB_SS0233******ZB_FACT_DIM_YS***ZLZB_SS0233*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0233')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0233'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0233'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0233'
end
go

/*********No.39: ZLZB_SS0234******ZBMX***ZLZB_SS0234*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0234')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0234'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='双侧输卵管-卵癌切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0234'
end
go

/*********No.39: ZLZB_SS0234******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0234*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0234')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0234'
 where zb_id='ZLZB_SS0234'
end
go

/*********No.39: ZLZB_SS0234******HD_ZBMX_HZ***ZLZB_SS0234*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0234')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11197'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0234'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0234'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0234'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=47    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0234'
,zb_name='双侧输卵管-卵癌切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0234'
end
go

/*********No.39: ZLZB_SS0234******ZB_FACT_DIM_YS***ZLZB_SS0234*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0234')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0234'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0234'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0234'
end
go

/*********No.40: ZLZB_SS0235******ZBMX***ZLZB_SS0235*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0235')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0235'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='双侧输卵管-卵癌切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0235'
end
go

/*********No.40: ZLZB_SS0235******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0235*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0235')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0235'
 where zb_id='ZLZB_SS0235'
end
go

/*********No.40: ZLZB_SS0235******HD_ZBMX_HZ***ZLZB_SS0235*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0235')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11198'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0235'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0235'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0235'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=47    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0235'
,zb_name='双侧输卵管-卵癌切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0235'
end
go

/*********No.40: ZLZB_SS0235******ZB_FACT_DIM_YS***ZLZB_SS0235*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0235')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0235'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0235'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0235'
end
go

/*********No.41: ZLZB_SS0236******ZBMX***ZLZB_SS0236*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0236')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0236'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全子宫切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0236'
end
go

/*********No.41: ZLZB_SS0236******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0236*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0236')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0236'
 where zb_id='ZLZB_SS0236'
end
go

/*********No.41: ZLZB_SS0236******HD_ZBMX_HZ***ZLZB_SS0236*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0236')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11200'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0236'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0236'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0236'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=48   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0236'
,zb_name='全子宫切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0236'
end
go

/*********No.41: ZLZB_SS0236******ZB_FACT_DIM_YS***ZLZB_SS0236*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0236')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0236'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0236'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0236'
end
go

/*********No.42: ZLZB_SS0237******ZBMX***ZLZB_SS0237*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0237')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0237'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全子宫切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0237'
end
go

/*********No.42: ZLZB_SS0237******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0237*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0237')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0237'
 where zb_id='ZLZB_SS0237'
end
go

/*********No.42: ZLZB_SS0237******HD_ZBMX_HZ***ZLZB_SS0237*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0237')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11201'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0237'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0237'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0237'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=48  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0237'
,zb_name='全子宫切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0237'
end
go

/*********No.42: ZLZB_SS0237******ZB_FACT_DIM_YS***ZLZB_SS0237*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0237')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0237'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0237'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0237'
end
go

/*********No.43: ZLZB_SS0238******ZBMX***ZLZB_SS0238*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0238')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0238'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全子宫切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0238'
end
go

/*********No.43: ZLZB_SS0238******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0238*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0238')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0238'
 where zb_id='ZLZB_SS0238'
end
go

/*********No.43: ZLZB_SS0238******HD_ZBMX_HZ***ZLZB_SS0238*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0238')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11202'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0238'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0238'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0238'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=48    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0238'
,zb_name='全子宫切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0238'
end
go

/*********No.43: ZLZB_SS0238******ZB_FACT_DIM_YS***ZLZB_SS0238*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0238')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0238'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0238'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0238'
end
go

/*********No.44: ZLZB_SS0239******ZBMX***ZLZB_SS0239*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0239')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0239'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全子宫切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0239'
end
go

/*********No.44: ZLZB_SS0239******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0239*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0239')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0239'
 where zb_id='ZLZB_SS0239'
end
go

/*********No.44: ZLZB_SS0239******HD_ZBMX_HZ***ZLZB_SS0239*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0239')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11203'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0239'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0239'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0239'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=48    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0239'
,zb_name='全子宫切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0239'
end
go

/*********No.44: ZLZB_SS0239******ZB_FACT_DIM_YS***ZLZB_SS0239*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0239')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0239'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0239'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0239'
end
go

/*********No.45: ZLZB_SS0240******ZBMX***ZLZB_SS0240*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0240')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0240'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全子宫切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0240'
end
go

/*********No.45: ZLZB_SS0240******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0240*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0240')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0240'
 where zb_id='ZLZB_SS0240'
end
go

/*********No.45: ZLZB_SS0240******HD_ZBMX_HZ***ZLZB_SS0240*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0240')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11204'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0240'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0240'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0240'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=48    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0240'
,zb_name='全子宫切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0240'
end
go

/*********No.45: ZLZB_SS0240******ZB_FACT_DIM_YS***ZLZB_SS0240*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0240')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0240'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0240'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0240'
end
go

/*********No.46: ZLZB_SS0241******ZBMX***ZLZB_SS0241*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0241')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0241'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='盆腔淋巴结清扫术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0241'
end
go

/*********No.46: ZLZB_SS0241******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0241*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0241')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0241'
 where zb_id='ZLZB_SS0241'
end
go

/*********No.46: ZLZB_SS0241******HD_ZBMX_HZ***ZLZB_SS0241*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0241')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11206'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0241'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0241'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0241'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=49   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0241'
,zb_name='盆腔淋巴结清扫术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0241'
end
go

/*********No.46: ZLZB_SS0241******ZB_FACT_DIM_YS***ZLZB_SS0241*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0241')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0241'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0241'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0241'
end
go

/*********No.47: ZLZB_SS0242******ZBMX***ZLZB_SS0242*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0242')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0242'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='盆腔淋巴结清扫术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0242'
end
go

/*********No.47: ZLZB_SS0242******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0242*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0242')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0242'
 where zb_id='ZLZB_SS0242'
end
go

/*********No.47: ZLZB_SS0242******HD_ZBMX_HZ***ZLZB_SS0242*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0242')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11207'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0242'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0242'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0242'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=49  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0242'
,zb_name='盆腔淋巴结清扫术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0242'
end
go

/*********No.47: ZLZB_SS0242******ZB_FACT_DIM_YS***ZLZB_SS0242*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0242')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0242'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0242'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0242'
end
go

/*********No.48: ZLZB_SS0243******ZBMX***ZLZB_SS0243*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0243')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0243'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='盆腔淋巴结清扫术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0243'
end
go

/*********No.48: ZLZB_SS0243******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0243*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0243')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0243'
 where zb_id='ZLZB_SS0243'
end
go

/*********No.48: ZLZB_SS0243******HD_ZBMX_HZ***ZLZB_SS0243*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0243')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11208'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0243'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0243'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0243'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=49    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0243'
,zb_name='盆腔淋巴结清扫术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0243'
end
go

/*********No.48: ZLZB_SS0243******ZB_FACT_DIM_YS***ZLZB_SS0243*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0243')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0243'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0243'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0243'
end
go

/*********No.49: ZLZB_SS0244******ZBMX***ZLZB_SS0244*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0244')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0244'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='盆腔淋巴结清扫术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0244'
end
go

/*********No.49: ZLZB_SS0244******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0244*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0244')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0244'
 where zb_id='ZLZB_SS0244'
end
go

/*********No.49: ZLZB_SS0244******HD_ZBMX_HZ***ZLZB_SS0244*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0244')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11209'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0244'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0244'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0244'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=49    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0244'
,zb_name='盆腔淋巴结清扫术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0244'
end
go

/*********No.49: ZLZB_SS0244******ZB_FACT_DIM_YS***ZLZB_SS0244*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0244')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0244'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0244'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0244'
end
go

/*********No.50: ZLZB_SS0245******ZBMX***ZLZB_SS0245*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0245')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0245'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='盆腔淋巴结清扫术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0245'
end
go

/*********No.50: ZLZB_SS0245******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0245*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0245')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0245'
 where zb_id='ZLZB_SS0245'
end
go

/*********No.50: ZLZB_SS0245******HD_ZBMX_HZ***ZLZB_SS0245*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0245')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11210'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0245'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0245'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0245'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=49    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0245'
,zb_name='盆腔淋巴结清扫术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0245'
end
go

/*********No.50: ZLZB_SS0245******ZB_FACT_DIM_YS***ZLZB_SS0245*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0245')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0245'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0245'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0245'
end
go

/*********No.51: ZLZB_SS02401******ZBMX***ZLZB_SS02401*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02401')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02401'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02401'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全子宫切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02401'
end
go

/*********No.51: ZLZB_SS02401******HD_ZBMX_HZ***ZLZB_SS02401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11205'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02401'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02401'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=48    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02401'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=48    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02401'
,zb_name='全子宫切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02401'
end
go

/*********No.52: ZLZB_SS02451******ZBMX***ZLZB_SS02451*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02451')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02451'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02451'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='盆腔淋巴结清扫术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02451'
end
go

/*********No.52: ZLZB_SS02451******HD_ZBMX_HZ***ZLZB_SS02451*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02451')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11211'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02451'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02451'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=49    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02451'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=49    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02451'
,zb_name='盆腔淋巴结清扫术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02451'
end
go

/*********No.53: ZLZB_SS01008******ZBMX***ZLZB_SS01008*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01008')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01008'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01008'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='患者人次'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01008'
end
go

/*********No.53: ZLZB_SS01008******HD_ZBMX_HZ***ZLZB_SS01008*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01008')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11035'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle='select ''ZLZB_SS01008'' zbmx_id,  timekey, yykey ,kskey ,sexkey,nldkey,zytskey,cflxkey,zdsskey, sum(rc)  fz,  0 fm from FACT_GZ_HZAQ_ZDSS a where  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey,sexkey,nldkey,zytskey,cflxkey,zdsskey'
,sql_start='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( select ''ZLZB_SS01008'' zbmx_id,  timekey, yykey ,kskey ,sexkey,nldkey,zytskey,cflxkey,zdsskey, sum(rc)  fz,  0 fm from FACT_GZ_HZAQ_ZDSS a where  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey,sexkey,nldkey,zytskey,cflxkey,zdsskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01008'' zbmx_id,  timekey, yykey ,kskey , sum(rc)  fz,  0 fm from FACT_GZ_HZAQ_ZDSS where  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey            ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01008'
,zb_name='患者人次'
,zbzt='0'
 where zb_id='ZLZB_SS01008'
end
go

/*********No.54: ZLZB_SS1001******ZBMX***ZLZB_SS1001*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS1001')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS1001'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS1001'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='重点手术种数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS1001'
end
go

/*********No.54: ZLZB_SS1001******HD_ZBMX_HZ***ZLZB_SS1001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS1001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11218'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS1001'' zbmx_id, CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')  timekey,   yykey ,kskey , count(distinct zdsskey ) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1''),yykey,kskey'
,sql_start='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS1001'' zbmx_id, CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')  timekey,   yykey ,kskey , count(distinct zdsskey ) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1''),yykey,kskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS1001'' zbmx_id, CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')  timekey,   yykey , -1 kskey , count(distinct zdsskey ) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1''),yykey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS1001'
,zb_name='重点手术种数'
,zbzt='0'
 where zb_id='ZLZB_SS1001'
end
go

/*********No.54: ZLZB_SS1001******ZB_FACT_DIM_YS***ZLZB_SS1001*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS1001')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS1001'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS1001'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS1001'
end
go

/*********No.55: ZLZB_SS00551******ZBMX***ZLZB_SS00551*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00551')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00551'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00551'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='阴道分娩的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00551'
end
go

/*********No.55: ZLZB_SS00551******HD_ZBMX_HZ***ZLZB_SS00551*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00551')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10975'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00551'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00551'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00551'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=11    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00551'
,zb_name='阴道分娩的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00551'
end
go

/*********No.56: ZLZB_SS00601******ZBMX***ZLZB_SS00601*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00601')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00601'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00601'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺手术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00601'
end
go

/*********No.56: ZLZB_SS00601******HD_ZBMX_HZ***ZLZB_SS00601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00601')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10981'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00601'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00601'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00601'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=12    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00601'
,zb_name='乳腺手术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00601'
end
go

/*********No.57: ZLZB_SS00651******ZBMX***ZLZB_SS00651*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00651')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00651'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00651'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00651'
end
go

/*********No.57: ZLZB_SS00651******HD_ZBMX_HZ***ZLZB_SS00651*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00651')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10987'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00651'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00651'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00651'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=13    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00651'
,zb_name='肺切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00651'
end
go

/*********No.58: ZLZB_SS00701******ZBMX***ZLZB_SS00701*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00701')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00701'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00701'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00701'
end
go

/*********No.58: ZLZB_SS00701******HD_ZBMX_HZ***ZLZB_SS00701*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00701')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10993'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00701'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00701'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00701'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=14    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00701'
,zb_name='胃切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00701'
end
go

/*********No.59: ZLZB_SS00751******ZBMX***ZLZB_SS00751*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00751')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00751'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00751'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00751'
end
go

/*********No.59: ZLZB_SS00751******HD_ZBMX_HZ***ZLZB_SS00751*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00751')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10999'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00751'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00751'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00751'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=15    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00751'
,zb_name='直肠切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00751'
end
go

/*********No.60: ZLZB_SS00801******ZBMX***ZLZB_SS00801*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00801')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00801'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00801'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾与前列腺相关手术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00801'
end
go

/*********No.60: ZLZB_SS00801******HD_ZBMX_HZ***ZLZB_SS00801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00801')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11005'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00801'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00801'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00801'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=16    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00801'
,zb_name='肾与前列腺相关手术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00801'
end
go

/*********No.61: ZLZB_SS00851******ZBMX***ZLZB_SS00851*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00851')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00851'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00851'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='血管内修补术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00851'
end
go

/*********No.61: ZLZB_SS00851******HD_ZBMX_HZ***ZLZB_SS00851*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00851')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11011'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00851'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00851'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00851'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=17    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00851'
,zb_name='血管内修补术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00851'
end
go

/*********No.62: ZLZB_SS00901******ZBMX***ZLZB_SS00901*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00901')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00901'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00901'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='恶性肿瘤手术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00901'
end
go

/*********No.62: ZLZB_SS00901******HD_ZBMX_HZ***ZLZB_SS00901*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00901')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11017'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00901'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00901'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00901'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=18    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00901'
,zb_name='恶性肿瘤手术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00901'
end
go

/*********No.63: ZLZB_SS00951******ZBMX***ZLZB_SS00951*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00951')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00951'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00951'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='甲状腺癌联合根治术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00951'
end
go

/*********No.63: ZLZB_SS00951******HD_ZBMX_HZ***ZLZB_SS00951*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00951')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11023'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00951'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00951'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00951'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=19    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00951'
,zb_name='甲状腺癌联合根治术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00951'
end
go

/*********No.64: ZLZB_SS01001******ZBMX***ZLZB_SS01001*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01001')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01001'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01001'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='喉癌联合根治术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01001'
end
go

/*********No.64: ZLZB_SS01001******HD_ZBMX_HZ***ZLZB_SS01001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11029'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01001'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01001'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01001'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=20    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01001'
,zb_name='喉癌联合根治术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01001'
end
go

/*********No.64: ZLZB_SS01001******ZB_FACT_DIM_YS***ZLZB_SS01001*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01001')
begin
update ZB_FACT_DIM_YS set
dim_table='病案科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01001'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01001'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01001'
end
go

/*********No.65: ZLZB_SS01051******ZBMX***ZLZB_SS01051*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01051')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01051'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01051'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺叶切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01051'
end
go

/*********No.65: ZLZB_SS01051******HD_ZBMX_HZ***ZLZB_SS01051*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01051')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11043'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01051'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=21    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01051'
,zb_name='肺叶切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01051'
end
go

/*********No.66: ZLZB_SS01101******ZBMX***ZLZB_SS01101*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01101')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01101'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01101'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全肺切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01101'
end
go

/*********No.66: ZLZB_SS01101******HD_ZBMX_HZ***ZLZB_SS01101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11049'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01101'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01101'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01101'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=22    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01101'
,zb_name='全肺切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01101'
end
go

/*********No.67: ZLZB_SS01151******ZBMX***ZLZB_SS01151*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01151')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01151'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01151'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胸腔镜肺癌切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01151'
end
go

/*********No.67: ZLZB_SS01151******HD_ZBMX_HZ***ZLZB_SS01151*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01151')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11055'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01151'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01151'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01151'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=23    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01151'
,zb_name='胸腔镜肺癌切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01151'
end
go

/*********No.68: ZLZB_SS01201******ZBMX***ZLZB_SS01201*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01201')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01201'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01201'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓上吻合术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01201'
end
go

/*********No.68: ZLZB_SS01201******HD_ZBMX_HZ***ZLZB_SS01201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11061'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01201'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01201'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01201'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=24    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01201'
,zb_name='食管部分切除、食管胃弓上吻合术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01201'
end
go

/*********No.69: ZLZB_SS01251******ZBMX***ZLZB_SS01251*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01251')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01251'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01251'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓下吻合术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01251'
end
go

/*********No.69: ZLZB_SS01251******HD_ZBMX_HZ***ZLZB_SS01251*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01251')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11067'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01251'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01251'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01251'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=25    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01251'
,zb_name='食管部分切除、食管胃弓下吻合术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01251'
end
go

/*********No.70: ZLZB_SS01301******ZBMX***ZLZB_SS01301*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01301')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01301'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01301'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃近端切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01301'
end
go

/*********No.70: ZLZB_SS01301******HD_ZBMX_HZ***ZLZB_SS01301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11073'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01301'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01301'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01301'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=26    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01301'
,zb_name='胃近端切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01301'
end
go

/*********No.71: ZLZB_SS01351******ZBMX***ZLZB_SS01351*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01351')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01351'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01351'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃远端切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01351'
end
go

/*********No.71: ZLZB_SS01351******HD_ZBMX_HZ***ZLZB_SS01351*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01351')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11079'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01351'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01351'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01351'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=27    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01351'
,zb_name='胃远端切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01351'
end
go

/*********No.72: ZLZB_SS01401******ZBMX***ZLZB_SS01401*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01401')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01401'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01401'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全胃切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01401'
end
go

/*********No.72: ZLZB_SS01401******HD_ZBMX_HZ***ZLZB_SS01401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11085'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01401'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01401'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01401'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=28    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01401'
,zb_name='全胃切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01401'
end
go

/*********No.73: ZLZB_SS01451******ZBMX***ZLZB_SS01451*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01451')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01451'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01451'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性全胃切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01451'
end
go

/*********No.73: ZLZB_SS01451******HD_ZBMX_HZ***ZLZB_SS01451*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01451')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11091'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01451'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01451'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01451'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=29    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01451'
,zb_name='根治性全胃切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01451'
end
go

/*********No.74: ZLZB_SS01501******ZBMX***ZLZB_SS01501*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01501')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01501'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01501'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝叶切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01501'
end
go

/*********No.74: ZLZB_SS01501******HD_ZBMX_HZ***ZLZB_SS01501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01501')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11097'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01501'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01501'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01501'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=30    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01501'
,zb_name='肝叶切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01501'
end
go

/*********No.75: ZLZB_SS01551******ZBMX***ZLZB_SS01551*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01551')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01551'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01551'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='半肝切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01551'
end
go

/*********No.75: ZLZB_SS01551******HD_ZBMX_HZ***ZLZB_SS01551*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01551')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11103'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01551'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01551'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01551'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=31    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01551'
,zb_name='半肝切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01551'
end
go

/*********No.76: ZLZB_SS01601******ZBMX***ZLZB_SS01601*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01601')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01601'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01601'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝段切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01601'
end
go

/*********No.76: ZLZB_SS01601******HD_ZBMX_HZ***ZLZB_SS01601*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01601')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11109'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01601'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01601'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01601'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=32    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01601'
,zb_name='肝段切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01601'
end
go

/*********No.77: ZLZB_SS01651******ZBMX***ZLZB_SS01651*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01651')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01651'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01651'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝肿物不规则切除术（部分切除术）的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01651'
end
go

/*********No.77: ZLZB_SS01651******HD_ZBMX_HZ***ZLZB_SS01651*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01651')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11115'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01651'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01651'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01651'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=33    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01651'
,zb_name='肝肿物不规则切除术（部分切除术）的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01651'
end
go

/*********No.78: ZLZB_SS01701******ZBMX***ZLZB_SS01701*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01701')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01701'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01701'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='左半结肠切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01701'
end
go

/*********No.78: ZLZB_SS01701******HD_ZBMX_HZ***ZLZB_SS01701*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01701')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11121'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01701'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01701'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01701'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=34    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01701'
,zb_name='左半结肠切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01701'
end
go

/*********No.79: ZLZB_SS01751******ZBMX***ZLZB_SS01751*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01751')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01751'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01751'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='右半结肠切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01751'
end
go

/*********No.79: ZLZB_SS01751******HD_ZBMX_HZ***ZLZB_SS01751*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01751')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11127'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01751'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01751'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01751'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=35    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01751'
,zb_name='右半结肠切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01751'
end
go

/*********No.80: ZLZB_SS01801******ZBMX***ZLZB_SS01801*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01801')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01801'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01801'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠前切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01801'
end
go

/*********No.80: ZLZB_SS01801******HD_ZBMX_HZ***ZLZB_SS01801*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01801')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11133'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01801'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01801'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01801'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=36    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01801'
,zb_name='直肠前切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01801'
end
go

/*********No.81: ZLZB_SS01851******ZBMX***ZLZB_SS01851*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01851')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01851'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01851'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹会阴直肠切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01851'
end
go

/*********No.81: ZLZB_SS01851******HD_ZBMX_HZ***ZLZB_SS01851*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01851')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11139'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01851'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01851'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01851'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=37    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01851'
,zb_name='腹会阴直肠切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01851'
end
go

/*********No.82: ZLZB_SS01901******ZBMX***ZLZB_SS01901*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01901')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01901'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01901'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜结直肠癌根治术手术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01901'
end
go

/*********No.82: ZLZB_SS01901******HD_ZBMX_HZ***ZLZB_SS01901*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01901')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11145'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01901'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01901'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01901'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=38    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01901'
,zb_name='腹腔镜结直肠癌根治术手术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01901'
end
go

/*********No.83: ZLZB_SS01951******ZBMX***ZLZB_SS01951*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01951')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01951'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01951'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='惠普尔氏术（根治性胰十二指肠切除术）的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01951'
end
go

/*********No.83: ZLZB_SS01951******HD_ZBMX_HZ***ZLZB_SS01951*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01951')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11151'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01951'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01951'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS01951'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=39    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01951'
,zb_name='惠普尔氏术（根治性胰十二指肠切除术）的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01951'
end
go

/*********No.84: ZLZB_SS0022******ZBMX***ZLZB_SS0022*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0022')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0022'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜下胆囊切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0022'
end
go

/*********No.84: ZLZB_SS0022******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0022*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0022')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0022'
 where zb_id='ZLZB_SS0022'
end
go

/*********No.84: ZLZB_SS0022******HD_ZBMX_HZ***ZLZB_SS0022*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0022')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10935'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0022'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0022'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0022'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=5  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0022'
,zb_name='腹腔镜下胆囊切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0022'
end
go

/*********No.84: ZLZB_SS0022******ZB_FACT_DIM_YS***ZLZB_SS0022*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0022')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0022'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0022'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0022'
end
go

/*********No.85: ZLZB_SS0023******ZBMX***ZLZB_SS0023*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0023')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0023'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜下胆囊切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0023'
end
go

/*********No.85: ZLZB_SS0023******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0023*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0023')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0023'
 where zb_id='ZLZB_SS0023'
end
go

/*********No.85: ZLZB_SS0023******HD_ZBMX_HZ***ZLZB_SS0023*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0023')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10936'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0023'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0023'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0023'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=5    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0023'
,zb_name='腹腔镜下胆囊切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0023'
end
go

/*********No.85: ZLZB_SS0023******ZB_FACT_DIM_YS***ZLZB_SS0023*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0023')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0023'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0023'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0023'
end
go

/*********No.86: ZLZB_SS00052******ZBMX***ZLZB_SS00052*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00052')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00052'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00052'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的总费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00052'
end
go

/*********No.86: ZLZB_SS00052******HD_ZBMX_HZ***ZLZB_SS00052*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00052')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10915'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00052'' zbmx_id, dxmkey,   timekey, yykey ,kskey ,  sum(cffy) fz, 0 fm from FACT_GZ_ZDSS_FYFX a  where zdsskey=1 and timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey ,dxmkey ,timekey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00052'' zbmx_id, dxmkey,   timekey, yykey ,kskey ,  sum(cffy) fz, 0 fm from FACT_GZ_ZDSS_FYFX  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey ,dxmkey ,timekey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00052'' zbmx_id, dxmkey,   timekey, yykey ,kskey ,  sum(cffy) fz, 0 fm from FACT_GZ_ZDSS_FYFX  where zdsskey=1    and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey ,dxmkey ,timekey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00052'
,zb_name='髋、膝关节置换术的总费用'
,zbzt='0'
 where zb_id='ZLZB_SS00052'
end
go

/*********No.86: ZLZB_SS00052******ZB_FACT_DIM_YS***ZLZB_SS00052*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS00052')
begin
update ZB_FACT_DIM_YS set
dim_table='大项目'
,dim_table_name='DIM_SFDXMK'
,dim_table_val='dxmmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS00052'
,fz_fact_val='1'
,join_code='dxmkey'
,next_join_code='dxmkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS00052'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS00052'
end
go

/*********No.87: ZLZB_SS1003******ZBMX***ZLZB_SS1003*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS1003')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS1003'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS1003'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='术前住院天数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS1003'
end
go

/*********No.87: ZLZB_SS1003******HD_ZBMX_HZ***ZLZB_SS1003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS1003')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11219'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS1003'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(sqzyts) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where  sqzyts is not null     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS1003'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(sqzyts) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where  sqzyts is not null     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS1003'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(sqzyts) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where  sqzyts is not null     and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS1003'
,zb_name='术前住院天数'
,zbzt='0'
 where zb_id='ZLZB_SS1003'
end
go

/*********No.87: ZLZB_SS1003******ZB_FACT_DIM_YS***ZLZB_SS1003*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS1003')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS1003'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS1003'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS1003'
end
go

/*********No.88: ZLZB_SS1002******ZBMX***ZLZB_SS1002*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS1002')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS1002'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS1002'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='术前平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS1002'
end
go

/*********No.88: ZLZB_SS1002******HD_ZBMX_HZ***ZLZB_SS1002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS1002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='ZLZB_SS01008,ZLZB_SS1003'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11453'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS1002'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(sqzyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where  sqzyts is not null     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS1002'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(sqzyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where  sqzyts is not null     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT  ''ZLZB_SS1002''  zbmx_id,yykey,yydm,kskey,ksdm,month,SUM(fz) fz,SUM(fm) fm ,NULL czry,getdate() gxrq,null bqkey
FROM
(
SELECT yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm 
FROM FACT_RESULT_KS_VALUE_M 
WHERE dateadd(year,1,month) < getdate() and zbmx_id =''ZLZB_SS1003''
         and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL
SELECT yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm 
FROM FACT_RESULT_KS_VALUE_M 
WHERE dateadd(year,1,month) < getdate() and zbmx_id =''ZLZB_SS01008''
       and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t
GROUP BY yykey,yydm,kskey,ksdm,month '
,ysfs='-1'
,zb_id='ZLZB_SS1002'
,zb_name='术前平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS1002'
end
go

/*********No.88: ZLZB_SS1002******ZB_FACT_DIM_YS***ZLZB_SS1002*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS1002')
begin
update ZB_FACT_DIM_YS set
dim_table='病案科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='ZLZB_SS01008'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS1003'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS1002'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS1002'
end
go

/*********No.89: ZLZB_SS01009******ZBMX***ZLZB_SS01009*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01009')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01009'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01009'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='重点手术住院总日数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01009'
end
go

/*********No.89: ZLZB_SS01009******HD_ZBMX_HZ***ZLZB_SS01009*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01009')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11036'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')     '
,sql_middle=' select ''ZLZB_SS01009'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a where timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey   '
,sql_start='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01009'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a where timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey     ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')     '
,sql_text_first=''
,tqsql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01009'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, 0 fm from FACT_GZ_HZAQ_ZDSS where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey     ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')     '
,ysfs='-1'
,zb_id='ZLZB_SS01009'
,zb_name='重点手术住院总日数'
,zbzt='0'
 where zb_id='ZLZB_SS01009'
end
go

/*********No.89: ZLZB_SS01009******ZB_FACT_DIM_YS***ZLZB_SS01009*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01009')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01009'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01009'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01009'
end
go

/*********No.90: ZLZB_SS00051******ZBMX***ZLZB_SS00051*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00051')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00051'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00051'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的均次药费'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00051'
end
go

/*********No.90: ZLZB_SS00051******HD_ZBMX_HZ***ZLZB_SS00051*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00051')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10914'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,mzyskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,mzyskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=1    and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00051'
,zb_name='髋、膝关节置换术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00051'
end
go

/*********No.90: ZLZB_SS00051******ZB_FACT_DIM_YS***ZLZB_SS00051*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS00051')
begin
update ZB_FACT_DIM_YS set
dim_table='大项目'
,dim_table_name='DIM_SFDXMK'
,dim_table_val='dxmmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS00051'
,fz_fact_val='1'
,join_code='dxmkey'
,next_join_code='dxmkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS00051'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS00051'
end
go

/*********No.91: ZLZB_SS0024******ZBMX***ZLZB_SS0024*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0024')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0024'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜下胆囊切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0024'
end
go

/*********No.91: ZLZB_SS0024******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0024*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0024')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0024'
 where zb_id='ZLZB_SS0024'
end
go

/*********No.91: ZLZB_SS0024******HD_ZBMX_HZ***ZLZB_SS0024*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0024')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10937'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0024'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0024'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0024'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=5    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0024'
,zb_name='腹腔镜下胆囊切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0024'
end
go

/*********No.91: ZLZB_SS0024******ZB_FACT_DIM_YS***ZLZB_SS0024*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0024')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0024'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0024'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0024'
end
go

/*********No.92: ZLZB_SS0025******ZBMX***ZLZB_SS0025*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0025')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0025'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜下胆囊切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0025'
end
go

/*********No.92: ZLZB_SS0025******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0025*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0025')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0025'
 where zb_id='ZLZB_SS0025'
end
go

/*********No.92: ZLZB_SS0025******HD_ZBMX_HZ***ZLZB_SS0025*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0025')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10938'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0025'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0025'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0025'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=5    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0025'
,zb_name='腹腔镜下胆囊切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0025'
end
go

/*********No.92: ZLZB_SS0025******ZB_FACT_DIM_YS***ZLZB_SS0025*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0025')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0025'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0025'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0025'
end
go

/*********No.93: ZLZB_SS0026******ZBMX***ZLZB_SS0026*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0026')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0026'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='冠状动脉旁路移植术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0026'
end
go

/*********No.93: ZLZB_SS0026******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0026*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0026')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0026'
 where zb_id='ZLZB_SS0026'
end
go

/*********No.93: ZLZB_SS0026******HD_ZBMX_HZ***ZLZB_SS0026*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0026')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10940'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0026'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0026'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0026'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=6   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0026'
,zb_name='冠状动脉旁路移植术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0026'
end
go

/*********No.93: ZLZB_SS0026******ZB_FACT_DIM_YS***ZLZB_SS0026*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0026')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0026'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0026'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0026'
end
go

/*********No.94: ZLZB_SS0027******ZBMX***ZLZB_SS0027*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0027')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0027'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='冠状动脉旁路移植术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0027'
end
go

/*********No.94: ZLZB_SS0027******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0027*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0027')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0027'
 where zb_id='ZLZB_SS0027'
end
go

/*********No.94: ZLZB_SS0027******HD_ZBMX_HZ***ZLZB_SS0027*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0027')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10941'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0027'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0027'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0027'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=6  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0027'
,zb_name='冠状动脉旁路移植术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0027'
end
go

/*********No.94: ZLZB_SS0027******ZB_FACT_DIM_YS***ZLZB_SS0027*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0027')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0027'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0027'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0027'
end
go

/*********No.95: ZLZB_SS00101******ZBMX***ZLZB_SS00101*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00101')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00101'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00101'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='椎板切除术或脊柱融合相关手术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00101'
end
go

/*********No.95: ZLZB_SS00101******HD_ZBMX_HZ***ZLZB_SS00101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10921'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00101'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00101'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00101'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=2    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00101'
,zb_name='椎板切除术或脊柱融合相关手术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00101'
end
go

/*********No.96: ZLZB_SS00151******ZBMX***ZLZB_SS00151*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00151')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00151'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00151'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰腺切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00151'
end
go

/*********No.96: ZLZB_SS00151******HD_ZBMX_HZ***ZLZB_SS00151*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00151')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10927'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00151'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00151'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00151'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=3    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00151'
,zb_name='胰腺切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00151'
end
go

/*********No.97: ZLZB_SS00201******ZBMX***ZLZB_SS00201*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00201')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00201'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00201'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00201'
end
go

/*********No.97: ZLZB_SS00201******HD_ZBMX_HZ***ZLZB_SS00201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10933'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00201'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00201'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00201'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=4    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00201'
,zb_name='食管切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00201'
end
go

/*********No.98: ZLZB_SS00251******ZBMX***ZLZB_SS00251*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00251')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00251'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00251'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜下胆囊切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00251'
end
go

/*********No.98: ZLZB_SS00251******HD_ZBMX_HZ***ZLZB_SS00251*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00251')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10939'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00251'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00251'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00251'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=5    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00251'
,zb_name='腹腔镜下胆囊切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00251'
end
go

/*********No.99: ZLZB_SS00301******ZBMX***ZLZB_SS00301*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00301')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00301'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00301'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='冠状动脉旁路移植术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00301'
end
go

/*********No.99: ZLZB_SS00301******HD_ZBMX_HZ***ZLZB_SS00301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10945'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00301'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00301'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00301'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=6    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00301'
,zb_name='冠状动脉旁路移植术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00301'
end
go

/*********No.100: ZLZB_SS00351******ZBMX***ZLZB_SS00351*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00351')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00351'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00351'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='经皮冠状动脉介入治疗的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00351'
end
go

/*********No.100: ZLZB_SS00351******HD_ZBMX_HZ***ZLZB_SS00351*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00351')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10951'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00351'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00351'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00351'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=7    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00351'
,zb_name='经皮冠状动脉介入治疗的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00351'
end
go

/*********No.101: ZLZB_SS00401******ZBMX***ZLZB_SS00401*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00401')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00401'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00401'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='颅脑手术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00401'
end
go

/*********No.101: ZLZB_SS00401******HD_ZBMX_HZ***ZLZB_SS00401*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00401')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10957'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00401'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00401'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00401'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=8    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00401'
,zb_name='颅脑手术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00401'
end
go

/*********No.102: ZLZB_SS00451******ZBMX***ZLZB_SS00451*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00451')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00451'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00451'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='子宫切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00451'
end
go

/*********No.102: ZLZB_SS00451******HD_ZBMX_HZ***ZLZB_SS00451*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00451')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10963'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00451'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00451'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00451'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=9    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00451'
,zb_name='子宫切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00451'
end
go

/*********No.103: ZLZB_SS00501******ZBMX***ZLZB_SS00501*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS00501')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS00501'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS00501'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='剖宫产的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS00501'
end
go

/*********No.103: ZLZB_SS00501******HD_ZBMX_HZ***ZLZB_SS00501*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS00501')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10969'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS00501'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS00501'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS00501'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=10    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS00501'
,zb_name='剖宫产的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS00501'
end
go

/*********No.104: ZLZB_SS02001******ZBMX***ZLZB_SS02001*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02001')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02001'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02001'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰体尾切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02001'
end
go

/*********No.104: ZLZB_SS02001******HD_ZBMX_HZ***ZLZB_SS02001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11157'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02001'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02001'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02001'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=40    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02001'
,zb_name='胰体尾切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02001'
end
go

/*********No.105: ZLZB_SS02051******ZBMX***ZLZB_SS02051*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02051')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02051'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02051'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌改良根治术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02051'
end
go

/*********No.105: ZLZB_SS02051******HD_ZBMX_HZ***ZLZB_SS02051*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02051')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11163'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02051'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02051'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=41    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02051'
,zb_name='乳腺癌改良根治术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02051'
end
go

/*********No.106: ZLZB_SS02101******ZBMX***ZLZB_SS02101*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02101')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02101'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02101'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌保留乳房术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02101'
end
go

/*********No.106: ZLZB_SS02101******HD_ZBMX_HZ***ZLZB_SS02101*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02101')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11169'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02101'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02101'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02101'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=42    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02101'
,zb_name='乳腺癌保留乳房术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02101'
end
go

/*********No.107: ZLZB_SS02151******ZBMX***ZLZB_SS02151*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02151')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02151'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02151'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾癌根治术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02151'
end
go

/*********No.107: ZLZB_SS02151******HD_ZBMX_HZ***ZLZB_SS02151*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02151')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11175'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02151'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02151'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=43    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02151'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=43    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02151'
,zb_name='肾癌根治术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02151'
end
go

/*********No.108: ZLZB_SS02201******ZBMX***ZLZB_SS02201*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02201')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02201'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02201'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾肿瘤保留肾单位手术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02201'
end
go

/*********No.108: ZLZB_SS02201******HD_ZBMX_HZ***ZLZB_SS02201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11181'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02201'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02201'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=44    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02201'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=44    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02201'
,zb_name='肾肿瘤保留肾单位手术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02201'
end
go

/*********No.109: ZLZB_SS02251******ZBMX***ZLZB_SS02251*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02251')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02251'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02251'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='前列腺癌根治术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02251'
end
go

/*********No.109: ZLZB_SS02251******HD_ZBMX_HZ***ZLZB_SS02251*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02251')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11187'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02251'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02251'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=45    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02251'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=45    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02251'
,zb_name='前列腺癌根治术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02251'
end
go

/*********No.110: ZLZB_SS02301******ZBMX***ZLZB_SS02301*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02301')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02301'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02301'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性膀胱切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02301'
end
go

/*********No.110: ZLZB_SS02301******HD_ZBMX_HZ***ZLZB_SS02301*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02301')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11193'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02301'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02301'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=46    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02301'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=46    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02301'
,zb_name='根治性膀胱切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02301'
end
go

/*********No.111: ZLZB_SS02351******ZBMX***ZLZB_SS02351*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS02351')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS02351'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS02351'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='双侧输卵管-卵癌切除术的均次药费'
,percent_type='1'
,pid=''
,pjbz=''
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS02351'
end
go

/*********No.111: ZLZB_SS02351******HD_ZBMX_HZ***ZLZB_SS02351*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS02351')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11199'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS02351'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS02351'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=47    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS02351'' zbmx_id,  timekey, yykey ,kskey , sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=47    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS02351'
,zb_name='双侧输卵管-卵癌切除术的均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS02351'
end
go

/*********No.112: ZLZB_SS0068******ZBMX***ZLZB_SS0068*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0068')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0068'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0068'
end
go

/*********No.112: ZLZB_SS0068******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0068*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0068')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0068'
 where zb_id='ZLZB_SS0068'
end
go

/*********No.112: ZLZB_SS0068******HD_ZBMX_HZ***ZLZB_SS0068*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0068')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10990'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0068'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0068'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0068'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=14    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0068'
,zb_name='胃切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0068'
end
go

/*********No.112: ZLZB_SS0068******ZB_FACT_DIM_YS***ZLZB_SS0068*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0068')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0068'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0068'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0068'
end
go

/*********No.113: ZLZB_SS0069******ZBMX***ZLZB_SS0069*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0069')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0069'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0069'
end
go

/*********No.113: ZLZB_SS0069******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0069*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0069')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0069'
 where zb_id='ZLZB_SS0069'
end
go

/*********No.113: ZLZB_SS0069******HD_ZBMX_HZ***ZLZB_SS0069*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0069')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10991'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0069'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0069'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0069'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=14    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0069'
,zb_name='胃切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0069'
end
go

/*********No.113: ZLZB_SS0069******ZB_FACT_DIM_YS***ZLZB_SS0069*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0069')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0069'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0069'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0069'
end
go

/*********No.114: ZLZB_SS0070******ZBMX***ZLZB_SS0070*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0070')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0070'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0070'
end
go

/*********No.114: ZLZB_SS0070******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0070*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0070')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0070'
 where zb_id='ZLZB_SS0070'
end
go

/*********No.114: ZLZB_SS0070******HD_ZBMX_HZ***ZLZB_SS0070*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0070')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10992'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0070'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0070'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0070'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=14    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0070'
,zb_name='胃切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0070'
end
go

/*********No.114: ZLZB_SS0070******ZB_FACT_DIM_YS***ZLZB_SS0070*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0070')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0070'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0070'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0070'
end
go

/*********No.115: ZLZB_SS0071******ZBMX***ZLZB_SS0071*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0071')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0071'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0071'
end
go

/*********No.115: ZLZB_SS0071******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0071*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0071')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0071'
 where zb_id='ZLZB_SS0071'
end
go

/*********No.115: ZLZB_SS0071******HD_ZBMX_HZ***ZLZB_SS0071*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0071')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10994'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0071'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0071'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0071'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=15   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0071'
,zb_name='直肠切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0071'
end
go

/*********No.115: ZLZB_SS0071******ZB_FACT_DIM_YS***ZLZB_SS0071*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0071')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0071'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0071'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0071'
end
go

/*********No.116: ZLZB_SS0072******ZBMX***ZLZB_SS0072*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0072')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0072'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0072'
end
go

/*********No.116: ZLZB_SS0072******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0072*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0072')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0072'
 where zb_id='ZLZB_SS0072'
end
go

/*********No.116: ZLZB_SS0072******HD_ZBMX_HZ***ZLZB_SS0072*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0072')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10995'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0072'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0072'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0072'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=15  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0072'
,zb_name='直肠切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0072'
end
go

/*********No.116: ZLZB_SS0072******ZB_FACT_DIM_YS***ZLZB_SS0072*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0072')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0072'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0072'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0072'
end
go

/*********No.117: ZLZB_SS0073******ZBMX***ZLZB_SS0073*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0073')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0073'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0073'
end
go

/*********No.117: ZLZB_SS0073******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0073*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0073')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0073'
 where zb_id='ZLZB_SS0073'
end
go

/*********No.117: ZLZB_SS0073******HD_ZBMX_HZ***ZLZB_SS0073*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0073')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10996'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0073'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0073'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0073'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=15    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0073'
,zb_name='直肠切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0073'
end
go

/*********No.117: ZLZB_SS0073******ZB_FACT_DIM_YS***ZLZB_SS0073*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0073')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0073'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0073'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0073'
end
go

/*********No.118: ZLZB_SS0074******ZBMX***ZLZB_SS0074*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0074')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0074'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0074'
end
go

/*********No.118: ZLZB_SS0074******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0074*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0074')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0074'
 where zb_id='ZLZB_SS0074'
end
go

/*********No.118: ZLZB_SS0074******HD_ZBMX_HZ***ZLZB_SS0074*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0074')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10997'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0074'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0074'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0074'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=15    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0074'
,zb_name='直肠切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0074'
end
go

/*********No.118: ZLZB_SS0074******ZB_FACT_DIM_YS***ZLZB_SS0074*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0074')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0074'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0074'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0074'
end
go

/*********No.119: ZLZB_SS0075******ZBMX***ZLZB_SS0075*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0075')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0075'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0075'
end
go

/*********No.119: ZLZB_SS0075******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0075*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0075')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0075'
 where zb_id='ZLZB_SS0075'
end
go

/*********No.119: ZLZB_SS0075******HD_ZBMX_HZ***ZLZB_SS0075*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0075')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10998'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0075'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0075'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=15    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0075'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=15    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0075'
,zb_name='直肠切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0075'
end
go

/*********No.119: ZLZB_SS0075******ZB_FACT_DIM_YS***ZLZB_SS0075*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0075')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0075'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0075'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0075'
end
go

/*********No.120: ZLZB_SS0029******ZBMX***ZLZB_SS0029*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0029')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0029'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='冠状动脉旁路移植术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0029'
end
go

/*********No.120: ZLZB_SS0029******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0029*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0029')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0029'
 where zb_id='ZLZB_SS0029'
end
go

/*********No.120: ZLZB_SS0029******HD_ZBMX_HZ***ZLZB_SS0029*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0029')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10943'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0029'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0029'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0029'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=6    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0029'
,zb_name='冠状动脉旁路移植术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0029'
end
go

/*********No.120: ZLZB_SS0029******ZB_FACT_DIM_YS***ZLZB_SS0029*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0029')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0029'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0029'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0029'
end
go

/*********No.121: ZLZB_SS0030******ZBMX***ZLZB_SS0030*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0030')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0030'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='冠状动脉旁路移植术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0030'
end
go

/*********No.121: ZLZB_SS0030******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0030*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0030')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0030'
 where zb_id='ZLZB_SS0030'
end
go

/*********No.121: ZLZB_SS0030******HD_ZBMX_HZ***ZLZB_SS0030*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0030')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10944'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0030'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0030'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=6    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0030'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=6    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0030'
,zb_name='冠状动脉旁路移植术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0030'
end
go

/*********No.121: ZLZB_SS0030******ZB_FACT_DIM_YS***ZLZB_SS0030*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0030')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0030'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0030'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0030'
end
go

/*********No.122: ZLZB_SS0031******ZBMX***ZLZB_SS0031*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0031')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0031'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='经皮冠状动脉介入治疗的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0031'
end
go

/*********No.122: ZLZB_SS0031******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0031*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0031')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0031'
 where zb_id='ZLZB_SS0031'
end
go

/*********No.122: ZLZB_SS0031******HD_ZBMX_HZ***ZLZB_SS0031*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0031')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10946'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0031'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0031'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0031'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=7   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0031'
,zb_name='经皮冠状动脉介入治疗的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0031'
end
go

/*********No.122: ZLZB_SS0031******ZB_FACT_DIM_YS***ZLZB_SS0031*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0031')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0031'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0031'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0031'
end
go

/*********No.123: ZLZB_SS0032******ZBMX***ZLZB_SS0032*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0032')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0032'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='经皮冠状动脉介入治疗的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0032'
end
go

/*********No.123: ZLZB_SS0032******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0032*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0032')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0032'
 where zb_id='ZLZB_SS0032'
end
go

/*********No.123: ZLZB_SS0032******HD_ZBMX_HZ***ZLZB_SS0032*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0032')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10947'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0032'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0032'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0032'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=7  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0032'
,zb_name='经皮冠状动脉介入治疗的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0032'
end
go

/*********No.123: ZLZB_SS0032******ZB_FACT_DIM_YS***ZLZB_SS0032*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0032')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0032'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0032'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0032'
end
go

/*********No.124: ZLZB_SS0033******ZBMX***ZLZB_SS0033*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0033')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0033'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='经皮冠状动脉介入治疗的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0033'
end
go

/*********No.124: ZLZB_SS0033******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0033*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0033')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0033'
 where zb_id='ZLZB_SS0033'
end
go

/*********No.124: ZLZB_SS0033******HD_ZBMX_HZ***ZLZB_SS0033*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0033')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10948'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0033'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0033'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0033'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=7    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0033'
,zb_name='经皮冠状动脉介入治疗的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0033'
end
go

/*********No.124: ZLZB_SS0033******ZB_FACT_DIM_YS***ZLZB_SS0033*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0033')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0033'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0033'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0033'
end
go

/*********No.125: ZLZB_SS0034******ZBMX***ZLZB_SS0034*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0034')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0034'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='经皮冠状动脉介入治疗的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0034'
end
go

/*********No.125: ZLZB_SS0034******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0034*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0034')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0034'
 where zb_id='ZLZB_SS0034'
end
go

/*********No.125: ZLZB_SS0034******HD_ZBMX_HZ***ZLZB_SS0034*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0034')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10949'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0034'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0034'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0034'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=7    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0034'
,zb_name='经皮冠状动脉介入治疗的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0034'
end
go

/*********No.125: ZLZB_SS0034******ZB_FACT_DIM_YS***ZLZB_SS0034*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0034')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0034'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0034'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0034'
end
go

/*********No.126: ZLZB_SS0035******ZBMX***ZLZB_SS0035*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0035')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0035'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='经皮冠状动脉介入治疗的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0035'
end
go

/*********No.126: ZLZB_SS0035******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0035*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0035')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0035'
 where zb_id='ZLZB_SS0035'
end
go

/*********No.126: ZLZB_SS0035******HD_ZBMX_HZ***ZLZB_SS0035*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0035')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10950'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0035'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0035'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=7    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0035'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=7    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0035'
,zb_name='经皮冠状动脉介入治疗的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0035'
end
go

/*********No.126: ZLZB_SS0035******ZB_FACT_DIM_YS***ZLZB_SS0035*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0035')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0035'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0035'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0035'
end
go

/*********No.127: ZLZB_SS0036******ZBMX***ZLZB_SS0036*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0036')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0036'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='颅脑手术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0036'
end
go

/*********No.127: ZLZB_SS0036******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0036*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0036')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0036'
 where zb_id='ZLZB_SS0036'
end
go

/*********No.127: ZLZB_SS0036******HD_ZBMX_HZ***ZLZB_SS0036*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0036')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10952'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0036'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0036'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0036'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=8   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0036'
,zb_name='颅脑手术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0036'
end
go

/*********No.127: ZLZB_SS0036******ZB_FACT_DIM_YS***ZLZB_SS0036*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0036')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0036'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0036'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0036'
end
go

/*********No.128: ZLZB_SS0037******ZBMX***ZLZB_SS0037*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0037')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0037'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='颅脑手术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0037'
end
go

/*********No.128: ZLZB_SS0037******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0037*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0037')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0037'
 where zb_id='ZLZB_SS0037'
end
go

/*********No.128: ZLZB_SS0037******HD_ZBMX_HZ***ZLZB_SS0037*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0037')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10953'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0037'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0037'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0037'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=8  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0037'
,zb_name='颅脑手术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0037'
end
go

/*********No.128: ZLZB_SS0037******ZB_FACT_DIM_YS***ZLZB_SS0037*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0037')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0037'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0037'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0037'
end
go

/*********No.129: ZLZB_SS0038******ZBMX***ZLZB_SS0038*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0038')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0038'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='颅脑手术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0038'
end
go

/*********No.129: ZLZB_SS0038******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0038*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0038')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0038'
 where zb_id='ZLZB_SS0038'
end
go

/*********No.129: ZLZB_SS0038******HD_ZBMX_HZ***ZLZB_SS0038*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0038')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10954'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0038'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0038'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0038'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=8    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0038'
,zb_name='颅脑手术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0038'
end
go

/*********No.129: ZLZB_SS0038******ZB_FACT_DIM_YS***ZLZB_SS0038*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0038')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0038'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0038'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0038'
end
go

/*********No.130: ZLZB_SS0039******ZBMX***ZLZB_SS0039*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0039')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0039'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='颅脑手术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0039'
end
go

/*********No.130: ZLZB_SS0039******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0039*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0039')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0039'
 where zb_id='ZLZB_SS0039'
end
go

/*********No.130: ZLZB_SS0039******HD_ZBMX_HZ***ZLZB_SS0039*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0039')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10955'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0039'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0039'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0039'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=8    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0039'
,zb_name='颅脑手术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0039'
end
go

/*********No.130: ZLZB_SS0039******ZB_FACT_DIM_YS***ZLZB_SS0039*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0039')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0039'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0039'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0039'
end
go

/*********No.131: ZLZB_SS0040******ZBMX***ZLZB_SS0040*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0040')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0040'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='颅脑手术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0040'
end
go

/*********No.131: ZLZB_SS0040******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0040*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0040')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0040'
 where zb_id='ZLZB_SS0040'
end
go

/*********No.131: ZLZB_SS0040******HD_ZBMX_HZ***ZLZB_SS0040*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0040')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10956'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0040'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0040'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=8    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0040'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=8    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0040'
,zb_name='颅脑手术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0040'
end
go

/*********No.131: ZLZB_SS0040******ZB_FACT_DIM_YS***ZLZB_SS0040*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0040')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0040'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0040'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0040'
end
go

/*********No.132: ZLZB_SS0041******ZBMX***ZLZB_SS0041*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0041')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0041'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='子宫切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0041'
end
go

/*********No.132: ZLZB_SS0041******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0041*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0041')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0041'
 where zb_id='ZLZB_SS0041'
end
go

/*********No.132: ZLZB_SS0041******HD_ZBMX_HZ***ZLZB_SS0041*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0041')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10958'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0041'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0041'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0041'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=9   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0041'
,zb_name='子宫切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0041'
end
go

/*********No.132: ZLZB_SS0041******ZB_FACT_DIM_YS***ZLZB_SS0041*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0041')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0041'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0041'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0041'
end
go

/*********No.133: ZLZB_SS0042******ZBMX***ZLZB_SS0042*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0042')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0042'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='子宫切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0042'
end
go

/*********No.133: ZLZB_SS0042******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0042*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0042')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0042'
 where zb_id='ZLZB_SS0042'
end
go

/*********No.133: ZLZB_SS0042******HD_ZBMX_HZ***ZLZB_SS0042*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0042')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10959'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0042'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0042'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0042'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=9  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0042'
,zb_name='子宫切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0042'
end
go

/*********No.133: ZLZB_SS0042******ZB_FACT_DIM_YS***ZLZB_SS0042*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0042')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0042'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0042'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0042'
end
go

/*********No.134: ZLZB_SS0043******ZBMX***ZLZB_SS0043*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0043')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0043'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='子宫切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0043'
end
go

/*********No.134: ZLZB_SS0043******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0043*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0043')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0043'
 where zb_id='ZLZB_SS0043'
end
go

/*********No.134: ZLZB_SS0043******HD_ZBMX_HZ***ZLZB_SS0043*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0043')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10960'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0043'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0043'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0043'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=9    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0043'
,zb_name='子宫切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0043'
end
go

/*********No.134: ZLZB_SS0043******ZB_FACT_DIM_YS***ZLZB_SS0043*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0043')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0043'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0043'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0043'
end
go

/*********No.135: ZLZB_SS0044******ZBMX***ZLZB_SS0044*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0044')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0044'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='子宫切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0044'
end
go

/*********No.135: ZLZB_SS0044******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0044*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0044')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0044'
 where zb_id='ZLZB_SS0044'
end
go

/*********No.135: ZLZB_SS0044******HD_ZBMX_HZ***ZLZB_SS0044*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0044')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10961'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0044'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0044'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0044'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=9    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0044'
,zb_name='子宫切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0044'
end
go

/*********No.135: ZLZB_SS0044******ZB_FACT_DIM_YS***ZLZB_SS0044*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0044')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0044'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0044'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0044'
end
go

/*********No.136: ZLZB_SS0045******ZBMX***ZLZB_SS0045*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0045')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0045'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='子宫切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0045'
end
go

/*********No.136: ZLZB_SS0045******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0045*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0045')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0045'
 where zb_id='ZLZB_SS0045'
end
go

/*********No.136: ZLZB_SS0045******HD_ZBMX_HZ***ZLZB_SS0045*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0045')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10962'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0045'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0045'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=9    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0045'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=9    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0045'
,zb_name='子宫切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0045'
end
go

/*********No.136: ZLZB_SS0045******ZB_FACT_DIM_YS***ZLZB_SS0045*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0045')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0045'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0045'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0045'
end
go

/*********No.137: ZLZB_SS0046******ZBMX***ZLZB_SS0046*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0046')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0046'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='剖宫产的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0046'
end
go

/*********No.137: ZLZB_SS0046******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0046*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0046')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0046'
 where zb_id='ZLZB_SS0046'
end
go

/*********No.137: ZLZB_SS0046******HD_ZBMX_HZ***ZLZB_SS0046*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0046')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10964'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0046'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0046'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0046'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=10   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0046'
,zb_name='剖宫产的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0046'
end
go

/*********No.137: ZLZB_SS0046******ZB_FACT_DIM_YS***ZLZB_SS0046*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0046')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0046'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0046'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0046'
end
go

/*********No.138: ZLZB_SS0047******ZBMX***ZLZB_SS0047*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0047')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0047'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='剖宫产的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0047'
end
go

/*********No.138: ZLZB_SS0047******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0047*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0047')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0047'
 where zb_id='ZLZB_SS0047'
end
go

/*********No.138: ZLZB_SS0047******HD_ZBMX_HZ***ZLZB_SS0047*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0047')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10965'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0047'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0047'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0047'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=10  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0047'
,zb_name='剖宫产的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0047'
end
go

/*********No.138: ZLZB_SS0047******ZB_FACT_DIM_YS***ZLZB_SS0047*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0047')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0047'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0047'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0047'
end
go

/*********No.139: ZLZB_SS0048******ZBMX***ZLZB_SS0048*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0048')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0048'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='剖宫产的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0048'
end
go

/*********No.139: ZLZB_SS0048******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0048*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0048')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0048'
 where zb_id='ZLZB_SS0048'
end
go

/*********No.139: ZLZB_SS0048******HD_ZBMX_HZ***ZLZB_SS0048*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0048')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10966'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0048'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0048'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0048'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=10    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0048'
,zb_name='剖宫产的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0048'
end
go

/*********No.139: ZLZB_SS0048******ZB_FACT_DIM_YS***ZLZB_SS0048*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0048')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0048'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0048'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0048'
end
go

/*********No.140: ZLZB_SS0049******ZBMX***ZLZB_SS0049*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0049')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0049'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='剖宫产的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0049'
end
go

/*********No.140: ZLZB_SS0049******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0049*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0049')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0049'
 where zb_id='ZLZB_SS0049'
end
go

/*********No.140: ZLZB_SS0049******HD_ZBMX_HZ***ZLZB_SS0049*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0049')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10967'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0049'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0049'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0049'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=10    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0049'
,zb_name='剖宫产的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0049'
end
go

/*********No.140: ZLZB_SS0049******ZB_FACT_DIM_YS***ZLZB_SS0049*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0049')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0049'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0049'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0049'
end
go

/*********No.141: ZLZB_SS0050******ZBMX***ZLZB_SS0050*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0050')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0050'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='剖宫产的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0050'
end
go

/*********No.141: ZLZB_SS0050******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0050*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0050')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0050'
 where zb_id='ZLZB_SS0050'
end
go

/*********No.141: ZLZB_SS0050******HD_ZBMX_HZ***ZLZB_SS0050*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0050')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10968'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0050'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0050'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=10    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0050'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=10    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0050'
,zb_name='剖宫产的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0050'
end
go

/*********No.141: ZLZB_SS0050******ZB_FACT_DIM_YS***ZLZB_SS0050*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0050')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0050'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0050'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0050'
end
go

/*********No.142: ZLZB_SS0252******ZBMX***ZLZB_SS0252*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0252')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0252'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋关节置换术死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0252'
end
go

/*********No.142: ZLZB_SS0252******HD_ZBMX_HZ***ZLZB_SS0252*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0252')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11213'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0252'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=55   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0252'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=55   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='   SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0252'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=55   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0252'
,zb_name='髋关节置换术死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0252'
end
go

/*********No.142: ZLZB_SS0252******ZB_FACT_DIM_YS***ZLZB_SS0252*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0252')
begin
update ZB_FACT_DIM_YS set
dim_table='离院方式'
,dim_table_name='BA_YY_LYFS'
,dim_table_val='name'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0252'
,fz_fact_val='1'
,join_code='lyfskey'
,next_join_code='lyfskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0252'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0252'
end
go

/*********No.143: ZLZB_SS0257******ZBMX***ZLZB_SS0257*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0257')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0257'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='心脏瓣膜置换术死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0257'
end
go

/*********No.143: ZLZB_SS0257******HD_ZBMX_HZ***ZLZB_SS0257*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0257')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11215'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0256'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=56   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0256'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=56   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='   SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0257'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=56   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0257'
,zb_name='心脏瓣膜置换术死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0257'
end
go

/*********No.143: ZLZB_SS0257******ZB_FACT_DIM_YS***ZLZB_SS0257*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0257')
begin
update ZB_FACT_DIM_YS set
dim_table='离院方式'
,dim_table_name='BA_YY_LYFS'
,dim_table_val='name'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0257'
,fz_fact_val='1'
,join_code='lyfskey'
,next_join_code='lyfskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0257'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0257'
end
go

/*********No.144: ZLZB_SS0262******ZBMX***ZLZB_SS0262*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0262')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0262'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='脑血肿清除术死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0262'
end
go

/*********No.144: ZLZB_SS0262******HD_ZBMX_HZ***ZLZB_SS0262*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0262')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11217'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0262'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=57   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0262'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=57   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='   SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0262'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=57   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0262'
,zb_name='脑血肿清除术死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0262'
end
go

/*********No.144: ZLZB_SS0262******ZB_FACT_DIM_YS***ZLZB_SS0262*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0262')
begin
update ZB_FACT_DIM_YS set
dim_table='离院方式'
,dim_table_name='BA_YY_LYFS'
,dim_table_val='name'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0262'
,fz_fact_val='1'
,join_code='lyfskey'
,next_join_code='lyfskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0262'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0262'
end
go

/*********No.145: ZLZB_SS0251******ZBMX***ZLZB_SS0251*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0251')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0251'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋关节置换术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0251'
end
go

/*********No.145: ZLZB_SS0251******HD_ZBMX_HZ***ZLZB_SS0251*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0251')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11212'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0251'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=55   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0251'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=55   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='   SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0251'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=55   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0251'
,zb_name='髋关节置换术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0251'
end
go

/*********No.145: ZLZB_SS0251******ZB_FACT_DIM_YS***ZLZB_SS0251*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0251')
begin
update ZB_FACT_DIM_YS set
dim_table='离院方式'
,dim_table_name='BA_YY_LYFS'
,dim_table_val='name'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0251'
,fz_fact_val='1'
,join_code='lyfskey'
,next_join_code='lyfskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0251'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0251'
end
go

/*********No.146: ZLZB_SS0256******ZBMX***ZLZB_SS0256*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0256')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0256'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='心脏瓣膜置换术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0256'
end
go

/*********No.146: ZLZB_SS0256******HD_ZBMX_HZ***ZLZB_SS0256*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0256')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11214'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0256'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=56   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0256'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=56   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='   SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0256'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=56   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0256'
,zb_name='心脏瓣膜置换术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0256'
end
go

/*********No.146: ZLZB_SS0256******ZB_FACT_DIM_YS***ZLZB_SS0256*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0256')
begin
update ZB_FACT_DIM_YS set
dim_table='离院方式'
,dim_table_name='BA_YY_LYFS'
,dim_table_val='name'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0256'
,fz_fact_val='1'
,join_code='lyfskey'
,next_join_code='lyfskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0256'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0256'
end
go

/*********No.147: ZLZB_SS0261******ZBMX***ZLZB_SS0261*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0261')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0261'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='脑血肿清除术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0261'
end
go

/*********No.147: ZLZB_SS0261******HD_ZBMX_HZ***ZLZB_SS0261*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0261')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11216'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0261'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=57   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0261'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=57   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='   SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0261'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=57   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0261'
,zb_name='脑血肿清除术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0261'
end
go

/*********No.147: ZLZB_SS0261******ZB_FACT_DIM_YS***ZLZB_SS0261*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0261')
begin
update ZB_FACT_DIM_YS set
dim_table='离院方式'
,dim_table_name='BA_YY_LYFS'
,dim_table_val='name'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0261'
,fz_fact_val='1'
,join_code='lyfskey'
,next_join_code='lyfskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0261'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0261'
end
go

/*********No.148: ZLZB_SS0012******ZBMX***ZLZB_SS0012*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0012')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0012'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰腺切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0012'
end
go

/*********No.148: ZLZB_SS0012******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0012*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0012')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0012'
 where zb_id='ZLZB_SS0012'
end
go

/*********No.148: ZLZB_SS0012******HD_ZBMX_HZ***ZLZB_SS0012*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0012')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10923'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0012'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0012'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0012'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=3  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0012'
,zb_name='胰腺切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0012'
end
go

/*********No.148: ZLZB_SS0012******ZB_FACT_DIM_YS***ZLZB_SS0012*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0012')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0012'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0012'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0012'
end
go

/*********No.149: ZLZB_SS0013******ZBMX***ZLZB_SS0013*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0013')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0013'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰腺切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0013'
end
go

/*********No.149: ZLZB_SS0013******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0013*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0013')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0013'
 where zb_id='ZLZB_SS0013'
end
go

/*********No.149: ZLZB_SS0013******HD_ZBMX_HZ***ZLZB_SS0013*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0013')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10924'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0013'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0013'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0013'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=3    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0013'
,zb_name='胰腺切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0013'
end
go

/*********No.149: ZLZB_SS0013******ZB_FACT_DIM_YS***ZLZB_SS0013*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0013')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0013'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0013'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0013'
end
go

/*********No.150: ZLZB_SS0014******ZBMX***ZLZB_SS0014*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0014')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0014'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰腺切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0014'
end
go

/*********No.150: ZLZB_SS0014******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0014*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0014')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0014'
 where zb_id='ZLZB_SS0014'
end
go

/*********No.150: ZLZB_SS0014******HD_ZBMX_HZ***ZLZB_SS0014*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0014')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10925'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0014'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0014'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0014'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=3    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0014'
,zb_name='胰腺切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0014'
end
go

/*********No.150: ZLZB_SS0014******ZB_FACT_DIM_YS***ZLZB_SS0014*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0014')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0014'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0014'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0014'
end
go

/*********No.151: ZLZB_SS0015******ZBMX***ZLZB_SS0015*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0015')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0015'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰腺切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0015'
end
go

/*********No.151: ZLZB_SS0015******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0015*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0015')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0015'
 where zb_id='ZLZB_SS0015'
end
go

/*********No.151: ZLZB_SS0015******HD_ZBMX_HZ***ZLZB_SS0015*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0015')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10926'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0015'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0015'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0015'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=3    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0015'
,zb_name='胰腺切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0015'
end
go

/*********No.151: ZLZB_SS0015******ZB_FACT_DIM_YS***ZLZB_SS0015*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0015')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0015'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0015'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0015'
end
go

/*********No.152: ZLZB_SS0016******ZBMX***ZLZB_SS0016*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0016')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS0016'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0016'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0016'
end
go

/*********No.152: ZLZB_SS0016******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0016*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0016')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0016'
 where zb_id='ZLZB_SS0016'
end
go

/*********No.152: ZLZB_SS0016******HD_ZBMX_HZ***ZLZB_SS0016*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0016')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10928'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0016'' zbmx_id, mzyskey,  lyfskey,  sexkey, nldkey, cflxkey,zytskey, timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,sexkey, nldkey, cflxkey,zytskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0016'' zbmx_id, mzyskey,  lyfskey,  sexkey, nldkey, cflxkey,zytskey, timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0016'' zbmx_id, mzyskey,  lyfskey,  sexkey, nldkey, cflxkey,zytskey, timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=4   and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0016'
,zb_name='食管切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0016'
end
go

/*********No.152: ZLZB_SS0016******ZB_FACT_DIM_YS***ZLZB_SS0016*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0016')
begin
update ZB_FACT_DIM_YS set
dim_table='重返类型'
,dim_table_name='DIM_CFLX'
,dim_table_val='cfmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS0016'
,fz_fact_val='1'
,join_code='cflxkey'
,next_join_code='cflxkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0016'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0016'
end
go

/*********No.153: ZLZB_SS0017******ZBMX***ZLZB_SS0017*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0017')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0017'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0017'
end
go

/*********No.153: ZLZB_SS0017******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0017*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0017')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0017'
 where zb_id='ZLZB_SS0017'
end
go

/*********No.153: ZLZB_SS0017******HD_ZBMX_HZ***ZLZB_SS0017*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0017')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10929'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0017'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0017'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0017'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=4  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0017'
,zb_name='食管切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0017'
end
go

/*********No.153: ZLZB_SS0017******ZB_FACT_DIM_YS***ZLZB_SS0017*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0017')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0017'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0017'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0017'
end
go

/*********No.154: ZLZB_SS0018******ZBMX***ZLZB_SS0018*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0018')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0018'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0018'
end
go

/*********No.154: ZLZB_SS0018******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0018*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0018')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0018'
 where zb_id='ZLZB_SS0018'
end
go

/*********No.154: ZLZB_SS0018******HD_ZBMX_HZ***ZLZB_SS0018*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0018')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10930'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0018'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0018'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0018'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=4    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0018'
,zb_name='食管切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0018'
end
go

/*********No.154: ZLZB_SS0018******ZB_FACT_DIM_YS***ZLZB_SS0018*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0018')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0018'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0018'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0018'
end
go

/*********No.155: ZLZB_SS0019******ZBMX***ZLZB_SS0019*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0019')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0019'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0019'
end
go

/*********No.155: ZLZB_SS0019******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0019*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0019')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0019'
 where zb_id='ZLZB_SS0019'
end
go

/*********No.155: ZLZB_SS0019******HD_ZBMX_HZ***ZLZB_SS0019*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0019')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10931'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0019'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0019'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0019'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=4    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0019'
,zb_name='食管切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0019'
end
go

/*********No.155: ZLZB_SS0019******ZB_FACT_DIM_YS***ZLZB_SS0019*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0019')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0019'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0019'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0019'
end
go

/*********No.156: ZLZB_SS0020******ZBMX***ZLZB_SS0020*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0020')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0020'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0020'
end
go

/*********No.156: ZLZB_SS0020******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0020*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0020')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0020'
 where zb_id='ZLZB_SS0020'
end
go

/*********No.156: ZLZB_SS0020******HD_ZBMX_HZ***ZLZB_SS0020*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0020')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10932'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0020'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0020'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=4    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0020'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=4    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0020'
,zb_name='食管切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0020'
end
go

/*********No.156: ZLZB_SS0020******ZB_FACT_DIM_YS***ZLZB_SS0020*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0020')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0020'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0020'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0020'
end
go

/*********No.157: ZLZB_SS0021******ZBMX***ZLZB_SS0021*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0021')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0021'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜下胆囊切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0021'
end
go

/*********No.157: ZLZB_SS0021******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0021*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0021')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0021'
 where zb_id='ZLZB_SS0021'
end
go

/*********No.157: ZLZB_SS0021******HD_ZBMX_HZ***ZLZB_SS0021*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0021')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10934'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0021'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0021'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=5   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0021'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=5   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0021'
,zb_name='腹腔镜下胆囊切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0021'
end
go

/*********No.157: ZLZB_SS0021******ZB_FACT_DIM_YS***ZLZB_SS0021*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0021')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0021'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0021'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0021'
end
go

/*********No.158: ZLZB_SS0001******ZBMX***ZLZB_SS0001*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0001')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS0001'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0001'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0001'
end
go

/*********No.158: ZLZB_SS0001******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0001*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0001')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0001'
 where zb_id='ZLZB_SS0001'
end
go

/*********No.158: ZLZB_SS0001******HD_ZBMX_HZ***ZLZB_SS0001*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0001')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10907'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0001'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0001'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0001'' zbmx_id, mzyskey,  lyfskey,   sexkey, nldkey, cflxkey,zytskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=1   and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey,   sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0001'
,zb_name='髋、膝关节置换术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0001'
end
go

/*********No.158: ZLZB_SS0001******ZB_FACT_DIM_YS***ZLZB_SS0001*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0001')
begin
update ZB_FACT_DIM_YS set
dim_table='重返类型'
,dim_table_name='DIM_CFLX'
,dim_table_val='cfmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS0001'
,fz_fact_val='1'
,join_code='cflxkey'
,next_join_code='cflxkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0001'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0001'
end
go

/*********No.159: ZLZB_SS0002******ZBMX***ZLZB_SS0002*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0002')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS0002'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0002'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0002'
end
go

/*********No.159: ZLZB_SS0002******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0002*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0002')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0002'
 where zb_id='ZLZB_SS0002'
end
go

/*********No.159: ZLZB_SS0002******HD_ZBMX_HZ***ZLZB_SS0002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10910'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0002'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0002'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0002'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=1  and lyfskey=5     and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0002'
,zb_name='髋、膝关节置换术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0002'
end
go

/*********No.159: ZLZB_SS0002******ZB_FACT_DIM_YS***ZLZB_SS0002*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0002')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0002'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0002'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0002'
end
go

/*********No.160: ZLZB_SS0003******ZBMX***ZLZB_SS0003*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0003')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS0003'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0003'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0003'
end
go

/*********No.160: ZLZB_SS0003******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0003*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0003')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0003'
 where zb_id='ZLZB_SS0003'
end
go

/*********No.160: ZLZB_SS0003******HD_ZBMX_HZ***ZLZB_SS0003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0003')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10911'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0003'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0003'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0003'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=1    and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey ,mzyskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0003'
,zb_name='髋、膝关节置换术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0003'
end
go

/*********No.160: ZLZB_SS0003******ZB_FACT_DIM_YS***ZLZB_SS0003*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0003')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0003'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0003'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0003'
end
go

/*********No.161: ZLZB_SS0004******ZBMX***ZLZB_SS0004*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0004')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0004'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0004'
end
go

/*********No.161: ZLZB_SS0004******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0004*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0004')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0004'
 where zb_id='ZLZB_SS0004'
end
go

/*********No.161: ZLZB_SS0004******HD_ZBMX_HZ***ZLZB_SS0004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0004')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10912'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0004'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0004'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0004'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=1    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0004'
,zb_name='髋、膝关节置换术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0004'
end
go

/*********No.161: ZLZB_SS0004******ZB_FACT_DIM_YS***ZLZB_SS0004*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0004')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0004'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0004'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0004'
end
go

/*********No.162: ZLZB_SS0005******ZBMX***ZLZB_SS0005*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0005')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0005'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='髋、膝关节置换术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0005'
end
go

/*********No.162: ZLZB_SS0005******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0005*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0005')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0005'
 where zb_id='ZLZB_SS0005'
end
go

/*********No.162: ZLZB_SS0005******HD_ZBMX_HZ***ZLZB_SS0005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0005')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10913'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0005'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0005'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=1    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0005'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=1    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0005'
,zb_name='髋、膝关节置换术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0005'
end
go

/*********No.162: ZLZB_SS0005******ZB_FACT_DIM_YS***ZLZB_SS0005*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0005')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0005'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0005'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0005'
end
go

/*********No.163: ZLZB_SS0006******ZBMX***ZLZB_SS0006*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0006')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS0006'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0006'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='椎板切除术或脊柱融合相关手术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0006'
end
go

/*********No.163: ZLZB_SS0006******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0006*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0006')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0006'
 where zb_id='ZLZB_SS0006'
end
go

/*********No.163: ZLZB_SS0006******HD_ZBMX_HZ***ZLZB_SS0006*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0006')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10916'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0006'' zbmx_id, mzyskey,  lyfskey,  sexkey, nldkey, cflxkey,zytskey, timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,nldkey ,sexkey, nldkey, cflxkey,zytskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0006'' zbmx_id, mzyskey,  lyfskey,  sexkey, nldkey, cflxkey,zytskey, timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,nldkey ,sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0006'' zbmx_id, mzyskey,  lyfskey,  sexkey, nldkey, cflxkey,zytskey, timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=2   and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,nldkey ,sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0006'
,zb_name='椎板切除术或脊柱融合相关手术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0006'
end
go

/*********No.163: ZLZB_SS0006******ZB_FACT_DIM_YS***ZLZB_SS0006*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0006')
begin
update ZB_FACT_DIM_YS set
dim_table='重返类型'
,dim_table_name='DIM_CFLX'
,dim_table_val='cfmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS0006'
,fz_fact_val='1'
,join_code='cflxkey'
,next_join_code='cflxkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0006'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0006'
end
go

/*********No.164: ZLZB_SS0007******ZBMX***ZLZB_SS0007*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0007')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS0007'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0007'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='椎板切除术或脊柱融合相关手术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0007'
end
go

/*********No.164: ZLZB_SS0007******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0007*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0007')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0007'
 where zb_id='ZLZB_SS0007'
end
go

/*********No.164: ZLZB_SS0007******HD_ZBMX_HZ***ZLZB_SS0007*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0007')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10917'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0007'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0007'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0007'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=2  and lyfskey=5     and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0007'
,zb_name='椎板切除术或脊柱融合相关手术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0007'
end
go

/*********No.164: ZLZB_SS0007******ZB_FACT_DIM_YS***ZLZB_SS0007*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0007')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0007'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0007'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0007'
end
go

/*********No.165: ZLZB_SS0008******ZBMX***ZLZB_SS0008*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0008')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS0008'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0008'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='椎板切除术或脊柱融合相关手术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0008'
end
go

/*********No.165: ZLZB_SS0008******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0008*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0008')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0008'
 where zb_id='ZLZB_SS0008'
end
go

/*********No.165: ZLZB_SS0008******HD_ZBMX_HZ***ZLZB_SS0008*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0008')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10918'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0008'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0008'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0008'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=2    and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0008'
,zb_name='椎板切除术或脊柱融合相关手术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0008'
end
go

/*********No.165: ZLZB_SS0008******ZB_FACT_DIM_YS***ZLZB_SS0008*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0008')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0008'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0008'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0008'
end
go

/*********No.166: ZLZB_SS0009******ZBMX***ZLZB_SS0009*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0009')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0009'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='椎板切除术或脊柱融合相关手术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0009'
end
go

/*********No.166: ZLZB_SS0009******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0009*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0009')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0009'
 where zb_id='ZLZB_SS0009'
end
go

/*********No.166: ZLZB_SS0009******HD_ZBMX_HZ***ZLZB_SS0009*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0009')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10919'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0009'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0009'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0009'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=2    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0009'
,zb_name='椎板切除术或脊柱融合相关手术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0009'
end
go

/*********No.166: ZLZB_SS0009******ZB_FACT_DIM_YS***ZLZB_SS0009*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0009')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0009'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0009'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0009'
end
go

/*********No.167: ZLZB_SS0010******ZBMX***ZLZB_SS0010*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0010')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0010'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='椎板切除术或脊柱融合相关手术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0010'
end
go

/*********No.167: ZLZB_SS0010******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0010*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0010')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0010'
 where zb_id='ZLZB_SS0010'
end
go

/*********No.167: ZLZB_SS0010******HD_ZBMX_HZ***ZLZB_SS0010*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0010')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10920'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0010'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0010'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=2    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0010'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=2    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0010'
,zb_name='椎板切除术或脊柱融合相关手术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0010'
end
go

/*********No.167: ZLZB_SS0010******ZB_FACT_DIM_YS***ZLZB_SS0010*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0010')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0010'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0010'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0010'
end
go

/*********No.168: ZLZB_SS0159******ZBMX***ZLZB_SS0159*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0159')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0159'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝段切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0159'
end
go

/*********No.168: ZLZB_SS0159******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0159*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0159')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0159'
 where zb_id='ZLZB_SS0159'
end
go

/*********No.168: ZLZB_SS0159******HD_ZBMX_HZ***ZLZB_SS0159*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0159')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11107'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0159'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0159'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0159'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=32    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0159'
,zb_name='肝段切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0159'
end
go

/*********No.168: ZLZB_SS0159******ZB_FACT_DIM_YS***ZLZB_SS0159*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0159')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0159'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0159'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0159'
end
go

/*********No.169: ZLZB_SS0160******ZBMX***ZLZB_SS0160*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0160')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0160'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝段切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0160'
end
go

/*********No.169: ZLZB_SS0160******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0160*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0160')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0160'
 where zb_id='ZLZB_SS0160'
end
go

/*********No.169: ZLZB_SS0160******HD_ZBMX_HZ***ZLZB_SS0160*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0160')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11108'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0160'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0160'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0160'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=32    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0160'
,zb_name='肝段切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0160'
end
go

/*********No.169: ZLZB_SS0160******ZB_FACT_DIM_YS***ZLZB_SS0160*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0160')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0160'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0160'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0160'
end
go

/*********No.170: ZLZB_SS0161******ZBMX***ZLZB_SS0161*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0161')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0161'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝肿物不规则切除术（部分切除术）的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0161'
end
go

/*********No.170: ZLZB_SS0161******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0161*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0161')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0161'
 where zb_id='ZLZB_SS0161'
end
go

/*********No.170: ZLZB_SS0161******HD_ZBMX_HZ***ZLZB_SS0161*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0161')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11110'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0161'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0161'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0161'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=33   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0161'
,zb_name='肝肿物不规则切除术（部分切除术）的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0161'
end
go

/*********No.170: ZLZB_SS0161******ZB_FACT_DIM_YS***ZLZB_SS0161*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0161')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0161'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0161'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0161'
end
go

/*********No.171: ZLZB_SS0162******ZBMX***ZLZB_SS0162*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0162')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0162'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝肿物不规则切除术（部分切除术）的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0162'
end
go

/*********No.171: ZLZB_SS0162******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0162*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0162')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0162'
 where zb_id='ZLZB_SS0162'
end
go

/*********No.171: ZLZB_SS0162******HD_ZBMX_HZ***ZLZB_SS0162*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0162')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11111'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0162'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0162'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0162'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=33  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0162'
,zb_name='肝肿物不规则切除术（部分切除术）的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0162'
end
go

/*********No.171: ZLZB_SS0162******ZB_FACT_DIM_YS***ZLZB_SS0162*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0162')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0162'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0162'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0162'
end
go

/*********No.172: ZLZB_SS0163******ZBMX***ZLZB_SS0163*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0163')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0163'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝肿物不规则切除术（部分切除术）的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0163'
end
go

/*********No.172: ZLZB_SS0163******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0163*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0163')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0163'
 where zb_id='ZLZB_SS0163'
end
go

/*********No.172: ZLZB_SS0163******HD_ZBMX_HZ***ZLZB_SS0163*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0163')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11112'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0163'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0163'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0163'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=33    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0163'
,zb_name='肝肿物不规则切除术（部分切除术）的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0163'
end
go

/*********No.172: ZLZB_SS0163******ZB_FACT_DIM_YS***ZLZB_SS0163*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0163')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0163'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0163'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0163'
end
go

/*********No.173: ZLZB_SS0164******ZBMX***ZLZB_SS0164*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0164')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0164'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝肿物不规则切除术（部分切除术）的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0164'
end
go

/*********No.173: ZLZB_SS0164******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0164*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0164')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0164'
 where zb_id='ZLZB_SS0164'
end
go

/*********No.173: ZLZB_SS0164******HD_ZBMX_HZ***ZLZB_SS0164*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0164')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11113'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0164'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0164'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0164'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=33    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0164'
,zb_name='肝肿物不规则切除术（部分切除术）的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0164'
end
go

/*********No.173: ZLZB_SS0164******ZB_FACT_DIM_YS***ZLZB_SS0164*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0164')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0164'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0164'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0164'
end
go

/*********No.174: ZLZB_SS0165******ZBMX***ZLZB_SS0165*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0165')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0165'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝肿物不规则切除术（部分切除术）的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0165'
end
go

/*********No.174: ZLZB_SS0165******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0165*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0165')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0165'
 where zb_id='ZLZB_SS0165'
end
go

/*********No.174: ZLZB_SS0165******HD_ZBMX_HZ***ZLZB_SS0165*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0165')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11114'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0165'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0165'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=33    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0165'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=33    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0165'
,zb_name='肝肿物不规则切除术（部分切除术）的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0165'
end
go

/*********No.174: ZLZB_SS0165******ZB_FACT_DIM_YS***ZLZB_SS0165*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0165')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0165'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0165'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0165'
end
go

/*********No.175: ZLZB_SS0166******ZBMX***ZLZB_SS0166*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0166')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0166'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='左半结肠切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0166'
end
go

/*********No.175: ZLZB_SS0166******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0166*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0166')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0166'
 where zb_id='ZLZB_SS0166'
end
go

/*********No.175: ZLZB_SS0166******HD_ZBMX_HZ***ZLZB_SS0166*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0166')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11116'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0166'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0166'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0166'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=34   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0166'
,zb_name='左半结肠切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0166'
end
go

/*********No.175: ZLZB_SS0166******ZB_FACT_DIM_YS***ZLZB_SS0166*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0166')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0166'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0166'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0166'
end
go

/*********No.176: ZLZB_SS0167******ZBMX***ZLZB_SS0167*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0167')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0167'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='左半结肠切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0167'
end
go

/*********No.176: ZLZB_SS0167******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0167*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0167')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0167'
 where zb_id='ZLZB_SS0167'
end
go

/*********No.176: ZLZB_SS0167******HD_ZBMX_HZ***ZLZB_SS0167*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0167')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11117'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0167'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0167'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0167'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=34  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0167'
,zb_name='左半结肠切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0167'
end
go

/*********No.176: ZLZB_SS0167******ZB_FACT_DIM_YS***ZLZB_SS0167*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0167')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0167'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0167'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0167'
end
go

/*********No.177: ZLZB_SS0168******ZBMX***ZLZB_SS0168*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0168')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0168'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='左半结肠切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0168'
end
go

/*********No.177: ZLZB_SS0168******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0168*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0168')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0168'
 where zb_id='ZLZB_SS0168'
end
go

/*********No.177: ZLZB_SS0168******HD_ZBMX_HZ***ZLZB_SS0168*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0168')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11118'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0168'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0168'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0168'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=34    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0168'
,zb_name='左半结肠切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0168'
end
go

/*********No.177: ZLZB_SS0168******ZB_FACT_DIM_YS***ZLZB_SS0168*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0168')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0168'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0168'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0168'
end
go

/*********No.178: ZLZB_SS0169******ZBMX***ZLZB_SS0169*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0169')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0169'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='左半结肠切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0169'
end
go

/*********No.178: ZLZB_SS0169******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0169*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0169')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0169'
 where zb_id='ZLZB_SS0169'
end
go

/*********No.178: ZLZB_SS0169******HD_ZBMX_HZ***ZLZB_SS0169*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0169')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11119'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0169'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0169'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0169'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=34    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0169'
,zb_name='左半结肠切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0169'
end
go

/*********No.178: ZLZB_SS0169******ZB_FACT_DIM_YS***ZLZB_SS0169*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0169')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0169'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0169'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0169'
end
go

/*********No.179: ZLZB_SS0170******ZBMX***ZLZB_SS0170*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0170')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0170'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='左半结肠切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0170'
end
go

/*********No.179: ZLZB_SS0170******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0170*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0170')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0170'
 where zb_id='ZLZB_SS0170'
end
go

/*********No.179: ZLZB_SS0170******HD_ZBMX_HZ***ZLZB_SS0170*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0170')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11120'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0170'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0170'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=34    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0170'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=34    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0170'
,zb_name='左半结肠切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0170'
end
go

/*********No.179: ZLZB_SS0170******ZB_FACT_DIM_YS***ZLZB_SS0170*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0170')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0170'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0170'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0170'
end
go

/*********No.180: ZLZB_SS0171******ZBMX***ZLZB_SS0171*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0171')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0171'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='右半结肠切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0171'
end
go

/*********No.180: ZLZB_SS0171******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0171*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0171')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0171'
 where zb_id='ZLZB_SS0171'
end
go

/*********No.180: ZLZB_SS0171******HD_ZBMX_HZ***ZLZB_SS0171*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0171')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11122'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0171'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0171'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0171'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=35   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0171'
,zb_name='右半结肠切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0171'
end
go

/*********No.180: ZLZB_SS0171******ZB_FACT_DIM_YS***ZLZB_SS0171*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0171')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0171'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0171'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0171'
end
go

/*********No.181: ZLZB_SS0172******ZBMX***ZLZB_SS0172*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0172')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0172'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='右半结肠切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0172'
end
go

/*********No.181: ZLZB_SS0172******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0172*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0172')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0172'
 where zb_id='ZLZB_SS0172'
end
go

/*********No.181: ZLZB_SS0172******HD_ZBMX_HZ***ZLZB_SS0172*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0172')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11123'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0172'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0172'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0172'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=35  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0172'
,zb_name='右半结肠切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0172'
end
go

/*********No.181: ZLZB_SS0172******ZB_FACT_DIM_YS***ZLZB_SS0172*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0172')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0172'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0172'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0172'
end
go

/*********No.182: ZLZB_SS0173******ZBMX***ZLZB_SS0173*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0173')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0173'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='右半结肠切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0173'
end
go

/*********No.182: ZLZB_SS0173******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0173*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0173')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0173'
 where zb_id='ZLZB_SS0173'
end
go

/*********No.182: ZLZB_SS0173******HD_ZBMX_HZ***ZLZB_SS0173*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0173')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11124'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0173'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0173'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0173'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=35    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0173'
,zb_name='右半结肠切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0173'
end
go

/*********No.182: ZLZB_SS0173******ZB_FACT_DIM_YS***ZLZB_SS0173*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0173')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0173'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0173'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0173'
end
go

/*********No.183: ZLZB_SS0174******ZBMX***ZLZB_SS0174*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0174')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0174'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='右半结肠切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0174'
end
go

/*********No.183: ZLZB_SS0174******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0174*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0174')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0174'
 where zb_id='ZLZB_SS0174'
end
go

/*********No.183: ZLZB_SS0174******HD_ZBMX_HZ***ZLZB_SS0174*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0174')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11125'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0174'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0174'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0174'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=35    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0174'
,zb_name='右半结肠切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0174'
end
go

/*********No.183: ZLZB_SS0174******ZB_FACT_DIM_YS***ZLZB_SS0174*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0174')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0174'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0174'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0174'
end
go

/*********No.184: ZLZB_SS0175******ZBMX***ZLZB_SS0175*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0175')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0175'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='右半结肠切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0175'
end
go

/*********No.184: ZLZB_SS0175******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0175*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0175')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0175'
 where zb_id='ZLZB_SS0175'
end
go

/*********No.184: ZLZB_SS0175******HD_ZBMX_HZ***ZLZB_SS0175*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0175')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11126'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0175'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0175'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=35    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0175'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=35    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0175'
,zb_name='右半结肠切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0175'
end
go

/*********No.184: ZLZB_SS0175******ZB_FACT_DIM_YS***ZLZB_SS0175*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0175')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0175'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0175'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0175'
end
go

/*********No.185: ZLZB_SS0176******ZBMX***ZLZB_SS0176*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0176')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0176'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠前切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0176'
end
go

/*********No.185: ZLZB_SS0176******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0176*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0176')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0176'
 where zb_id='ZLZB_SS0176'
end
go

/*********No.185: ZLZB_SS0176******HD_ZBMX_HZ***ZLZB_SS0176*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0176')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11128'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0176'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0176'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0176'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=36   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0176'
,zb_name='直肠前切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0176'
end
go

/*********No.185: ZLZB_SS0176******ZB_FACT_DIM_YS***ZLZB_SS0176*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0176')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0176'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0176'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0176'
end
go

/*********No.186: ZLZB_SS0177******ZBMX***ZLZB_SS0177*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0177')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0177'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠前切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0177'
end
go

/*********No.186: ZLZB_SS0177******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0177*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0177')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0177'
 where zb_id='ZLZB_SS0177'
end
go

/*********No.186: ZLZB_SS0177******HD_ZBMX_HZ***ZLZB_SS0177*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0177')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11129'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0177'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0177'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0177'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=36  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0177'
,zb_name='直肠前切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0177'
end
go

/*********No.186: ZLZB_SS0177******ZB_FACT_DIM_YS***ZLZB_SS0177*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0177')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0177'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0177'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0177'
end
go

/*********No.187: ZLZB_SS0178******ZBMX***ZLZB_SS0178*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0178')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0178'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠前切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0178'
end
go

/*********No.187: ZLZB_SS0178******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0178*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0178')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0178'
 where zb_id='ZLZB_SS0178'
end
go

/*********No.187: ZLZB_SS0178******HD_ZBMX_HZ***ZLZB_SS0178*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0178')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11130'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0178'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0178'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0178'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=36    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0178'
,zb_name='直肠前切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0178'
end
go

/*********No.187: ZLZB_SS0178******ZB_FACT_DIM_YS***ZLZB_SS0178*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0178')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0178'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0178'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0178'
end
go

/*********No.188: ZLZB_SS0179******ZBMX***ZLZB_SS0179*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0179')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0179'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠前切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0179'
end
go

/*********No.188: ZLZB_SS0179******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0179*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0179')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0179'
 where zb_id='ZLZB_SS0179'
end
go

/*********No.188: ZLZB_SS0179******HD_ZBMX_HZ***ZLZB_SS0179*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0179')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11131'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0179'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0179'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0179'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=36    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0179'
,zb_name='直肠前切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0179'
end
go

/*********No.188: ZLZB_SS0179******ZB_FACT_DIM_YS***ZLZB_SS0179*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0179')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0179'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0179'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0179'
end
go

/*********No.189: ZLZB_SS0180******ZBMX***ZLZB_SS0180*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0180')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0180'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='直肠前切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0180'
end
go

/*********No.189: ZLZB_SS0180******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0180*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0180')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0180'
 where zb_id='ZLZB_SS0180'
end
go

/*********No.189: ZLZB_SS0180******HD_ZBMX_HZ***ZLZB_SS0180*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0180')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11132'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0180'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0180'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=36    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0180'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=36    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0180'
,zb_name='直肠前切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0180'
end
go

/*********No.189: ZLZB_SS0180******ZB_FACT_DIM_YS***ZLZB_SS0180*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0180')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0180'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0180'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0180'
end
go

/*********No.190: ZLZB_SS0181******ZBMX***ZLZB_SS0181*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0181')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0181'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹会阴直肠切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0181'
end
go

/*********No.190: ZLZB_SS0181******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0181*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0181')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0181'
 where zb_id='ZLZB_SS0181'
end
go

/*********No.190: ZLZB_SS0181******HD_ZBMX_HZ***ZLZB_SS0181*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0181')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11134'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0181'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0181'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0181'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=37   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0181'
,zb_name='腹会阴直肠切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0181'
end
go

/*********No.190: ZLZB_SS0181******ZB_FACT_DIM_YS***ZLZB_SS0181*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0181')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0181'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0181'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0181'
end
go

/*********No.191: ZLZB_SS0182******ZBMX***ZLZB_SS0182*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0182')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0182'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹会阴直肠切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0182'
end
go

/*********No.191: ZLZB_SS0182******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0182*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0182')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0182'
 where zb_id='ZLZB_SS0182'
end
go

/*********No.191: ZLZB_SS0182******HD_ZBMX_HZ***ZLZB_SS0182*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0182')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11135'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0182'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0182'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0182'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=37  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0182'
,zb_name='腹会阴直肠切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0182'
end
go

/*********No.191: ZLZB_SS0182******ZB_FACT_DIM_YS***ZLZB_SS0182*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0182')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0182'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0182'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0182'
end
go

/*********No.192: ZLZB_SS0183******ZBMX***ZLZB_SS0183*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0183')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0183'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹会阴直肠切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0183'
end
go

/*********No.192: ZLZB_SS0183******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0183*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0183')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0183'
 where zb_id='ZLZB_SS0183'
end
go

/*********No.192: ZLZB_SS0183******HD_ZBMX_HZ***ZLZB_SS0183*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0183')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11136'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0183'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0183'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0183'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=37    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0183'
,zb_name='腹会阴直肠切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0183'
end
go

/*********No.192: ZLZB_SS0183******ZB_FACT_DIM_YS***ZLZB_SS0183*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0183')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0183'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0183'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0183'
end
go

/*********No.193: ZLZB_SS0184******ZBMX***ZLZB_SS0184*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0184')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0184'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹会阴直肠切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0184'
end
go

/*********No.193: ZLZB_SS0184******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0184*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0184')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0184'
 where zb_id='ZLZB_SS0184'
end
go

/*********No.193: ZLZB_SS0184******HD_ZBMX_HZ***ZLZB_SS0184*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0184')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11137'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0184'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0184'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0184'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=37    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0184'
,zb_name='腹会阴直肠切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0184'
end
go

/*********No.193: ZLZB_SS0184******ZB_FACT_DIM_YS***ZLZB_SS0184*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0184')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0184'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0184'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0184'
end
go

/*********No.194: ZLZB_SS0185******ZBMX***ZLZB_SS0185*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0185')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0185'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹会阴直肠切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0185'
end
go

/*********No.194: ZLZB_SS0185******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0185*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0185')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0185'
 where zb_id='ZLZB_SS0185'
end
go

/*********No.194: ZLZB_SS0185******HD_ZBMX_HZ***ZLZB_SS0185*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0185')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11138'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0185'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0185'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=37    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0185'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=37    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0185'
,zb_name='腹会阴直肠切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0185'
end
go

/*********No.194: ZLZB_SS0185******ZB_FACT_DIM_YS***ZLZB_SS0185*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0185')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0185'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0185'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0185'
end
go

/*********No.195: ZLZB_SS0186******ZBMX***ZLZB_SS0186*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0186')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0186'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜结直肠癌根治术手术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0186'
end
go

/*********No.195: ZLZB_SS0186******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0186*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0186')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0186'
 where zb_id='ZLZB_SS0186'
end
go

/*********No.195: ZLZB_SS0186******HD_ZBMX_HZ***ZLZB_SS0186*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0186')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11140'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0186'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0186'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0186'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=38   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0186'
,zb_name='腹腔镜结直肠癌根治术手术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0186'
end
go

/*********No.195: ZLZB_SS0186******ZB_FACT_DIM_YS***ZLZB_SS0186*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0186')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0186'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0186'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0186'
end
go

/*********No.196: ZLZB_SS0188******ZBMX***ZLZB_SS0188*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0188')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0188'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜结直肠癌根治术手术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0188'
end
go

/*********No.196: ZLZB_SS0188******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0188*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0188')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0188'
 where zb_id='ZLZB_SS0188'
end
go

/*********No.196: ZLZB_SS0188******HD_ZBMX_HZ***ZLZB_SS0188*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0188')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11142'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0188'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0188'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0188'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=38    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0188'
,zb_name='腹腔镜结直肠癌根治术手术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0188'
end
go

/*********No.196: ZLZB_SS0188******ZB_FACT_DIM_YS***ZLZB_SS0188*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0188')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0188'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0188'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0188'
end
go

/*********No.197: ZLZB_SS0189******ZBMX***ZLZB_SS0189*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0189')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0189'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜结直肠癌根治术手术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0189'
end
go

/*********No.197: ZLZB_SS0189******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0189*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0189')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0189'
 where zb_id='ZLZB_SS0189'
end
go

/*********No.197: ZLZB_SS0189******HD_ZBMX_HZ***ZLZB_SS0189*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0189')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11143'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0189'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0189'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0189'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=38    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0189'
,zb_name='腹腔镜结直肠癌根治术手术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0189'
end
go

/*********No.197: ZLZB_SS0189******ZB_FACT_DIM_YS***ZLZB_SS0189*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0189')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0189'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0189'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0189'
end
go

/*********No.198: ZLZB_SS0190******ZBMX***ZLZB_SS0190*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0190')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0190'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜结直肠癌根治术手术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0190'
end
go

/*********No.198: ZLZB_SS0190******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0190*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0190')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0190'
 where zb_id='ZLZB_SS0190'
end
go

/*********No.198: ZLZB_SS0190******HD_ZBMX_HZ***ZLZB_SS0190*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0190')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11144'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0190'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0190'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0190'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=38    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0190'
,zb_name='腹腔镜结直肠癌根治术手术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0190'
end
go

/*********No.198: ZLZB_SS0190******ZB_FACT_DIM_YS***ZLZB_SS0190*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0190')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0190'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0190'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0190'
end
go

/*********No.199: ZLZB_SS0191******ZBMX***ZLZB_SS0191*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0191')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0191'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='惠普尔氏术（根治性胰十二指肠切除术）的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0191'
end
go

/*********No.199: ZLZB_SS0191******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0191*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0191')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0191'
 where zb_id='ZLZB_SS0191'
end
go

/*********No.199: ZLZB_SS0191******HD_ZBMX_HZ***ZLZB_SS0191*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0191')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11146'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0191'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0191'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0191'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=39   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0191'
,zb_name='惠普尔氏术（根治性胰十二指肠切除术）的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0191'
end
go

/*********No.199: ZLZB_SS0191******ZB_FACT_DIM_YS***ZLZB_SS0191*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0191')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0191'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0191'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0191'
end
go

/*********No.200: ZLZB_SS0192******ZBMX***ZLZB_SS0192*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0192')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0192'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='惠普尔氏术（根治性胰十二指肠切除术）的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0192'
end
go

/*********No.200: ZLZB_SS0192******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0192*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0192')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0192'
 where zb_id='ZLZB_SS0192'
end
go

/*********No.200: ZLZB_SS0192******HD_ZBMX_HZ***ZLZB_SS0192*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0192')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11147'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0192'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0192'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0192'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=39  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0192'
,zb_name='惠普尔氏术（根治性胰十二指肠切除术）的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0192'
end
go

/*********No.200: ZLZB_SS0192******ZB_FACT_DIM_YS***ZLZB_SS0192*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0192')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0192'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0192'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0192'
end
go

/*********No.201: ZLZB_SS0193******ZBMX***ZLZB_SS0193*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0193')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0193'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='惠普尔氏术（根治性胰十二指肠切除术）的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0193'
end
go

/*********No.201: ZLZB_SS0193******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0193*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0193')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0193'
 where zb_id='ZLZB_SS0193'
end
go

/*********No.201: ZLZB_SS0193******HD_ZBMX_HZ***ZLZB_SS0193*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0193')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11148'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0193'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0193'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0193'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=39    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0193'
,zb_name='惠普尔氏术（根治性胰十二指肠切除术）的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0193'
end
go

/*********No.201: ZLZB_SS0193******ZB_FACT_DIM_YS***ZLZB_SS0193*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0193')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0193'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0193'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0193'
end
go

/*********No.202: ZLZB_SS0194******ZBMX***ZLZB_SS0194*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0194')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0194'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='惠普尔氏术（根治性胰十二指肠切除术）的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0194'
end
go

/*********No.202: ZLZB_SS0194******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0194*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0194')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0194'
 where zb_id='ZLZB_SS0194'
end
go

/*********No.202: ZLZB_SS0194******HD_ZBMX_HZ***ZLZB_SS0194*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0194')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11149'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0194'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0194'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0194'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=39    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0194'
,zb_name='惠普尔氏术（根治性胰十二指肠切除术）的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0194'
end
go

/*********No.202: ZLZB_SS0194******ZB_FACT_DIM_YS***ZLZB_SS0194*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0194')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0194'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0194'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0194'
end
go

/*********No.203: ZLZB_SS0195******ZBMX***ZLZB_SS0195*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0195')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0195'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='惠普尔氏术（根治性胰十二指肠切除术）的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0195'
end
go

/*********No.203: ZLZB_SS0195******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0195*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0195')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0195'
 where zb_id='ZLZB_SS0195'
end
go

/*********No.203: ZLZB_SS0195******HD_ZBMX_HZ***ZLZB_SS0195*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0195')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11150'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0195'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0195'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=39    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0195'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=39    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0195'
,zb_name='惠普尔氏术（根治性胰十二指肠切除术）的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0195'
end
go

/*********No.203: ZLZB_SS0195******ZB_FACT_DIM_YS***ZLZB_SS0195*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0195')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0195'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0195'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0195'
end
go

/*********No.204: ZLZB_SS0196******ZBMX***ZLZB_SS0196*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0196')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0196'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰体尾切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0196'
end
go

/*********No.204: ZLZB_SS0196******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0196*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0196')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0196'
 where zb_id='ZLZB_SS0196'
end
go

/*********No.204: ZLZB_SS0196******HD_ZBMX_HZ***ZLZB_SS0196*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0196')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11152'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0196'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0196'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0196'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=40   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0196'
,zb_name='胰体尾切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0196'
end
go

/*********No.204: ZLZB_SS0196******ZB_FACT_DIM_YS***ZLZB_SS0196*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0196')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0196'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0196'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0196'
end
go

/*********No.205: ZLZB_SS0197******ZBMX***ZLZB_SS0197*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0197')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0197'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰体尾切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0197'
end
go

/*********No.205: ZLZB_SS0197******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0197*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0197')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0197'
 where zb_id='ZLZB_SS0197'
end
go

/*********No.205: ZLZB_SS0197******HD_ZBMX_HZ***ZLZB_SS0197*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0197')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11153'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0197'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0197'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0197'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=40  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0197'
,zb_name='胰体尾切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0197'
end
go

/*********No.205: ZLZB_SS0197******ZB_FACT_DIM_YS***ZLZB_SS0197*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0197')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0197'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0197'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0197'
end
go

/*********No.206: ZLZB_SS0198******ZBMX***ZLZB_SS0198*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0198')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0198'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰体尾切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0198'
end
go

/*********No.206: ZLZB_SS0198******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0198*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0198')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0198'
 where zb_id='ZLZB_SS0198'
end
go

/*********No.206: ZLZB_SS0198******HD_ZBMX_HZ***ZLZB_SS0198*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0198')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11154'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0198'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0198'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0198'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=40    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0198'
,zb_name='胰体尾切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0198'
end
go

/*********No.206: ZLZB_SS0198******ZB_FACT_DIM_YS***ZLZB_SS0198*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0198')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0198'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0198'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0198'
end
go

/*********No.207: ZLZB_SS0199******ZBMX***ZLZB_SS0199*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0199')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0199'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰体尾切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0199'
end
go

/*********No.207: ZLZB_SS0199******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0199*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0199')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0199'
 where zb_id='ZLZB_SS0199'
end
go

/*********No.207: ZLZB_SS0199******HD_ZBMX_HZ***ZLZB_SS0199*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0199')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11155'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0199'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0199'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0199'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=40    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0199'
,zb_name='胰体尾切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0199'
end
go

/*********No.207: ZLZB_SS0199******ZB_FACT_DIM_YS***ZLZB_SS0199*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0199')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0199'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0199'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0199'
end
go

/*********No.208: ZLZB_SS0200******ZBMX***ZLZB_SS0200*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0200')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0200'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰体尾切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0200'
end
go

/*********No.208: ZLZB_SS0200******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0200*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0200')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0200'
 where zb_id='ZLZB_SS0200'
end
go

/*********No.208: ZLZB_SS0200******HD_ZBMX_HZ***ZLZB_SS0200*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0200')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11156'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0200'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0200'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=40    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0200'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=40    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0200'
,zb_name='胰体尾切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0200'
end
go

/*********No.208: ZLZB_SS0200******ZB_FACT_DIM_YS***ZLZB_SS0200*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0200')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0200'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0200'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0200'
end
go

/*********No.209: ZLZB_SS0201******ZBMX***ZLZB_SS0201*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0201')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0201'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌改良根治术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0201'
end
go

/*********No.209: ZLZB_SS0201******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0201*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0201')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0201'
 where zb_id='ZLZB_SS0201'
end
go

/*********No.209: ZLZB_SS0201******HD_ZBMX_HZ***ZLZB_SS0201*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0201')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11158'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0201'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0201'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0201'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=41   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0201'
,zb_name='乳腺癌改良根治术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0201'
end
go

/*********No.209: ZLZB_SS0201******ZB_FACT_DIM_YS***ZLZB_SS0201*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0201')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0201'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0201'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0201'
end
go

/*********No.210: ZLZB_SS0202******ZBMX***ZLZB_SS0202*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0202')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0202'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌改良根治术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0202'
end
go

/*********No.210: ZLZB_SS0202******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0202*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0202')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0202'
 where zb_id='ZLZB_SS0202'
end
go

/*********No.210: ZLZB_SS0202******HD_ZBMX_HZ***ZLZB_SS0202*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0202')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11159'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0202'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0202'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0202'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=41  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0202'
,zb_name='乳腺癌改良根治术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0202'
end
go

/*********No.210: ZLZB_SS0202******ZB_FACT_DIM_YS***ZLZB_SS0202*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0202')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0202'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0202'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0202'
end
go

/*********No.211: ZLZB_SS0203******ZBMX***ZLZB_SS0203*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0203')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0203'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌改良根治术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0203'
end
go

/*********No.211: ZLZB_SS0203******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0203*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0203')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0203'
 where zb_id='ZLZB_SS0203'
end
go

/*********No.211: ZLZB_SS0203******HD_ZBMX_HZ***ZLZB_SS0203*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0203')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11160'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0203'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0203'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0203'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=41    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0203'
,zb_name='乳腺癌改良根治术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0203'
end
go

/*********No.211: ZLZB_SS0203******ZB_FACT_DIM_YS***ZLZB_SS0203*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0203')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0203'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0203'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0203'
end
go

/*********No.212: ZLZB_SS0204******ZBMX***ZLZB_SS0204*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0204')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0204'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌改良根治术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0204'
end
go

/*********No.212: ZLZB_SS0204******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0204*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0204')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0204'
 where zb_id='ZLZB_SS0204'
end
go

/*********No.212: ZLZB_SS0204******HD_ZBMX_HZ***ZLZB_SS0204*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0204')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11161'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0204'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0204'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0204'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=41    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0204'
,zb_name='乳腺癌改良根治术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0204'
end
go

/*********No.212: ZLZB_SS0204******ZB_FACT_DIM_YS***ZLZB_SS0204*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0204')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0204'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0204'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0204'
end
go

/*********No.213: ZLZB_SS0205******ZBMX***ZLZB_SS0205*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0205')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0205'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌改良根治术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0205'
end
go

/*********No.213: ZLZB_SS0205******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0205*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0205')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0205'
 where zb_id='ZLZB_SS0205'
end
go

/*********No.213: ZLZB_SS0205******HD_ZBMX_HZ***ZLZB_SS0205*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0205')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11162'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0205'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0205'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=41    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0205'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=41    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0205'
,zb_name='乳腺癌改良根治术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0205'
end
go

/*********No.213: ZLZB_SS0205******ZB_FACT_DIM_YS***ZLZB_SS0205*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0205')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0205'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0205'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0205'
end
go

/*********No.214: ZLZB_SS0206******ZBMX***ZLZB_SS0206*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0206')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0206'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺癌保留乳房术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0206'
end
go

/*********No.214: ZLZB_SS0206******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0206*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0206')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0206'
 where zb_id='ZLZB_SS0206'
end
go

/*********No.214: ZLZB_SS0206******HD_ZBMX_HZ***ZLZB_SS0206*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0206')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11164'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0206'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0206'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=42   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0206'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=42   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0206'
,zb_name='乳腺癌保留乳房术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0206'
end
go

/*********No.214: ZLZB_SS0206******ZB_FACT_DIM_YS***ZLZB_SS0206*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0206')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0206'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0206'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0206'
end
go

/*********No.215: ZLZB_SS0011******ZBMX***ZLZB_SS0011*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0011')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS0011'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0011'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='1'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胰腺切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0011'
end
go

/*********No.215: ZLZB_SS0011******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0011*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0011')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0011'
 where zb_id='ZLZB_SS0011'
end
go

/*********No.215: ZLZB_SS0011******HD_ZBMX_HZ***ZLZB_SS0011*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0011')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10922'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0011'' zbmx_id, mzyskey,  lyfskey, sexkey, nldkey, cflxkey,zytskey,  timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,sexkey, nldkey, cflxkey,zytskey'
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0011'' zbmx_id, mzyskey,  lyfskey, sexkey, nldkey, cflxkey,zytskey,  timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=3   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0011'' zbmx_id, mzyskey,  lyfskey, sexkey, nldkey, cflxkey,zytskey,  timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=3   and  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey ,sexkey, nldkey, cflxkey,zytskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0011'
,zb_name='胰腺切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0011'
end
go

/*********No.215: ZLZB_SS0011******ZB_FACT_DIM_YS***ZLZB_SS0011*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0011')
begin
update ZB_FACT_DIM_YS set
dim_table='重返类型'
,dim_table_name='DIM_CFLX'
,dim_table_val='cfmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS0011'
,fz_fact_val='1'
,join_code='cflxkey'
,next_join_code='cflxkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0011'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0011'
end
go

/*********No.216: ZLZB_SS0052******ZBMX***ZLZB_SS0052*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0052')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0052'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='阴道分娩的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0052'
end
go

/*********No.216: ZLZB_SS0052******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0052*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0052')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0052'
 where zb_id='ZLZB_SS0052'
end
go

/*********No.216: ZLZB_SS0052******HD_ZBMX_HZ***ZLZB_SS0052*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0052')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10971'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0052'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0052'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0052'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=11  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0052'
,zb_name='阴道分娩的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0052'
end
go

/*********No.216: ZLZB_SS0052******ZB_FACT_DIM_YS***ZLZB_SS0052*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0052')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0052'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0052'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0052'
end
go

/*********No.217: ZLZB_SS0053******ZBMX***ZLZB_SS0053*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0053')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0053'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='阴道分娩的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0053'
end
go

/*********No.217: ZLZB_SS0053******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0053*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0053')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0053'
 where zb_id='ZLZB_SS0053'
end
go

/*********No.217: ZLZB_SS0053******HD_ZBMX_HZ***ZLZB_SS0053*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0053')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10972'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0053'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0053'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0053'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=11    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0053'
,zb_name='阴道分娩的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0053'
end
go

/*********No.217: ZLZB_SS0053******ZB_FACT_DIM_YS***ZLZB_SS0053*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0053')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0053'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0053'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0053'
end
go

/*********No.218: ZLZB_SS0054******ZBMX***ZLZB_SS0054*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0054')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0054'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='阴道分娩的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0054'
end
go

/*********No.218: ZLZB_SS0054******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0054*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0054')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0054'
 where zb_id='ZLZB_SS0054'
end
go

/*********No.218: ZLZB_SS0054******HD_ZBMX_HZ***ZLZB_SS0054*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0054')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10973'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0054'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0054'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0054'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=11    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0054'
,zb_name='阴道分娩的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0054'
end
go

/*********No.218: ZLZB_SS0054******ZB_FACT_DIM_YS***ZLZB_SS0054*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0054')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0054'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0054'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0054'
end
go

/*********No.219: ZLZB_SS0055******ZBMX***ZLZB_SS0055*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0055')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0055'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='阴道分娩的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0055'
end
go

/*********No.219: ZLZB_SS0055******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0055*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0055')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0055'
 where zb_id='ZLZB_SS0055'
end
go

/*********No.219: ZLZB_SS0055******HD_ZBMX_HZ***ZLZB_SS0055*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0055')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10974'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0055'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0055'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=11    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0055'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=11    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0055'
,zb_name='阴道分娩的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0055'
end
go

/*********No.219: ZLZB_SS0055******ZB_FACT_DIM_YS***ZLZB_SS0055*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0055')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0055'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0055'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0055'
end
go

/*********No.220: ZLZB_SS0056******ZBMX***ZLZB_SS0056*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0056')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0056'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺手术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0056'
end
go

/*********No.220: ZLZB_SS0056******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0056*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0056')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0056'
 where zb_id='ZLZB_SS0056'
end
go

/*********No.220: ZLZB_SS0056******HD_ZBMX_HZ***ZLZB_SS0056*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0056')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10976'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0056'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0056'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0056'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=12   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0056'
,zb_name='乳腺手术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0056'
end
go

/*********No.220: ZLZB_SS0056******ZB_FACT_DIM_YS***ZLZB_SS0056*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0056')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0056'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0056'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0056'
end
go

/*********No.221: ZLZB_SS0057******ZBMX***ZLZB_SS0057*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0057')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0057'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺手术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0057'
end
go

/*********No.221: ZLZB_SS0057******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0057*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0057')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0057'
 where zb_id='ZLZB_SS0057'
end
go

/*********No.221: ZLZB_SS0057******HD_ZBMX_HZ***ZLZB_SS0057*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0057')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10977'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0057'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0057'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0057'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=12  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0057'
,zb_name='乳腺手术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0057'
end
go

/*********No.221: ZLZB_SS0057******ZB_FACT_DIM_YS***ZLZB_SS0057*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0057')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0057'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0057'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0057'
end
go

/*********No.222: ZLZB_SS0058******ZBMX***ZLZB_SS0058*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0058')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0058'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺手术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0058'
end
go

/*********No.222: ZLZB_SS0058******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0058*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0058')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0058'
 where zb_id='ZLZB_SS0058'
end
go

/*********No.222: ZLZB_SS0058******HD_ZBMX_HZ***ZLZB_SS0058*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0058')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10978'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0058'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0058'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0058'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=12    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0058'
,zb_name='乳腺手术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0058'
end
go

/*********No.222: ZLZB_SS0058******ZB_FACT_DIM_YS***ZLZB_SS0058*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0058')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0058'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0058'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0058'
end
go

/*********No.223: ZLZB_SS0059******ZBMX***ZLZB_SS0059*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0059')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0059'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺手术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0059'
end
go

/*********No.223: ZLZB_SS0059******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0059*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0059')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0059'
 where zb_id='ZLZB_SS0059'
end
go

/*********No.223: ZLZB_SS0059******HD_ZBMX_HZ***ZLZB_SS0059*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0059')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10979'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0059'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0059'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0059'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=12    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0059'
,zb_name='乳腺手术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0059'
end
go

/*********No.223: ZLZB_SS0059******ZB_FACT_DIM_YS***ZLZB_SS0059*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0059')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0059'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0059'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0059'
end
go

/*********No.224: ZLZB_SS0060******ZBMX***ZLZB_SS0060*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0060')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0060'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='乳腺手术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0060'
end
go

/*********No.224: ZLZB_SS0060******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0060*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0060')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0060'
 where zb_id='ZLZB_SS0060'
end
go

/*********No.224: ZLZB_SS0060******HD_ZBMX_HZ***ZLZB_SS0060*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0060')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10980'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0060'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0060'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=12    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0060'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=12    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0060'
,zb_name='乳腺手术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0060'
end
go

/*********No.224: ZLZB_SS0060******ZB_FACT_DIM_YS***ZLZB_SS0060*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0060')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0060'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0060'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0060'
end
go

/*********No.225: ZLZB_SS0061******ZBMX***ZLZB_SS0061*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0061')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0061'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0061'
end
go

/*********No.225: ZLZB_SS0061******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0061*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0061')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0061'
 where zb_id='ZLZB_SS0061'
end
go

/*********No.225: ZLZB_SS0061******HD_ZBMX_HZ***ZLZB_SS0061*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0061')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10982'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0061'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0061'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0061'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=13   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0061'
,zb_name='肺切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0061'
end
go

/*********No.225: ZLZB_SS0061******ZB_FACT_DIM_YS***ZLZB_SS0061*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0061')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0061'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0061'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0061'
end
go

/*********No.226: ZLZB_SS0062******ZBMX***ZLZB_SS0062*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0062')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0062'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0062'
end
go

/*********No.226: ZLZB_SS0062******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0062*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0062')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0062'
 where zb_id='ZLZB_SS0062'
end
go

/*********No.226: ZLZB_SS0062******HD_ZBMX_HZ***ZLZB_SS0062*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0062')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10983'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0062'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0062'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0062'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=13  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0062'
,zb_name='肺切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0062'
end
go

/*********No.226: ZLZB_SS0062******ZB_FACT_DIM_YS***ZLZB_SS0062*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0062')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0062'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0062'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0062'
end
go

/*********No.227: ZLZB_SS0063******ZBMX***ZLZB_SS0063*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0063')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0063'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0063'
end
go

/*********No.227: ZLZB_SS0063******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0063*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0063')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0063'
 where zb_id='ZLZB_SS0063'
end
go

/*********No.227: ZLZB_SS0063******HD_ZBMX_HZ***ZLZB_SS0063*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0063')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10984'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0063'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0063'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0063'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=13    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0063'
,zb_name='肺切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0063'
end
go

/*********No.227: ZLZB_SS0063******ZB_FACT_DIM_YS***ZLZB_SS0063*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0063')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0063'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0063'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0063'
end
go

/*********No.228: ZLZB_SS0064******ZBMX***ZLZB_SS0064*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0064')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0064'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0064'
end
go

/*********No.228: ZLZB_SS0064******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0064*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0064')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0064'
 where zb_id='ZLZB_SS0064'
end
go

/*********No.228: ZLZB_SS0064******HD_ZBMX_HZ***ZLZB_SS0064*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0064')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10985'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0064'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0064'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0064'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=13    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0064'
,zb_name='肺切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0064'
end
go

/*********No.228: ZLZB_SS0064******ZB_FACT_DIM_YS***ZLZB_SS0064*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0064')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0064'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0064'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0064'
end
go

/*********No.229: ZLZB_SS0065******ZBMX***ZLZB_SS0065*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0065')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0065'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0065'
end
go

/*********No.229: ZLZB_SS0065******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0065*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0065')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0065'
 where zb_id='ZLZB_SS0065'
end
go

/*********No.229: ZLZB_SS0065******HD_ZBMX_HZ***ZLZB_SS0065*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0065')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10986'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0065'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0065'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=13    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0065'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=13    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0065'
,zb_name='肺切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0065'
end
go

/*********No.229: ZLZB_SS0065******ZB_FACT_DIM_YS***ZLZB_SS0065*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0065')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0065'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0065'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0065'
end
go

/*********No.230: ZLZB_SS0066******ZBMX***ZLZB_SS0066*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0066')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0066'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0066'
end
go

/*********No.230: ZLZB_SS0066******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0066*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0066')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0066'
 where zb_id='ZLZB_SS0066'
end
go

/*********No.230: ZLZB_SS0066******HD_ZBMX_HZ***ZLZB_SS0066*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0066')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10988'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0066'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0066'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0066'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=14   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0066'
,zb_name='胃切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0066'
end
go

/*********No.230: ZLZB_SS0066******ZB_FACT_DIM_YS***ZLZB_SS0066*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0066')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0066'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0066'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0066'
end
go

/*********No.231: ZLZB_SS0067******ZBMX***ZLZB_SS0067*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0067')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0067'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0067'
end
go

/*********No.231: ZLZB_SS0067******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0067*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0067')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0067'
 where zb_id='ZLZB_SS0067'
end
go

/*********No.231: ZLZB_SS0067******HD_ZBMX_HZ***ZLZB_SS0067*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0067')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='10989'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0067'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0067'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=14  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0067'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=14  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0067'
,zb_name='胃切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0067'
end
go

/*********No.231: ZLZB_SS0067******ZB_FACT_DIM_YS***ZLZB_SS0067*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0067')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0067'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0067'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0067'
end
go

/*********No.232: ZLZB_SS0077******ZBMX***ZLZB_SS0077*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0077')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0077'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾与前列腺相关手术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0077'
end
go

/*********No.232: ZLZB_SS0077******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0077*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0077')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0077'
 where zb_id='ZLZB_SS0077'
end
go

/*********No.232: ZLZB_SS0077******HD_ZBMX_HZ***ZLZB_SS0077*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0077')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11001'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0077'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0077'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0077'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=16  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0077'
,zb_name='肾与前列腺相关手术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0077'
end
go

/*********No.232: ZLZB_SS0077******ZB_FACT_DIM_YS***ZLZB_SS0077*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0077')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0077'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0077'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0077'
end
go

/*********No.233: ZLZB_SS0078******ZBMX***ZLZB_SS0078*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0078')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0078'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾与前列腺相关手术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0078'
end
go

/*********No.233: ZLZB_SS0078******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0078*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0078')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0078'
 where zb_id='ZLZB_SS0078'
end
go

/*********No.233: ZLZB_SS0078******HD_ZBMX_HZ***ZLZB_SS0078*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0078')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11002'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0078'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0078'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0078'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=16    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0078'
,zb_name='肾与前列腺相关手术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0078'
end
go

/*********No.233: ZLZB_SS0078******ZB_FACT_DIM_YS***ZLZB_SS0078*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0078')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0078'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0078'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0078'
end
go

/*********No.234: ZLZB_SS0079******ZBMX***ZLZB_SS0079*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0079')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0079'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾与前列腺相关手术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0079'
end
go

/*********No.234: ZLZB_SS0079******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0079*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0079')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0079'
 where zb_id='ZLZB_SS0079'
end
go

/*********No.234: ZLZB_SS0079******HD_ZBMX_HZ***ZLZB_SS0079*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0079')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11003'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0079'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0079'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0079'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=16    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0079'
,zb_name='肾与前列腺相关手术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0079'
end
go

/*********No.234: ZLZB_SS0079******ZB_FACT_DIM_YS***ZLZB_SS0079*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0079')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0079'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0079'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0079'
end
go

/*********No.235: ZLZB_SS0080******ZBMX***ZLZB_SS0080*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0080')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0080'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肾与前列腺相关手术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0080'
end
go

/*********No.235: ZLZB_SS0080******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0080*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0080')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0080'
 where zb_id='ZLZB_SS0080'
end
go

/*********No.235: ZLZB_SS0080******HD_ZBMX_HZ***ZLZB_SS0080*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0080')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11004'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0080'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0080'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=16    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0080'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=16    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0080'
,zb_name='肾与前列腺相关手术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0080'
end
go

/*********No.235: ZLZB_SS0080******ZB_FACT_DIM_YS***ZLZB_SS0080*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0080')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0080'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0080'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0080'
end
go

/*********No.236: ZLZB_SS0081******ZBMX***ZLZB_SS0081*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0081')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0081'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='血管内修补术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0081'
end
go

/*********No.236: ZLZB_SS0081******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0081*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0081')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0081'
 where zb_id='ZLZB_SS0081'
end
go

/*********No.236: ZLZB_SS0081******HD_ZBMX_HZ***ZLZB_SS0081*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0081')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11006'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0081'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0081'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0081'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=17   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0081'
,zb_name='血管内修补术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0081'
end
go

/*********No.236: ZLZB_SS0081******ZB_FACT_DIM_YS***ZLZB_SS0081*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0081')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0081'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0081'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0081'
end
go

/*********No.237: ZLZB_SS0082******ZBMX***ZLZB_SS0082*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0082')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0082'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='血管内修补术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0082'
end
go

/*********No.237: ZLZB_SS0082******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0082*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0082')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0082'
 where zb_id='ZLZB_SS0082'
end
go

/*********No.237: ZLZB_SS0082******HD_ZBMX_HZ***ZLZB_SS0082*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0082')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11007'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0082'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0082'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0082'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=17  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0082'
,zb_name='血管内修补术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0082'
end
go

/*********No.237: ZLZB_SS0082******ZB_FACT_DIM_YS***ZLZB_SS0082*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0082')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0082'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0082'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0082'
end
go

/*********No.238: ZLZB_SS0083******ZBMX***ZLZB_SS0083*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0083')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0083'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='血管内修补术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0083'
end
go

/*********No.238: ZLZB_SS0083******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0083*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0083')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0083'
 where zb_id='ZLZB_SS0083'
end
go

/*********No.238: ZLZB_SS0083******HD_ZBMX_HZ***ZLZB_SS0083*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0083')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11008'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0083'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0083'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0083'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=17    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0083'
,zb_name='血管内修补术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0083'
end
go

/*********No.238: ZLZB_SS0083******ZB_FACT_DIM_YS***ZLZB_SS0083*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0083')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0083'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0083'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0083'
end
go

/*********No.239: ZLZB_SS0084******ZBMX***ZLZB_SS0084*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0084')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0084'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='血管内修补术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0084'
end
go

/*********No.239: ZLZB_SS0084******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0084*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0084')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0084'
 where zb_id='ZLZB_SS0084'
end
go

/*********No.239: ZLZB_SS0084******HD_ZBMX_HZ***ZLZB_SS0084*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0084')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11009'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0084'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0084'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0084'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=17    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0084'
,zb_name='血管内修补术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0084'
end
go

/*********No.239: ZLZB_SS0084******ZB_FACT_DIM_YS***ZLZB_SS0084*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0084')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0084'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0084'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0084'
end
go

/*********No.240: ZLZB_SS0085******ZBMX***ZLZB_SS0085*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0085')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0085'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='血管内修补术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0085'
end
go

/*********No.240: ZLZB_SS0085******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0085*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0085')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0085'
 where zb_id='ZLZB_SS0085'
end
go

/*********No.240: ZLZB_SS0085******HD_ZBMX_HZ***ZLZB_SS0085*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0085')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11010'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0085'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0085'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=17    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0085'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=17    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0085'
,zb_name='血管内修补术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0085'
end
go

/*********No.240: ZLZB_SS0085******ZB_FACT_DIM_YS***ZLZB_SS0085*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0085')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0085'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0085'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0085'
end
go

/*********No.241: ZLZB_SS0086******ZBMX***ZLZB_SS0086*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0086')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0086'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='恶性肿瘤手术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0086'
end
go

/*********No.241: ZLZB_SS0086******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0086*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0086')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0086'
 where zb_id='ZLZB_SS0086'
end
go

/*********No.241: ZLZB_SS0086******HD_ZBMX_HZ***ZLZB_SS0086*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0086')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11012'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0086'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0086'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0086'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=18   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0086'
,zb_name='恶性肿瘤手术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0086'
end
go

/*********No.241: ZLZB_SS0086******ZB_FACT_DIM_YS***ZLZB_SS0086*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0086')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0086'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0086'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0086'
end
go

/*********No.242: ZLZB_SS0087******ZBMX***ZLZB_SS0087*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0087')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0087'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='恶性肿瘤手术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0087'
end
go

/*********No.242: ZLZB_SS0087******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0087*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0087')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0087'
 where zb_id='ZLZB_SS0087'
end
go

/*********No.242: ZLZB_SS0087******HD_ZBMX_HZ***ZLZB_SS0087*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0087')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11013'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0087'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0087'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0087'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=18  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0087'
,zb_name='恶性肿瘤手术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0087'
end
go

/*********No.242: ZLZB_SS0087******ZB_FACT_DIM_YS***ZLZB_SS0087*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0087')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0087'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0087'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0087'
end
go

/*********No.243: ZLZB_SS0088******ZBMX***ZLZB_SS0088*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0088')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0088'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='恶性肿瘤手术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0088'
end
go

/*********No.243: ZLZB_SS0088******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0088*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0088')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0088'
 where zb_id='ZLZB_SS0088'
end
go

/*********No.243: ZLZB_SS0088******HD_ZBMX_HZ***ZLZB_SS0088*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0088')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11014'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0088'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0088'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0088'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=18    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0088'
,zb_name='恶性肿瘤手术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0088'
end
go

/*********No.243: ZLZB_SS0088******ZB_FACT_DIM_YS***ZLZB_SS0088*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0088')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0088'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0088'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0088'
end
go

/*********No.244: ZLZB_SS0187******ZBMX***ZLZB_SS0187*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0187')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0187'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='腹腔镜结直肠癌根治术手术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0187'
end
go

/*********No.244: ZLZB_SS0187******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0187*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0187')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0187'
 where zb_id='ZLZB_SS0187'
end
go

/*********No.244: ZLZB_SS0187******HD_ZBMX_HZ***ZLZB_SS0187*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0187')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11141'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0187'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0187'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=38  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0187'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=38  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0187'
,zb_name='腹腔镜结直肠癌根治术手术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0187'
end
go

/*********No.244: ZLZB_SS0187******ZB_FACT_DIM_YS***ZLZB_SS0187*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0187')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0187'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0187'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0187'
end
go

/*********No.245: ZLZB_SS01002******ZBMX***ZLZB_SS01002*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01002')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01002'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01002'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='患者人次占比'
,percent_type='100'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01002'
end
go

/*********No.245: ZLZB_SS01002******HD_ZBMX_HZ***ZLZB_SS01002*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01002')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex='A102,ZLZB_SS01001'
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11452'
,proc_name=''
,sql_end=''
,sql_middle=''
,sql_start=''
,sql_text='SELECT  ''ZLZB_SS01002''  zbmx_id,yykey,yydm,kskey,ksdm,month,SUM(fz) fz,SUM(fm) fm ,NULL czry,getdate() gxrq,null bqkey
FROM
(
SELECT yykey,yydm,kskey,ksdm,month,fz,0 fm 
FROM FACT_RESULT_KS_VALUE_M 
WHERE zbmx_id =''ZLZB_SS01001''
         and month between @kssj and @jssj UNION ALL
SELECT yykey,yydm,kskey,ksdm,month,0 fz,fz fm 
FROM FACT_RESULT_KS_VALUE_M 
WHERE zbmx_id =''A102''
       and month between @kssj and @jssj )t
GROUP BY yykey,yydm,kskey,ksdm,month '
,sql_text_first=''
,tqsql_text='SELECT  ''ZLZB_SS01002''  zbmx_id,yykey,yydm,kskey,ksdm,month,SUM(fz) fz,SUM(fm) fm ,NULL czry,getdate() gxrq,null bqkey
FROM
(
SELECT yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,fz,0 fm 
FROM FACT_RESULT_KS_VALUE_M 
WHERE dateadd(year,1,month) < getdate() and zbmx_id =''ZLZB_SS01001''
         and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) UNION ALL
SELECT yykey,yydm,kskey,ksdm,dateadd(year,1,month) month,0 fz,fz fm 
FROM FACT_RESULT_KS_VALUE_M 
WHERE dateadd(year,1,month) < getdate() and zbmx_id =''A102''
       and month between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) )t
GROUP BY yykey,yydm,kskey,ksdm,month '
,ysfs=''
,zb_id='ZLZB_SS01002'
,zb_name='患者人次占比'
,zbzt='0'
 where zb_id='ZLZB_SS01002'
end
go

/*********No.245: ZLZB_SS01002******ZB_FACT_DIM_YS***ZLZB_SS01002*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01002')
begin
update ZB_FACT_DIM_YS set
dim_table='病案科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='A102'
,fm_fact_val='1'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01008'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01002'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01002'
end
go

/*********No.246: ZLZB_SS01003******ZBMX***ZLZB_SS01003*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01003')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01003'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01003'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01003'
end
go

/*********No.246: ZLZB_SS01003******HD_ZBMX_HZ***ZLZB_SS01003*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01003')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11030'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01003'' zbmx_id,  timekey, yykey ,kskey , zdsskey, sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey  ,zdsskey         '
,sql_start='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01003'' zbmx_id,  timekey, yykey ,kskey , zdsskey, sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey  ,zdsskey           ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01003'' zbmx_id,  timekey, yykey ,kskey , zdsskey, sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey  ,zdsskey           ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01003'
,zb_name='平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS01003'
end
go

/*********No.246: ZLZB_SS01003******ZB_FACT_DIM_YS***ZLZB_SS01003*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01003')
begin
update ZB_FACT_DIM_YS set
dim_table='病案科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='ZLZB_SS01008'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01009'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01003'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01003'
end
go

/*********No.247: ZLZB_SS01004******ZBMX***ZLZB_SS01004*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01004')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01004'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01004'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='患者费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01004'
end
go

/*********No.247: ZLZB_SS01004******HD_ZBMX_HZ***ZLZB_SS01004*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01004')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11031'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01004'' zbmx_id,  timekey, yykey ,kskey ,zdsskey, sum(zfy) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a where   timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey,zdsskey'
,sql_start='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01004'' zbmx_id,  timekey, yykey ,kskey ,zdsskey, sum(zfy) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a where   timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey,zdsskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01004'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, 0 fm from FACT_GZ_HZAQ_ZDSS where   timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01004'
,zb_name='患者费用'
,zbzt='0'
 where zb_id='ZLZB_SS01004'
end
go

/*********No.247: ZLZB_SS01004******ZB_FACT_DIM_YS***ZLZB_SS01004*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01004')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01004'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01004'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01004'
end
go

/*********No.248: ZLZB_SS01005******ZBMX***ZLZB_SS01005*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01005')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01005'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01005'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='均次费'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01005'
end
go

/*********No.248: ZLZB_SS01005******HD_ZBMX_HZ***ZLZB_SS01005*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01005')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11032'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01005'' zbmx_id,  timekey, yykey ,kskey , zdsskey, sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where   timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey'
,sql_start='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01005'' zbmx_id,  timekey, yykey ,kskey , zdsskey, sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where   timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01005'' zbmx_id,  timekey, yykey ,kskey , zdsskey, sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where   timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01005'
,zb_name='均次费'
,zbzt='0'
 where zb_id='ZLZB_SS01005'
end
go

/*********No.248: ZLZB_SS01005******ZB_FACT_DIM_YS***ZLZB_SS01005*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01005')
begin
update ZB_FACT_DIM_YS set
dim_table='病案科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='ZLZB_SS01008'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01004'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01005'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01005'
end
go

/*********No.249: ZLZB_SS01006******ZBMX***ZLZB_SS01006*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01006')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01006'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01006'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='患者药费'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01006'
end
go

/*********No.249: ZLZB_SS01006******HD_ZBMX_HZ***ZLZB_SS01006*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01006')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11033'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01006'' zbmx_id,  timekey, yykey ,kskey , zdsskey,  sum(ypfy) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a where  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey'
,sql_start='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01006'' zbmx_id,  timekey, yykey ,kskey , zdsskey,  sum(ypfy) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a where  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01006'' zbmx_id,  timekey, yykey ,kskey , zdsskey,  sum(ypfy) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a where  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01006'
,zb_name='患者药费'
,zbzt='0'
 where zb_id='ZLZB_SS01006'
end
go

/*********No.249: ZLZB_SS01006******ZB_FACT_DIM_YS***ZLZB_SS01006*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01006')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01006'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01006'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01006'
end
go

/*********No.250: ZLZB_SS01007******ZBMX***ZLZB_SS01007*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01007')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01007'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01007'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='均次药费'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01007'
end
go

/*********No.250: ZLZB_SS01007******HD_ZBMX_HZ***ZLZB_SS01007*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01007')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11034'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS01007'' zbmx_id,  timekey, yykey ,kskey , zdsskey,  sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey      '
,sql_start='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01007'' zbmx_id,  timekey, yykey ,kskey , zdsskey,  sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey        ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS01007'' zbmx_id,  timekey, yykey ,kskey , zdsskey,  sum(ypfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a where  timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey ,zdsskey        ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX_BA c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS01007'
,zb_name='均次药费'
,zbzt='0'
 where zb_id='ZLZB_SS01007'
end
go

/*********No.250: ZLZB_SS01007******ZB_FACT_DIM_YS***ZLZB_SS01007*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01007')
begin
update ZB_FACT_DIM_YS set
dim_table='病案科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition=' where'
,fm_fact_table_name='ZLZB_SS01008'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01006'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01007'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01007'
end
go

/*********No.251: ZLZB_SS0090******ZBMX***ZLZB_SS0090*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0090')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0090'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='恶性肿瘤手术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0090'
end
go

/*********No.251: ZLZB_SS0090******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0090*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0090')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0090'
 where zb_id='ZLZB_SS0090'
end
go

/*********No.251: ZLZB_SS0090******HD_ZBMX_HZ***ZLZB_SS0090*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0090')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11016'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0090'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0090'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=18    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0090'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=18    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0090'
,zb_name='恶性肿瘤手术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0090'
end
go

/*********No.251: ZLZB_SS0090******ZB_FACT_DIM_YS***ZLZB_SS0090*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0090')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0090'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0090'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0090'
end
go

/*********No.252: ZLZB_SS0091******ZBMX***ZLZB_SS0091*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0091')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0091'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='甲状腺癌联合根治术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0091'
end
go

/*********No.252: ZLZB_SS0091******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0091*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0091')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0091'
 where zb_id='ZLZB_SS0091'
end
go

/*********No.252: ZLZB_SS0091******HD_ZBMX_HZ***ZLZB_SS0091*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0091')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11018'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0091'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0091'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0091'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=19   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0091'
,zb_name='甲状腺癌联合根治术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0091'
end
go

/*********No.252: ZLZB_SS0091******ZB_FACT_DIM_YS***ZLZB_SS0091*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0091')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0091'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0091'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0091'
end
go

/*********No.253: ZLZB_SS0092******ZBMX***ZLZB_SS0092*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0092')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0092'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='甲状腺癌联合根治术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0092'
end
go

/*********No.253: ZLZB_SS0092******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0092*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0092')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0092'
 where zb_id='ZLZB_SS0092'
end
go

/*********No.253: ZLZB_SS0092******HD_ZBMX_HZ***ZLZB_SS0092*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0092')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11019'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0092'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0092'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0092'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=19  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0092'
,zb_name='甲状腺癌联合根治术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0092'
end
go

/*********No.253: ZLZB_SS0092******ZB_FACT_DIM_YS***ZLZB_SS0092*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0092')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0092'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0092'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0092'
end
go

/*********No.254: ZLZB_SS0093******ZBMX***ZLZB_SS0093*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0093')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0093'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='甲状腺癌联合根治术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0093'
end
go

/*********No.254: ZLZB_SS0093******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0093*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0093')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0093'
 where zb_id='ZLZB_SS0093'
end
go

/*********No.254: ZLZB_SS0093******HD_ZBMX_HZ***ZLZB_SS0093*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0093')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11020'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0093'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0093'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0093'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=19    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0093'
,zb_name='甲状腺癌联合根治术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0093'
end
go

/*********No.254: ZLZB_SS0093******ZB_FACT_DIM_YS***ZLZB_SS0093*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0093')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0093'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0093'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0093'
end
go

/*********No.255: ZLZB_SS0095******ZBMX***ZLZB_SS0095*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0095')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0095'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='甲状腺癌联合根治术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0095'
end
go

/*********No.255: ZLZB_SS0095******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0095*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0095')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0095'
 where zb_id='ZLZB_SS0095'
end
go

/*********No.255: ZLZB_SS0095******HD_ZBMX_HZ***ZLZB_SS0095*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0095')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11022'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0095'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0095'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=19    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0095'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=19    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0095'
,zb_name='甲状腺癌联合根治术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0095'
end
go

/*********No.255: ZLZB_SS0095******ZB_FACT_DIM_YS***ZLZB_SS0095*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0095')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0095'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0095'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0095'
end
go

/*********No.256: ZLZB_SS0123******ZBMX***ZLZB_SS0123*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0123')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0123'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓下吻合术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0123'
end
go

/*********No.256: ZLZB_SS0123******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0123*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0123')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0123'
 where zb_id='ZLZB_SS0123'
end
go

/*********No.256: ZLZB_SS0123******HD_ZBMX_HZ***ZLZB_SS0123*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0123')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11064'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0123'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0123'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0123'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=25    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0123'
,zb_name='食管部分切除、食管胃弓下吻合术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0123'
end
go

/*********No.256: ZLZB_SS0123******ZB_FACT_DIM_YS***ZLZB_SS0123*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0123')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0123'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0123'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0123'
end
go

/*********No.257: ZLZB_SS0124******ZBMX***ZLZB_SS0124*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0124')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0124'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓下吻合术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0124'
end
go

/*********No.257: ZLZB_SS0124******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0124*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0124')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0124'
 where zb_id='ZLZB_SS0124'
end
go

/*********No.257: ZLZB_SS0124******HD_ZBMX_HZ***ZLZB_SS0124*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0124')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11065'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0124'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0124'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0124'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=25    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0124'
,zb_name='食管部分切除、食管胃弓下吻合术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0124'
end
go

/*********No.257: ZLZB_SS0124******ZB_FACT_DIM_YS***ZLZB_SS0124*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0124')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0124'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0124'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0124'
end
go

/*********No.258: ZLZB_SS0125******ZBMX***ZLZB_SS0125*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0125')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0125'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓下吻合术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0125'
end
go

/*********No.258: ZLZB_SS0125******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0125*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0125')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0125'
 where zb_id='ZLZB_SS0125'
end
go

/*********No.258: ZLZB_SS0125******HD_ZBMX_HZ***ZLZB_SS0125*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0125')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11066'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0125'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0125'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0125'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=25    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0125'
,zb_name='食管部分切除、食管胃弓下吻合术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0125'
end
go

/*********No.258: ZLZB_SS0125******ZB_FACT_DIM_YS***ZLZB_SS0125*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0125')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0125'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0125'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0125'
end
go

/*********No.259: ZLZB_SS0126******ZBMX***ZLZB_SS0126*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0126')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0126'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃近端切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0126'
end
go

/*********No.259: ZLZB_SS0126******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0126*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0126')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0126'
 where zb_id='ZLZB_SS0126'
end
go

/*********No.259: ZLZB_SS0126******HD_ZBMX_HZ***ZLZB_SS0126*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0126')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11068'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0126'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0126'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0126'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=26   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0126'
,zb_name='胃近端切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0126'
end
go

/*********No.259: ZLZB_SS0126******ZB_FACT_DIM_YS***ZLZB_SS0126*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0126')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0126'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0126'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0126'
end
go

/*********No.260: ZLZB_SS0127******ZBMX***ZLZB_SS0127*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0127')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0127'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃近端切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0127'
end
go

/*********No.260: ZLZB_SS0127******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0127*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0127')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0127'
 where zb_id='ZLZB_SS0127'
end
go

/*********No.260: ZLZB_SS0127******HD_ZBMX_HZ***ZLZB_SS0127*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0127')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11069'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0127'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0127'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0127'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=26  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0127'
,zb_name='胃近端切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0127'
end
go

/*********No.260: ZLZB_SS0127******ZB_FACT_DIM_YS***ZLZB_SS0127*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0127')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0127'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0127'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0127'
end
go

/*********No.261: ZLZB_SS0128******ZBMX***ZLZB_SS0128*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0128')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0128'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃近端切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0128'
end
go

/*********No.261: ZLZB_SS0128******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0128*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0128')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0128'
 where zb_id='ZLZB_SS0128'
end
go

/*********No.261: ZLZB_SS0128******HD_ZBMX_HZ***ZLZB_SS0128*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0128')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11070'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0128'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0128'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0128'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=26    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0128'
,zb_name='胃近端切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0128'
end
go

/*********No.261: ZLZB_SS0128******ZB_FACT_DIM_YS***ZLZB_SS0128*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0128')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0128'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0128'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0128'
end
go

/*********No.262: ZLZB_SS0129******ZBMX***ZLZB_SS0129*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0129')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0129'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃近端切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0129'
end
go

/*********No.262: ZLZB_SS0129******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0129*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0129')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0129'
 where zb_id='ZLZB_SS0129'
end
go

/*********No.262: ZLZB_SS0129******HD_ZBMX_HZ***ZLZB_SS0129*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0129')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11071'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0129'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0129'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0129'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=26    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0129'
,zb_name='胃近端切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0129'
end
go

/*********No.262: ZLZB_SS0129******ZB_FACT_DIM_YS***ZLZB_SS0129*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0129')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0129'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0129'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0129'
end
go

/*********No.263: ZLZB_SS0130******ZBMX***ZLZB_SS0130*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0130')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0130'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃近端切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0130'
end
go

/*********No.263: ZLZB_SS0130******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0130*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0130')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0130'
 where zb_id='ZLZB_SS0130'
end
go

/*********No.263: ZLZB_SS0130******HD_ZBMX_HZ***ZLZB_SS0130*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0130')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11072'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0130'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0130'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=26    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0130'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=26    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0130'
,zb_name='胃近端切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0130'
end
go

/*********No.263: ZLZB_SS0130******ZB_FACT_DIM_YS***ZLZB_SS0130*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0130')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0130'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0130'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0130'
end
go

/*********No.264: ZLZB_SS0131******ZBMX***ZLZB_SS0131*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0131')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0131'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃远端切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0131'
end
go

/*********No.264: ZLZB_SS0131******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0131*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0131')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0131'
 where zb_id='ZLZB_SS0131'
end
go

/*********No.264: ZLZB_SS0131******HD_ZBMX_HZ***ZLZB_SS0131*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0131')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11074'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0131'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0131'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0131'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=27   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0131'
,zb_name='胃远端切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0131'
end
go

/*********No.264: ZLZB_SS0131******ZB_FACT_DIM_YS***ZLZB_SS0131*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0131')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0131'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0131'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0131'
end
go

/*********No.265: ZLZB_SS0132******ZBMX***ZLZB_SS0132*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0132')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0132'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃远端切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0132'
end
go

/*********No.265: ZLZB_SS0132******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0132*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0132')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0132'
 where zb_id='ZLZB_SS0132'
end
go

/*********No.265: ZLZB_SS0132******HD_ZBMX_HZ***ZLZB_SS0132*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0132')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11075'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0132'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0132'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0132'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=27  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0132'
,zb_name='胃远端切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0132'
end
go

/*********No.265: ZLZB_SS0132******ZB_FACT_DIM_YS***ZLZB_SS0132*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0132')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0132'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0132'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0132'
end
go

/*********No.266: ZLZB_SS0133******ZBMX***ZLZB_SS0133*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0133')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0133'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃远端切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0133'
end
go

/*********No.266: ZLZB_SS0133******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0133*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0133')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0133'
 where zb_id='ZLZB_SS0133'
end
go

/*********No.266: ZLZB_SS0133******HD_ZBMX_HZ***ZLZB_SS0133*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0133')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11076'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0133'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0133'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0133'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=27    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0133'
,zb_name='胃远端切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0133'
end
go

/*********No.266: ZLZB_SS0133******ZB_FACT_DIM_YS***ZLZB_SS0133*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0133')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0133'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0133'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0133'
end
go

/*********No.267: ZLZB_SS0134******ZBMX***ZLZB_SS0134*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0134')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0134'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃远端切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0134'
end
go

/*********No.267: ZLZB_SS0134******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0134*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0134')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0134'
 where zb_id='ZLZB_SS0134'
end
go

/*********No.267: ZLZB_SS0134******HD_ZBMX_HZ***ZLZB_SS0134*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0134')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11077'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0134'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0134'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0134'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=27    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0134'
,zb_name='胃远端切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0134'
end
go

/*********No.267: ZLZB_SS0134******ZB_FACT_DIM_YS***ZLZB_SS0134*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0134')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0134'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0134'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0134'
end
go

/*********No.268: ZLZB_SS0135******ZBMX***ZLZB_SS0135*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0135')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0135'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胃远端切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0135'
end
go

/*********No.268: ZLZB_SS0135******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0135*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0135')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0135'
 where zb_id='ZLZB_SS0135'
end
go

/*********No.268: ZLZB_SS0135******HD_ZBMX_HZ***ZLZB_SS0135*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0135')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11078'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0135'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0135'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=27    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0135'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=27    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0135'
,zb_name='胃远端切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0135'
end
go

/*********No.268: ZLZB_SS0135******ZB_FACT_DIM_YS***ZLZB_SS0135*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0135')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0135'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0135'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0135'
end
go

/*********No.269: ZLZB_SS0136******ZBMX***ZLZB_SS0136*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0136')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0136'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全胃切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0136'
end
go

/*********No.269: ZLZB_SS0136******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0136*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0136')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0136'
 where zb_id='ZLZB_SS0136'
end
go

/*********No.269: ZLZB_SS0136******HD_ZBMX_HZ***ZLZB_SS0136*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0136')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11080'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0136'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0136'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0136'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=28   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0136'
,zb_name='全胃切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0136'
end
go

/*********No.269: ZLZB_SS0136******ZB_FACT_DIM_YS***ZLZB_SS0136*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0136')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0136'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0136'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0136'
end
go

/*********No.270: ZLZB_SS0137******ZBMX***ZLZB_SS0137*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0137')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0137'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全胃切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0137'
end
go

/*********No.270: ZLZB_SS0137******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0137*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0137')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0137'
 where zb_id='ZLZB_SS0137'
end
go

/*********No.270: ZLZB_SS0137******HD_ZBMX_HZ***ZLZB_SS0137*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0137')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11081'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0137'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0137'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0137'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=28  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0137'
,zb_name='全胃切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0137'
end
go

/*********No.270: ZLZB_SS0137******ZB_FACT_DIM_YS***ZLZB_SS0137*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0137')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0137'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0137'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0137'
end
go

/*********No.271: ZLZB_SS0138******ZBMX***ZLZB_SS0138*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0138')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0138'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全胃切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0138'
end
go

/*********No.271: ZLZB_SS0138******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0138*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0138')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0138'
 where zb_id='ZLZB_SS0138'
end
go

/*********No.271: ZLZB_SS0138******HD_ZBMX_HZ***ZLZB_SS0138*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0138')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11082'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0138'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0138'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0138'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=28    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0138'
,zb_name='全胃切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0138'
end
go

/*********No.271: ZLZB_SS0138******ZB_FACT_DIM_YS***ZLZB_SS0138*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0138')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0138'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0138'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0138'
end
go

/*********No.272: ZLZB_SS0139******ZBMX***ZLZB_SS0139*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0139')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0139'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全胃切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0139'
end
go

/*********No.272: ZLZB_SS0139******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0139*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0139')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0139'
 where zb_id='ZLZB_SS0139'
end
go

/*********No.272: ZLZB_SS0139******HD_ZBMX_HZ***ZLZB_SS0139*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0139')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11083'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0139'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0139'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0139'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=28    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0139'
,zb_name='全胃切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0139'
end
go

/*********No.272: ZLZB_SS0139******ZB_FACT_DIM_YS***ZLZB_SS0139*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0139')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0139'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0139'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0139'
end
go

/*********No.273: ZLZB_SS0140******ZBMX***ZLZB_SS0140*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0140')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0140'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全胃切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0140'
end
go

/*********No.273: ZLZB_SS0140******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0140*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0140')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0140'
 where zb_id='ZLZB_SS0140'
end
go

/*********No.273: ZLZB_SS0140******HD_ZBMX_HZ***ZLZB_SS0140*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0140')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11084'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0140'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0140'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=28    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0140'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=28    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0140'
,zb_name='全胃切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0140'
end
go

/*********No.273: ZLZB_SS0140******ZB_FACT_DIM_YS***ZLZB_SS0140*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0140')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0140'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0140'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0140'
end
go

/*********No.274: ZLZB_SS0141******ZBMX***ZLZB_SS0141*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0141')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0141'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性全胃切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0141'
end
go

/*********No.274: ZLZB_SS0141******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0141*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0141')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0141'
 where zb_id='ZLZB_SS0141'
end
go

/*********No.274: ZLZB_SS0141******HD_ZBMX_HZ***ZLZB_SS0141*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0141')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11086'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0141'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0141'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0141'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=29   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0141'
,zb_name='根治性全胃切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0141'
end
go

/*********No.274: ZLZB_SS0141******ZB_FACT_DIM_YS***ZLZB_SS0141*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0141')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0141'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0141'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0141'
end
go

/*********No.275: ZLZB_SS0142******ZBMX***ZLZB_SS0142*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0142')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0142'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性全胃切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0142'
end
go

/*********No.275: ZLZB_SS0142******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0142*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0142')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0142'
 where zb_id='ZLZB_SS0142'
end
go

/*********No.275: ZLZB_SS0142******HD_ZBMX_HZ***ZLZB_SS0142*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0142')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11087'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0142'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0142'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0142'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=29  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0142'
,zb_name='根治性全胃切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0142'
end
go

/*********No.275: ZLZB_SS0142******ZB_FACT_DIM_YS***ZLZB_SS0142*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0142')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0142'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0142'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0142'
end
go

/*********No.276: ZLZB_SS0143******ZBMX***ZLZB_SS0143*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0143')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0143'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性全胃切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0143'
end
go

/*********No.276: ZLZB_SS0143******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0143*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0143')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0143'
 where zb_id='ZLZB_SS0143'
end
go

/*********No.276: ZLZB_SS0143******HD_ZBMX_HZ***ZLZB_SS0143*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0143')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11088'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0143'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0143'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0143'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=29    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0143'
,zb_name='根治性全胃切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0143'
end
go

/*********No.276: ZLZB_SS0143******ZB_FACT_DIM_YS***ZLZB_SS0143*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0143')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0143'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0143'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0143'
end
go

/*********No.277: ZLZB_SS0144******ZBMX***ZLZB_SS0144*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0144')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0144'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性全胃切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0144'
end
go

/*********No.277: ZLZB_SS0144******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0144*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0144')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0144'
 where zb_id='ZLZB_SS0144'
end
go

/*********No.277: ZLZB_SS0144******HD_ZBMX_HZ***ZLZB_SS0144*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0144')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11089'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0144'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0144'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0144'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=29    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0144'
,zb_name='根治性全胃切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0144'
end
go

/*********No.277: ZLZB_SS0144******ZB_FACT_DIM_YS***ZLZB_SS0144*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0144')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0144'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0144'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0144'
end
go

/*********No.278: ZLZB_SS0145******ZBMX***ZLZB_SS0145*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0145')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0145'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='根治性全胃切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0145'
end
go

/*********No.278: ZLZB_SS0145******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0145*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0145')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0145'
 where zb_id='ZLZB_SS0145'
end
go

/*********No.278: ZLZB_SS0145******HD_ZBMX_HZ***ZLZB_SS0145*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0145')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11090'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0145'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0145'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=29    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0145'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=29    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0145'
,zb_name='根治性全胃切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0145'
end
go

/*********No.278: ZLZB_SS0145******ZB_FACT_DIM_YS***ZLZB_SS0145*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0145')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0145'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0145'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0145'
end
go

/*********No.279: ZLZB_SS01010******ZBMX***ZLZB_SS01010*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS01010')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid='ZLZB_SS01010'
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS01010'
,is_hz=''
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt='0'
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='重点手术患者总费用_HIS'
,percent_type='10000'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw=''
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS01010'
end
go

/*********No.279: ZLZB_SS01010******HD_ZBMX_HZ***ZLZB_SS01010*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS01010')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11038'
,proc_name=''
,sql_end='   ) a inner join DIM_YYXX b ON a.yykey=b.yykey 
inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey 
WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) 
GROUP  BY a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select   timekey, yykey ,kskey , dxmkey , sum(cffy) fz, 0 fm from FACT_GZ_ZDSS_FYFX a  where timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey ,dxmkey ,timekey'
,sql_start='SELECT ''ZLZB_SS01010''  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm
, CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,0 fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  '
,sql_text='SELECT ''ZLZB_SS01010''  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm
, CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,0 fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select   timekey, yykey ,kskey , dxmkey , sum(cffy) fz, 0 fm from FACT_GZ_ZDSS_FYFX a  where timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey ,dxmkey ,timekey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey 
inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey 
WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey)) 
GROUP  BY a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='SELECT ''ZLZB_SS01010''  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm
, CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,0 fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select   timekey, yykey ,kskey , dxmkey , sum(cffy) fz, 0 fm from FACT_GZ_ZDSS_FYFX a  where timekey between dateadd(year,-1,@kssj) and dateadd(year,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey ,dxmkey ,timekey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey 
inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey 
WHERE timekey between dateadd(year,-1,@kssj)  and dateadd(year,-1,@jssj) and (a.yykey in (@yykey) or -1 in (@yykey)) 
GROUP  BY a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='1'
,zb_id='ZLZB_SS01010'
,zb_name='重点手术患者总费用_HIS'
,zbzt='0'
 where zb_id='ZLZB_SS01010'
end
go

/*********No.279: ZLZB_SS01010******ZB_FACT_DIM_YS***ZLZB_SS01010*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS01010')
begin
update ZB_FACT_DIM_YS set
dim_table='大项目'
,dim_table_name='DIM_SFDXMK'
,dim_table_val='dxmmc'
,fm_condition=' where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition=' where'
,fz_fact_table_name='ZLZB_SS01010'
,fz_fact_val='1'
,join_code='dxmkey'
,next_join_code='dxmkey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS01010'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS01010'
end
go

/*********No.280: ZLZB_SS0104******ZBMX***ZLZB_SS0104*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0104')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0104'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺叶切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0104'
end
go

/*********No.280: ZLZB_SS0104******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0104*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0104')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0104'
 where zb_id='ZLZB_SS0104'
end
go

/*********No.280: ZLZB_SS0104******HD_ZBMX_HZ***ZLZB_SS0104*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0104')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11041'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0104'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0104'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0104'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=21    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0104'
,zb_name='肺叶切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0104'
end
go

/*********No.280: ZLZB_SS0104******ZB_FACT_DIM_YS***ZLZB_SS0104*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0104')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0104'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0104'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0104'
end
go

/*********No.281: ZLZB_SS0105******ZBMX***ZLZB_SS0105*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0105')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0105'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肺叶切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0105'
end
go

/*********No.281: ZLZB_SS0105******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0105*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0105')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0105'
 where zb_id='ZLZB_SS0105'
end
go

/*********No.281: ZLZB_SS0105******HD_ZBMX_HZ***ZLZB_SS0105*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0105')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11042'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0105'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0105'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=21    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0105'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=21    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0105'
,zb_name='肺叶切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0105'
end
go

/*********No.281: ZLZB_SS0105******ZB_FACT_DIM_YS***ZLZB_SS0105*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0105')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0105'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0105'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0105'
end
go

/*********No.282: ZLZB_SS0106******ZBMX***ZLZB_SS0106*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0106')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0106'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全肺切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0106'
end
go

/*********No.282: ZLZB_SS0106******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0106*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0106')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0106'
 where zb_id='ZLZB_SS0106'
end
go

/*********No.282: ZLZB_SS0106******HD_ZBMX_HZ***ZLZB_SS0106*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0106')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11044'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0106'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0106'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0106'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=22   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0106'
,zb_name='全肺切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0106'
end
go

/*********No.282: ZLZB_SS0106******ZB_FACT_DIM_YS***ZLZB_SS0106*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0106')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0106'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0106'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0106'
end
go

/*********No.283: ZLZB_SS0107******ZBMX***ZLZB_SS0107*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0107')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0107'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全肺切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0107'
end
go

/*********No.283: ZLZB_SS0107******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0107*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0107')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0107'
 where zb_id='ZLZB_SS0107'
end
go

/*********No.283: ZLZB_SS0107******HD_ZBMX_HZ***ZLZB_SS0107*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0107')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11045'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0107'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0107'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0107'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=22  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0107'
,zb_name='全肺切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0107'
end
go

/*********No.283: ZLZB_SS0107******ZB_FACT_DIM_YS***ZLZB_SS0107*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0107')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0107'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0107'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0107'
end
go

/*********No.284: ZLZB_SS0108******ZBMX***ZLZB_SS0108*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0108')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0108'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全肺切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0108'
end
go

/*********No.284: ZLZB_SS0108******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0108*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0108')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0108'
 where zb_id='ZLZB_SS0108'
end
go

/*********No.284: ZLZB_SS0108******HD_ZBMX_HZ***ZLZB_SS0108*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0108')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11046'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0108'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0108'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0108'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=22    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0108'
,zb_name='全肺切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0108'
end
go

/*********No.284: ZLZB_SS0108******ZB_FACT_DIM_YS***ZLZB_SS0108*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0108')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0108'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0108'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0108'
end
go

/*********No.285: ZLZB_SS0109******ZBMX***ZLZB_SS0109*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0109')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0109'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全肺切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0109'
end
go

/*********No.285: ZLZB_SS0109******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0109*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0109')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0109'
 where zb_id='ZLZB_SS0109'
end
go

/*********No.285: ZLZB_SS0109******HD_ZBMX_HZ***ZLZB_SS0109*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0109')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11047'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0109'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0109'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0109'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=22    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0109'
,zb_name='全肺切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0109'
end
go

/*********No.285: ZLZB_SS0109******ZB_FACT_DIM_YS***ZLZB_SS0109*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0109')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0109'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0109'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0109'
end
go

/*********No.286: ZLZB_SS0110******ZBMX***ZLZB_SS0110*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0110')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0110'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='全肺切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0110'
end
go

/*********No.286: ZLZB_SS0110******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0110*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0110')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0110'
 where zb_id='ZLZB_SS0110'
end
go

/*********No.286: ZLZB_SS0110******HD_ZBMX_HZ***ZLZB_SS0110*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0110')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11048'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0110'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0110'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=22    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0110'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=22    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0110'
,zb_name='全肺切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0110'
end
go

/*********No.286: ZLZB_SS0110******ZB_FACT_DIM_YS***ZLZB_SS0110*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0110')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0110'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0110'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0110'
end
go

/*********No.287: ZLZB_SS0111******ZBMX***ZLZB_SS0111*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0111')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0111'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胸腔镜肺癌切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0111'
end
go

/*********No.287: ZLZB_SS0111******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0111*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0111')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0111'
 where zb_id='ZLZB_SS0111'
end
go

/*********No.287: ZLZB_SS0111******HD_ZBMX_HZ***ZLZB_SS0111*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0111')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11050'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0111'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0111'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0111'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=23   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0111'
,zb_name='胸腔镜肺癌切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0111'
end
go

/*********No.287: ZLZB_SS0111******ZB_FACT_DIM_YS***ZLZB_SS0111*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0111')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0111'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0111'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0111'
end
go

/*********No.288: ZLZB_SS0112******ZBMX***ZLZB_SS0112*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0112')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0112'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胸腔镜肺癌切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0112'
end
go

/*********No.288: ZLZB_SS0112******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0112*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0112')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0112'
 where zb_id='ZLZB_SS0112'
end
go

/*********No.288: ZLZB_SS0112******HD_ZBMX_HZ***ZLZB_SS0112*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0112')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11051'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0112'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0112'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0112'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=23  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0112'
,zb_name='胸腔镜肺癌切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0112'
end
go

/*********No.288: ZLZB_SS0112******ZB_FACT_DIM_YS***ZLZB_SS0112*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0112')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0112'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0112'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0112'
end
go

/*********No.289: ZLZB_SS0113******ZBMX***ZLZB_SS0113*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0113')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0113'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胸腔镜肺癌切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0113'
end
go

/*********No.289: ZLZB_SS0113******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0113*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0113')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0113'
 where zb_id='ZLZB_SS0113'
end
go

/*********No.289: ZLZB_SS0113******HD_ZBMX_HZ***ZLZB_SS0113*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0113')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11052'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0113'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0113'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0113'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=23    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0113'
,zb_name='胸腔镜肺癌切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0113'
end
go

/*********No.289: ZLZB_SS0113******ZB_FACT_DIM_YS***ZLZB_SS0113*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0113')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0113'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0113'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0113'
end
go

/*********No.290: ZLZB_SS0114******ZBMX***ZLZB_SS0114*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0114')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0114'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胸腔镜肺癌切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0114'
end
go

/*********No.290: ZLZB_SS0114******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0114*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0114')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0114'
 where zb_id='ZLZB_SS0114'
end
go

/*********No.290: ZLZB_SS0114******HD_ZBMX_HZ***ZLZB_SS0114*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0114')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11053'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0114'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0114'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0114'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=23    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0114'
,zb_name='胸腔镜肺癌切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0114'
end
go

/*********No.290: ZLZB_SS0114******ZB_FACT_DIM_YS***ZLZB_SS0114*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0114')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0114'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0114'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0114'
end
go

/*********No.291: ZLZB_SS0115******ZBMX***ZLZB_SS0115*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0115')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0115'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='胸腔镜肺癌切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0115'
end
go

/*********No.291: ZLZB_SS0115******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0115*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0115')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0115'
 where zb_id='ZLZB_SS0115'
end
go

/*********No.291: ZLZB_SS0115******HD_ZBMX_HZ***ZLZB_SS0115*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0115')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11054'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0115'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0115'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=23    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0115'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=23    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0115'
,zb_name='胸腔镜肺癌切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0115'
end
go

/*********No.291: ZLZB_SS0115******ZB_FACT_DIM_YS***ZLZB_SS0115*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0115')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0115'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0115'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0115'
end
go

/*********No.292: ZLZB_SS0116******ZBMX***ZLZB_SS0116*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0116')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0116'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓上吻合术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0116'
end
go

/*********No.292: ZLZB_SS0116******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0116*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0116')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0116'
 where zb_id='ZLZB_SS0116'
end
go

/*********No.292: ZLZB_SS0116******HD_ZBMX_HZ***ZLZB_SS0116*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0116')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11056'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0116'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0116'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0116'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=24   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0116'
,zb_name='食管部分切除、食管胃弓上吻合术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0116'
end
go

/*********No.292: ZLZB_SS0116******ZB_FACT_DIM_YS***ZLZB_SS0116*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0116')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0116'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0116'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0116'
end
go

/*********No.293: ZLZB_SS0117******ZBMX***ZLZB_SS0117*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0117')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0117'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓上吻合术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0117'
end
go

/*********No.293: ZLZB_SS0117******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0117*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0117')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0117'
 where zb_id='ZLZB_SS0117'
end
go

/*********No.293: ZLZB_SS0117******HD_ZBMX_HZ***ZLZB_SS0117*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0117')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11057'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0117'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0117'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0117'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=24  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0117'
,zb_name='食管部分切除、食管胃弓上吻合术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0117'
end
go

/*********No.293: ZLZB_SS0117******ZB_FACT_DIM_YS***ZLZB_SS0117*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0117')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0117'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0117'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0117'
end
go

/*********No.294: ZLZB_SS0118******ZBMX***ZLZB_SS0118*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0118')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0118'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓上吻合术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0118'
end
go

/*********No.294: ZLZB_SS0118******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0118*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0118')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0118'
 where zb_id='ZLZB_SS0118'
end
go

/*********No.294: ZLZB_SS0118******HD_ZBMX_HZ***ZLZB_SS0118*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0118')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11058'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0118'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0118'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0118'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=24    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0118'
,zb_name='食管部分切除、食管胃弓上吻合术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0118'
end
go

/*********No.294: ZLZB_SS0118******ZB_FACT_DIM_YS***ZLZB_SS0118*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0118')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0118'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0118'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0118'
end
go

/*********No.295: ZLZB_SS0119******ZBMX***ZLZB_SS0119*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0119')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0119'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓上吻合术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0119'
end
go

/*********No.295: ZLZB_SS0119******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0119*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0119')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0119'
 where zb_id='ZLZB_SS0119'
end
go

/*********No.295: ZLZB_SS0119******HD_ZBMX_HZ***ZLZB_SS0119*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0119')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11059'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0119'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0119'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0119'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=24    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0119'
,zb_name='食管部分切除、食管胃弓上吻合术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0119'
end
go

/*********No.295: ZLZB_SS0119******ZB_FACT_DIM_YS***ZLZB_SS0119*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0119')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0119'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0119'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0119'
end
go

/*********No.296: ZLZB_SS0120******ZBMX***ZLZB_SS0120*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0120')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0120'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓上吻合术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0120'
end
go

/*********No.296: ZLZB_SS0120******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0120*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0120')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0120'
 where zb_id='ZLZB_SS0120'
end
go

/*********No.296: ZLZB_SS0120******HD_ZBMX_HZ***ZLZB_SS0120*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0120')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11060'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0120'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0120'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=24    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0120'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=24    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0120'
,zb_name='食管部分切除、食管胃弓上吻合术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0120'
end
go

/*********No.296: ZLZB_SS0120******ZB_FACT_DIM_YS***ZLZB_SS0120*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0120')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0120'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0120'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0120'
end
go

/*********No.297: ZLZB_SS0121******ZBMX***ZLZB_SS0121*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0121')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0121'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓下吻合术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0121'
end
go

/*********No.297: ZLZB_SS0121******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0121*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0121')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0121'
 where zb_id='ZLZB_SS0121'
end
go

/*********No.297: ZLZB_SS0121******HD_ZBMX_HZ***ZLZB_SS0121*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0121')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11062'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0121'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0121'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0121'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=25   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0121'
,zb_name='食管部分切除、食管胃弓下吻合术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0121'
end
go

/*********No.297: ZLZB_SS0121******ZB_FACT_DIM_YS***ZLZB_SS0121*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0121')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0121'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0121'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0121'
end
go

/*********No.298: ZLZB_SS0122******ZBMX***ZLZB_SS0122*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0122')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0122'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='食管部分切除、食管胃弓下吻合术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0122'
end
go

/*********No.298: ZLZB_SS0122******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0122*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0122')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0122'
 where zb_id='ZLZB_SS0122'
end
go

/*********No.298: ZLZB_SS0122******HD_ZBMX_HZ***ZLZB_SS0122*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0122')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11063'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0122'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0122'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=25  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0122'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=25  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0122'
,zb_name='食管部分切除、食管胃弓下吻合术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0122'
end
go

/*********No.298: ZLZB_SS0122******ZB_FACT_DIM_YS***ZLZB_SS0122*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0122')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0122'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0122'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0122'
end
go

/*********No.299: ZLZB_SS0146******ZBMX***ZLZB_SS0146*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0146')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0146'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝叶切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0146'
end
go

/*********No.299: ZLZB_SS0146******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0146*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0146')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0146'
 where zb_id='ZLZB_SS0146'
end
go

/*********No.299: ZLZB_SS0146******HD_ZBMX_HZ***ZLZB_SS0146*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0146')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11092'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0146'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0146'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0146'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=30   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0146'
,zb_name='肝叶切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0146'
end
go

/*********No.299: ZLZB_SS0146******ZB_FACT_DIM_YS***ZLZB_SS0146*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0146')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0146'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0146'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0146'
end
go

/*********No.300: ZLZB_SS0147******ZBMX***ZLZB_SS0147*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0147')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0147'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝叶切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0147'
end
go

/*********No.300: ZLZB_SS0147******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0147*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0147')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0147'
 where zb_id='ZLZB_SS0147'
end
go

/*********No.300: ZLZB_SS0147******HD_ZBMX_HZ***ZLZB_SS0147*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0147')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11093'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0147'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0147'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0147'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=30  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0147'
,zb_name='肝叶切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0147'
end
go

/*********No.300: ZLZB_SS0147******ZB_FACT_DIM_YS***ZLZB_SS0147*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0147')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0147'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0147'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0147'
end
go

/*********No.301: ZLZB_SS0148******ZBMX***ZLZB_SS0148*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0148')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0148'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝叶切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0148'
end
go

/*********No.301: ZLZB_SS0148******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0148*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0148')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0148'
 where zb_id='ZLZB_SS0148'
end
go

/*********No.301: ZLZB_SS0148******HD_ZBMX_HZ***ZLZB_SS0148*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0148')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11094'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0148'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0148'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0148'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=30    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0148'
,zb_name='肝叶切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0148'
end
go

/*********No.301: ZLZB_SS0148******ZB_FACT_DIM_YS***ZLZB_SS0148*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0148')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0148'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0148'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0148'
end
go

/*********No.302: ZLZB_SS0149******ZBMX***ZLZB_SS0149*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0149')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0149'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝叶切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0149'
end
go

/*********No.302: ZLZB_SS0149******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0149*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0149')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0149'
 where zb_id='ZLZB_SS0149'
end
go

/*********No.302: ZLZB_SS0149******HD_ZBMX_HZ***ZLZB_SS0149*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0149')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11095'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0149'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0149'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0149'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=30    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0149'
,zb_name='肝叶切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0149'
end
go

/*********No.302: ZLZB_SS0149******ZB_FACT_DIM_YS***ZLZB_SS0149*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0149')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0149'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0149'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0149'
end
go

/*********No.303: ZLZB_SS0150******ZBMX***ZLZB_SS0150*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0150')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0150'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝叶切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0150'
end
go

/*********No.303: ZLZB_SS0150******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0150*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0150')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0150'
 where zb_id='ZLZB_SS0150'
end
go

/*********No.303: ZLZB_SS0150******HD_ZBMX_HZ***ZLZB_SS0150*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0150')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11096'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0150'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0150'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=30    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0150'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=30    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0150'
,zb_name='肝叶切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0150'
end
go

/*********No.303: ZLZB_SS0150******ZB_FACT_DIM_YS***ZLZB_SS0150*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0150')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0150'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0150'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0150'
end
go

/*********No.304: ZLZB_SS0151******ZBMX***ZLZB_SS0151*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0151')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0151'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='半肝切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0151'
end
go

/*********No.304: ZLZB_SS0151******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0151*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0151')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0151'
 where zb_id='ZLZB_SS0151'
end
go

/*********No.304: ZLZB_SS0151******HD_ZBMX_HZ***ZLZB_SS0151*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0151')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11098'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0151'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0151'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0151'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=31   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0151'
,zb_name='半肝切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0151'
end
go

/*********No.304: ZLZB_SS0151******ZB_FACT_DIM_YS***ZLZB_SS0151*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0151')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0151'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0151'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0151'
end
go

/*********No.305: ZLZB_SS0152******ZBMX***ZLZB_SS0152*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0152')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0152'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='半肝切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0152'
end
go

/*********No.305: ZLZB_SS0152******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0152*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0152')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0152'
 where zb_id='ZLZB_SS0152'
end
go

/*********No.305: ZLZB_SS0152******HD_ZBMX_HZ***ZLZB_SS0152*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0152')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11099'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0152'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0152'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0152'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=31  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0152'
,zb_name='半肝切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0152'
end
go

/*********No.305: ZLZB_SS0152******ZB_FACT_DIM_YS***ZLZB_SS0152*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0152')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0152'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0152'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0152'
end
go

/*********No.306: ZLZB_SS0153******ZBMX***ZLZB_SS0153*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0153')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0153'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='半肝切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0153'
end
go

/*********No.306: ZLZB_SS0153******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0153*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0153')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0153'
 where zb_id='ZLZB_SS0153'
end
go

/*********No.306: ZLZB_SS0153******HD_ZBMX_HZ***ZLZB_SS0153*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0153')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11100'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0153'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0153'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0153'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=31    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0153'
,zb_name='半肝切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0153'
end
go

/*********No.306: ZLZB_SS0153******ZB_FACT_DIM_YS***ZLZB_SS0153*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0153')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0153'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0153'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0153'
end
go

/*********No.307: ZLZB_SS0154******ZBMX***ZLZB_SS0154*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0154')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0154'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='半肝切除术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0154'
end
go

/*********No.307: ZLZB_SS0154******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0154*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0154')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0154'
 where zb_id='ZLZB_SS0154'
end
go

/*********No.307: ZLZB_SS0154******HD_ZBMX_HZ***ZLZB_SS0154*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0154')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11101'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0154'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0154'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0154'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=31    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0154'
,zb_name='半肝切除术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0154'
end
go

/*********No.307: ZLZB_SS0154******ZB_FACT_DIM_YS***ZLZB_SS0154*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0154')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0154'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0154'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0154'
end
go

/*********No.308: ZLZB_SS0155******ZBMX***ZLZB_SS0155*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0155')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0155'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='半肝切除术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0155'
end
go

/*********No.308: ZLZB_SS0155******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0155*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0155')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0155'
 where zb_id='ZLZB_SS0155'
end
go

/*********No.308: ZLZB_SS0155******HD_ZBMX_HZ***ZLZB_SS0155*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0155')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11102'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0155'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0155'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=31    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0155'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=31    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0155'
,zb_name='半肝切除术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0155'
end
go

/*********No.308: ZLZB_SS0155******ZB_FACT_DIM_YS***ZLZB_SS0155*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0155')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0155'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0155'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0155'
end
go

/*********No.309: ZLZB_SS0156******ZBMX***ZLZB_SS0156*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0156')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0156'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝段切除术的总例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0156'
end
go

/*********No.309: ZLZB_SS0156******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0156*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0156')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0156'
 where zb_id='ZLZB_SS0156'
end
go

/*********No.309: ZLZB_SS0156******HD_ZBMX_HZ***ZLZB_SS0156*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0156')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11104'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0156'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0156'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32   and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0156'' zbmx_id,  timekey, yykey ,kskey , sum(rc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=32   and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0156'
,zb_name='肝段切除术的总例数'
,zbzt='0'
 where zb_id='ZLZB_SS0156'
end
go

/*********No.309: ZLZB_SS0156******ZB_FACT_DIM_YS***ZLZB_SS0156*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0156')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0156'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0156'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0156'
end
go

/*********No.310: ZLZB_SS0157******ZBMX***ZLZB_SS0157*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0157')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0157'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝段切除术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0157'
end
go

/*********No.310: ZLZB_SS0157******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0157*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0157')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0157'
 where zb_id='ZLZB_SS0157'
end
go

/*********No.310: ZLZB_SS0157******HD_ZBMX_HZ***ZLZB_SS0157*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0157')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11105'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0157'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0157'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0157'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=32  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0157'
,zb_name='肝段切除术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0157'
end
go

/*********No.310: ZLZB_SS0157******ZB_FACT_DIM_YS***ZLZB_SS0157*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0157')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0157'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0157'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0157'
end
go

/*********No.311: ZLZB_SS0158******ZBMX***ZLZB_SS0158*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0158')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0158'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='肝段切除术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0158'
end
go

/*********No.311: ZLZB_SS0158******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0158*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0158')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0158'
 where zb_id='ZLZB_SS0158'
end
go

/*********No.311: ZLZB_SS0158******HD_ZBMX_HZ***ZLZB_SS0158*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0158')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11106'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0158'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0158'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=32    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0158'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=32    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0158'
,zb_name='肝段切除术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0158'
end
go

/*********No.311: ZLZB_SS0158******ZB_FACT_DIM_YS***ZLZB_SS0158*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0158')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0158'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0158'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0158'
end
go

/*********No.312: ZLZB_SS0097******ZBMX***ZLZB_SS0097*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0097')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0097'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='喉癌联合根治术的死亡例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0097'
end
go

/*********No.312: ZLZB_SS0097******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0097*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0097')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='swrc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0097'
 where zb_id='ZLZB_SS0097'
end
go

/*********No.312: ZLZB_SS0097******HD_ZBMX_HZ***ZLZB_SS0097*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0097')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11025'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0097'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0097'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20  and lyfskey=5     and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0097'' zbmx_id,  timekey, yykey ,kskey , sum(swrc) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=20  and lyfskey=5     and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0097'
,zb_name='喉癌联合根治术的死亡例数'
,zbzt='0'
 where zb_id='ZLZB_SS0097'
end
go

/*********No.312: ZLZB_SS0097******ZB_FACT_DIM_YS***ZLZB_SS0097*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0097')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0097'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0097'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0097'
end
go

/*********No.313: ZLZB_SS0098******ZBMX***ZLZB_SS0098*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0098')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0098'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='喉癌联合根治术的术后非预期再手术例数'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='0'
,tjzb=''
,xsws='0'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='例'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0098'
end
go

/*********No.313: ZLZB_SS0098******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0098*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0098')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='shfyqzssls'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0098'
 where zb_id='ZLZB_SS0098'
end
go

/*********No.313: ZLZB_SS0098******HD_ZBMX_HZ***ZLZB_SS0098*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0098')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11026'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0098'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0098'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0098'' zbmx_id,  timekey, yykey ,kskey , sum(shfyqzssls) fz, 0 fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=20    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0098'
,zb_name='喉癌联合根治术的术后非预期再手术例数'
,zbzt='0'
 where zb_id='ZLZB_SS0098'
end
go

/*********No.313: ZLZB_SS0098******ZB_FACT_DIM_YS***ZLZB_SS0098*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0098')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0098'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0098'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0098'
end
go

/*********No.314: ZLZB_SS0099******ZBMX***ZLZB_SS0099*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0099')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0099'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='喉癌联合根治术的平均住院日'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='天'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0099'
end
go

/*********No.314: ZLZB_SS0099******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0099*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0099')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0099'
 where zb_id='ZLZB_SS0099'
end
go

/*********No.314: ZLZB_SS0099******HD_ZBMX_HZ***ZLZB_SS0099*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0099')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11027'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0099'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0099'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0099'' zbmx_id,  timekey, yykey ,kskey , sum(zyts) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=20    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0099'
,zb_name='喉癌联合根治术的平均住院日'
,zbzt='0'
 where zb_id='ZLZB_SS0099'
end
go

/*********No.314: ZLZB_SS0099******ZB_FACT_DIM_YS***ZLZB_SS0099*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0099')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0099'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0099'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0099'
end
go

/*********No.315: ZLZB_SS0100******ZBMX***ZLZB_SS0100*****************/

if  exists(select 1 from ZBMX where id='ZLZB_SS0100')
begin
update ZBMX set
blbz=''
,blfs=''
,blgz=''
,bmid=''
,code=''
,czry=''
,fjgz_id=''
,gxrq=''
,id='ZLZB_SS0100'
,is_hz='0'
,isblzb=''
,isxybl=''
,jlzt='0'
,jskj=''
,jyzt=''
,ljfs=''
,mbz_having='1'
,mbz_lrfa=''
,mbz_lrfs='1'
,mbz_zzfd='0.00000'
,memo=''
,mzzybz=''
,name='喉癌联合根治术的平均住院费用'
,percent_type='1'
,pid=''
,pjbz='1'
,qrzt=''
,tjfs='1'
,tjzb=''
,xsws='4'
,xtly=''
,yjgzdm=''
,yjgznr=''
,zbdw='元'
,zbfl_id='ZLZB03'
,zbyy=''
 where id='ZLZB_SS0100'
end
go

/*********No.315: ZLZB_SS0100******Y_COLUMN_MAP_ZBFACT***ZLZB_SS0100*****************/

if  exists(select 1 from Y_COLUMN_MAP_ZBFACT where zb_id='ZLZB_SS0100')
begin
update Y_COLUMN_MAP_ZBFACT set
depend_zbids=''
,fact_colname='rc'
,fact_tablename='FACT_GZ_HZAQ_ZDSS'
,zb_id='ZLZB_SS0100'
 where zb_id='ZLZB_SS0100'
end
go

/*********No.315: ZLZB_SS0100******HD_ZBMX_HZ***ZLZB_SS0100*****************/

if  exists(select 1 from HD_ZBMX_HZ where zb_id='ZLZB_SS0100')
begin
update HD_ZBMX_HZ set
condition=''
,dependindex=''
,dlzgs=''
,dylx=''
,fact_dlz=''
,fact_table=''
,gspz=''
,hqsql_text=''
,jlzt='1'
,kslx=''
,kxwdz=''
,memo=''
,orderno='11028'
,proc_name=''
,sql_end='  ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_middle=' select ''ZLZB_SS0100'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey '
,sql_start='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM ( '
,sql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (  select ''ZLZB_SS0100'' zbmx_id, mzyskey,  lyfskey,   timekey, yykey ,kskey , yskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS a  where zdsskey=20    and  timekey between @kssj and @jssj and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey , yskey ,timekey,lyfskey,mzyskey   ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE timekey between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),timekey,120)+''1'')'
,sql_text_first=''
,tqsql_text='  SELECT  zbmx_id,a.yykey,ISNULL(b.yydm,''01'') yydm,a.kskey,c.ksdm  , CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'') month, SUM(fz) fz,sum(fm) fm,NULL czry,GETDATE()  gxrq,null bqkey  FROM (   select ''ZLZB_SS0100'' zbmx_id,  timekey, yykey ,kskey , sum(zfy) fz, sum(rc) fm from FACT_GZ_HZAQ_ZDSS  where zdsskey=20    and  timekey between DATEADD(YEAR,-1,@kssj) and DATEADD(YEAR,-1,@jssj) and (yykey in (@yykey) or -1 in (@yykey)) group by yykey,kskey,timekey    ) a inner join DIM_YYXX b ON a.yykey=b.yykey   inner join DIM_KSXX c ON a.kskey=c.kskey and a.yykey=c.yykey   WHERE DATEADD(YEAR,1,timekey) between @kssj  and @jssj and (a.yykey in (@yykey) or -1 in (@yykey))   GROUP  BY zbmx_id,  a.yykey,b.yydm,a.kskey,c.ksdm,CONVERT(DATE,CONVERT(CHAR(8),DATEADD(YEAR,1,timekey),120)+''1'')'
,ysfs='-1'
,zb_id='ZLZB_SS0100'
,zb_name='喉癌联合根治术的平均住院费用'
,zbzt='0'
 where zb_id='ZLZB_SS0100'
end
go

/*********No.315: ZLZB_SS0100******ZB_FACT_DIM_YS***ZLZB_SS0100*****************/

if  exists(select 1 from ZB_FACT_DIM_YS where zbmx_id='ZLZB_SS0100')
begin
update ZB_FACT_DIM_YS set
dim_table='科室'
,dim_table_name='DIM_KSXX_BA'
,dim_table_val='ksmc'
,fm_condition='where'
,fm_fact_table_name='0'
,fm_fact_val='0'
,fz_condition='where'
,fz_fact_table_name='ZLZB_SS0100'
,fz_fact_val='1'
,join_code='kskey'
,next_join_code='kskey'
,next_kz_key=''
,next_kz_value=''
,wdkz_key=''
,wdkz_lb=''
,wdkz_name=''
,wdkz_table=''
,zbmx_id='ZLZB_SS0100'
,zbmx_tjhs='sum'
 where zbmx_id='ZLZB_SS0100'
end
go
